function RM(t,e){for(var n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in t)){const d=Object.getOwnPropertyDescriptor(o,a);d&&Object.defineProperty(t,a,d.get?d:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(a){if(a.ep)return;a.ep=!0;const d=n(a);fetch(a.href,d)}})();var Rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function MM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var a=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:function(){return t[o]}})}),n}var BE={exports:{}},Oy={},VE={exports:{}},ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lf=Symbol.for("react.element"),LM=Symbol.for("react.portal"),DM=Symbol.for("react.fragment"),zM=Symbol.for("react.strict_mode"),OM=Symbol.for("react.profiler"),FM=Symbol.for("react.provider"),NM=Symbol.for("react.context"),BM=Symbol.for("react.forward_ref"),VM=Symbol.for("react.suspense"),jM=Symbol.for("react.memo"),UM=Symbol.for("react.lazy"),E2=Symbol.iterator;function $M(t){return t===null||typeof t!="object"?null:(t=E2&&t[E2]||t["@@iterator"],typeof t=="function"?t:null)}var jE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},UE=Object.assign,$E={};function yd(t,e,n){this.props=t,this.context=e,this.refs=$E,this.updater=n||jE}yd.prototype.isReactComponent={};yd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};yd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function qE(){}qE.prototype=yd.prototype;function ax(t,e,n){this.props=t,this.context=e,this.refs=$E,this.updater=n||jE}var lx=ax.prototype=new qE;lx.constructor=ax;UE(lx,yd.prototype);lx.isPureReactComponent=!0;var I2=Array.isArray,HE=Object.prototype.hasOwnProperty,ux={current:null},WE={key:!0,ref:!0,__self:!0,__source:!0};function GE(t,e,n){var o,a={},d=null,p=null;if(e!=null)for(o in e.ref!==void 0&&(p=e.ref),e.key!==void 0&&(d=""+e.key),e)HE.call(e,o)&&!WE.hasOwnProperty(o)&&(a[o]=e[o]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var S=Array(c),A=0;A<c;A++)S[A]=arguments[A+2];a.children=S}if(t&&t.defaultProps)for(o in c=t.defaultProps,c)a[o]===void 0&&(a[o]=c[o]);return{$$typeof:Lf,type:t,key:d,ref:p,props:a,_owner:ux.current}}function qM(t,e){return{$$typeof:Lf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lf}function HM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var C2=/\/+/g;function _0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?HM(""+t.key):e.toString(36)}function hg(t,e,n,o,a){var d=typeof t;(d==="undefined"||d==="boolean")&&(t=null);var p=!1;if(t===null)p=!0;else switch(d){case"string":case"number":p=!0;break;case"object":switch(t.$$typeof){case Lf:case LM:p=!0}}if(p)return p=t,a=a(p),t=o===""?"."+_0(p,0):o,I2(a)?(n="",t!=null&&(n=t.replace(C2,"$&/")+"/"),hg(a,e,n,"",function(A){return A})):a!=null&&(cx(a)&&(a=qM(a,n+(!a.key||p&&p.key===a.key?"":(""+a.key).replace(C2,"$&/")+"/")+t)),e.push(a)),1;if(p=0,o=o===""?".":o+":",I2(t))for(var c=0;c<t.length;c++){d=t[c];var S=o+_0(d,c);p+=hg(d,e,n,S,a)}else if(S=$M(t),typeof S=="function")for(t=S.call(t),c=0;!(d=t.next()).done;)d=d.value,S=o+_0(d,c++),p+=hg(d,e,n,S,a);else if(d==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return p}function Om(t,e,n){if(t==null)return t;var o=[],a=0;return hg(t,o,"","",function(d){return e.call(n,d,a++)}),o}function WM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var go={current:null},dg={transition:null},GM={ReactCurrentDispatcher:go,ReactCurrentBatchConfig:dg,ReactCurrentOwner:ux};function KE(){throw Error("act(...) is not supported in production builds of React.")}ln.Children={map:Om,forEach:function(t,e,n){Om(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Om(t,function(){e++}),e},toArray:function(t){return Om(t,function(e){return e})||[]},only:function(t){if(!cx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ln.Component=yd;ln.Fragment=DM;ln.Profiler=OM;ln.PureComponent=ax;ln.StrictMode=zM;ln.Suspense=VM;ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GM;ln.act=KE;ln.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var o=UE({},t.props),a=t.key,d=t.ref,p=t._owner;if(e!=null){if(e.ref!==void 0&&(d=e.ref,p=ux.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(S in e)HE.call(e,S)&&!WE.hasOwnProperty(S)&&(o[S]=e[S]===void 0&&c!==void 0?c[S]:e[S])}var S=arguments.length-2;if(S===1)o.children=n;else if(1<S){c=Array(S);for(var A=0;A<S;A++)c[A]=arguments[A+2];o.children=c}return{$$typeof:Lf,type:t.type,key:a,ref:d,props:o,_owner:p}};ln.createContext=function(t){return t={$$typeof:NM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:FM,_context:t},t.Consumer=t};ln.createElement=GE;ln.createFactory=function(t){var e=GE.bind(null,t);return e.type=t,e};ln.createRef=function(){return{current:null}};ln.forwardRef=function(t){return{$$typeof:BM,render:t}};ln.isValidElement=cx;ln.lazy=function(t){return{$$typeof:UM,_payload:{_status:-1,_result:t},_init:WM}};ln.memo=function(t,e){return{$$typeof:jM,type:t,compare:e===void 0?null:e}};ln.startTransition=function(t){var e=dg.transition;dg.transition={};try{t()}finally{dg.transition=e}};ln.unstable_act=KE;ln.useCallback=function(t,e){return go.current.useCallback(t,e)};ln.useContext=function(t){return go.current.useContext(t)};ln.useDebugValue=function(){};ln.useDeferredValue=function(t){return go.current.useDeferredValue(t)};ln.useEffect=function(t,e){return go.current.useEffect(t,e)};ln.useId=function(){return go.current.useId()};ln.useImperativeHandle=function(t,e,n){return go.current.useImperativeHandle(t,e,n)};ln.useInsertionEffect=function(t,e){return go.current.useInsertionEffect(t,e)};ln.useLayoutEffect=function(t,e){return go.current.useLayoutEffect(t,e)};ln.useMemo=function(t,e){return go.current.useMemo(t,e)};ln.useReducer=function(t,e,n){return go.current.useReducer(t,e,n)};ln.useRef=function(t){return go.current.useRef(t)};ln.useState=function(t){return go.current.useState(t)};ln.useSyncExternalStore=function(t,e,n){return go.current.useSyncExternalStore(t,e,n)};ln.useTransition=function(){return go.current.useTransition()};ln.version="18.3.1";VE.exports=ln;var Ve=VE.exports;const mr=gd(Ve),KM=RM({__proto__:null,default:mr},[Ve]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZM=Ve,XM=Symbol.for("react.element"),YM=Symbol.for("react.fragment"),QM=Object.prototype.hasOwnProperty,JM=ZM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e4={key:!0,ref:!0,__self:!0,__source:!0};function ZE(t,e,n){var o,a={},d=null,p=null;n!==void 0&&(d=""+n),e.key!==void 0&&(d=""+e.key),e.ref!==void 0&&(p=e.ref);for(o in e)QM.call(e,o)&&!e4.hasOwnProperty(o)&&(a[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps,e)a[o]===void 0&&(a[o]=e[o]);return{$$typeof:XM,type:t,key:d,ref:p,props:a,_owner:JM.current}}Oy.Fragment=YM;Oy.jsx=ZE;Oy.jsxs=ZE;BE.exports=Oy;var He=BE.exports,_v={},XE={exports:{}},Yo={},YE={exports:{}},QE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(et,ht){var Tt=et.length;et.push(ht);e:for(;0<Tt;){var kt=Tt-1>>>1,At=et[kt];if(0<a(At,ht))et[kt]=ht,et[Tt]=At,Tt=kt;else break e}}function n(et){return et.length===0?null:et[0]}function o(et){if(et.length===0)return null;var ht=et[0],Tt=et.pop();if(Tt!==ht){et[0]=Tt;e:for(var kt=0,At=et.length,jt=At>>>1;kt<jt;){var Hn=2*(kt+1)-1,fn=et[Hn],kn=Hn+1,Pn=et[kn];if(0>a(fn,Tt))kn<At&&0>a(Pn,fn)?(et[kt]=Pn,et[kn]=Tt,kt=kn):(et[kt]=fn,et[Hn]=Tt,kt=Hn);else if(kn<At&&0>a(Pn,Tt))et[kt]=Pn,et[kn]=Tt,kt=kn;else break e}}return ht}function a(et,ht){var Tt=et.sortIndex-ht.sortIndex;return Tt!==0?Tt:et.id-ht.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;t.unstable_now=function(){return d.now()}}else{var p=Date,c=p.now();t.unstable_now=function(){return p.now()-c}}var S=[],A=[],D=1,L=null,z=3,ee=!1,pe=!1,ue=!1,me=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(et){for(var ht=n(A);ht!==null;){if(ht.callback===null)o(A);else if(ht.startTime<=et)o(A),ht.sortIndex=ht.expirationTime,e(S,ht);else break;ht=n(A)}}function be(et){if(ue=!1,re(et),!pe)if(n(S)!==null)pe=!0,cn(Le);else{var ht=n(A);ht!==null&&tn(be,ht.startTime-et)}}function Le(et,ht){pe=!1,ue&&(ue=!1,te(X),X=-1),ee=!0;var Tt=z;try{for(re(ht),L=n(S);L!==null&&(!(L.expirationTime>ht)||et&&!de());){var kt=L.callback;if(typeof kt=="function"){L.callback=null,z=L.priorityLevel;var At=kt(L.expirationTime<=ht);ht=t.unstable_now(),typeof At=="function"?L.callback=At:L===n(S)&&o(S),re(ht)}else o(S);L=n(S)}if(L!==null)var jt=!0;else{var Hn=n(A);Hn!==null&&tn(be,Hn.startTime-ht),jt=!1}return jt}finally{L=null,z=Tt,ee=!1}}var Me=!1,J=null,X=-1,Y=5,ie=-1;function de(){return!(t.unstable_now()-ie<Y)}function we(){if(J!==null){var et=t.unstable_now();ie=et;var ht=!0;try{ht=J(!0,et)}finally{ht?se():(Me=!1,J=null)}}else Me=!1}var se;if(typeof G=="function")se=function(){G(we)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,un=ut.port2;ut.port1.onmessage=we,se=function(){un.postMessage(null)}}else se=function(){me(we,0)};function cn(et){J=et,Me||(Me=!0,se())}function tn(et,ht){X=me(function(){et(t.unstable_now())},ht)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(et){et.callback=null},t.unstable_continueExecution=function(){pe||ee||(pe=!0,cn(Le))},t.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<et?Math.floor(1e3/et):5},t.unstable_getCurrentPriorityLevel=function(){return z},t.unstable_getFirstCallbackNode=function(){return n(S)},t.unstable_next=function(et){switch(z){case 1:case 2:case 3:var ht=3;break;default:ht=z}var Tt=z;z=ht;try{return et()}finally{z=Tt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(et,ht){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var Tt=z;z=et;try{return ht()}finally{z=Tt}},t.unstable_scheduleCallback=function(et,ht,Tt){var kt=t.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?kt+Tt:kt):Tt=kt,et){case 1:var At=-1;break;case 2:At=250;break;case 5:At=1073741823;break;case 4:At=1e4;break;default:At=5e3}return At=Tt+At,et={id:D++,callback:ht,priorityLevel:et,startTime:Tt,expirationTime:At,sortIndex:-1},Tt>kt?(et.sortIndex=Tt,e(A,et),n(S)===null&&et===n(A)&&(ue?(te(X),X=-1):ue=!0,tn(be,Tt-kt))):(et.sortIndex=At,e(S,et),pe||ee||(pe=!0,cn(Le))),et},t.unstable_shouldYield=de,t.unstable_wrapCallback=function(et){var ht=z;return function(){var Tt=z;z=ht;try{return et.apply(this,arguments)}finally{z=Tt}}}})(QE);YE.exports=QE;var t4=YE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n4=Ve,Xo=t4;function Je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var JE=new Set,of={};function xc(t,e){Hh(t,e),Hh(t+"Capture",e)}function Hh(t,e){for(of[t]=e,t=0;t<e.length;t++)JE.add(e[t])}var rl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vv=Object.prototype.hasOwnProperty,r4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A2={},k2={};function i4(t){return vv.call(k2,t)?!0:vv.call(A2,t)?!1:r4.test(t)?k2[t]=!0:(A2[t]=!0,!1)}function o4(t,e,n,o){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function s4(t,e,n,o){if(e===null||typeof e>"u"||o4(t,e,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yo(t,e,n,o,a,d,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=d,this.removeEmptyString=p}var zi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zi[t]=new yo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zi[e]=new yo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zi[t]=new yo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zi[t]=new yo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zi[t]=new yo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zi[t]=new yo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zi[t]=new yo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zi[t]=new yo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zi[t]=new yo(t,5,!1,t.toLowerCase(),null,!1,!1)});var hx=/[\-:]([a-z])/g;function dx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hx,dx);zi[e]=new yo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hx,dx);zi[e]=new yo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hx,dx);zi[e]=new yo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zi[t]=new yo(t,1,!1,t.toLowerCase(),null,!1,!1)});zi.xlinkHref=new yo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zi[t]=new yo(t,1,!1,t.toLowerCase(),null,!0,!0)});function px(t,e,n,o){var a=zi.hasOwnProperty(e)?zi[e]:null;(a!==null?a.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(s4(e,n,a,o)&&(n=null),o||a===null?i4(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,o=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,o?t.setAttributeNS(o,e,n):t.setAttribute(e,n))))}var ll=n4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fm=Symbol.for("react.element"),_h=Symbol.for("react.portal"),vh=Symbol.for("react.fragment"),fx=Symbol.for("react.strict_mode"),xv=Symbol.for("react.profiler"),eI=Symbol.for("react.provider"),tI=Symbol.for("react.context"),mx=Symbol.for("react.forward_ref"),wv=Symbol.for("react.suspense"),bv=Symbol.for("react.suspense_list"),gx=Symbol.for("react.memo"),Nl=Symbol.for("react.lazy"),nI=Symbol.for("react.offscreen"),P2=Symbol.iterator;function wp(t){return t===null||typeof t!="object"?null:(t=P2&&t[P2]||t["@@iterator"],typeof t=="function"?t:null)}var _r=Object.assign,v0;function Mp(t){if(v0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);v0=e&&e[1]||""}return`
`+v0+t}var x0=!1;function w0(t,e){if(!t||x0)return"";x0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(A){var o=A}Reflect.construct(t,[],e)}else{try{e.call()}catch(A){o=A}t.call(e.prototype)}else{try{throw Error()}catch(A){o=A}t()}}catch(A){if(A&&o&&typeof A.stack=="string"){for(var a=A.stack.split(`
`),d=o.stack.split(`
`),p=a.length-1,c=d.length-1;1<=p&&0<=c&&a[p]!==d[c];)c--;for(;1<=p&&0<=c;p--,c--)if(a[p]!==d[c]){if(p!==1||c!==1)do if(p--,c--,0>c||a[p]!==d[c]){var S=`
`+a[p].replace(" at new "," at ");return t.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",t.displayName)),S}while(1<=p&&0<=c);break}}}finally{x0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Mp(t):""}function a4(t){switch(t.tag){case 5:return Mp(t.type);case 16:return Mp("Lazy");case 13:return Mp("Suspense");case 19:return Mp("SuspenseList");case 0:case 2:case 15:return t=w0(t.type,!1),t;case 11:return t=w0(t.type.render,!1),t;case 1:return t=w0(t.type,!0),t;default:return""}}function Sv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vh:return"Fragment";case _h:return"Portal";case xv:return"Profiler";case fx:return"StrictMode";case wv:return"Suspense";case bv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case tI:return(t.displayName||"Context")+".Consumer";case eI:return(t._context.displayName||"Context")+".Provider";case mx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gx:return e=t.displayName||null,e!==null?e:Sv(t.type)||"Memo";case Nl:e=t._payload,t=t._init;try{return Sv(t(e))}catch{}}return null}function l4(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sv(e);case 8:return e===fx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function au(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function u4(t){var e=rI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),o=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,d=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(p){o=""+p,d.call(this,p)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(p){o=""+p},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nm(t){t._valueTracker||(t._valueTracker=u4(t))}function iI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),o="";return t&&(o=rI(t)?t.checked?"true":"false":t.value),t=o,t!==n?(e.setValue(t),!0):!1}function Og(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tv(t,e){var n=e.checked;return _r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function R2(t,e){var n=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;n=au(e.value!=null?e.value:n),t._wrapperState={initialChecked:o,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function oI(t,e){e=e.checked,e!=null&&px(t,"checked",e,!1)}function Ev(t,e){oI(t,e);var n=au(e.value),o=e.type;if(n!=null)o==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(o==="submit"||o==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Iv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Iv(t,e.type,au(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function M2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Iv(t,e,n){(e!=="number"||Og(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lp=Array.isArray;function Rh(t,e,n,o){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&o&&(t[n].defaultSelected=!0)}else{for(n=""+au(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,o&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Cv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Je(91));return _r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function L2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Je(92));if(Lp(n)){if(1<n.length)throw Error(Je(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:au(n)}}function sI(t,e){var n=au(e.value),o=au(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),o!=null&&(t.defaultValue=""+o)}function D2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function aI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Av(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?aI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bm,lI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,o,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,o,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bm=Bm||document.createElement("div"),Bm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $p={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c4=["Webkit","ms","Moz","O"];Object.keys($p).forEach(function(t){c4.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$p[e]=$p[t]})});function uI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$p.hasOwnProperty(t)&&$p[t]?(""+e).trim():e+"px"}function cI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var o=n.indexOf("--")===0,a=uI(n,e[n],o);n==="float"&&(n="cssFloat"),o?t.setProperty(n,a):t[n]=a}}var h4=_r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kv(t,e){if(e){if(h4[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Je(62))}}function Pv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rv=null;function yx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mv=null,Mh=null,Lh=null;function z2(t){if(t=Of(t)){if(typeof Mv!="function")throw Error(Je(280));var e=t.stateNode;e&&(e=jy(e),Mv(t.stateNode,t.type,e))}}function hI(t){Mh?Lh?Lh.push(t):Lh=[t]:Mh=t}function dI(){if(Mh){var t=Mh,e=Lh;if(Lh=Mh=null,z2(t),e)for(t=0;t<e.length;t++)z2(e[t])}}function pI(t,e){return t(e)}function fI(){}var b0=!1;function mI(t,e,n){if(b0)return t(e,n);b0=!0;try{return pI(t,e,n)}finally{b0=!1,(Mh!==null||Lh!==null)&&(fI(),dI())}}function af(t,e){var n=t.stateNode;if(n===null)return null;var o=jy(n);if(o===null)return null;n=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,e,typeof n));return n}var Lv=!1;if(rl)try{var bp={};Object.defineProperty(bp,"passive",{get:function(){Lv=!0}}),window.addEventListener("test",bp,bp),window.removeEventListener("test",bp,bp)}catch{Lv=!1}function d4(t,e,n,o,a,d,p,c,S){var A=Array.prototype.slice.call(arguments,3);try{e.apply(n,A)}catch(D){this.onError(D)}}var qp=!1,Fg=null,Ng=!1,Dv=null,p4={onError:function(t){qp=!0,Fg=t}};function f4(t,e,n,o,a,d,p,c,S){qp=!1,Fg=null,d4.apply(p4,arguments)}function m4(t,e,n,o,a,d,p,c,S){if(f4.apply(this,arguments),qp){if(qp){var A=Fg;qp=!1,Fg=null}else throw Error(Je(198));Ng||(Ng=!0,Dv=A)}}function wc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function gI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function O2(t){if(wc(t)!==t)throw Error(Je(188))}function g4(t){var e=t.alternate;if(!e){if(e=wc(t),e===null)throw Error(Je(188));return e!==t?null:t}for(var n=t,o=e;;){var a=n.return;if(a===null)break;var d=a.alternate;if(d===null){if(o=a.return,o!==null){n=o;continue}break}if(a.child===d.child){for(d=a.child;d;){if(d===n)return O2(a),t;if(d===o)return O2(a),e;d=d.sibling}throw Error(Je(188))}if(n.return!==o.return)n=a,o=d;else{for(var p=!1,c=a.child;c;){if(c===n){p=!0,n=a,o=d;break}if(c===o){p=!0,o=a,n=d;break}c=c.sibling}if(!p){for(c=d.child;c;){if(c===n){p=!0,n=d,o=a;break}if(c===o){p=!0,o=d,n=a;break}c=c.sibling}if(!p)throw Error(Je(189))}}if(n.alternate!==o)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:e}function yI(t){return t=g4(t),t!==null?_I(t):null}function _I(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_I(t);if(e!==null)return e;t=t.sibling}return null}var vI=Xo.unstable_scheduleCallback,F2=Xo.unstable_cancelCallback,y4=Xo.unstable_shouldYield,_4=Xo.unstable_requestPaint,Rr=Xo.unstable_now,v4=Xo.unstable_getCurrentPriorityLevel,_x=Xo.unstable_ImmediatePriority,xI=Xo.unstable_UserBlockingPriority,Bg=Xo.unstable_NormalPriority,x4=Xo.unstable_LowPriority,wI=Xo.unstable_IdlePriority,Fy=null,va=null;function w4(t){if(va&&typeof va.onCommitFiberRoot=="function")try{va.onCommitFiberRoot(Fy,t,void 0,(t.current.flags&128)===128)}catch{}}var Hs=Math.clz32?Math.clz32:T4,b4=Math.log,S4=Math.LN2;function T4(t){return t>>>=0,t===0?32:31-(b4(t)/S4|0)|0}var Vm=64,jm=4194304;function Dp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vg(t,e){var n=t.pendingLanes;if(n===0)return 0;var o=0,a=t.suspendedLanes,d=t.pingedLanes,p=n&268435455;if(p!==0){var c=p&~a;c!==0?o=Dp(c):(d&=p,d!==0&&(o=Dp(d)))}else p=n&~a,p!==0?o=Dp(p):d!==0&&(o=Dp(d));if(o===0)return 0;if(e!==0&&e!==o&&!(e&a)&&(a=o&-o,d=e&-e,a>=d||a===16&&(d&4194240)!==0))return e;if(o&4&&(o|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=o;0<e;)n=31-Hs(e),a=1<<n,o|=t[n],e&=~a;return o}function E4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I4(t,e){for(var n=t.suspendedLanes,o=t.pingedLanes,a=t.expirationTimes,d=t.pendingLanes;0<d;){var p=31-Hs(d),c=1<<p,S=a[p];S===-1?(!(c&n)||c&o)&&(a[p]=E4(c,e)):S<=e&&(t.expiredLanes|=c),d&=~c}}function zv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bI(){var t=Vm;return Vm<<=1,!(Vm&4194240)&&(Vm=64),t}function S0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Df(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hs(e),t[e]=n}function C4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var o=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Hs(n),d=1<<a;e[a]=0,o[a]=-1,t[a]=-1,n&=~d}}function vx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var o=31-Hs(n),a=1<<o;a&e|t[o]&e&&(t[o]|=e),n&=~a}}var Fn=0;function SI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var TI,xx,EI,II,CI,Ov=!1,Um=[],Zl=null,Xl=null,Yl=null,lf=new Map,uf=new Map,jl=[],A4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function N2(t,e){switch(t){case"focusin":case"focusout":Zl=null;break;case"dragenter":case"dragleave":Xl=null;break;case"mouseover":case"mouseout":Yl=null;break;case"pointerover":case"pointerout":lf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uf.delete(e.pointerId)}}function Sp(t,e,n,o,a,d){return t===null||t.nativeEvent!==d?(t={blockedOn:e,domEventName:n,eventSystemFlags:o,nativeEvent:d,targetContainers:[a]},e!==null&&(e=Of(e),e!==null&&xx(e)),t):(t.eventSystemFlags|=o,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function k4(t,e,n,o,a){switch(e){case"focusin":return Zl=Sp(Zl,t,e,n,o,a),!0;case"dragenter":return Xl=Sp(Xl,t,e,n,o,a),!0;case"mouseover":return Yl=Sp(Yl,t,e,n,o,a),!0;case"pointerover":var d=a.pointerId;return lf.set(d,Sp(lf.get(d)||null,t,e,n,o,a)),!0;case"gotpointercapture":return d=a.pointerId,uf.set(d,Sp(uf.get(d)||null,t,e,n,o,a)),!0}return!1}function AI(t){var e=Yu(t.target);if(e!==null){var n=wc(e);if(n!==null){if(e=n.tag,e===13){if(e=gI(n),e!==null){t.blockedOn=e,CI(t.priority,function(){EI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Fv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var o=new n.constructor(n.type,n);Rv=o,n.target.dispatchEvent(o),Rv=null}else return e=Of(n),e!==null&&xx(e),t.blockedOn=n,!1;e.shift()}return!0}function B2(t,e,n){pg(t)&&n.delete(e)}function P4(){Ov=!1,Zl!==null&&pg(Zl)&&(Zl=null),Xl!==null&&pg(Xl)&&(Xl=null),Yl!==null&&pg(Yl)&&(Yl=null),lf.forEach(B2),uf.forEach(B2)}function Tp(t,e){t.blockedOn===e&&(t.blockedOn=null,Ov||(Ov=!0,Xo.unstable_scheduleCallback(Xo.unstable_NormalPriority,P4)))}function cf(t){function e(a){return Tp(a,t)}if(0<Um.length){Tp(Um[0],t);for(var n=1;n<Um.length;n++){var o=Um[n];o.blockedOn===t&&(o.blockedOn=null)}}for(Zl!==null&&Tp(Zl,t),Xl!==null&&Tp(Xl,t),Yl!==null&&Tp(Yl,t),lf.forEach(e),uf.forEach(e),n=0;n<jl.length;n++)o=jl[n],o.blockedOn===t&&(o.blockedOn=null);for(;0<jl.length&&(n=jl[0],n.blockedOn===null);)AI(n),n.blockedOn===null&&jl.shift()}var Dh=ll.ReactCurrentBatchConfig,jg=!0;function R4(t,e,n,o){var a=Fn,d=Dh.transition;Dh.transition=null;try{Fn=1,wx(t,e,n,o)}finally{Fn=a,Dh.transition=d}}function M4(t,e,n,o){var a=Fn,d=Dh.transition;Dh.transition=null;try{Fn=4,wx(t,e,n,o)}finally{Fn=a,Dh.transition=d}}function wx(t,e,n,o){if(jg){var a=Fv(t,e,n,o);if(a===null)L0(t,e,o,Ug,n),N2(t,o);else if(k4(a,t,e,n,o))o.stopPropagation();else if(N2(t,o),e&4&&-1<A4.indexOf(t)){for(;a!==null;){var d=Of(a);if(d!==null&&TI(d),d=Fv(t,e,n,o),d===null&&L0(t,e,o,Ug,n),d===a)break;a=d}a!==null&&o.stopPropagation()}else L0(t,e,o,null,n)}}var Ug=null;function Fv(t,e,n,o){if(Ug=null,t=yx(o),t=Yu(t),t!==null)if(e=wc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=gI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ug=t,null}function kI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v4()){case _x:return 1;case xI:return 4;case Bg:case x4:return 16;case wI:return 536870912;default:return 16}default:return 16}}var $l=null,bx=null,fg=null;function PI(){if(fg)return fg;var t,e=bx,n=e.length,o,a="value"in $l?$l.value:$l.textContent,d=a.length;for(t=0;t<n&&e[t]===a[t];t++);var p=n-t;for(o=1;o<=p&&e[n-o]===a[d-o];o++);return fg=a.slice(t,1<o?1-o:void 0)}function mg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $m(){return!0}function V2(){return!1}function Qo(t){function e(n,o,a,d,p){this._reactName=n,this._targetInst=a,this.type=o,this.nativeEvent=d,this.target=p,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(d):d[c]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?$m:V2,this.isPropagationStopped=V2,this}return _r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$m)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$m)},persist:function(){},isPersistent:$m}),e}var _d={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sx=Qo(_d),zf=_r({},_d,{view:0,detail:0}),L4=Qo(zf),T0,E0,Ep,Ny=_r({},zf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ep&&(Ep&&t.type==="mousemove"?(T0=t.screenX-Ep.screenX,E0=t.screenY-Ep.screenY):E0=T0=0,Ep=t),T0)},movementY:function(t){return"movementY"in t?t.movementY:E0}}),j2=Qo(Ny),D4=_r({},Ny,{dataTransfer:0}),z4=Qo(D4),O4=_r({},zf,{relatedTarget:0}),I0=Qo(O4),F4=_r({},_d,{animationName:0,elapsedTime:0,pseudoElement:0}),N4=Qo(F4),B4=_r({},_d,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),V4=Qo(B4),j4=_r({},_d,{data:0}),U2=Qo(j4),U4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=q4[t])?!!e[t]:!1}function Tx(){return H4}var W4=_r({},zf,{key:function(t){if(t.key){var e=U4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tx,charCode:function(t){return t.type==="keypress"?mg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),G4=Qo(W4),K4=_r({},Ny,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$2=Qo(K4),Z4=_r({},zf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tx}),X4=Qo(Z4),Y4=_r({},_d,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q4=Qo(Y4),J4=_r({},Ny,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),e3=Qo(J4),t3=[9,13,27,32],Ex=rl&&"CompositionEvent"in window,Hp=null;rl&&"documentMode"in document&&(Hp=document.documentMode);var n3=rl&&"TextEvent"in window&&!Hp,RI=rl&&(!Ex||Hp&&8<Hp&&11>=Hp),q2=" ",H2=!1;function MI(t,e){switch(t){case"keyup":return t3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xh=!1;function r3(t,e){switch(t){case"compositionend":return LI(e);case"keypress":return e.which!==32?null:(H2=!0,q2);case"textInput":return t=e.data,t===q2&&H2?null:t;default:return null}}function i3(t,e){if(xh)return t==="compositionend"||!Ex&&MI(t,e)?(t=PI(),fg=bx=$l=null,xh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return RI&&e.locale!=="ko"?null:e.data;default:return null}}var o3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function W2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!o3[t.type]:e==="textarea"}function DI(t,e,n,o){hI(o),e=$g(e,"onChange"),0<e.length&&(n=new Sx("onChange","change",null,n,o),t.push({event:n,listeners:e}))}var Wp=null,hf=null;function s3(t){HI(t,0)}function By(t){var e=Sh(t);if(iI(e))return t}function a3(t,e){if(t==="change")return e}var zI=!1;if(rl){var C0;if(rl){var A0="oninput"in document;if(!A0){var G2=document.createElement("div");G2.setAttribute("oninput","return;"),A0=typeof G2.oninput=="function"}C0=A0}else C0=!1;zI=C0&&(!document.documentMode||9<document.documentMode)}function K2(){Wp&&(Wp.detachEvent("onpropertychange",OI),hf=Wp=null)}function OI(t){if(t.propertyName==="value"&&By(hf)){var e=[];DI(e,hf,t,yx(t)),mI(s3,e)}}function l3(t,e,n){t==="focusin"?(K2(),Wp=e,hf=n,Wp.attachEvent("onpropertychange",OI)):t==="focusout"&&K2()}function u3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return By(hf)}function c3(t,e){if(t==="click")return By(e)}function h3(t,e){if(t==="input"||t==="change")return By(e)}function d3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ks=typeof Object.is=="function"?Object.is:d3;function df(t,e){if(Ks(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var a=n[o];if(!vv.call(e,a)||!Ks(t[a],e[a]))return!1}return!0}function Z2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function X2(t,e){var n=Z2(t);t=0;for(var o;n;){if(n.nodeType===3){if(o=t+n.textContent.length,t<=e&&o>=e)return{node:n,offset:e-t};t=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Z2(n)}}function FI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?FI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function NI(){for(var t=window,e=Og();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Og(t.document)}return e}function Ix(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function p3(t){var e=NI(),n=t.focusedElem,o=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&FI(n.ownerDocument.documentElement,n)){if(o!==null&&Ix(n)){if(e=o.start,t=o.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,d=Math.min(o.start,a);o=o.end===void 0?d:Math.min(o.end,a),!t.extend&&d>o&&(a=o,o=d,d=a),a=X2(n,d);var p=X2(n,o);a&&p&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==p.node||t.focusOffset!==p.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),d>o?(t.addRange(e),t.extend(p.node,p.offset)):(e.setEnd(p.node,p.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var f3=rl&&"documentMode"in document&&11>=document.documentMode,wh=null,Nv=null,Gp=null,Bv=!1;function Y2(t,e,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bv||wh==null||wh!==Og(o)||(o=wh,"selectionStart"in o&&Ix(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Gp&&df(Gp,o)||(Gp=o,o=$g(Nv,"onSelect"),0<o.length&&(e=new Sx("onSelect","select",null,e,n),t.push({event:e,listeners:o}),e.target=wh)))}function qm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bh={animationend:qm("Animation","AnimationEnd"),animationiteration:qm("Animation","AnimationIteration"),animationstart:qm("Animation","AnimationStart"),transitionend:qm("Transition","TransitionEnd")},k0={},BI={};rl&&(BI=document.createElement("div").style,"AnimationEvent"in window||(delete bh.animationend.animation,delete bh.animationiteration.animation,delete bh.animationstart.animation),"TransitionEvent"in window||delete bh.transitionend.transition);function Vy(t){if(k0[t])return k0[t];if(!bh[t])return t;var e=bh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in BI)return k0[t]=e[n];return t}var VI=Vy("animationend"),jI=Vy("animationiteration"),UI=Vy("animationstart"),$I=Vy("transitionend"),qI=new Map,Q2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function du(t,e){qI.set(t,e),xc(e,[t])}for(var P0=0;P0<Q2.length;P0++){var R0=Q2[P0],m3=R0.toLowerCase(),g3=R0[0].toUpperCase()+R0.slice(1);du(m3,"on"+g3)}du(VI,"onAnimationEnd");du(jI,"onAnimationIteration");du(UI,"onAnimationStart");du("dblclick","onDoubleClick");du("focusin","onFocus");du("focusout","onBlur");du($I,"onTransitionEnd");Hh("onMouseEnter",["mouseout","mouseover"]);Hh("onMouseLeave",["mouseout","mouseover"]);Hh("onPointerEnter",["pointerout","pointerover"]);Hh("onPointerLeave",["pointerout","pointerover"]);xc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xc("onBeforeInput",["compositionend","keypress","textInput","paste"]);xc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),y3=new Set("cancel close invalid load scroll toggle".split(" ").concat(zp));function J2(t,e,n){var o=t.type||"unknown-event";t.currentTarget=n,m4(o,e,void 0,t),t.currentTarget=null}function HI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var o=t[n],a=o.event;o=o.listeners;e:{var d=void 0;if(e)for(var p=o.length-1;0<=p;p--){var c=o[p],S=c.instance,A=c.currentTarget;if(c=c.listener,S!==d&&a.isPropagationStopped())break e;J2(a,c,A),d=S}else for(p=0;p<o.length;p++){if(c=o[p],S=c.instance,A=c.currentTarget,c=c.listener,S!==d&&a.isPropagationStopped())break e;J2(a,c,A),d=S}}}if(Ng)throw t=Dv,Ng=!1,Dv=null,t}function tr(t,e){var n=e[qv];n===void 0&&(n=e[qv]=new Set);var o=t+"__bubble";n.has(o)||(WI(e,t,2,!1),n.add(o))}function M0(t,e,n){var o=0;e&&(o|=4),WI(n,t,o,e)}var Hm="_reactListening"+Math.random().toString(36).slice(2);function pf(t){if(!t[Hm]){t[Hm]=!0,JE.forEach(function(n){n!=="selectionchange"&&(y3.has(n)||M0(n,!1,t),M0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hm]||(e[Hm]=!0,M0("selectionchange",!1,e))}}function WI(t,e,n,o){switch(kI(e)){case 1:var a=R4;break;case 4:a=M4;break;default:a=wx}n=a.bind(null,e,n,t),a=void 0,!Lv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),o?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function L0(t,e,n,o,a){var d=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var p=o.tag;if(p===3||p===4){var c=o.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(p===4)for(p=o.return;p!==null;){var S=p.tag;if((S===3||S===4)&&(S=p.stateNode.containerInfo,S===a||S.nodeType===8&&S.parentNode===a))return;p=p.return}for(;c!==null;){if(p=Yu(c),p===null)return;if(S=p.tag,S===5||S===6){o=d=p;continue e}c=c.parentNode}}o=o.return}mI(function(){var A=d,D=yx(n),L=[];e:{var z=qI.get(t);if(z!==void 0){var ee=Sx,pe=t;switch(t){case"keypress":if(mg(n)===0)break e;case"keydown":case"keyup":ee=G4;break;case"focusin":pe="focus",ee=I0;break;case"focusout":pe="blur",ee=I0;break;case"beforeblur":case"afterblur":ee=I0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=j2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=z4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=X4;break;case VI:case jI:case UI:ee=N4;break;case $I:ee=Q4;break;case"scroll":ee=L4;break;case"wheel":ee=e3;break;case"copy":case"cut":case"paste":ee=V4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=$2}var ue=(e&4)!==0,me=!ue&&t==="scroll",te=ue?z!==null?z+"Capture":null:z;ue=[];for(var G=A,re;G!==null;){re=G;var be=re.stateNode;if(re.tag===5&&be!==null&&(re=be,te!==null&&(be=af(G,te),be!=null&&ue.push(ff(G,be,re)))),me)break;G=G.return}0<ue.length&&(z=new ee(z,pe,null,n,D),L.push({event:z,listeners:ue}))}}if(!(e&7)){e:{if(z=t==="mouseover"||t==="pointerover",ee=t==="mouseout"||t==="pointerout",z&&n!==Rv&&(pe=n.relatedTarget||n.fromElement)&&(Yu(pe)||pe[il]))break e;if((ee||z)&&(z=D.window===D?D:(z=D.ownerDocument)?z.defaultView||z.parentWindow:window,ee?(pe=n.relatedTarget||n.toElement,ee=A,pe=pe?Yu(pe):null,pe!==null&&(me=wc(pe),pe!==me||pe.tag!==5&&pe.tag!==6)&&(pe=null)):(ee=null,pe=A),ee!==pe)){if(ue=j2,be="onMouseLeave",te="onMouseEnter",G="mouse",(t==="pointerout"||t==="pointerover")&&(ue=$2,be="onPointerLeave",te="onPointerEnter",G="pointer"),me=ee==null?z:Sh(ee),re=pe==null?z:Sh(pe),z=new ue(be,G+"leave",ee,n,D),z.target=me,z.relatedTarget=re,be=null,Yu(D)===A&&(ue=new ue(te,G+"enter",pe,n,D),ue.target=re,ue.relatedTarget=me,be=ue),me=be,ee&&pe)t:{for(ue=ee,te=pe,G=0,re=ue;re;re=dh(re))G++;for(re=0,be=te;be;be=dh(be))re++;for(;0<G-re;)ue=dh(ue),G--;for(;0<re-G;)te=dh(te),re--;for(;G--;){if(ue===te||te!==null&&ue===te.alternate)break t;ue=dh(ue),te=dh(te)}ue=null}else ue=null;ee!==null&&eS(L,z,ee,ue,!1),pe!==null&&me!==null&&eS(L,me,pe,ue,!0)}}e:{if(z=A?Sh(A):window,ee=z.nodeName&&z.nodeName.toLowerCase(),ee==="select"||ee==="input"&&z.type==="file")var Le=a3;else if(W2(z))if(zI)Le=h3;else{Le=u3;var Me=l3}else(ee=z.nodeName)&&ee.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(Le=c3);if(Le&&(Le=Le(t,A))){DI(L,Le,n,D);break e}Me&&Me(t,z,A),t==="focusout"&&(Me=z._wrapperState)&&Me.controlled&&z.type==="number"&&Iv(z,"number",z.value)}switch(Me=A?Sh(A):window,t){case"focusin":(W2(Me)||Me.contentEditable==="true")&&(wh=Me,Nv=A,Gp=null);break;case"focusout":Gp=Nv=wh=null;break;case"mousedown":Bv=!0;break;case"contextmenu":case"mouseup":case"dragend":Bv=!1,Y2(L,n,D);break;case"selectionchange":if(f3)break;case"keydown":case"keyup":Y2(L,n,D)}var J;if(Ex)e:{switch(t){case"compositionstart":var X="onCompositionStart";break e;case"compositionend":X="onCompositionEnd";break e;case"compositionupdate":X="onCompositionUpdate";break e}X=void 0}else xh?MI(t,n)&&(X="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(X="onCompositionStart");X&&(RI&&n.locale!=="ko"&&(xh||X!=="onCompositionStart"?X==="onCompositionEnd"&&xh&&(J=PI()):($l=D,bx="value"in $l?$l.value:$l.textContent,xh=!0)),Me=$g(A,X),0<Me.length&&(X=new U2(X,t,null,n,D),L.push({event:X,listeners:Me}),J?X.data=J:(J=LI(n),J!==null&&(X.data=J)))),(J=n3?r3(t,n):i3(t,n))&&(A=$g(A,"onBeforeInput"),0<A.length&&(D=new U2("onBeforeInput","beforeinput",null,n,D),L.push({event:D,listeners:A}),D.data=J))}HI(L,e)})}function ff(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $g(t,e){for(var n=e+"Capture",o=[];t!==null;){var a=t,d=a.stateNode;a.tag===5&&d!==null&&(a=d,d=af(t,n),d!=null&&o.unshift(ff(t,d,a)),d=af(t,e),d!=null&&o.push(ff(t,d,a))),t=t.return}return o}function dh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eS(t,e,n,o,a){for(var d=e._reactName,p=[];n!==null&&n!==o;){var c=n,S=c.alternate,A=c.stateNode;if(S!==null&&S===o)break;c.tag===5&&A!==null&&(c=A,a?(S=af(n,d),S!=null&&p.unshift(ff(n,S,c))):a||(S=af(n,d),S!=null&&p.push(ff(n,S,c)))),n=n.return}p.length!==0&&t.push({event:e,listeners:p})}var _3=/\r\n?/g,v3=/\u0000|\uFFFD/g;function tS(t){return(typeof t=="string"?t:""+t).replace(_3,`
`).replace(v3,"")}function Wm(t,e,n){if(e=tS(e),tS(t)!==e&&n)throw Error(Je(425))}function qg(){}var Vv=null,jv=null;function Uv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $v=typeof setTimeout=="function"?setTimeout:void 0,x3=typeof clearTimeout=="function"?clearTimeout:void 0,nS=typeof Promise=="function"?Promise:void 0,w3=typeof queueMicrotask=="function"?queueMicrotask:typeof nS<"u"?function(t){return nS.resolve(null).then(t).catch(b3)}:$v;function b3(t){setTimeout(function(){throw t})}function D0(t,e){var n=e,o=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(o===0){t.removeChild(a),cf(e);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=a}while(n);cf(e)}function Ql(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vd=Math.random().toString(36).slice(2),ga="__reactFiber$"+vd,mf="__reactProps$"+vd,il="__reactContainer$"+vd,qv="__reactEvents$"+vd,S3="__reactListeners$"+vd,T3="__reactHandles$"+vd;function Yu(t){var e=t[ga];if(e)return e;for(var n=t.parentNode;n;){if(e=n[il]||n[ga]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rS(t);t!==null;){if(n=t[ga])return n;t=rS(t)}return e}t=n,n=t.parentNode}return null}function Of(t){return t=t[ga]||t[il],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Sh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function jy(t){return t[mf]||null}var Hv=[],Th=-1;function pu(t){return{current:t}}function rr(t){0>Th||(t.current=Hv[Th],Hv[Th]=null,Th--)}function Yn(t,e){Th++,Hv[Th]=t.current,t.current=e}var lu={},eo=pu(lu),ko=pu(!1),cc=lu;function Wh(t,e){var n=t.type.contextTypes;if(!n)return lu;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var a={},d;for(d in n)a[d]=e[d];return o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Po(t){return t=t.childContextTypes,t!=null}function Hg(){rr(ko),rr(eo)}function iS(t,e,n){if(eo.current!==lu)throw Error(Je(168));Yn(eo,e),Yn(ko,n)}function GI(t,e,n){var o=t.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var a in o)if(!(a in e))throw Error(Je(108,l4(t)||"Unknown",a));return _r({},n,o)}function Wg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||lu,cc=eo.current,Yn(eo,t),Yn(ko,ko.current),!0}function oS(t,e,n){var o=t.stateNode;if(!o)throw Error(Je(169));n?(t=GI(t,e,cc),o.__reactInternalMemoizedMergedChildContext=t,rr(ko),rr(eo),Yn(eo,t)):rr(ko),Yn(ko,n)}var Ja=null,Uy=!1,z0=!1;function KI(t){Ja===null?Ja=[t]:Ja.push(t)}function E3(t){Uy=!0,KI(t)}function fu(){if(!z0&&Ja!==null){z0=!0;var t=0,e=Fn;try{var n=Ja;for(Fn=1;t<n.length;t++){var o=n[t];do o=o(!0);while(o!==null)}Ja=null,Uy=!1}catch(a){throw Ja!==null&&(Ja=Ja.slice(t+1)),vI(_x,fu),a}finally{Fn=e,z0=!1}}return null}var Eh=[],Ih=0,Gg=null,Kg=0,ms=[],gs=0,hc=null,el=1,tl="";function Gu(t,e){Eh[Ih++]=Kg,Eh[Ih++]=Gg,Gg=t,Kg=e}function ZI(t,e,n){ms[gs++]=el,ms[gs++]=tl,ms[gs++]=hc,hc=t;var o=el;t=tl;var a=32-Hs(o)-1;o&=~(1<<a),n+=1;var d=32-Hs(e)+a;if(30<d){var p=a-a%5;d=(o&(1<<p)-1).toString(32),o>>=p,a-=p,el=1<<32-Hs(e)+a|n<<a|o,tl=d+t}else el=1<<d|n<<a|o,tl=t}function Cx(t){t.return!==null&&(Gu(t,1),ZI(t,1,0))}function Ax(t){for(;t===Gg;)Gg=Eh[--Ih],Eh[Ih]=null,Kg=Eh[--Ih],Eh[Ih]=null;for(;t===hc;)hc=ms[--gs],ms[gs]=null,tl=ms[--gs],ms[gs]=null,el=ms[--gs],ms[gs]=null}var Zo=null,Ko=null,hr=!1,$s=null;function XI(t,e){var n=ys(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Zo=t,Ko=Ql(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Zo=t,Ko=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=hc!==null?{id:el,overflow:tl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ys(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Zo=t,Ko=null,!0):!1;default:return!1}}function Wv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gv(t){if(hr){var e=Ko;if(e){var n=e;if(!sS(t,e)){if(Wv(t))throw Error(Je(418));e=Ql(n.nextSibling);var o=Zo;e&&sS(t,e)?XI(o,n):(t.flags=t.flags&-4097|2,hr=!1,Zo=t)}}else{if(Wv(t))throw Error(Je(418));t.flags=t.flags&-4097|2,hr=!1,Zo=t}}}function aS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Zo=t}function Gm(t){if(t!==Zo)return!1;if(!hr)return aS(t),hr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Uv(t.type,t.memoizedProps)),e&&(e=Ko)){if(Wv(t))throw YI(),Error(Je(418));for(;e;)XI(t,e),e=Ql(e.nextSibling)}if(aS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ko=Ql(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ko=null}}else Ko=Zo?Ql(t.stateNode.nextSibling):null;return!0}function YI(){for(var t=Ko;t;)t=Ql(t.nextSibling)}function Gh(){Ko=Zo=null,hr=!1}function kx(t){$s===null?$s=[t]:$s.push(t)}var I3=ll.ReactCurrentBatchConfig;function Ip(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var o=n.stateNode}if(!o)throw Error(Je(147,t));var a=o,d=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===d?e.ref:(e=function(p){var c=a.refs;p===null?delete c[d]:c[d]=p},e._stringRef=d,e)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function Km(t,e){throw t=Object.prototype.toString.call(e),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lS(t){var e=t._init;return e(t._payload)}function QI(t){function e(te,G){if(t){var re=te.deletions;re===null?(te.deletions=[G],te.flags|=16):re.push(G)}}function n(te,G){if(!t)return null;for(;G!==null;)e(te,G),G=G.sibling;return null}function o(te,G){for(te=new Map;G!==null;)G.key!==null?te.set(G.key,G):te.set(G.index,G),G=G.sibling;return te}function a(te,G){return te=nu(te,G),te.index=0,te.sibling=null,te}function d(te,G,re){return te.index=re,t?(re=te.alternate,re!==null?(re=re.index,re<G?(te.flags|=2,G):re):(te.flags|=2,G)):(te.flags|=1048576,G)}function p(te){return t&&te.alternate===null&&(te.flags|=2),te}function c(te,G,re,be){return G===null||G.tag!==6?(G=U0(re,te.mode,be),G.return=te,G):(G=a(G,re),G.return=te,G)}function S(te,G,re,be){var Le=re.type;return Le===vh?D(te,G,re.props.children,be,re.key):G!==null&&(G.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Nl&&lS(Le)===G.type)?(be=a(G,re.props),be.ref=Ip(te,G,re),be.return=te,be):(be=bg(re.type,re.key,re.props,null,te.mode,be),be.ref=Ip(te,G,re),be.return=te,be)}function A(te,G,re,be){return G===null||G.tag!==4||G.stateNode.containerInfo!==re.containerInfo||G.stateNode.implementation!==re.implementation?(G=$0(re,te.mode,be),G.return=te,G):(G=a(G,re.children||[]),G.return=te,G)}function D(te,G,re,be,Le){return G===null||G.tag!==7?(G=rc(re,te.mode,be,Le),G.return=te,G):(G=a(G,re),G.return=te,G)}function L(te,G,re){if(typeof G=="string"&&G!==""||typeof G=="number")return G=U0(""+G,te.mode,re),G.return=te,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Fm:return re=bg(G.type,G.key,G.props,null,te.mode,re),re.ref=Ip(te,null,G),re.return=te,re;case _h:return G=$0(G,te.mode,re),G.return=te,G;case Nl:var be=G._init;return L(te,be(G._payload),re)}if(Lp(G)||wp(G))return G=rc(G,te.mode,re,null),G.return=te,G;Km(te,G)}return null}function z(te,G,re,be){var Le=G!==null?G.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return Le!==null?null:c(te,G,""+re,be);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Fm:return re.key===Le?S(te,G,re,be):null;case _h:return re.key===Le?A(te,G,re,be):null;case Nl:return Le=re._init,z(te,G,Le(re._payload),be)}if(Lp(re)||wp(re))return Le!==null?null:D(te,G,re,be,null);Km(te,re)}return null}function ee(te,G,re,be,Le){if(typeof be=="string"&&be!==""||typeof be=="number")return te=te.get(re)||null,c(G,te,""+be,Le);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case Fm:return te=te.get(be.key===null?re:be.key)||null,S(G,te,be,Le);case _h:return te=te.get(be.key===null?re:be.key)||null,A(G,te,be,Le);case Nl:var Me=be._init;return ee(te,G,re,Me(be._payload),Le)}if(Lp(be)||wp(be))return te=te.get(re)||null,D(G,te,be,Le,null);Km(G,be)}return null}function pe(te,G,re,be){for(var Le=null,Me=null,J=G,X=G=0,Y=null;J!==null&&X<re.length;X++){J.index>X?(Y=J,J=null):Y=J.sibling;var ie=z(te,J,re[X],be);if(ie===null){J===null&&(J=Y);break}t&&J&&ie.alternate===null&&e(te,J),G=d(ie,G,X),Me===null?Le=ie:Me.sibling=ie,Me=ie,J=Y}if(X===re.length)return n(te,J),hr&&Gu(te,X),Le;if(J===null){for(;X<re.length;X++)J=L(te,re[X],be),J!==null&&(G=d(J,G,X),Me===null?Le=J:Me.sibling=J,Me=J);return hr&&Gu(te,X),Le}for(J=o(te,J);X<re.length;X++)Y=ee(J,te,X,re[X],be),Y!==null&&(t&&Y.alternate!==null&&J.delete(Y.key===null?X:Y.key),G=d(Y,G,X),Me===null?Le=Y:Me.sibling=Y,Me=Y);return t&&J.forEach(function(de){return e(te,de)}),hr&&Gu(te,X),Le}function ue(te,G,re,be){var Le=wp(re);if(typeof Le!="function")throw Error(Je(150));if(re=Le.call(re),re==null)throw Error(Je(151));for(var Me=Le=null,J=G,X=G=0,Y=null,ie=re.next();J!==null&&!ie.done;X++,ie=re.next()){J.index>X?(Y=J,J=null):Y=J.sibling;var de=z(te,J,ie.value,be);if(de===null){J===null&&(J=Y);break}t&&J&&de.alternate===null&&e(te,J),G=d(de,G,X),Me===null?Le=de:Me.sibling=de,Me=de,J=Y}if(ie.done)return n(te,J),hr&&Gu(te,X),Le;if(J===null){for(;!ie.done;X++,ie=re.next())ie=L(te,ie.value,be),ie!==null&&(G=d(ie,G,X),Me===null?Le=ie:Me.sibling=ie,Me=ie);return hr&&Gu(te,X),Le}for(J=o(te,J);!ie.done;X++,ie=re.next())ie=ee(J,te,X,ie.value,be),ie!==null&&(t&&ie.alternate!==null&&J.delete(ie.key===null?X:ie.key),G=d(ie,G,X),Me===null?Le=ie:Me.sibling=ie,Me=ie);return t&&J.forEach(function(we){return e(te,we)}),hr&&Gu(te,X),Le}function me(te,G,re,be){if(typeof re=="object"&&re!==null&&re.type===vh&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case Fm:e:{for(var Le=re.key,Me=G;Me!==null;){if(Me.key===Le){if(Le=re.type,Le===vh){if(Me.tag===7){n(te,Me.sibling),G=a(Me,re.props.children),G.return=te,te=G;break e}}else if(Me.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Nl&&lS(Le)===Me.type){n(te,Me.sibling),G=a(Me,re.props),G.ref=Ip(te,Me,re),G.return=te,te=G;break e}n(te,Me);break}else e(te,Me);Me=Me.sibling}re.type===vh?(G=rc(re.props.children,te.mode,be,re.key),G.return=te,te=G):(be=bg(re.type,re.key,re.props,null,te.mode,be),be.ref=Ip(te,G,re),be.return=te,te=be)}return p(te);case _h:e:{for(Me=re.key;G!==null;){if(G.key===Me)if(G.tag===4&&G.stateNode.containerInfo===re.containerInfo&&G.stateNode.implementation===re.implementation){n(te,G.sibling),G=a(G,re.children||[]),G.return=te,te=G;break e}else{n(te,G);break}else e(te,G);G=G.sibling}G=$0(re,te.mode,be),G.return=te,te=G}return p(te);case Nl:return Me=re._init,me(te,G,Me(re._payload),be)}if(Lp(re))return pe(te,G,re,be);if(wp(re))return ue(te,G,re,be);Km(te,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,G!==null&&G.tag===6?(n(te,G.sibling),G=a(G,re),G.return=te,te=G):(n(te,G),G=U0(re,te.mode,be),G.return=te,te=G),p(te)):n(te,G)}return me}var Kh=QI(!0),JI=QI(!1),Zg=pu(null),Xg=null,Ch=null,Px=null;function Rx(){Px=Ch=Xg=null}function Mx(t){var e=Zg.current;rr(Zg),t._currentValue=e}function Kv(t,e,n){for(;t!==null;){var o=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),t===n)break;t=t.return}}function zh(t,e){Xg=t,Px=Ch=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Co=!0),t.firstContext=null)}function vs(t){var e=t._currentValue;if(Px!==t)if(t={context:t,memoizedValue:e,next:null},Ch===null){if(Xg===null)throw Error(Je(308));Ch=t,Xg.dependencies={lanes:0,firstContext:t}}else Ch=Ch.next=t;return e}var Qu=null;function Lx(t){Qu===null?Qu=[t]:Qu.push(t)}function eC(t,e,n,o){var a=e.interleaved;return a===null?(n.next=n,Lx(e)):(n.next=a.next,a.next=n),e.interleaved=n,ol(t,o)}function ol(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Bl=!1;function Dx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function nl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Jl(t,e,n){var o=t.updateQueue;if(o===null)return null;if(o=o.shared,wn&2){var a=o.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),o.pending=e,ol(t,n)}return a=o.interleaved,a===null?(e.next=e,Lx(o)):(e.next=a.next,a.next=e),o.interleaved=e,ol(t,n)}function gg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,vx(t,n)}}function uS(t,e){var n=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var a=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};d===null?a=d=p:d=d.next=p,n=n.next}while(n!==null);d===null?a=d=e:d=d.next=e}else a=d=e;n={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:d,shared:o.shared,effects:o.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yg(t,e,n,o){var a=t.updateQueue;Bl=!1;var d=a.firstBaseUpdate,p=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var S=c,A=S.next;S.next=null,p===null?d=A:p.next=A,p=S;var D=t.alternate;D!==null&&(D=D.updateQueue,c=D.lastBaseUpdate,c!==p&&(c===null?D.firstBaseUpdate=A:c.next=A,D.lastBaseUpdate=S))}if(d!==null){var L=a.baseState;p=0,D=A=S=null,c=d;do{var z=c.lane,ee=c.eventTime;if((o&z)===z){D!==null&&(D=D.next={eventTime:ee,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var pe=t,ue=c;switch(z=e,ee=n,ue.tag){case 1:if(pe=ue.payload,typeof pe=="function"){L=pe.call(ee,L,z);break e}L=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=ue.payload,z=typeof pe=="function"?pe.call(ee,L,z):pe,z==null)break e;L=_r({},L,z);break e;case 2:Bl=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,z=a.effects,z===null?a.effects=[c]:z.push(c))}else ee={eventTime:ee,lane:z,tag:c.tag,payload:c.payload,callback:c.callback,next:null},D===null?(A=D=ee,S=L):D=D.next=ee,p|=z;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;z=c,c=z.next,z.next=null,a.lastBaseUpdate=z,a.shared.pending=null}}while(!0);if(D===null&&(S=L),a.baseState=S,a.firstBaseUpdate=A,a.lastBaseUpdate=D,e=a.shared.interleaved,e!==null){a=e;do p|=a.lane,a=a.next;while(a!==e)}else d===null&&(a.shared.lanes=0);pc|=p,t.lanes=p,t.memoizedState=L}}function cS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var o=t[e],a=o.callback;if(a!==null){if(o.callback=null,o=n,typeof a!="function")throw Error(Je(191,a));a.call(o)}}}var Ff={},xa=pu(Ff),gf=pu(Ff),yf=pu(Ff);function Ju(t){if(t===Ff)throw Error(Je(174));return t}function zx(t,e){switch(Yn(yf,e),Yn(gf,t),Yn(xa,Ff),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Av(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Av(e,t)}rr(xa),Yn(xa,e)}function Zh(){rr(xa),rr(gf),rr(yf)}function nC(t){Ju(yf.current);var e=Ju(xa.current),n=Av(e,t.type);e!==n&&(Yn(gf,t),Yn(xa,n))}function Ox(t){gf.current===t&&(rr(xa),rr(gf))}var gr=pu(0);function Qg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var O0=[];function Fx(){for(var t=0;t<O0.length;t++)O0[t]._workInProgressVersionPrimary=null;O0.length=0}var yg=ll.ReactCurrentDispatcher,F0=ll.ReactCurrentBatchConfig,dc=0,yr=null,Yr=null,_i=null,Jg=!1,Kp=!1,_f=0,C3=0;function Ki(){throw Error(Je(321))}function Nx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ks(t[n],e[n]))return!1;return!0}function Bx(t,e,n,o,a,d){if(dc=d,yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yg.current=t===null||t.memoizedState===null?R3:M3,t=n(o,a),Kp){d=0;do{if(Kp=!1,_f=0,25<=d)throw Error(Je(301));d+=1,_i=Yr=null,e.updateQueue=null,yg.current=L3,t=n(o,a)}while(Kp)}if(yg.current=ey,e=Yr!==null&&Yr.next!==null,dc=0,_i=Yr=yr=null,Jg=!1,e)throw Error(Je(300));return t}function Vx(){var t=_f!==0;return _f=0,t}function fa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?yr.memoizedState=_i=t:_i=_i.next=t,_i}function xs(){if(Yr===null){var t=yr.alternate;t=t!==null?t.memoizedState:null}else t=Yr.next;var e=_i===null?yr.memoizedState:_i.next;if(e!==null)_i=e,Yr=t;else{if(t===null)throw Error(Je(310));Yr=t,t={memoizedState:Yr.memoizedState,baseState:Yr.baseState,baseQueue:Yr.baseQueue,queue:Yr.queue,next:null},_i===null?yr.memoizedState=_i=t:_i=_i.next=t}return _i}function vf(t,e){return typeof e=="function"?e(t):e}function N0(t){var e=xs(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var o=Yr,a=o.baseQueue,d=n.pending;if(d!==null){if(a!==null){var p=a.next;a.next=d.next,d.next=p}o.baseQueue=a=d,n.pending=null}if(a!==null){d=a.next,o=o.baseState;var c=p=null,S=null,A=d;do{var D=A.lane;if((dc&D)===D)S!==null&&(S=S.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),o=A.hasEagerState?A.eagerState:t(o,A.action);else{var L={lane:D,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};S===null?(c=S=L,p=o):S=S.next=L,yr.lanes|=D,pc|=D}A=A.next}while(A!==null&&A!==d);S===null?p=o:S.next=c,Ks(o,e.memoizedState)||(Co=!0),e.memoizedState=o,e.baseState=p,e.baseQueue=S,n.lastRenderedState=o}if(t=n.interleaved,t!==null){a=t;do d=a.lane,yr.lanes|=d,pc|=d,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function B0(t){var e=xs(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var o=n.dispatch,a=n.pending,d=e.memoizedState;if(a!==null){n.pending=null;var p=a=a.next;do d=t(d,p.action),p=p.next;while(p!==a);Ks(d,e.memoizedState)||(Co=!0),e.memoizedState=d,e.baseQueue===null&&(e.baseState=d),n.lastRenderedState=d}return[d,o]}function rC(){}function iC(t,e){var n=yr,o=xs(),a=e(),d=!Ks(o.memoizedState,a);if(d&&(o.memoizedState=a,Co=!0),o=o.queue,jx(aC.bind(null,n,o,t),[t]),o.getSnapshot!==e||d||_i!==null&&_i.memoizedState.tag&1){if(n.flags|=2048,xf(9,sC.bind(null,n,o,a,e),void 0,null),xi===null)throw Error(Je(349));dc&30||oC(n,e,a)}return a}function oC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function sC(t,e,n,o){e.value=n,e.getSnapshot=o,lC(e)&&uC(t)}function aC(t,e,n){return n(function(){lC(e)&&uC(t)})}function lC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ks(t,n)}catch{return!0}}function uC(t){var e=ol(t,1);e!==null&&Ws(e,t,1,-1)}function hS(t){var e=fa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vf,lastRenderedState:t},e.queue=t,t=t.dispatch=P3.bind(null,yr,t),[e.memoizedState,t]}function xf(t,e,n,o){return t={tag:t,create:e,destroy:n,deps:o,next:null},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(o=n.next,n.next=t,t.next=o,e.lastEffect=t)),t}function cC(){return xs().memoizedState}function _g(t,e,n,o){var a=fa();yr.flags|=t,a.memoizedState=xf(1|e,n,void 0,o===void 0?null:o)}function $y(t,e,n,o){var a=xs();o=o===void 0?null:o;var d=void 0;if(Yr!==null){var p=Yr.memoizedState;if(d=p.destroy,o!==null&&Nx(o,p.deps)){a.memoizedState=xf(e,n,d,o);return}}yr.flags|=t,a.memoizedState=xf(1|e,n,d,o)}function dS(t,e){return _g(8390656,8,t,e)}function jx(t,e){return $y(2048,8,t,e)}function hC(t,e){return $y(4,2,t,e)}function dC(t,e){return $y(4,4,t,e)}function pC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fC(t,e,n){return n=n!=null?n.concat([t]):null,$y(4,4,pC.bind(null,e,t),n)}function Ux(){}function mC(t,e){var n=xs();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&Nx(e,o[1])?o[0]:(n.memoizedState=[t,e],t)}function gC(t,e){var n=xs();e=e===void 0?null:e;var o=n.memoizedState;return o!==null&&e!==null&&Nx(e,o[1])?o[0]:(t=t(),n.memoizedState=[t,e],t)}function yC(t,e,n){return dc&21?(Ks(n,e)||(n=bI(),yr.lanes|=n,pc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Co=!0),t.memoizedState=n)}function A3(t,e){var n=Fn;Fn=n!==0&&4>n?n:4,t(!0);var o=F0.transition;F0.transition={};try{t(!1),e()}finally{Fn=n,F0.transition=o}}function _C(){return xs().memoizedState}function k3(t,e,n){var o=tu(t);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},vC(t))xC(e,n);else if(n=eC(t,e,n,o),n!==null){var a=mo();Ws(n,t,o,a),wC(n,e,o)}}function P3(t,e,n){var o=tu(t),a={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(vC(t))xC(e,a);else{var d=t.alternate;if(t.lanes===0&&(d===null||d.lanes===0)&&(d=e.lastRenderedReducer,d!==null))try{var p=e.lastRenderedState,c=d(p,n);if(a.hasEagerState=!0,a.eagerState=c,Ks(c,p)){var S=e.interleaved;S===null?(a.next=a,Lx(e)):(a.next=S.next,S.next=a),e.interleaved=a;return}}catch{}finally{}n=eC(t,e,a,o),n!==null&&(a=mo(),Ws(n,t,o,a),wC(n,e,o))}}function vC(t){var e=t.alternate;return t===yr||e!==null&&e===yr}function xC(t,e){Kp=Jg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function wC(t,e,n){if(n&4194240){var o=e.lanes;o&=t.pendingLanes,n|=o,e.lanes=n,vx(t,n)}}var ey={readContext:vs,useCallback:Ki,useContext:Ki,useEffect:Ki,useImperativeHandle:Ki,useInsertionEffect:Ki,useLayoutEffect:Ki,useMemo:Ki,useReducer:Ki,useRef:Ki,useState:Ki,useDebugValue:Ki,useDeferredValue:Ki,useTransition:Ki,useMutableSource:Ki,useSyncExternalStore:Ki,useId:Ki,unstable_isNewReconciler:!1},R3={readContext:vs,useCallback:function(t,e){return fa().memoizedState=[t,e===void 0?null:e],t},useContext:vs,useEffect:dS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_g(4194308,4,pC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _g(4194308,4,t,e)},useInsertionEffect:function(t,e){return _g(4,2,t,e)},useMemo:function(t,e){var n=fa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var o=fa();return e=n!==void 0?n(e):e,o.memoizedState=o.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},o.queue=t,t=t.dispatch=k3.bind(null,yr,t),[o.memoizedState,t]},useRef:function(t){var e=fa();return t={current:t},e.memoizedState=t},useState:hS,useDebugValue:Ux,useDeferredValue:function(t){return fa().memoizedState=t},useTransition:function(){var t=hS(!1),e=t[0];return t=A3.bind(null,t[1]),fa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var o=yr,a=fa();if(hr){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=e(),xi===null)throw Error(Je(349));dc&30||oC(o,e,n)}a.memoizedState=n;var d={value:n,getSnapshot:e};return a.queue=d,dS(aC.bind(null,o,d,t),[t]),o.flags|=2048,xf(9,sC.bind(null,o,d,n,e),void 0,null),n},useId:function(){var t=fa(),e=xi.identifierPrefix;if(hr){var n=tl,o=el;n=(o&~(1<<32-Hs(o)-1)).toString(32)+n,e=":"+e+"R"+n,n=_f++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=C3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},M3={readContext:vs,useCallback:mC,useContext:vs,useEffect:jx,useImperativeHandle:fC,useInsertionEffect:hC,useLayoutEffect:dC,useMemo:gC,useReducer:N0,useRef:cC,useState:function(){return N0(vf)},useDebugValue:Ux,useDeferredValue:function(t){var e=xs();return yC(e,Yr.memoizedState,t)},useTransition:function(){var t=N0(vf)[0],e=xs().memoizedState;return[t,e]},useMutableSource:rC,useSyncExternalStore:iC,useId:_C,unstable_isNewReconciler:!1},L3={readContext:vs,useCallback:mC,useContext:vs,useEffect:jx,useImperativeHandle:fC,useInsertionEffect:hC,useLayoutEffect:dC,useMemo:gC,useReducer:B0,useRef:cC,useState:function(){return B0(vf)},useDebugValue:Ux,useDeferredValue:function(t){var e=xs();return Yr===null?e.memoizedState=t:yC(e,Yr.memoizedState,t)},useTransition:function(){var t=B0(vf)[0],e=xs().memoizedState;return[t,e]},useMutableSource:rC,useSyncExternalStore:iC,useId:_C,unstable_isNewReconciler:!1};function js(t,e){if(t&&t.defaultProps){e=_r({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Zv(t,e,n,o){e=t.memoizedState,n=n(o,e),n=n==null?e:_r({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qy={isMounted:function(t){return(t=t._reactInternals)?wc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var o=mo(),a=tu(t),d=nl(o,a);d.payload=e,n!=null&&(d.callback=n),e=Jl(t,d,a),e!==null&&(Ws(e,t,a,o),gg(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var o=mo(),a=tu(t),d=nl(o,a);d.tag=1,d.payload=e,n!=null&&(d.callback=n),e=Jl(t,d,a),e!==null&&(Ws(e,t,a,o),gg(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=mo(),o=tu(t),a=nl(n,o);a.tag=2,e!=null&&(a.callback=e),e=Jl(t,a,o),e!==null&&(Ws(e,t,o,n),gg(e,t,o))}};function pS(t,e,n,o,a,d,p){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,d,p):e.prototype&&e.prototype.isPureReactComponent?!df(n,o)||!df(a,d):!0}function bC(t,e,n){var o=!1,a=lu,d=e.contextType;return typeof d=="object"&&d!==null?d=vs(d):(a=Po(e)?cc:eo.current,o=e.contextTypes,d=(o=o!=null)?Wh(t,a):lu),e=new e(n,d),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qy,t.stateNode=e,e._reactInternals=t,o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=d),e}function fS(t,e,n,o){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,o),e.state!==t&&qy.enqueueReplaceState(e,e.state,null)}function Xv(t,e,n,o){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Dx(t);var d=e.contextType;typeof d=="object"&&d!==null?a.context=vs(d):(d=Po(e)?cc:eo.current,a.context=Wh(t,d)),a.state=t.memoizedState,d=e.getDerivedStateFromProps,typeof d=="function"&&(Zv(t,e,d,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&qy.enqueueReplaceState(a,a.state,null),Yg(t,n,a,o),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Xh(t,e){try{var n="",o=e;do n+=a4(o),o=o.return;while(o);var a=n}catch(d){a=`
Error generating stack: `+d.message+`
`+d.stack}return{value:t,source:e,stack:a,digest:null}}function V0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Yv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var D3=typeof WeakMap=="function"?WeakMap:Map;function SC(t,e,n){n=nl(-1,n),n.tag=3,n.payload={element:null};var o=e.value;return n.callback=function(){ny||(ny=!0,a1=o),Yv(t,e)},n}function TC(t,e,n){n=nl(-1,n),n.tag=3;var o=t.type.getDerivedStateFromError;if(typeof o=="function"){var a=e.value;n.payload=function(){return o(a)},n.callback=function(){Yv(t,e)}}var d=t.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(n.callback=function(){Yv(t,e),typeof o!="function"&&(eu===null?eu=new Set([this]):eu.add(this));var p=e.stack;this.componentDidCatch(e.value,{componentStack:p!==null?p:""})}),n}function mS(t,e,n){var o=t.pingCache;if(o===null){o=t.pingCache=new D3;var a=new Set;o.set(e,a)}else a=o.get(e),a===void 0&&(a=new Set,o.set(e,a));a.has(n)||(a.add(n),t=K3.bind(null,t,e,n),e.then(t,t))}function gS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yS(t,e,n,o,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=nl(-1,1),e.tag=2,Jl(n,e,1))),n.lanes|=1),t)}var z3=ll.ReactCurrentOwner,Co=!1;function po(t,e,n,o){e.child=t===null?JI(e,null,n,o):Kh(e,t.child,n,o)}function _S(t,e,n,o,a){n=n.render;var d=e.ref;return zh(e,a),o=Bx(t,e,n,o,d,a),n=Vx(),t!==null&&!Co?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,sl(t,e,a)):(hr&&n&&Cx(e),e.flags|=1,po(t,e,o,a),e.child)}function vS(t,e,n,o,a){if(t===null){var d=n.type;return typeof d=="function"&&!Xx(d)&&d.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=d,EC(t,e,d,o,a)):(t=bg(n.type,null,o,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(d=t.child,!(t.lanes&a)){var p=d.memoizedProps;if(n=n.compare,n=n!==null?n:df,n(p,o)&&t.ref===e.ref)return sl(t,e,a)}return e.flags|=1,t=nu(d,o),t.ref=e.ref,t.return=e,e.child=t}function EC(t,e,n,o,a){if(t!==null){var d=t.memoizedProps;if(df(d,o)&&t.ref===e.ref)if(Co=!1,e.pendingProps=o=d,(t.lanes&a)!==0)t.flags&131072&&(Co=!0);else return e.lanes=t.lanes,sl(t,e,a)}return Qv(t,e,n,o,a)}function IC(t,e,n){var o=e.pendingProps,a=o.children,d=t!==null?t.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yn(kh,Go),Go|=n;else{if(!(n&1073741824))return t=d!==null?d.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Yn(kh,Go),Go|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:n,Yn(kh,Go),Go|=o}else d!==null?(o=d.baseLanes|n,e.memoizedState=null):o=n,Yn(kh,Go),Go|=o;return po(t,e,a,n),e.child}function CC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Qv(t,e,n,o,a){var d=Po(n)?cc:eo.current;return d=Wh(e,d),zh(e,a),n=Bx(t,e,n,o,d,a),o=Vx(),t!==null&&!Co?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,sl(t,e,a)):(hr&&o&&Cx(e),e.flags|=1,po(t,e,n,a),e.child)}function xS(t,e,n,o,a){if(Po(n)){var d=!0;Wg(e)}else d=!1;if(zh(e,a),e.stateNode===null)vg(t,e),bC(e,n,o),Xv(e,n,o,a),o=!0;else if(t===null){var p=e.stateNode,c=e.memoizedProps;p.props=c;var S=p.context,A=n.contextType;typeof A=="object"&&A!==null?A=vs(A):(A=Po(n)?cc:eo.current,A=Wh(e,A));var D=n.getDerivedStateFromProps,L=typeof D=="function"||typeof p.getSnapshotBeforeUpdate=="function";L||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(c!==o||S!==A)&&fS(e,p,o,A),Bl=!1;var z=e.memoizedState;p.state=z,Yg(e,o,p,a),S=e.memoizedState,c!==o||z!==S||ko.current||Bl?(typeof D=="function"&&(Zv(e,n,D,o),S=e.memoizedState),(c=Bl||pS(e,n,c,o,z,S,A))?(L||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(e.flags|=4194308)):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=S),p.props=o,p.state=S,p.context=A,o=c):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{p=e.stateNode,tC(t,e),c=e.memoizedProps,A=e.type===e.elementType?c:js(e.type,c),p.props=A,L=e.pendingProps,z=p.context,S=n.contextType,typeof S=="object"&&S!==null?S=vs(S):(S=Po(n)?cc:eo.current,S=Wh(e,S));var ee=n.getDerivedStateFromProps;(D=typeof ee=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(c!==L||z!==S)&&fS(e,p,o,S),Bl=!1,z=e.memoizedState,p.state=z,Yg(e,o,p,a);var pe=e.memoizedState;c!==L||z!==pe||ko.current||Bl?(typeof ee=="function"&&(Zv(e,n,ee,o),pe=e.memoizedState),(A=Bl||pS(e,n,A,o,z,pe,S)||!1)?(D||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,pe,S),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,pe,S)),typeof p.componentDidUpdate=="function"&&(e.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof p.componentDidUpdate!="function"||c===t.memoizedProps&&z===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&z===t.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=pe),p.props=o,p.state=pe,p.context=S,o=A):(typeof p.componentDidUpdate!="function"||c===t.memoizedProps&&z===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&z===t.memoizedState||(e.flags|=1024),o=!1)}return Jv(t,e,n,o,d,a)}function Jv(t,e,n,o,a,d){CC(t,e);var p=(e.flags&128)!==0;if(!o&&!p)return a&&oS(e,n,!1),sl(t,e,d);o=e.stateNode,z3.current=e;var c=p&&typeof n.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,t!==null&&p?(e.child=Kh(e,t.child,null,d),e.child=Kh(e,null,c,d)):po(t,e,c,d),e.memoizedState=o.state,a&&oS(e,n,!0),e.child}function AC(t){var e=t.stateNode;e.pendingContext?iS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iS(t,e.context,!1),zx(t,e.containerInfo)}function wS(t,e,n,o,a){return Gh(),kx(a),e.flags|=256,po(t,e,n,o),e.child}var e1={dehydrated:null,treeContext:null,retryLane:0};function t1(t){return{baseLanes:t,cachePool:null,transitions:null}}function kC(t,e,n){var o=e.pendingProps,a=gr.current,d=!1,p=(e.flags&128)!==0,c;if((c=p)||(c=t!==null&&t.memoizedState===null?!1:(a&2)!==0),c?(d=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Yn(gr,a&1),t===null)return Gv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(p=o.children,t=o.fallback,d?(o=e.mode,d=e.child,p={mode:"hidden",children:p},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=p):d=Gy(p,o,0,null),t=rc(t,o,n,null),d.return=e,t.return=e,d.sibling=t,e.child=d,e.child.memoizedState=t1(n),e.memoizedState=e1,t):$x(e,p));if(a=t.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return O3(t,e,p,o,c,a,n);if(d){d=o.fallback,p=e.mode,a=t.child,c=a.sibling;var S={mode:"hidden",children:o.children};return!(p&1)&&e.child!==a?(o=e.child,o.childLanes=0,o.pendingProps=S,e.deletions=null):(o=nu(a,S),o.subtreeFlags=a.subtreeFlags&14680064),c!==null?d=nu(c,d):(d=rc(d,p,n,null),d.flags|=2),d.return=e,o.return=e,o.sibling=d,e.child=o,o=d,d=e.child,p=t.child.memoizedState,p=p===null?t1(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},d.memoizedState=p,d.childLanes=t.childLanes&~n,e.memoizedState=e1,o}return d=t.child,t=d.sibling,o=nu(d,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=n),o.return=e,o.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=o,e.memoizedState=null,o}function $x(t,e){return e=Gy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Zm(t,e,n,o){return o!==null&&kx(o),Kh(e,t.child,null,n),t=$x(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O3(t,e,n,o,a,d,p){if(n)return e.flags&256?(e.flags&=-257,o=V0(Error(Je(422))),Zm(t,e,p,o)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(d=o.fallback,a=e.mode,o=Gy({mode:"visible",children:o.children},a,0,null),d=rc(d,a,p,null),d.flags|=2,o.return=e,d.return=e,o.sibling=d,e.child=o,e.mode&1&&Kh(e,t.child,null,p),e.child.memoizedState=t1(p),e.memoizedState=e1,d);if(!(e.mode&1))return Zm(t,e,p,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;return o=c,d=Error(Je(419)),o=V0(d,o,void 0),Zm(t,e,p,o)}if(c=(p&t.childLanes)!==0,Co||c){if(o=xi,o!==null){switch(p&-p){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|p)?0:a,a!==0&&a!==d.retryLane&&(d.retryLane=a,ol(t,a),Ws(o,t,a,-1))}return Zx(),o=V0(Error(Je(421))),Zm(t,e,p,o)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=Z3.bind(null,t),a._reactRetry=e,null):(t=d.treeContext,Ko=Ql(a.nextSibling),Zo=e,hr=!0,$s=null,t!==null&&(ms[gs++]=el,ms[gs++]=tl,ms[gs++]=hc,el=t.id,tl=t.overflow,hc=e),e=$x(e,o.children),e.flags|=4096,e)}function bS(t,e,n){t.lanes|=e;var o=t.alternate;o!==null&&(o.lanes|=e),Kv(t.return,e,n)}function j0(t,e,n,o,a){var d=t.memoizedState;d===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:a}:(d.isBackwards=e,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=n,d.tailMode=a)}function PC(t,e,n){var o=e.pendingProps,a=o.revealOrder,d=o.tail;if(po(t,e,o.children,n),o=gr.current,o&2)o=o&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bS(t,n,e);else if(t.tag===19)bS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(Yn(gr,o),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Qg(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),j0(e,!1,a,n,d);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Qg(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}j0(e,!0,n,null,d);break;case"together":j0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),pc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Je(153));if(e.child!==null){for(t=e.child,n=nu(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=nu(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function F3(t,e,n){switch(e.tag){case 3:AC(e),Gh();break;case 5:nC(e);break;case 1:Po(e.type)&&Wg(e);break;case 4:zx(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,a=e.memoizedProps.value;Yn(Zg,o._currentValue),o._currentValue=a;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(Yn(gr,gr.current&1),e.flags|=128,null):n&e.child.childLanes?kC(t,e,n):(Yn(gr,gr.current&1),t=sl(t,e,n),t!==null?t.sibling:null);Yn(gr,gr.current&1);break;case 19:if(o=(n&e.childLanes)!==0,t.flags&128){if(o)return PC(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Yn(gr,gr.current),o)break;return null;case 22:case 23:return e.lanes=0,IC(t,e,n)}return sl(t,e,n)}var RC,n1,MC,LC;RC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};n1=function(){};MC=function(t,e,n,o){var a=t.memoizedProps;if(a!==o){t=e.stateNode,Ju(xa.current);var d=null;switch(n){case"input":a=Tv(t,a),o=Tv(t,o),d=[];break;case"select":a=_r({},a,{value:void 0}),o=_r({},o,{value:void 0}),d=[];break;case"textarea":a=Cv(t,a),o=Cv(t,o),d=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(t.onclick=qg)}kv(n,o);var p;n=null;for(A in a)if(!o.hasOwnProperty(A)&&a.hasOwnProperty(A)&&a[A]!=null)if(A==="style"){var c=a[A];for(p in c)c.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(of.hasOwnProperty(A)?d||(d=[]):(d=d||[]).push(A,null));for(A in o){var S=o[A];if(c=a!=null?a[A]:void 0,o.hasOwnProperty(A)&&S!==c&&(S!=null||c!=null))if(A==="style")if(c){for(p in c)!c.hasOwnProperty(p)||S&&S.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in S)S.hasOwnProperty(p)&&c[p]!==S[p]&&(n||(n={}),n[p]=S[p])}else n||(d||(d=[]),d.push(A,n)),n=S;else A==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,c=c?c.__html:void 0,S!=null&&c!==S&&(d=d||[]).push(A,S)):A==="children"?typeof S!="string"&&typeof S!="number"||(d=d||[]).push(A,""+S):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(of.hasOwnProperty(A)?(S!=null&&A==="onScroll"&&tr("scroll",t),d||c===S||(d=[])):(d=d||[]).push(A,S))}n&&(d=d||[]).push("style",n);var A=d;(e.updateQueue=A)&&(e.flags|=4)}};LC=function(t,e,n,o){n!==o&&(e.flags|=4)};function Cp(t,e){if(!hr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function Zi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,o=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=o,t.childLanes=n,e}function N3(t,e,n){var o=e.pendingProps;switch(Ax(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zi(e),null;case 1:return Po(e.type)&&Hg(),Zi(e),null;case 3:return o=e.stateNode,Zh(),rr(ko),rr(eo),Fx(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Gm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$s!==null&&(c1($s),$s=null))),n1(t,e),Zi(e),null;case 5:Ox(e);var a=Ju(yf.current);if(n=e.type,t!==null&&e.stateNode!=null)MC(t,e,n,o,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(Je(166));return Zi(e),null}if(t=Ju(xa.current),Gm(e)){o=e.stateNode,n=e.type;var d=e.memoizedProps;switch(o[ga]=e,o[mf]=d,t=(e.mode&1)!==0,n){case"dialog":tr("cancel",o),tr("close",o);break;case"iframe":case"object":case"embed":tr("load",o);break;case"video":case"audio":for(a=0;a<zp.length;a++)tr(zp[a],o);break;case"source":tr("error",o);break;case"img":case"image":case"link":tr("error",o),tr("load",o);break;case"details":tr("toggle",o);break;case"input":R2(o,d),tr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},tr("invalid",o);break;case"textarea":L2(o,d),tr("invalid",o)}kv(n,d),a=null;for(var p in d)if(d.hasOwnProperty(p)){var c=d[p];p==="children"?typeof c=="string"?o.textContent!==c&&(d.suppressHydrationWarning!==!0&&Wm(o.textContent,c,t),a=["children",c]):typeof c=="number"&&o.textContent!==""+c&&(d.suppressHydrationWarning!==!0&&Wm(o.textContent,c,t),a=["children",""+c]):of.hasOwnProperty(p)&&c!=null&&p==="onScroll"&&tr("scroll",o)}switch(n){case"input":Nm(o),M2(o,d,!0);break;case"textarea":Nm(o),D2(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=qg)}o=a,e.updateQueue=o,o!==null&&(e.flags|=4)}else{p=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=aI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=p.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof o.is=="string"?t=p.createElement(n,{is:o.is}):(t=p.createElement(n),n==="select"&&(p=t,o.multiple?p.multiple=!0:o.size&&(p.size=o.size))):t=p.createElementNS(t,n),t[ga]=e,t[mf]=o,RC(t,e,!1,!1),e.stateNode=t;e:{switch(p=Pv(n,o),n){case"dialog":tr("cancel",t),tr("close",t),a=o;break;case"iframe":case"object":case"embed":tr("load",t),a=o;break;case"video":case"audio":for(a=0;a<zp.length;a++)tr(zp[a],t);a=o;break;case"source":tr("error",t),a=o;break;case"img":case"image":case"link":tr("error",t),tr("load",t),a=o;break;case"details":tr("toggle",t),a=o;break;case"input":R2(t,o),a=Tv(t,o),tr("invalid",t);break;case"option":a=o;break;case"select":t._wrapperState={wasMultiple:!!o.multiple},a=_r({},o,{value:void 0}),tr("invalid",t);break;case"textarea":L2(t,o),a=Cv(t,o),tr("invalid",t);break;default:a=o}kv(n,a),c=a;for(d in c)if(c.hasOwnProperty(d)){var S=c[d];d==="style"?cI(t,S):d==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&lI(t,S)):d==="children"?typeof S=="string"?(n!=="textarea"||S!=="")&&sf(t,S):typeof S=="number"&&sf(t,""+S):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(of.hasOwnProperty(d)?S!=null&&d==="onScroll"&&tr("scroll",t):S!=null&&px(t,d,S,p))}switch(n){case"input":Nm(t),M2(t,o,!1);break;case"textarea":Nm(t),D2(t);break;case"option":o.value!=null&&t.setAttribute("value",""+au(o.value));break;case"select":t.multiple=!!o.multiple,d=o.value,d!=null?Rh(t,!!o.multiple,d,!1):o.defaultValue!=null&&Rh(t,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=qg)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zi(e),null;case 6:if(t&&e.stateNode!=null)LC(t,e,t.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(Je(166));if(n=Ju(yf.current),Ju(xa.current),Gm(e)){if(o=e.stateNode,n=e.memoizedProps,o[ga]=e,(d=o.nodeValue!==n)&&(t=Zo,t!==null))switch(t.tag){case 3:Wm(o.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wm(o.nodeValue,n,(t.mode&1)!==0)}d&&(e.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[ga]=e,e.stateNode=o}return Zi(e),null;case 13:if(rr(gr),o=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(hr&&Ko!==null&&e.mode&1&&!(e.flags&128))YI(),Gh(),e.flags|=98560,d=!1;else if(d=Gm(e),o!==null&&o.dehydrated!==null){if(t===null){if(!d)throw Error(Je(318));if(d=e.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(Je(317));d[ga]=e}else Gh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zi(e),d=!1}else $s!==null&&(c1($s),$s=null),d=!0;if(!d)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(o=o!==null,o!==(t!==null&&t.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(t===null||gr.current&1?Jr===0&&(Jr=3):Zx())),e.updateQueue!==null&&(e.flags|=4),Zi(e),null);case 4:return Zh(),n1(t,e),t===null&&pf(e.stateNode.containerInfo),Zi(e),null;case 10:return Mx(e.type._context),Zi(e),null;case 17:return Po(e.type)&&Hg(),Zi(e),null;case 19:if(rr(gr),d=e.memoizedState,d===null)return Zi(e),null;if(o=(e.flags&128)!==0,p=d.rendering,p===null)if(o)Cp(d,!1);else{if(Jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(p=Qg(t),p!==null){for(e.flags|=128,Cp(d,!1),o=p.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=n,n=e.child;n!==null;)d=n,t=o,d.flags&=14680066,p=d.alternate,p===null?(d.childLanes=0,d.lanes=t,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=p.childLanes,d.lanes=p.lanes,d.child=p.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=p.memoizedProps,d.memoizedState=p.memoizedState,d.updateQueue=p.updateQueue,d.type=p.type,t=p.dependencies,d.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Yn(gr,gr.current&1|2),e.child}t=t.sibling}d.tail!==null&&Rr()>Yh&&(e.flags|=128,o=!0,Cp(d,!1),e.lanes=4194304)}else{if(!o)if(t=Qg(p),t!==null){if(e.flags|=128,o=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Cp(d,!0),d.tail===null&&d.tailMode==="hidden"&&!p.alternate&&!hr)return Zi(e),null}else 2*Rr()-d.renderingStartTime>Yh&&n!==1073741824&&(e.flags|=128,o=!0,Cp(d,!1),e.lanes=4194304);d.isBackwards?(p.sibling=e.child,e.child=p):(n=d.last,n!==null?n.sibling=p:e.child=p,d.last=p)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=Rr(),e.sibling=null,n=gr.current,Yn(gr,o?n&1|2:n&1),e):(Zi(e),null);case 22:case 23:return Kx(),o=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?Go&1073741824&&(Zi(e),e.subtreeFlags&6&&(e.flags|=8192)):Zi(e),null;case 24:return null;case 25:return null}throw Error(Je(156,e.tag))}function B3(t,e){switch(Ax(e),e.tag){case 1:return Po(e.type)&&Hg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zh(),rr(ko),rr(eo),Fx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ox(e),null;case 13:if(rr(gr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Je(340));Gh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rr(gr),null;case 4:return Zh(),null;case 10:return Mx(e.type._context),null;case 22:case 23:return Kx(),null;case 24:return null;default:return null}}var Xm=!1,Qi=!1,V3=typeof WeakSet=="function"?WeakSet:Set,St=null;function Ah(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){Sr(t,e,o)}else n.current=null}function r1(t,e,n){try{n()}catch(o){Sr(t,e,o)}}var SS=!1;function j3(t,e){if(Vv=jg,t=NI(),Ix(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var a=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var p=0,c=-1,S=-1,A=0,D=0,L=t,z=null;t:for(;;){for(var ee;L!==n||a!==0&&L.nodeType!==3||(c=p+a),L!==d||o!==0&&L.nodeType!==3||(S=p+o),L.nodeType===3&&(p+=L.nodeValue.length),(ee=L.firstChild)!==null;)z=L,L=ee;for(;;){if(L===t)break t;if(z===n&&++A===a&&(c=p),z===d&&++D===o&&(S=p),(ee=L.nextSibling)!==null)break;L=z,z=L.parentNode}L=ee}n=c===-1||S===-1?null:{start:c,end:S}}else n=null}n=n||{start:0,end:0}}else n=null;for(jv={focusedElem:t,selectionRange:n},jg=!1,St=e;St!==null;)if(e=St,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,St=t;else for(;St!==null;){e=St;try{var pe=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(pe!==null){var ue=pe.memoizedProps,me=pe.memoizedState,te=e.stateNode,G=te.getSnapshotBeforeUpdate(e.elementType===e.type?ue:js(e.type,ue),me);te.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var re=e.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(be){Sr(e,e.return,be)}if(t=e.sibling,t!==null){t.return=e.return,St=t;break}St=e.return}return pe=SS,SS=!1,pe}function Zp(t,e,n){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&t)===t){var d=a.destroy;a.destroy=void 0,d!==void 0&&r1(e,n,d)}a=a.next}while(a!==o)}}function Hy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var o=n.create;n.destroy=o()}n=n.next}while(n!==e)}}function i1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function DC(t){var e=t.alternate;e!==null&&(t.alternate=null,DC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ga],delete e[mf],delete e[qv],delete e[S3],delete e[T3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zC(t){return t.tag===5||t.tag===3||t.tag===4}function TS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function o1(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qg));else if(o!==4&&(t=t.child,t!==null))for(o1(t,e,n),t=t.sibling;t!==null;)o1(t,e,n),t=t.sibling}function s1(t,e,n){var o=t.tag;if(o===5||o===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(o!==4&&(t=t.child,t!==null))for(s1(t,e,n),t=t.sibling;t!==null;)s1(t,e,n),t=t.sibling}var Pi=null,Us=!1;function zl(t,e,n){for(n=n.child;n!==null;)OC(t,e,n),n=n.sibling}function OC(t,e,n){if(va&&typeof va.onCommitFiberUnmount=="function")try{va.onCommitFiberUnmount(Fy,n)}catch{}switch(n.tag){case 5:Qi||Ah(n,e);case 6:var o=Pi,a=Us;Pi=null,zl(t,e,n),Pi=o,Us=a,Pi!==null&&(Us?(t=Pi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pi.removeChild(n.stateNode));break;case 18:Pi!==null&&(Us?(t=Pi,n=n.stateNode,t.nodeType===8?D0(t.parentNode,n):t.nodeType===1&&D0(t,n),cf(t)):D0(Pi,n.stateNode));break;case 4:o=Pi,a=Us,Pi=n.stateNode.containerInfo,Us=!0,zl(t,e,n),Pi=o,Us=a;break;case 0:case 11:case 14:case 15:if(!Qi&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var d=a,p=d.destroy;d=d.tag,p!==void 0&&(d&2||d&4)&&r1(n,e,p),a=a.next}while(a!==o)}zl(t,e,n);break;case 1:if(!Qi&&(Ah(n,e),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(c){Sr(n,e,c)}zl(t,e,n);break;case 21:zl(t,e,n);break;case 22:n.mode&1?(Qi=(o=Qi)||n.memoizedState!==null,zl(t,e,n),Qi=o):zl(t,e,n);break;default:zl(t,e,n)}}function ES(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new V3),e.forEach(function(o){var a=X3.bind(null,t,o);n.has(o)||(n.add(o),o.then(a,a))})}}function Bs(t,e){var n=e.deletions;if(n!==null)for(var o=0;o<n.length;o++){var a=n[o];try{var d=t,p=e,c=p;e:for(;c!==null;){switch(c.tag){case 5:Pi=c.stateNode,Us=!1;break e;case 3:Pi=c.stateNode.containerInfo,Us=!0;break e;case 4:Pi=c.stateNode.containerInfo,Us=!0;break e}c=c.return}if(Pi===null)throw Error(Je(160));OC(d,p,a),Pi=null,Us=!1;var S=a.alternate;S!==null&&(S.return=null),a.return=null}catch(A){Sr(a,e,A)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)FC(e,t),e=e.sibling}function FC(t,e){var n=t.alternate,o=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bs(e,t),pa(t),o&4){try{Zp(3,t,t.return),Hy(3,t)}catch(ue){Sr(t,t.return,ue)}try{Zp(5,t,t.return)}catch(ue){Sr(t,t.return,ue)}}break;case 1:Bs(e,t),pa(t),o&512&&n!==null&&Ah(n,n.return);break;case 5:if(Bs(e,t),pa(t),o&512&&n!==null&&Ah(n,n.return),t.flags&32){var a=t.stateNode;try{sf(a,"")}catch(ue){Sr(t,t.return,ue)}}if(o&4&&(a=t.stateNode,a!=null)){var d=t.memoizedProps,p=n!==null?n.memoizedProps:d,c=t.type,S=t.updateQueue;if(t.updateQueue=null,S!==null)try{c==="input"&&d.type==="radio"&&d.name!=null&&oI(a,d),Pv(c,p);var A=Pv(c,d);for(p=0;p<S.length;p+=2){var D=S[p],L=S[p+1];D==="style"?cI(a,L):D==="dangerouslySetInnerHTML"?lI(a,L):D==="children"?sf(a,L):px(a,D,L,A)}switch(c){case"input":Ev(a,d);break;case"textarea":sI(a,d);break;case"select":var z=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!d.multiple;var ee=d.value;ee!=null?Rh(a,!!d.multiple,ee,!1):z!==!!d.multiple&&(d.defaultValue!=null?Rh(a,!!d.multiple,d.defaultValue,!0):Rh(a,!!d.multiple,d.multiple?[]:"",!1))}a[mf]=d}catch(ue){Sr(t,t.return,ue)}}break;case 6:if(Bs(e,t),pa(t),o&4){if(t.stateNode===null)throw Error(Je(162));a=t.stateNode,d=t.memoizedProps;try{a.nodeValue=d}catch(ue){Sr(t,t.return,ue)}}break;case 3:if(Bs(e,t),pa(t),o&4&&n!==null&&n.memoizedState.isDehydrated)try{cf(e.containerInfo)}catch(ue){Sr(t,t.return,ue)}break;case 4:Bs(e,t),pa(t);break;case 13:Bs(e,t),pa(t),a=t.child,a.flags&8192&&(d=a.memoizedState!==null,a.stateNode.isHidden=d,!d||a.alternate!==null&&a.alternate.memoizedState!==null||(Wx=Rr())),o&4&&ES(t);break;case 22:if(D=n!==null&&n.memoizedState!==null,t.mode&1?(Qi=(A=Qi)||D,Bs(e,t),Qi=A):Bs(e,t),pa(t),o&8192){if(A=t.memoizedState!==null,(t.stateNode.isHidden=A)&&!D&&t.mode&1)for(St=t,D=t.child;D!==null;){for(L=St=D;St!==null;){switch(z=St,ee=z.child,z.tag){case 0:case 11:case 14:case 15:Zp(4,z,z.return);break;case 1:Ah(z,z.return);var pe=z.stateNode;if(typeof pe.componentWillUnmount=="function"){o=z,n=z.return;try{e=o,pe.props=e.memoizedProps,pe.state=e.memoizedState,pe.componentWillUnmount()}catch(ue){Sr(o,n,ue)}}break;case 5:Ah(z,z.return);break;case 22:if(z.memoizedState!==null){CS(L);continue}}ee!==null?(ee.return=z,St=ee):CS(L)}D=D.sibling}e:for(D=null,L=t;;){if(L.tag===5){if(D===null){D=L;try{a=L.stateNode,A?(d=a.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(c=L.stateNode,S=L.memoizedProps.style,p=S!=null&&S.hasOwnProperty("display")?S.display:null,c.style.display=uI("display",p))}catch(ue){Sr(t,t.return,ue)}}}else if(L.tag===6){if(D===null)try{L.stateNode.nodeValue=A?"":L.memoizedProps}catch(ue){Sr(t,t.return,ue)}}else if((L.tag!==22&&L.tag!==23||L.memoizedState===null||L===t)&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===t)break e;for(;L.sibling===null;){if(L.return===null||L.return===t)break e;D===L&&(D=null),L=L.return}D===L&&(D=null),L.sibling.return=L.return,L=L.sibling}}break;case 19:Bs(e,t),pa(t),o&4&&ES(t);break;case 21:break;default:Bs(e,t),pa(t)}}function pa(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zC(n)){var o=n;break e}n=n.return}throw Error(Je(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(sf(a,""),o.flags&=-33);var d=TS(t);s1(t,d,a);break;case 3:case 4:var p=o.stateNode.containerInfo,c=TS(t);o1(t,c,p);break;default:throw Error(Je(161))}}catch(S){Sr(t,t.return,S)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function U3(t,e,n){St=t,NC(t)}function NC(t,e,n){for(var o=(t.mode&1)!==0;St!==null;){var a=St,d=a.child;if(a.tag===22&&o){var p=a.memoizedState!==null||Xm;if(!p){var c=a.alternate,S=c!==null&&c.memoizedState!==null||Qi;c=Xm;var A=Qi;if(Xm=p,(Qi=S)&&!A)for(St=a;St!==null;)p=St,S=p.child,p.tag===22&&p.memoizedState!==null?AS(a):S!==null?(S.return=p,St=S):AS(a);for(;d!==null;)St=d,NC(d),d=d.sibling;St=a,Xm=c,Qi=A}IS(t)}else a.subtreeFlags&8772&&d!==null?(d.return=a,St=d):IS(t)}}function IS(t){for(;St!==null;){var e=St;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qi||Hy(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!Qi)if(n===null)o.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:js(e.type,n.memoizedProps);o.componentDidUpdate(a,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=e.updateQueue;d!==null&&cS(e,d,o);break;case 3:var p=e.updateQueue;if(p!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cS(e,p,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var S=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&n.focus();break;case"img":S.src&&(n.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var A=e.alternate;if(A!==null){var D=A.memoizedState;if(D!==null){var L=D.dehydrated;L!==null&&cf(L)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}Qi||e.flags&512&&i1(e)}catch(z){Sr(e,e.return,z)}}if(e===t){St=null;break}if(n=e.sibling,n!==null){n.return=e.return,St=n;break}St=e.return}}function CS(t){for(;St!==null;){var e=St;if(e===t){St=null;break}var n=e.sibling;if(n!==null){n.return=e.return,St=n;break}St=e.return}}function AS(t){for(;St!==null;){var e=St;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Hy(4,e)}catch(S){Sr(e,n,S)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var a=e.return;try{o.componentDidMount()}catch(S){Sr(e,a,S)}}var d=e.return;try{i1(e)}catch(S){Sr(e,d,S)}break;case 5:var p=e.return;try{i1(e)}catch(S){Sr(e,p,S)}}}catch(S){Sr(e,e.return,S)}if(e===t){St=null;break}var c=e.sibling;if(c!==null){c.return=e.return,St=c;break}St=e.return}}var $3=Math.ceil,ty=ll.ReactCurrentDispatcher,qx=ll.ReactCurrentOwner,_s=ll.ReactCurrentBatchConfig,wn=0,xi=null,qr=null,Li=0,Go=0,kh=pu(0),Jr=0,wf=null,pc=0,Wy=0,Hx=0,Xp=null,Io=null,Wx=0,Yh=1/0,Ya=null,ny=!1,a1=null,eu=null,Ym=!1,ql=null,ry=0,Yp=0,l1=null,xg=-1,wg=0;function mo(){return wn&6?Rr():xg!==-1?xg:xg=Rr()}function tu(t){return t.mode&1?wn&2&&Li!==0?Li&-Li:I3.transition!==null?(wg===0&&(wg=bI()),wg):(t=Fn,t!==0||(t=window.event,t=t===void 0?16:kI(t.type)),t):1}function Ws(t,e,n,o){if(50<Yp)throw Yp=0,l1=null,Error(Je(185));Df(t,n,o),(!(wn&2)||t!==xi)&&(t===xi&&(!(wn&2)&&(Wy|=n),Jr===4&&Ul(t,Li)),Ro(t,o),n===1&&wn===0&&!(e.mode&1)&&(Yh=Rr()+500,Uy&&fu()))}function Ro(t,e){var n=t.callbackNode;I4(t,e);var o=Vg(t,t===xi?Li:0);if(o===0)n!==null&&F2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=o&-o,t.callbackPriority!==e){if(n!=null&&F2(n),e===1)t.tag===0?E3(kS.bind(null,t)):KI(kS.bind(null,t)),w3(function(){!(wn&6)&&fu()}),n=null;else{switch(SI(o)){case 1:n=_x;break;case 4:n=xI;break;case 16:n=Bg;break;case 536870912:n=wI;break;default:n=Bg}n=WC(n,BC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function BC(t,e){if(xg=-1,wg=0,wn&6)throw Error(Je(327));var n=t.callbackNode;if(Oh()&&t.callbackNode!==n)return null;var o=Vg(t,t===xi?Li:0);if(o===0)return null;if(o&30||o&t.expiredLanes||e)e=iy(t,o);else{e=o;var a=wn;wn|=2;var d=jC();(xi!==t||Li!==e)&&(Ya=null,Yh=Rr()+500,nc(t,e));do try{W3();break}catch(c){VC(t,c)}while(!0);Rx(),ty.current=d,wn=a,qr!==null?e=0:(xi=null,Li=0,e=Jr)}if(e!==0){if(e===2&&(a=zv(t),a!==0&&(o=a,e=u1(t,a))),e===1)throw n=wf,nc(t,0),Ul(t,o),Ro(t,Rr()),n;if(e===6)Ul(t,o);else{if(a=t.current.alternate,!(o&30)&&!q3(a)&&(e=iy(t,o),e===2&&(d=zv(t),d!==0&&(o=d,e=u1(t,d))),e===1))throw n=wf,nc(t,0),Ul(t,o),Ro(t,Rr()),n;switch(t.finishedWork=a,t.finishedLanes=o,e){case 0:case 1:throw Error(Je(345));case 2:Ku(t,Io,Ya);break;case 3:if(Ul(t,o),(o&130023424)===o&&(e=Wx+500-Rr(),10<e)){if(Vg(t,0)!==0)break;if(a=t.suspendedLanes,(a&o)!==o){mo(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=$v(Ku.bind(null,t,Io,Ya),e);break}Ku(t,Io,Ya);break;case 4:if(Ul(t,o),(o&4194240)===o)break;for(e=t.eventTimes,a=-1;0<o;){var p=31-Hs(o);d=1<<p,p=e[p],p>a&&(a=p),o&=~d}if(o=a,o=Rr()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*$3(o/1960))-o,10<o){t.timeoutHandle=$v(Ku.bind(null,t,Io,Ya),o);break}Ku(t,Io,Ya);break;case 5:Ku(t,Io,Ya);break;default:throw Error(Je(329))}}}return Ro(t,Rr()),t.callbackNode===n?BC.bind(null,t):null}function u1(t,e){var n=Xp;return t.current.memoizedState.isDehydrated&&(nc(t,e).flags|=256),t=iy(t,e),t!==2&&(e=Io,Io=n,e!==null&&c1(e)),t}function c1(t){Io===null?Io=t:Io.push.apply(Io,t)}function q3(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var a=n[o],d=a.getSnapshot;a=a.value;try{if(!Ks(d(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ul(t,e){for(e&=~Hx,e&=~Wy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hs(e),o=1<<n;t[n]=-1,e&=~o}}function kS(t){if(wn&6)throw Error(Je(327));Oh();var e=Vg(t,0);if(!(e&1))return Ro(t,Rr()),null;var n=iy(t,e);if(t.tag!==0&&n===2){var o=zv(t);o!==0&&(e=o,n=u1(t,o))}if(n===1)throw n=wf,nc(t,0),Ul(t,e),Ro(t,Rr()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ku(t,Io,Ya),Ro(t,Rr()),null}function Gx(t,e){var n=wn;wn|=1;try{return t(e)}finally{wn=n,wn===0&&(Yh=Rr()+500,Uy&&fu())}}function fc(t){ql!==null&&ql.tag===0&&!(wn&6)&&Oh();var e=wn;wn|=1;var n=_s.transition,o=Fn;try{if(_s.transition=null,Fn=1,t)return t()}finally{Fn=o,_s.transition=n,wn=e,!(wn&6)&&fu()}}function Kx(){Go=kh.current,rr(kh)}function nc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,x3(n)),qr!==null)for(n=qr.return;n!==null;){var o=n;switch(Ax(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Hg();break;case 3:Zh(),rr(ko),rr(eo),Fx();break;case 5:Ox(o);break;case 4:Zh();break;case 13:rr(gr);break;case 19:rr(gr);break;case 10:Mx(o.type._context);break;case 22:case 23:Kx()}n=n.return}if(xi=t,qr=t=nu(t.current,null),Li=Go=e,Jr=0,wf=null,Hx=Wy=pc=0,Io=Xp=null,Qu!==null){for(e=0;e<Qu.length;e++)if(n=Qu[e],o=n.interleaved,o!==null){n.interleaved=null;var a=o.next,d=n.pending;if(d!==null){var p=d.next;d.next=a,o.next=p}n.pending=o}Qu=null}return t}function VC(t,e){do{var n=qr;try{if(Rx(),yg.current=ey,Jg){for(var o=yr.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}Jg=!1}if(dc=0,_i=Yr=yr=null,Kp=!1,_f=0,qx.current=null,n===null||n.return===null){Jr=1,wf=e,qr=null;break}e:{var d=t,p=n.return,c=n,S=e;if(e=Li,c.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var A=S,D=c,L=D.tag;if(!(D.mode&1)&&(L===0||L===11||L===15)){var z=D.alternate;z?(D.updateQueue=z.updateQueue,D.memoizedState=z.memoizedState,D.lanes=z.lanes):(D.updateQueue=null,D.memoizedState=null)}var ee=gS(p);if(ee!==null){ee.flags&=-257,yS(ee,p,c,d,e),ee.mode&1&&mS(d,A,e),e=ee,S=A;var pe=e.updateQueue;if(pe===null){var ue=new Set;ue.add(S),e.updateQueue=ue}else pe.add(S);break e}else{if(!(e&1)){mS(d,A,e),Zx();break e}S=Error(Je(426))}}else if(hr&&c.mode&1){var me=gS(p);if(me!==null){!(me.flags&65536)&&(me.flags|=256),yS(me,p,c,d,e),kx(Xh(S,c));break e}}d=S=Xh(S,c),Jr!==4&&(Jr=2),Xp===null?Xp=[d]:Xp.push(d),d=p;do{switch(d.tag){case 3:d.flags|=65536,e&=-e,d.lanes|=e;var te=SC(d,S,e);uS(d,te);break e;case 1:c=S;var G=d.type,re=d.stateNode;if(!(d.flags&128)&&(typeof G.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(eu===null||!eu.has(re)))){d.flags|=65536,e&=-e,d.lanes|=e;var be=TC(d,c,e);uS(d,be);break e}}d=d.return}while(d!==null)}$C(n)}catch(Le){e=Le,qr===n&&n!==null&&(qr=n=n.return);continue}break}while(!0)}function jC(){var t=ty.current;return ty.current=ey,t===null?ey:t}function Zx(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),xi===null||!(pc&268435455)&&!(Wy&268435455)||Ul(xi,Li)}function iy(t,e){var n=wn;wn|=2;var o=jC();(xi!==t||Li!==e)&&(Ya=null,nc(t,e));do try{H3();break}catch(a){VC(t,a)}while(!0);if(Rx(),wn=n,ty.current=o,qr!==null)throw Error(Je(261));return xi=null,Li=0,Jr}function H3(){for(;qr!==null;)UC(qr)}function W3(){for(;qr!==null&&!y4();)UC(qr)}function UC(t){var e=HC(t.alternate,t,Go);t.memoizedProps=t.pendingProps,e===null?$C(t):qr=e,qx.current=null}function $C(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=B3(n,e),n!==null){n.flags&=32767,qr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jr=6,qr=null;return}}else if(n=N3(n,e,Go),n!==null){qr=n;return}if(e=e.sibling,e!==null){qr=e;return}qr=e=t}while(e!==null);Jr===0&&(Jr=5)}function Ku(t,e,n){var o=Fn,a=_s.transition;try{_s.transition=null,Fn=1,G3(t,e,n,o)}finally{_s.transition=a,Fn=o}return null}function G3(t,e,n,o){do Oh();while(ql!==null);if(wn&6)throw Error(Je(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var d=n.lanes|n.childLanes;if(C4(t,d),t===xi&&(qr=xi=null,Li=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ym||(Ym=!0,WC(Bg,function(){return Oh(),null})),d=(n.flags&15990)!==0,n.subtreeFlags&15990||d){d=_s.transition,_s.transition=null;var p=Fn;Fn=1;var c=wn;wn|=4,qx.current=null,j3(t,n),FC(n,t),p3(jv),jg=!!Vv,jv=Vv=null,t.current=n,U3(n),_4(),wn=c,Fn=p,_s.transition=d}else t.current=n;if(Ym&&(Ym=!1,ql=t,ry=a),d=t.pendingLanes,d===0&&(eu=null),w4(n.stateNode),Ro(t,Rr()),e!==null)for(o=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],o(a.value,{componentStack:a.stack,digest:a.digest});if(ny)throw ny=!1,t=a1,a1=null,t;return ry&1&&t.tag!==0&&Oh(),d=t.pendingLanes,d&1?t===l1?Yp++:(Yp=0,l1=t):Yp=0,fu(),null}function Oh(){if(ql!==null){var t=SI(ry),e=_s.transition,n=Fn;try{if(_s.transition=null,Fn=16>t?16:t,ql===null)var o=!1;else{if(t=ql,ql=null,ry=0,wn&6)throw Error(Je(331));var a=wn;for(wn|=4,St=t.current;St!==null;){var d=St,p=d.child;if(St.flags&16){var c=d.deletions;if(c!==null){for(var S=0;S<c.length;S++){var A=c[S];for(St=A;St!==null;){var D=St;switch(D.tag){case 0:case 11:case 15:Zp(8,D,d)}var L=D.child;if(L!==null)L.return=D,St=L;else for(;St!==null;){D=St;var z=D.sibling,ee=D.return;if(DC(D),D===A){St=null;break}if(z!==null){z.return=ee,St=z;break}St=ee}}}var pe=d.alternate;if(pe!==null){var ue=pe.child;if(ue!==null){pe.child=null;do{var me=ue.sibling;ue.sibling=null,ue=me}while(ue!==null)}}St=d}}if(d.subtreeFlags&2064&&p!==null)p.return=d,St=p;else e:for(;St!==null;){if(d=St,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Zp(9,d,d.return)}var te=d.sibling;if(te!==null){te.return=d.return,St=te;break e}St=d.return}}var G=t.current;for(St=G;St!==null;){p=St;var re=p.child;if(p.subtreeFlags&2064&&re!==null)re.return=p,St=re;else e:for(p=G;St!==null;){if(c=St,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Hy(9,c)}}catch(Le){Sr(c,c.return,Le)}if(c===p){St=null;break e}var be=c.sibling;if(be!==null){be.return=c.return,St=be;break e}St=c.return}}if(wn=a,fu(),va&&typeof va.onPostCommitFiberRoot=="function")try{va.onPostCommitFiberRoot(Fy,t)}catch{}o=!0}return o}finally{Fn=n,_s.transition=e}}return!1}function PS(t,e,n){e=Xh(n,e),e=SC(t,e,1),t=Jl(t,e,1),e=mo(),t!==null&&(Df(t,1,e),Ro(t,e))}function Sr(t,e,n){if(t.tag===3)PS(t,t,n);else for(;e!==null;){if(e.tag===3){PS(e,t,n);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(eu===null||!eu.has(o))){t=Xh(n,t),t=TC(e,t,1),e=Jl(e,t,1),t=mo(),e!==null&&(Df(e,1,t),Ro(e,t));break}}e=e.return}}function K3(t,e,n){var o=t.pingCache;o!==null&&o.delete(e),e=mo(),t.pingedLanes|=t.suspendedLanes&n,xi===t&&(Li&n)===n&&(Jr===4||Jr===3&&(Li&130023424)===Li&&500>Rr()-Wx?nc(t,0):Hx|=n),Ro(t,e)}function qC(t,e){e===0&&(t.mode&1?(e=jm,jm<<=1,!(jm&130023424)&&(jm=4194304)):e=1);var n=mo();t=ol(t,e),t!==null&&(Df(t,e,n),Ro(t,n))}function Z3(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),qC(t,n)}function X3(t,e){var n=0;switch(t.tag){case 13:var o=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:o=t.stateNode;break;default:throw Error(Je(314))}o!==null&&o.delete(e),qC(t,n)}var HC;HC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ko.current)Co=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Co=!1,F3(t,e,n);Co=!!(t.flags&131072)}else Co=!1,hr&&e.flags&1048576&&ZI(e,Kg,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;vg(t,e),t=e.pendingProps;var a=Wh(e,eo.current);zh(e,n),a=Bx(null,e,o,t,a,n);var d=Vx();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Po(o)?(d=!0,Wg(e)):d=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Dx(e),a.updater=qy,e.stateNode=a,a._reactInternals=e,Xv(e,o,t,n),e=Jv(null,e,o,!0,d,n)):(e.tag=0,hr&&d&&Cx(e),po(null,e,a,n),e=e.child),e;case 16:o=e.elementType;e:{switch(vg(t,e),t=e.pendingProps,a=o._init,o=a(o._payload),e.type=o,a=e.tag=Q3(o),t=js(o,t),a){case 0:e=Qv(null,e,o,t,n);break e;case 1:e=xS(null,e,o,t,n);break e;case 11:e=_S(null,e,o,t,n);break e;case 14:e=vS(null,e,o,js(o.type,t),n);break e}throw Error(Je(306,o,""))}return e;case 0:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:js(o,a),Qv(t,e,o,a,n);case 1:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:js(o,a),xS(t,e,o,a,n);case 3:e:{if(AC(e),t===null)throw Error(Je(387));o=e.pendingProps,d=e.memoizedState,a=d.element,tC(t,e),Yg(e,o,null,n);var p=e.memoizedState;if(o=p.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},e.updateQueue.baseState=d,e.memoizedState=d,e.flags&256){a=Xh(Error(Je(423)),e),e=wS(t,e,o,n,a);break e}else if(o!==a){a=Xh(Error(Je(424)),e),e=wS(t,e,o,n,a);break e}else for(Ko=Ql(e.stateNode.containerInfo.firstChild),Zo=e,hr=!0,$s=null,n=JI(e,null,o,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gh(),o===a){e=sl(t,e,n);break e}po(t,e,o,n)}e=e.child}return e;case 5:return nC(e),t===null&&Gv(e),o=e.type,a=e.pendingProps,d=t!==null?t.memoizedProps:null,p=a.children,Uv(o,a)?p=null:d!==null&&Uv(o,d)&&(e.flags|=32),CC(t,e),po(t,e,p,n),e.child;case 6:return t===null&&Gv(e),null;case 13:return kC(t,e,n);case 4:return zx(e,e.stateNode.containerInfo),o=e.pendingProps,t===null?e.child=Kh(e,null,o,n):po(t,e,o,n),e.child;case 11:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:js(o,a),_S(t,e,o,a,n);case 7:return po(t,e,e.pendingProps,n),e.child;case 8:return po(t,e,e.pendingProps.children,n),e.child;case 12:return po(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(o=e.type._context,a=e.pendingProps,d=e.memoizedProps,p=a.value,Yn(Zg,o._currentValue),o._currentValue=p,d!==null)if(Ks(d.value,p)){if(d.children===a.children&&!ko.current){e=sl(t,e,n);break e}}else for(d=e.child,d!==null&&(d.return=e);d!==null;){var c=d.dependencies;if(c!==null){p=d.child;for(var S=c.firstContext;S!==null;){if(S.context===o){if(d.tag===1){S=nl(-1,n&-n),S.tag=2;var A=d.updateQueue;if(A!==null){A=A.shared;var D=A.pending;D===null?S.next=S:(S.next=D.next,D.next=S),A.pending=S}}d.lanes|=n,S=d.alternate,S!==null&&(S.lanes|=n),Kv(d.return,n,e),c.lanes|=n;break}S=S.next}}else if(d.tag===10)p=d.type===e.type?null:d.child;else if(d.tag===18){if(p=d.return,p===null)throw Error(Je(341));p.lanes|=n,c=p.alternate,c!==null&&(c.lanes|=n),Kv(p,n,e),p=d.sibling}else p=d.child;if(p!==null)p.return=d;else for(p=d;p!==null;){if(p===e){p=null;break}if(d=p.sibling,d!==null){d.return=p.return,p=d;break}p=p.return}d=p}po(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,o=e.pendingProps.children,zh(e,n),a=vs(a),o=o(a),e.flags|=1,po(t,e,o,n),e.child;case 14:return o=e.type,a=js(o,e.pendingProps),a=js(o.type,a),vS(t,e,o,a,n);case 15:return EC(t,e,e.type,e.pendingProps,n);case 17:return o=e.type,a=e.pendingProps,a=e.elementType===o?a:js(o,a),vg(t,e),e.tag=1,Po(o)?(t=!0,Wg(e)):t=!1,zh(e,n),bC(e,o,a),Xv(e,o,a,n),Jv(null,e,o,!0,t,n);case 19:return PC(t,e,n);case 22:return IC(t,e,n)}throw Error(Je(156,e.tag))};function WC(t,e){return vI(t,e)}function Y3(t,e,n,o){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ys(t,e,n,o){return new Y3(t,e,n,o)}function Xx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Q3(t){if(typeof t=="function")return Xx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mx)return 11;if(t===gx)return 14}return 2}function nu(t,e){var n=t.alternate;return n===null?(n=ys(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bg(t,e,n,o,a,d){var p=2;if(o=t,typeof t=="function")Xx(t)&&(p=1);else if(typeof t=="string")p=5;else e:switch(t){case vh:return rc(n.children,a,d,e);case fx:p=8,a|=8;break;case xv:return t=ys(12,n,e,a|2),t.elementType=xv,t.lanes=d,t;case wv:return t=ys(13,n,e,a),t.elementType=wv,t.lanes=d,t;case bv:return t=ys(19,n,e,a),t.elementType=bv,t.lanes=d,t;case nI:return Gy(n,a,d,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case eI:p=10;break e;case tI:p=9;break e;case mx:p=11;break e;case gx:p=14;break e;case Nl:p=16,o=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return e=ys(p,n,e,a),e.elementType=t,e.type=o,e.lanes=d,e}function rc(t,e,n,o){return t=ys(7,t,o,e),t.lanes=n,t}function Gy(t,e,n,o){return t=ys(22,t,o,e),t.elementType=nI,t.lanes=n,t.stateNode={isHidden:!1},t}function U0(t,e,n){return t=ys(6,t,null,e),t.lanes=n,t}function $0(t,e,n){return e=ys(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function J3(t,e,n,o,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S0(0),this.expirationTimes=S0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S0(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Yx(t,e,n,o,a,d,p,c,S){return t=new J3(t,e,n,c,S),e===1?(e=1,d===!0&&(e|=8)):e=0,d=ys(3,null,null,e),t.current=d,d.stateNode=t,d.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dx(d),t}function eL(t,e,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_h,key:o==null?null:""+o,children:t,containerInfo:e,implementation:n}}function GC(t){if(!t)return lu;t=t._reactInternals;e:{if(wc(t)!==t||t.tag!==1)throw Error(Je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Po(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(Po(n))return GI(t,n,e)}return e}function KC(t,e,n,o,a,d,p,c,S){return t=Yx(n,o,!0,t,a,d,p,c,S),t.context=GC(null),n=t.current,o=mo(),a=tu(n),d=nl(o,a),d.callback=e??null,Jl(n,d,a),t.current.lanes=a,Df(t,a,o),Ro(t,o),t}function Ky(t,e,n,o){var a=e.current,d=mo(),p=tu(a);return n=GC(n),e.context===null?e.context=n:e.pendingContext=n,e=nl(d,p),e.payload={element:t},o=o===void 0?null:o,o!==null&&(e.callback=o),t=Jl(a,e,p),t!==null&&(Ws(t,a,p,d),gg(t,a,p)),p}function oy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function RS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qx(t,e){RS(t,e),(t=t.alternate)&&RS(t,e)}function tL(){return null}var ZC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jx(t){this._internalRoot=t}Zy.prototype.render=Jx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Je(409));Ky(t,e,null,null)};Zy.prototype.unmount=Jx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fc(function(){Ky(null,t,null,null)}),e[il]=null}};function Zy(t){this._internalRoot=t}Zy.prototype.unstable_scheduleHydration=function(t){if(t){var e=II();t={blockedOn:null,target:t,priority:e};for(var n=0;n<jl.length&&e!==0&&e<jl[n].priority;n++);jl.splice(n,0,t),n===0&&AI(t)}};function ew(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Xy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function MS(){}function nL(t,e,n,o,a){if(a){if(typeof o=="function"){var d=o;o=function(){var A=oy(p);d.call(A)}}var p=KC(e,o,t,0,null,!1,!1,"",MS);return t._reactRootContainer=p,t[il]=p.current,pf(t.nodeType===8?t.parentNode:t),fc(),p}for(;a=t.lastChild;)t.removeChild(a);if(typeof o=="function"){var c=o;o=function(){var A=oy(S);c.call(A)}}var S=Yx(t,0,!1,null,null,!1,!1,"",MS);return t._reactRootContainer=S,t[il]=S.current,pf(t.nodeType===8?t.parentNode:t),fc(function(){Ky(e,S,n,o)}),S}function Yy(t,e,n,o,a){var d=n._reactRootContainer;if(d){var p=d;if(typeof a=="function"){var c=a;a=function(){var S=oy(p);c.call(S)}}Ky(e,p,t,a)}else p=nL(n,e,t,a,o);return oy(p)}TI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Dp(e.pendingLanes);n!==0&&(vx(e,n|1),Ro(e,Rr()),!(wn&6)&&(Yh=Rr()+500,fu()))}break;case 13:fc(function(){var o=ol(t,1);if(o!==null){var a=mo();Ws(o,t,1,a)}}),Qx(t,1)}};xx=function(t){if(t.tag===13){var e=ol(t,134217728);if(e!==null){var n=mo();Ws(e,t,134217728,n)}Qx(t,134217728)}};EI=function(t){if(t.tag===13){var e=tu(t),n=ol(t,e);if(n!==null){var o=mo();Ws(n,t,e,o)}Qx(t,e)}};II=function(){return Fn};CI=function(t,e){var n=Fn;try{return Fn=t,e()}finally{Fn=n}};Mv=function(t,e,n){switch(e){case"input":if(Ev(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var o=n[e];if(o!==t&&o.form===t.form){var a=jy(o);if(!a)throw Error(Je(90));iI(o),Ev(o,a)}}}break;case"textarea":sI(t,n);break;case"select":e=n.value,e!=null&&Rh(t,!!n.multiple,e,!1)}};pI=Gx;fI=fc;var rL={usingClientEntryPoint:!1,Events:[Of,Sh,jy,hI,dI,Gx]},Ap={findFiberByHostInstance:Yu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iL={bundleType:Ap.bundleType,version:Ap.version,rendererPackageName:Ap.rendererPackageName,rendererConfig:Ap.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ll.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yI(t),t===null?null:t.stateNode},findFiberByHostInstance:Ap.findFiberByHostInstance||tL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qm.isDisabled&&Qm.supportsFiber)try{Fy=Qm.inject(iL),va=Qm}catch{}}Yo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rL;Yo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ew(e))throw Error(Je(200));return eL(t,e,null,n)};Yo.createRoot=function(t,e){if(!ew(t))throw Error(Je(299));var n=!1,o="",a=ZC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Yx(t,1,!1,null,null,n,!1,o,a),t[il]=e.current,pf(t.nodeType===8?t.parentNode:t),new Jx(e)};Yo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=yI(e),t=t===null?null:t.stateNode,t};Yo.flushSync=function(t){return fc(t)};Yo.hydrate=function(t,e,n){if(!Xy(e))throw Error(Je(200));return Yy(null,t,e,!0,n)};Yo.hydrateRoot=function(t,e,n){if(!ew(t))throw Error(Je(405));var o=n!=null&&n.hydratedSources||null,a=!1,d="",p=ZC;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),e=KC(e,null,t,1,n??null,a,!1,d,p),t[il]=e.current,pf(t),o)for(t=0;t<o.length;t++)n=o[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new Zy(e)};Yo.render=function(t,e,n){if(!Xy(e))throw Error(Je(200));return Yy(null,t,e,!1,n)};Yo.unmountComponentAtNode=function(t){if(!Xy(t))throw Error(Je(40));return t._reactRootContainer?(fc(function(){Yy(null,null,t,!1,function(){t._reactRootContainer=null,t[il]=null})}),!0):!1};Yo.unstable_batchedUpdates=Gx;Yo.unstable_renderSubtreeIntoContainer=function(t,e,n,o){if(!Xy(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return Yy(t,e,n,!1,o)};Yo.version="18.3.1-next-f1338f8080-20240426";function XC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(XC)}catch(t){console.error(t)}}XC(),XE.exports=Yo;var YC=XE.exports;const oL=gd(YC);var LS=YC;_v.createRoot=LS.createRoot,_v.hydrateRoot=LS.hydrateRoot;/**
 * @remix-run/router v1.17.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bf(){return bf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},bf.apply(this,arguments)}var Hl;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Hl||(Hl={}));const DS="popstate";function sL(t){t===void 0&&(t={});function e(o,a){let{pathname:d,search:p,hash:c}=o.location;return h1("",{pathname:d,search:p,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(o,a){return typeof a=="string"?a:sy(a)}return lL(e,n,null,t)}function Er(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function QC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aL(){return Math.random().toString(36).substr(2,8)}function zS(t,e){return{usr:t.state,key:t.key,idx:e}}function h1(t,e,n,o){return n===void 0&&(n=null),bf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?xd(e):e,{state:n,key:e&&e.key||o||aL()})}function sy(t){let{pathname:e="/",search:n="",hash:o=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function xd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let o=t.indexOf("?");o>=0&&(e.search=t.substr(o),t=t.substr(0,o)),t&&(e.pathname=t)}return e}function lL(t,e,n,o){o===void 0&&(o={});let{window:a=document.defaultView,v5Compat:d=!1}=o,p=a.history,c=Hl.Pop,S=null,A=D();A==null&&(A=0,p.replaceState(bf({},p.state,{idx:A}),""));function D(){return(p.state||{idx:null}).idx}function L(){c=Hl.Pop;let me=D(),te=me==null?null:me-A;A=me,S&&S({action:c,location:ue.location,delta:te})}function z(me,te){c=Hl.Push;let G=h1(ue.location,me,te);A=D()+1;let re=zS(G,A),be=ue.createHref(G);try{p.pushState(re,"",be)}catch(Le){if(Le instanceof DOMException&&Le.name==="DataCloneError")throw Le;a.location.assign(be)}d&&S&&S({action:c,location:ue.location,delta:1})}function ee(me,te){c=Hl.Replace;let G=h1(ue.location,me,te);A=D();let re=zS(G,A),be=ue.createHref(G);p.replaceState(re,"",be),d&&S&&S({action:c,location:ue.location,delta:0})}function pe(me){let te=a.location.origin!=="null"?a.location.origin:a.location.href,G=typeof me=="string"?me:sy(me);return G=G.replace(/ $/,"%20"),Er(te,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,te)}let ue={get action(){return c},get location(){return t(a,p)},listen(me){if(S)throw new Error("A history only accepts one active listener");return a.addEventListener(DS,L),S=me,()=>{a.removeEventListener(DS,L),S=null}},createHref(me){return e(a,me)},createURL:pe,encodeLocation(me){let te=pe(me);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:z,replace:ee,go(me){return p.go(me)}};return ue}var OS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(OS||(OS={}));function uL(t,e,n){return n===void 0&&(n="/"),cL(t,e,n,!1)}function cL(t,e,n,o){let a=typeof e=="string"?xd(e):e,d=Qh(a.pathname||"/",n);if(d==null)return null;let p=JC(t);hL(p);let c=null;for(let S=0;c==null&&S<p.length;++S){let A=bL(d);c=xL(p[S],A,o)}return c}function JC(t,e,n,o){e===void 0&&(e=[]),n===void 0&&(n=[]),o===void 0&&(o="");let a=(d,p,c)=>{let S={relativePath:c===void 0?d.path||"":c,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};S.relativePath.startsWith("/")&&(Er(S.relativePath.startsWith(o),'Absolute route path "'+S.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),S.relativePath=S.relativePath.slice(o.length));let A=ru([o,S.relativePath]),D=n.concat(S);d.children&&d.children.length>0&&(Er(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+A+'".')),JC(d.children,e,D,A)),!(d.path==null&&!d.index)&&e.push({path:A,score:_L(A,d.index),routesMeta:D})};return t.forEach((d,p)=>{var c;if(d.path===""||!((c=d.path)!=null&&c.includes("?")))a(d,p);else for(let S of eA(d.path))a(d,p,S)}),e}function eA(t){let e=t.split("/");if(e.length===0)return[];let[n,...o]=e,a=n.endsWith("?"),d=n.replace(/\?$/,"");if(o.length===0)return a?[d,""]:[d];let p=eA(o.join("/")),c=[];return c.push(...p.map(S=>S===""?d:[d,S].join("/"))),a&&c.push(...p),c.map(S=>t.startsWith("/")&&S===""?"/":S)}function hL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:vL(e.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const dL=/^:[\w-]+$/,pL=3,fL=2,mL=1,gL=10,yL=-2,FS=t=>t==="*";function _L(t,e){let n=t.split("/"),o=n.length;return n.some(FS)&&(o+=yL),e&&(o+=fL),n.filter(a=>!FS(a)).reduce((a,d)=>a+(dL.test(d)?pL:d===""?mL:gL),o)}function vL(t,e){return t.length===e.length&&t.slice(0,-1).every((o,a)=>o===e[a])?t[t.length-1]-e[e.length-1]:0}function xL(t,e,n){let{routesMeta:o}=t,a={},d="/",p=[];for(let c=0;c<o.length;++c){let S=o[c],A=c===o.length-1,D=d==="/"?e:e.slice(d.length)||"/",L=ay({path:S.relativePath,caseSensitive:S.caseSensitive,end:A},D),z=S.route;if(!L&&A&&n&&!o[o.length-1].route.index&&(L=ay({path:S.relativePath,caseSensitive:S.caseSensitive,end:!1},D)),!L)return null;Object.assign(a,L.params),p.push({params:a,pathname:ru([d,L.pathname]),pathnameBase:IL(ru([d,L.pathnameBase])),route:z}),L.pathnameBase!=="/"&&(d=ru([d,L.pathnameBase]))}return p}function ay(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,o]=wL(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let d=a[0],p=d.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:o.reduce((A,D,L)=>{let{paramName:z,isOptional:ee}=D;if(z==="*"){let ue=c[L]||"";p=d.slice(0,d.length-ue.length).replace(/(.)\/+$/,"$1")}const pe=c[L];return ee&&!pe?A[z]=void 0:A[z]=(pe||"").replace(/%2F/g,"/"),A},{}),pathname:d,pathnameBase:p,pattern:t}}function wL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),QC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let o=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,c,S)=>(o.push({paramName:c,isOptional:S!=null}),S?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(o.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),o]}function bL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return QC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Qh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,o=t.charAt(n);return o&&o!=="/"?null:t.slice(n)||"/"}function SL(t,e){e===void 0&&(e="/");let{pathname:n,search:o="",hash:a=""}=typeof t=="string"?xd(t):t;return{pathname:n?n.startsWith("/")?n:TL(n,e):e,search:CL(o),hash:AL(a)}}function TL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function q0(t,e,n,o){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function EL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function tA(t,e){let n=EL(t);return e?n.map((o,a)=>a===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function nA(t,e,n,o){o===void 0&&(o=!1);let a;typeof t=="string"?a=xd(t):(a=bf({},t),Er(!a.pathname||!a.pathname.includes("?"),q0("?","pathname","search",a)),Er(!a.pathname||!a.pathname.includes("#"),q0("#","pathname","hash",a)),Er(!a.search||!a.search.includes("#"),q0("#","search","hash",a)));let d=t===""||a.pathname==="",p=d?"/":a.pathname,c;if(p==null)c=n;else{let L=e.length-1;if(!o&&p.startsWith("..")){let z=p.split("/");for(;z[0]==="..";)z.shift(),L-=1;a.pathname=z.join("/")}c=L>=0?e[L]:"/"}let S=SL(a,c),A=p&&p!=="/"&&p.endsWith("/"),D=(d||p===".")&&n.endsWith("/");return!S.pathname.endsWith("/")&&(A||D)&&(S.pathname+="/"),S}const ru=t=>t.join("/").replace(/\/\/+/g,"/"),IL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),CL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,AL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function kL(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const rA=["post","put","patch","delete"];new Set(rA);const PL=["get",...rA];new Set(PL);/**
 * React Router v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sf(){return Sf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Sf.apply(this,arguments)}const Qy=Ve.createContext(null),iA=Ve.createContext(null),mu=Ve.createContext(null),Jy=Ve.createContext(null),ul=Ve.createContext({outlet:null,matches:[],isDataRoute:!1}),oA=Ve.createContext(null);function RL(t,e){let{relative:n}=e===void 0?{}:e;Nf()||Er(!1);let{basename:o,navigator:a}=Ve.useContext(mu),{hash:d,pathname:p,search:c}=e_(t,{relative:n}),S=p;return o!=="/"&&(S=p==="/"?o:ru([o,p])),a.createHref({pathname:S,search:c,hash:d})}function Nf(){return Ve.useContext(Jy)!=null}function Ea(){return Nf()||Er(!1),Ve.useContext(Jy).location}function sA(t){Ve.useContext(mu).static||Ve.useLayoutEffect(t)}function tw(){let{isDataRoute:t}=Ve.useContext(ul);return t?GL():ML()}function ML(){Nf()||Er(!1);let t=Ve.useContext(Qy),{basename:e,future:n,navigator:o}=Ve.useContext(mu),{matches:a}=Ve.useContext(ul),{pathname:d}=Ea(),p=JSON.stringify(tA(a,n.v7_relativeSplatPath)),c=Ve.useRef(!1);return sA(()=>{c.current=!0}),Ve.useCallback(function(A,D){if(D===void 0&&(D={}),!c.current)return;if(typeof A=="number"){o.go(A);return}let L=nA(A,JSON.parse(p),d,D.relative==="path");t==null&&e!=="/"&&(L.pathname=L.pathname==="/"?e:ru([e,L.pathname])),(D.replace?o.replace:o.push)(L,D.state,D)},[e,o,p,d,t])}const LL=Ve.createContext(null);function DL(t){let e=Ve.useContext(ul).outlet;return e&&Ve.createElement(LL.Provider,{value:t},e)}function zL(){let{matches:t}=Ve.useContext(ul),e=t[t.length-1];return e?e.params:{}}function e_(t,e){let{relative:n}=e===void 0?{}:e,{future:o}=Ve.useContext(mu),{matches:a}=Ve.useContext(ul),{pathname:d}=Ea(),p=JSON.stringify(tA(a,o.v7_relativeSplatPath));return Ve.useMemo(()=>nA(t,JSON.parse(p),d,n==="path"),[t,p,d,n])}function OL(t,e){return FL(t,e)}function FL(t,e,n,o){Nf()||Er(!1);let{navigator:a}=Ve.useContext(mu),{matches:d}=Ve.useContext(ul),p=d[d.length-1],c=p?p.params:{};p&&p.pathname;let S=p?p.pathnameBase:"/";p&&p.route;let A=Ea(),D;if(e){var L;let me=typeof e=="string"?xd(e):e;S==="/"||(L=me.pathname)!=null&&L.startsWith(S)||Er(!1),D=me}else D=A;let z=D.pathname||"/",ee=z;if(S!=="/"){let me=S.replace(/^\//,"").split("/");ee="/"+z.replace(/^\//,"").split("/").slice(me.length).join("/")}let pe=uL(t,{pathname:ee}),ue=UL(pe&&pe.map(me=>Object.assign({},me,{params:Object.assign({},c,me.params),pathname:ru([S,a.encodeLocation?a.encodeLocation(me.pathname).pathname:me.pathname]),pathnameBase:me.pathnameBase==="/"?S:ru([S,a.encodeLocation?a.encodeLocation(me.pathnameBase).pathname:me.pathnameBase])})),d,n,o);return e&&ue?Ve.createElement(Jy.Provider,{value:{location:Sf({pathname:"/",search:"",hash:"",state:null,key:"default"},D),navigationType:Hl.Pop}},ue):ue}function NL(){let t=WL(),e=kL(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ve.createElement(Ve.Fragment,null,Ve.createElement("h2",null,"Unexpected Application Error!"),Ve.createElement("h3",{style:{fontStyle:"italic"}},e),n?Ve.createElement("pre",{style:a},n):null,null)}const BL=Ve.createElement(NL,null);class VL extends Ve.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?Ve.createElement(ul.Provider,{value:this.props.routeContext},Ve.createElement(oA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jL(t){let{routeContext:e,match:n,children:o}=t,a=Ve.useContext(Qy);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),Ve.createElement(ul.Provider,{value:e},o)}function UL(t,e,n,o){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),o===void 0&&(o=null),t==null){var d;if((d=n)!=null&&d.errors)t=n.matches;else return null}let p=t,c=(a=n)==null?void 0:a.errors;if(c!=null){let D=p.findIndex(L=>L.route.id&&(c==null?void 0:c[L.route.id])!==void 0);D>=0||Er(!1),p=p.slice(0,Math.min(p.length,D+1))}let S=!1,A=-1;if(n&&o&&o.v7_partialHydration)for(let D=0;D<p.length;D++){let L=p[D];if((L.route.HydrateFallback||L.route.hydrateFallbackElement)&&(A=D),L.route.id){let{loaderData:z,errors:ee}=n,pe=L.route.loader&&z[L.route.id]===void 0&&(!ee||ee[L.route.id]===void 0);if(L.route.lazy||pe){S=!0,A>=0?p=p.slice(0,A+1):p=[p[0]];break}}}return p.reduceRight((D,L,z)=>{let ee,pe=!1,ue=null,me=null;n&&(ee=c&&L.route.id?c[L.route.id]:void 0,ue=L.route.errorElement||BL,S&&(A<0&&z===0?(pe=!0,me=null):A===z&&(pe=!0,me=L.route.hydrateFallbackElement||null)));let te=e.concat(p.slice(0,z+1)),G=()=>{let re;return ee?re=ue:pe?re=me:L.route.Component?re=Ve.createElement(L.route.Component,null):L.route.element?re=L.route.element:re=D,Ve.createElement(jL,{match:L,routeContext:{outlet:D,matches:te,isDataRoute:n!=null},children:re})};return n&&(L.route.ErrorBoundary||L.route.errorElement||z===0)?Ve.createElement(VL,{location:n.location,revalidation:n.revalidation,component:ue,error:ee,children:G(),routeContext:{outlet:null,matches:te,isDataRoute:!0}}):G()},null)}var aA=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(aA||{}),ly=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ly||{});function $L(t){let e=Ve.useContext(Qy);return e||Er(!1),e}function qL(t){let e=Ve.useContext(iA);return e||Er(!1),e}function HL(t){let e=Ve.useContext(ul);return e||Er(!1),e}function lA(t){let e=HL(),n=e.matches[e.matches.length-1];return n.route.id||Er(!1),n.route.id}function WL(){var t;let e=Ve.useContext(oA),n=qL(ly.UseRouteError),o=lA(ly.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[o]}function GL(){let{router:t}=$L(aA.UseNavigateStable),e=lA(ly.UseNavigateStable),n=Ve.useRef(!1);return sA(()=>{n.current=!0}),Ve.useCallback(function(a,d){d===void 0&&(d={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Sf({fromRouteId:e},d)))},[t,e])}function KL(t){return DL(t.context)}function Op(t){Er(!1)}function ZL(t){let{basename:e="/",children:n=null,location:o,navigationType:a=Hl.Pop,navigator:d,static:p=!1,future:c}=t;Nf()&&Er(!1);let S=e.replace(/^\/*/,"/"),A=Ve.useMemo(()=>({basename:S,navigator:d,static:p,future:Sf({v7_relativeSplatPath:!1},c)}),[S,c,d,p]);typeof o=="string"&&(o=xd(o));let{pathname:D="/",search:L="",hash:z="",state:ee=null,key:pe="default"}=o,ue=Ve.useMemo(()=>{let me=Qh(D,S);return me==null?null:{location:{pathname:me,search:L,hash:z,state:ee,key:pe},navigationType:a}},[S,D,L,z,ee,pe,a]);return ue==null?null:Ve.createElement(mu.Provider,{value:A},Ve.createElement(Jy.Provider,{children:n,value:ue}))}function XL(t){let{children:e,location:n}=t;return OL(d1(e),n)}new Promise(()=>{});function d1(t,e){e===void 0&&(e=[]);let n=[];return Ve.Children.forEach(t,(o,a)=>{if(!Ve.isValidElement(o))return;let d=[...e,a];if(o.type===Ve.Fragment){n.push.apply(n,d1(o.props.children,d));return}o.type!==Op&&Er(!1),!o.props.index||!o.props.children||Er(!1);let p={id:o.props.id||d.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(p.children=d1(o.props.children,d)),n.push(p)}),n}/**
 * React Router DOM v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uy(){return uy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},uy.apply(this,arguments)}function uA(t,e){if(t==null)return{};var n={},o=Object.keys(t),a,d;for(d=0;d<o.length;d++)a=o[d],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function YL(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function QL(t,e){return t.button===0&&(!e||e==="_self")&&!YL(t)}function p1(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let o=t[n];return e.concat(Array.isArray(o)?o.map(a=>[n,a]):[[n,o]])},[]))}function JL(t,e){let n=p1(t);return e&&e.forEach((o,a)=>{n.has(a)||e.getAll(a).forEach(d=>{n.append(a,d)})}),n}const eD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],tD=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],nD="6";try{window.__reactRouterVersion=nD}catch{}const rD=Ve.createContext({isTransitioning:!1}),iD="startTransition",NS=KM[iD];function oD(t){let{basename:e,children:n,future:o,window:a}=t,d=Ve.useRef();d.current==null&&(d.current=sL({window:a,v5Compat:!0}));let p=d.current,[c,S]=Ve.useState({action:p.action,location:p.location}),{v7_startTransition:A}=o||{},D=Ve.useCallback(L=>{A&&NS?NS(()=>S(L)):S(L)},[S,A]);return Ve.useLayoutEffect(()=>p.listen(D),[p,D]),Ve.createElement(ZL,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:p,future:o})}const sD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cy=Ve.forwardRef(function(e,n){let{onClick:o,relative:a,reloadDocument:d,replace:p,state:c,target:S,to:A,preventScrollReset:D,unstable_viewTransition:L}=e,z=uA(e,eD),{basename:ee}=Ve.useContext(mu),pe,ue=!1;if(typeof A=="string"&&aD.test(A)&&(pe=A,sD))try{let re=new URL(window.location.href),be=A.startsWith("//")?new URL(re.protocol+A):new URL(A),Le=Qh(be.pathname,ee);be.origin===re.origin&&Le!=null?A=Le+be.search+be.hash:ue=!0}catch{}let me=RL(A,{relative:a}),te=uD(A,{replace:p,state:c,target:S,preventScrollReset:D,relative:a,unstable_viewTransition:L});function G(re){o&&o(re),re.defaultPrevented||te(re)}return Ve.createElement("a",uy({},z,{href:pe||me,onClick:ue||d?o:G,ref:n,target:S}))}),BS=Ve.forwardRef(function(e,n){let{"aria-current":o="page",caseSensitive:a=!1,className:d="",end:p=!1,style:c,to:S,unstable_viewTransition:A,children:D}=e,L=uA(e,tD),z=e_(S,{relative:L.relative}),ee=Ea(),pe=Ve.useContext(iA),{navigator:ue,basename:me}=Ve.useContext(mu),te=pe!=null&&cD(z)&&A===!0,G=ue.encodeLocation?ue.encodeLocation(z).pathname:z.pathname,re=ee.pathname,be=pe&&pe.navigation&&pe.navigation.location?pe.navigation.location.pathname:null;a||(re=re.toLowerCase(),be=be?be.toLowerCase():null,G=G.toLowerCase()),be&&me&&(be=Qh(be,me)||be);const Le=G!=="/"&&G.endsWith("/")?G.length-1:G.length;let Me=re===G||!p&&re.startsWith(G)&&re.charAt(Le)==="/",J=be!=null&&(be===G||!p&&be.startsWith(G)&&be.charAt(G.length)==="/"),X={isActive:Me,isPending:J,isTransitioning:te},Y=Me?o:void 0,ie;typeof d=="function"?ie=d(X):ie=[d,Me?"active":null,J?"pending":null,te?"transitioning":null].filter(Boolean).join(" ");let de=typeof c=="function"?c(X):c;return Ve.createElement(cy,uy({},L,{"aria-current":Y,className:ie,ref:n,style:de,to:S,unstable_viewTransition:A}),typeof D=="function"?D(X):D)});var f1;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(f1||(f1={}));var VS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(VS||(VS={}));function lD(t){let e=Ve.useContext(Qy);return e||Er(!1),e}function uD(t,e){let{target:n,replace:o,state:a,preventScrollReset:d,relative:p,unstable_viewTransition:c}=e===void 0?{}:e,S=tw(),A=Ea(),D=e_(t,{relative:p});return Ve.useCallback(L=>{if(QL(L,n)){L.preventDefault();let z=o!==void 0?o:sy(A)===sy(D);S(t,{replace:z,state:a,preventScrollReset:d,relative:p,unstable_viewTransition:c})}},[A,S,D,o,a,n,t,d,p,c])}function cA(t){let e=Ve.useRef(p1(t)),n=Ve.useRef(!1),o=Ea(),a=Ve.useMemo(()=>JL(o.search,n.current?null:e.current),[o.search]),d=tw(),p=Ve.useCallback((c,S)=>{const A=p1(typeof c=="function"?c(a):c);n.current=!0,d("?"+A,S)},[d,a]);return[a,p]}function cD(t,e){e===void 0&&(e={});let n=Ve.useContext(rD);n==null&&Er(!1);let{basename:o}=lD(f1.useViewTransitionState),a=e_(t,{relative:e.relative});if(!n.isTransitioning)return!1;let d=Qh(n.currentLocation.pathname,o)||n.currentLocation.pathname,p=Qh(n.nextLocation.pathname,o)||n.nextLocation.pathname;return ay(a.pathname,p)!=null||ay(a.pathname,d)!=null}var hA={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.4.1/LICENSE.txt
 */(function(t,e){(function(n,o){t.exports=o()})(Rp,function(){var n={},o={};function a(p,c,S){if(o[p]=S,p==="index"){var A="var sharedModule = {}; ("+o.shared+")(sharedModule); ("+o.worker+")(sharedModule);",D={};return o.shared(D),o.index(n,D),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([A],{type:"text/javascript"}))),n}}a("shared",["exports"],function(p){function c(s,r,l,h){return new(l||(l=Promise))(function(m,y){function x(k){try{E(h.next(k))}catch(R){y(R)}}function b(k){try{E(h.throw(k))}catch(R){y(R)}}function E(k){var R;k.done?m(k.value):(R=k.value,R instanceof l?R:new l(function(O){O(R)})).then(x,b)}E((h=h.apply(s,r||[])).next())})}function S(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}typeof SuppressedError=="function"&&SuppressedError;var A=D;function D(s,r){this.x=s,this.y=r}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,l=s.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),l=Math.sin(s),h=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=h,this},_rotateAround:function(s,r){var l=Math.cos(s),h=Math.sin(s),m=r.y+h*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-h*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},D.convert=function(s){return s instanceof D?s:Array.isArray(s)?new D(s[0],s[1]):s};var L=S(A),z=ee;function ee(s,r,l,h){this.cx=3*s,this.bx=3*(l-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=l,this.p2y=h}ee.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var l=s,h=0;h<8;h++){var m=this.sampleCurveX(l)-s;if(Math.abs(m)<r)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var x=0,b=1;for(l=s,h=0;h<20&&(m=this.sampleCurveX(l),!(Math.abs(m-s)<r));h++)s>m?x=l:b=l,l=.5*(b-x)+x;return l},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var pe=S(z);let ue,me;function te(){return ue==null&&(ue=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ue}function G(){if(me==null&&(me=!1,te())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let h=0;h<5*5;h++){const m=4*h;r.fillStyle=`rgb(${m},${m+1},${m+2})`,r.fillRect(h%5,Math.floor(h/5),1,1)}const l=r.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&l[h]!==h){me=!0;break}}}return me||!1}function re(s,r,l,h){const m=new pe(s,r,l,h);return y=>m.solve(y)}const be=re(.25,.1,.25,1);function Le(s,r,l){return Math.min(l,Math.max(r,s))}function Me(s,r,l){const h=l-r,m=((s-r)%h+h)%h+r;return m===r?l:m}function J(s,...r){for(const l of r)for(const h in l)s[h]=l[h];return s}let X=1;function Y(s,r,l){const h={};for(const m in s)h[m]=r.call(this,s[m],m,s);return h}function ie(s,r,l){const h={};for(const m in s)r.call(this,s[m],m,s)&&(h[m]=s[m]);return h}function de(s){return Array.isArray(s)?s.map(de):typeof s=="object"&&s?Y(s,de):s}const we={};function se(s){we[s]||(typeof console<"u"&&console.warn(s),we[s]=!0)}function ut(s,r,l){return(l.y-s.y)*(r.x-s.x)>(r.y-s.y)*(l.x-s.x)}function un(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let cn=null;function tn(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ht(s,r,l,h,m){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(s,{timestamp:0});try{const x=y==null?void 0:y.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const b=x.startsWith("BGR"),E=new Uint8ClampedArray(h*m*4);if(yield y.copyTo(E,function(k,R,O,V,$){const W=4*Math.max(-R,0),Z=(Math.max(0,O)-O)*V*4+W,ce=4*V,ge=Math.max(0,R),ke=Math.max(0,O);return{rect:{x:ge,y:ke,width:Math.min(k.width,R+V)-ge,height:Math.min(k.height,O+$)-ke},layout:[{offset:Z,stride:ce}]}}(s,r,l,h,m)),b)for(let k=0;k<E.length;k+=4){const R=E[k];E[k]=E[k+2],E[k+2]=R}return E}finally{y.close()}})}let Tt,kt;const At="AbortError";function jt(){return new Error(At)}const Hn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function fn(s){return Hn.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const kn="global-dispatcher";class Pn extends Error{constructor(r,l,h,m){super(`AJAXError: ${l} (${r}): ${h}`),this.status=r,this.statusText=l,this.url=h,this.body=m}}const vr=()=>un(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Lr=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const h=fn(s.url);if(h)return h(s,r);if(un(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:kn},r)}if(!(/^file:/.test(l=s.url)||/^file:/.test(vr())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,m){return c(this,void 0,void 0,function*(){const y=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:vr(),signal:m.signal});h.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const x=yield fetch(y);if(!x.ok){const k=yield x.blob();throw new Pn(x.status,x.statusText,h.url,k)}let b;b=h.type==="arrayBuffer"||h.type==="image"?x.arrayBuffer():h.type==="json"?x.json():x.text();const E=yield b;if(m.signal.aborted)throw jt();return{data:E,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,r);if(un(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:kn},r)}var l;return function(h,m){return new Promise((y,x)=>{var b;const E=new XMLHttpRequest;E.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(E.responseType="arraybuffer");for(const k in h.headers)E.setRequestHeader(k,h.headers[k]);h.type==="json"&&(E.responseType="text",!((b=h.headers)===null||b===void 0)&&b.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=h.credentials==="include",E.onerror=()=>{x(new Error(E.statusText))},E.onload=()=>{if(!m.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let k=E.response;if(h.type==="json")try{k=JSON.parse(E.response)}catch(R){return void x(R)}y({data:k,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const k=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});x(new Pn(E.status,E.statusText,h.url,k))}},m.signal.addEventListener("abort",()=>{E.abort(),x(jt())}),E.send(h.body)})}(s,r)};function Dr(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),l=window.location;return r.protocol===l.protocol&&r.host===l.host}function ei(s,r,l){l[s]&&l[s].indexOf(r)!==-1||(l[s]=l[s]||[],l[s].push(r))}function Nn(s,r,l){if(l&&l[s]){const h=l[s].indexOf(r);h!==-1&&l[s].splice(h,1)}}class Oi{constructor(r,l={}){J(this,l),this.type=r}}class En extends Oi{constructor(r,l={}){super("error",J({error:r},l))}}class no{on(r,l){return this._listeners=this._listeners||{},ei(r,l,this._listeners),this}off(r,l){return Nn(r,l,this._listeners),Nn(r,l,this._oneTimeListeners),this}once(r,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},ei(r,l,this._oneTimeListeners),this):new Promise(h=>this.once(r,h))}fire(r,l){typeof r=="string"&&(r=new Oi(r,l||{}));const h=r.type;if(this.listens(h)){r.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const b of m)b.call(this,r);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const b of y)Nn(h,b,this._oneTimeListeners),b.call(this,r);const x=this._eventedParent;x&&(J(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof En&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,l){return this._eventedParent=r,this._eventedParentData=l,this}}var Oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ro=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wr(s,r){const l={};for(const h in s)h!=="ref"&&(l[h]=s[h]);return ro.forEach(h=>{h in r&&(l[h]=r[h])}),l}function Vt(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let l=0;l<s.length;l++)if(!Vt(s[l],r[l]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const l in s)if(!Vt(s[l],r[l]))return!1;return!0}return s===r}function en(s,r){s.push(r)}function wi(s,r,l){en(l,{command:"addSource",args:[s,r[s]]})}function Do(s,r,l){en(r,{command:"removeSource",args:[s]}),l[s]=!0}function Qn(s,r,l,h){Do(s,l,h),wi(s,r,l)}function ti(s,r,l){let h;for(h in s[l])if(Object.prototype.hasOwnProperty.call(s[l],h)&&h!=="data"&&!Vt(s[l][h],r[l][h]))return!1;for(h in r[l])if(Object.prototype.hasOwnProperty.call(r[l],h)&&h!=="data"&&!Vt(s[l][h],r[l][h]))return!1;return!0}function Gr(s,r,l,h,m,y){s=s||{},r=r||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(Vt(s[x],r[x])||l.push({command:y,args:[h,x,r[x],m]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(Vt(s[x],r[x])||l.push({command:y,args:[h,x,r[x],m]}))}function mn(s){return s.id}function Kn(s,r){return s[r.id]=r,s}class Ke{constructor(r,l,h,m){this.message=(r?`${r}: `:"")+h,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function Ir(s,...r){for(const l of r)for(const h in l)s[h]=l[h];return s}class dr extends Error{constructor(r,l){super(l),this.message=l,this.key=r}}class Jo{constructor(r,l=[]){this.parent=r,this.bindings={};for(const[h,m]of l)this.bindings[h]=m}concat(r){return new Jo(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const bi={kind:"null"},Ze={kind:"number"},Bt={kind:"string"},Pt={kind:"boolean"},Cr={kind:"color"},xr={kind:"object"},Ot={kind:"value"},Fi={kind:"collator"},Ni={kind:"formatted"},Wt={kind:"padding"},ne={kind:"resolvedImage"},j={kind:"variableAnchorOffsetCollection"};function U(s,r){return{kind:"array",itemType:s,N:r}}function q(s){if(s.kind==="array"){const r=q(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const le=[bi,Ze,Bt,Pt,Cr,Ni,xr,U(Ot),Wt,ne,j];function ve(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!ve(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const l of le)if(!ve(l,r))return null}}return`Expected ${q(s)} but found ${q(r)} instead.`}function Ee(s,r){return r.some(l=>l.kind===s.kind)}function Ae(s,r){return r.some(l=>l==="null"?s===null:l==="array"?Array.isArray(s):l==="object"?s&&!Array.isArray(s)&&typeof s=="object":l===typeof s)}function ye(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const Re=.96422,Ue=.82521,Ne=4/29,Be=6/29,bt=3*Be*Be,yt=Be*Be*Be,Gt=Math.PI/180,Mt=180/Math.PI;function Kt(s){return(s%=360)<0&&(s+=360),s}function gn([s,r,l,h]){let m,y;const x=Wn((.2225045*(s=Sn(s))+.7168786*(r=Sn(r))+.0606169*(l=Sn(l)))/1);s===r&&r===l?m=y=x:(m=Wn((.4360747*s+.3850649*r+.1430804*l)/Re),y=Wn((.0139322*s+.0971045*r+.7141733*l)/Ue));const b=116*x-16;return[b<0?0:b,500*(m-x),200*(x-y),h]}function Sn(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Wn(s){return s>yt?Math.pow(s,1/3):s/bt+Ne}function Rt([s,r,l,h]){let m=(s+16)/116,y=isNaN(r)?m:m+r/500,x=isNaN(l)?m:m-l/200;return m=1*ir(m),y=Re*ir(y),x=Ue*ir(x),[Dn(3.1338561*y-1.6168667*m-.4906146*x),Dn(-.9787684*y+1.9161415*m+.033454*x),Dn(.0719453*y-.2289914*m+1.4052427*x),h]}function Dn(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function ir(s){return s>Be?s*s*s:bt*(s-Ne)}function zr(s){return parseInt(s.padEnd(2,s),16)/255}function Kr(s,r){return or(r?s/100:s,0,1)}function or(s,r,l){return Math.min(Math.max(r,s),l)}function bs(s){return!s.some(Number.isNaN)}const Cd={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class nn{constructor(r,l,h,m=1,y=!0){this.r=r,this.g=l,this.b=h,this.a=m,y||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[r,l,h,m]))}static parse(r){if(r instanceof nn)return r;if(typeof r!="string")return;const l=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Cd[h];if(m){const[x,b,E]=m;return[x/255,b/255,E/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const x=h.length<6?1:2;let b=1;return[zr(h.slice(b,b+=x)),zr(h.slice(b,b+=x)),zr(h.slice(b,b+=x)),zr(h.slice(b,b+x)||"ff")]}if(h.startsWith("rgb")){const x=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,E,k,R,O,V,$,W,Z,ce,ge,ke]=x,xe=[R||" ",$||" ",ce].join("");if(xe==="  "||xe==="  /"||xe===",,"||xe===",,,"){const Ce=[k,V,Z].join(""),ze=Ce==="%%%"?100:Ce===""?255:0;if(ze){const qe=[or(+E/ze,0,1),or(+O/ze,0,1),or(+W/ze,0,1),ge?Kr(+ge,ke):1];if(bs(qe))return qe}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,b,E,k,R,O,V,$,W]=y,Z=[E||" ",R||" ",V].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const ce=[+b,or(+k,0,100),or(+O,0,100),$?Kr(+$,W):1];if(bs(ce))return function([ge,ke,xe,Ce]){function ze(qe){const rt=(qe+ge/30)%12,Et=ke*Math.min(xe,1-xe);return xe-Et*Math.max(-1,Math.min(rt-3,9-rt,1))}return ge=Kt(ge),ke/=100,xe/=100,[ze(0),ze(8),ze(4),Ce]}(ce)}}}(r);return l?new nn(...l,!1):void 0}get rgb(){const{r,g:l,b:h,a:m}=this,y=m||1/0;return this.overwriteGetter("rgb",[r/y,l/y,h/y,m])}get hcl(){return this.overwriteGetter("hcl",function(r){const[l,h,m,y]=gn(r),x=Math.sqrt(h*h+m*m);return[Math.round(1e4*x)?Kt(Math.atan2(m,h)*Mt):NaN,x,l,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gn(this.rgb))}overwriteGetter(r,l){return Object.defineProperty(this,r,{value:l}),l}toString(){const[r,l,h,m]=this.rgb;return`rgba(${[r,l,h].map(y=>Math.round(255*y)).join(",")},${m})`}}nn.black=new nn(0,0,0,1),nn.white=new nn(1,1,1,1),nn.transparent=new nn(0,0,0,0),nn.red=new nn(1,0,0,1);class cl{constructor(r,l,h){this.sensitivity=r?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,l){return this.collator.compare(r,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ca{constructor(r,l,h,m,y){this.text=r,this.image=l,this.scale=h,this.fontStack=m,this.textColor=y}}class Ar{constructor(r){this.sections=r}static fromString(r){return new Ar([new Ca(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Ar?r:Ar.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class sr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof sr)return r;if(typeof r=="number")return new sr([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const l of r)if(typeof l!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new sr(r)}}toString(){return JSON.stringify(this.values)}}const Ss=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ni{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof ni)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let l=0;l<r.length;l+=2){const h=r[l],m=r[l+1];if(typeof h!="string"||!Ss.has(h)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new ni(r)}}toString(){return JSON.stringify(this.values)}}class Si{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Si({name:r,available:!1}):null}}function gu(s,r,l,h){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,r,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,r,l,h]:[s,r,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _o(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof nn||s instanceof cl||s instanceof Ar||s instanceof sr||s instanceof ni||s instanceof Si)return!0;if(Array.isArray(s)){for(const r of s)if(!_o(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!_o(s[r]))return!1;return!0}return!1}function Zn(s){if(s===null)return bi;if(typeof s=="string")return Bt;if(typeof s=="boolean")return Pt;if(typeof s=="number")return Ze;if(s instanceof nn)return Cr;if(s instanceof cl)return Fi;if(s instanceof Ar)return Ni;if(s instanceof sr)return Wt;if(s instanceof ni)return j;if(s instanceof Si)return ne;if(Array.isArray(s)){const r=s.length;let l;for(const h of s){const m=Zn(h);if(l){if(l===m)continue;l=Ot;break}l=m}return U(l||Ot,r)}return xr}function Ts(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof nn||s instanceof Ar||s instanceof sr||s instanceof ni||s instanceof Si?s.toString():JSON.stringify(s)}class es{constructor(r,l){this.type=r,this.value=l}static parse(r,l){if(r.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!_o(r[1]))return l.error("invalid value");const h=r[1];let m=Zn(h);const y=l.expectedType;return m.kind!=="array"||m.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(m=y),new es(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Gn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Es={string:Bt,number:Ze,boolean:Pt,object:xr};class io{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");let h,m=1;const y=r[0];if(y==="array"){let b,E;if(r.length>2){const k=r[1];if(typeof k!="string"||!(k in Es)||k==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=Es[k],m++}else b=Ot;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=r[2],m++}h=U(b,E)}else{if(!Es[y])throw new Error(`Types doesn't contain name = ${y}`);h=Es[y]}const x=[];for(;m<r.length;m++){const b=l.parse(r[m],m,Ot);if(!b)return null;x.push(b)}return new io(h,x)}evaluate(r){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(r);if(!ve(this.type,Zn(h)))return h;if(l===this.args.length-1)throw new Gn(`Expected value to be of type ${q(this.type)}, but found ${q(Zn(h))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Aa={"to-boolean":Pt,"to-color":Cr,"to-number":Ze,"to-string":Bt};class oo{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[0];if(!Aa[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&r.length!==2)return l.error("Expected one argument.");const m=Aa[h],y=[];for(let x=1;x<r.length;x++){const b=l.parse(r[x],x,Ot);if(!b)return null;y.push(b)}return new oo(m,y)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let l,h;for(const m of this.args){if(l=m.evaluate(r),h=null,l instanceof nn)return l;if(typeof l=="string"){const y=r.parseColor(l);if(y)return y}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:gu(l[0],l[1],l[2],l[3]),!h))return new nn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Gn(h||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const h of this.args){l=h.evaluate(r);const m=sr.parse(l);if(m)return m}throw new Gn(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const h of this.args){l=h.evaluate(r);const m=ni.parse(l);if(m)return m}throw new Gn(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const h of this.args){if(l=h.evaluate(r),l===null)return 0;const m=Number(l);if(!isNaN(m))return m}throw new Gn(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Ar.fromString(Ts(this.args[0].evaluate(r)));case"resolvedImage":return Si.fromString(Ts(this.args[0].evaluate(r)));default:return Ts(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const yu=["Unknown","Point","LineString","Polygon"];class Bi{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let l=this._parseColorCache[r];return l||(l=this._parseColorCache[r]=nn.parse(r)),l}}class Zt{constructor(r,l,h=[],m,y=new Jo,x=[]){this.registry=r,this.path=h,this.key=h.map(b=>`[${b}]`).join(""),this.scope=y,this.errors=x,this.expectedType=m,this._isConstant=l}parse(r,l,h,m,y={}){return l?this.concat(l,h,m)._parse(r,y):this._parse(r,y)}_parse(r,l){function h(m,y,x){return x==="assert"?new io(y,[m]):x==="coerce"?new oo(y,[m]):m}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=r[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let x=y.parse(r,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,E=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||E.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string")if(b.kind!=="padding"||E.kind!=="value"&&E.kind!=="number"&&E.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||E.kind!=="value"&&E.kind!=="array"){if(this.checkSubtype(b,E))return null}else x=h(x,b,l.typeAnnotation||"coerce");else x=h(x,b,l.typeAnnotation||"coerce");else x=h(x,b,l.typeAnnotation||"coerce");else x=h(x,b,l.typeAnnotation||"assert")}if(!(x instanceof es)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const b=new Bi;try{x=new es(x.type,x.evaluate(b))}catch(E){return this.error(E.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,l,h){const m=typeof r=="number"?this.path.concat(r):this.path,y=h?this.scope.concat(h):this.scope;return new Zt(this.registry,this._isConstant,m,l||null,y,this.errors)}error(r,...l){const h=`${this.key}${l.map(m=>`[${m}]`).join("")}`;this.errors.push(new dr(h,r))}checkSubtype(r,l){const h=ve(r,l);return h&&this.error(h),h}}class Is{constructor(r,l){this.type=l.type,this.bindings=[].concat(r),this.result=l}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const l of this.bindings)r(l[1]);r(this.result)}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const h=[];for(let y=1;y<r.length-1;y+=2){const x=r[y];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",y);const b=l.parse(r[y+1],y+1);if(!b)return null;h.push([x,b])}const m=l.parse(r[r.length-1],r.length-1,l.expectedType,h);return m?new Is(h,m):null}outputDefined(){return this.result.outputDefined()}}class zo{constructor(r,l){this.type=l.type,this.name=r,this.boundExpression=l}static parse(r,l){if(r.length!==2||typeof r[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const h=r[1];return l.scope.has(h)?new zo(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class hl{constructor(r,l,h){this.type=r,this.index=l,this.input=h}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ze),m=l.parse(r[2],2,U(l.expectedType||Ot));return h&&m?new hl(m.type.itemType,h,m):null}evaluate(r){const l=this.index.evaluate(r),h=this.input.evaluate(r);if(l<0)throw new Gn(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new Gn(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new Gn(`Array index must be an integer, but found ${l} instead.`);return h[l]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Tn{constructor(r,l){this.type=Pt,this.needle=r,this.haystack=l}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ot),m=l.parse(r[2],2,Ot);return h&&m?Ee(h.type,[Pt,Bt,Ze,bi,Ot])?new Tn(h,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${q(h.type)} instead`):null}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!h)return!1;if(!Ae(l,["boolean","string","number","null"]))throw new Gn(`Expected first argument to be of type boolean, string, number or null, but found ${q(Zn(l))} instead.`);if(!Ae(h,["string","array"]))throw new Gn(`Expected second argument to be of type array or string, but found ${q(Zn(h))} instead.`);return h.indexOf(l)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class ts{constructor(r,l,h){this.type=Ze,this.needle=r,this.haystack=l,this.fromIndex=h}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ot),m=l.parse(r[2],2,Ot);if(!h||!m)return null;if(!Ee(h.type,[Pt,Bt,Ze,bi,Ot]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${q(h.type)} instead`);if(r.length===4){const y=l.parse(r[3],3,Ze);return y?new ts(h,m,y):null}return new ts(h,m)}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!Ae(l,["boolean","string","number","null"]))throw new Gn(`Expected first argument to be of type boolean, string, number or null, but found ${q(Zn(l))} instead.`);if(!Ae(h,["string","array"]))throw new Gn(`Expected second argument to be of type array or string, but found ${q(Zn(h))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(r);return h.indexOf(l,m)}return h.indexOf(l)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Cs{constructor(r,l,h,m,y,x){this.inputType=r,this.type=l,this.input=h,this.cases=m,this.outputs=y,this.otherwise=x}static parse(r,l){if(r.length<5)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return l.error("Expected an even number of arguments.");let h,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);const y={},x=[];for(let k=2;k<r.length-1;k+=2){let R=r[k];const O=r[k+1];Array.isArray(R)||(R=[R]);const V=l.concat(k);if(R.length===0)return V.error("Expected at least one branch label.");for(const W of R){if(typeof W!="number"&&typeof W!="string")return V.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return V.error("Numeric branch labels must be integer values.");if(h){if(V.checkSubtype(h,Zn(W)))return null}else h=Zn(W);if(y[String(W)]!==void 0)return V.error("Branch labels must be unique.");y[String(W)]=x.length}const $=l.parse(O,k,m);if(!$)return null;m=m||$.type,x.push($)}const b=l.parse(r[1],1,Ot);if(!b)return null;const E=l.parse(r[r.length-1],r.length-1,m);return E?b.type.kind!=="value"&&l.concat(1).checkSubtype(h,b.type)?null:new Cs(h,m,b,y,x,E):null}evaluate(r){const l=this.input.evaluate(r);return(Zn(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class ns{constructor(r,l,h){this.type=r,this.branches=l,this.otherwise=h}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);const m=[];for(let x=1;x<r.length-1;x+=2){const b=l.parse(r[x],x,Pt);if(!b)return null;const E=l.parse(r[x+1],x+1,h);if(!E)return null;m.push([b,E]),h=h||E.type}const y=l.parse(r[r.length-1],r.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new ns(h,m,y)}evaluate(r){for(const[l,h]of this.branches)if(l.evaluate(r))return h.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[l,h]of this.branches)r(l),r(h);r(this.otherwise)}outputDefined(){return this.branches.every(([r,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class ka{constructor(r,l,h,m){this.type=r,this.input=l,this.beginIndex=h,this.endIndex=m}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Ot),m=l.parse(r[2],2,Ze);if(!h||!m)return null;if(!Ee(h.type,[U(Ot),Bt,Ot]))return l.error(`Expected first argument to be of type array or string, but found ${q(h.type)} instead`);if(r.length===4){const y=l.parse(r[3],3,Ze);return y?new ka(h.type,h,m,y):null}return new ka(h.type,h,m)}evaluate(r){const l=this.input.evaluate(r),h=this.beginIndex.evaluate(r);if(!Ae(l,["string","array"]))throw new Gn(`Expected first argument to be of type array or string, but found ${q(Zn(l))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(r);return l.slice(h,m)}return l.slice(h)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Pa(s,r){const l=s.length-1;let h,m,y=0,x=l,b=0;for(;y<=x;)if(b=Math.floor((y+x)/2),h=s[b],m=s[b+1],h<=r){if(b===l||r<m)return b;y=b+1}else{if(!(h>r))throw new Gn("Input is not a number.");x=b-1}return 0}class Ra{constructor(r,l,h){this.type=r,this.input=l,this.labels=[],this.outputs=[];for(const[m,y]of h)this.labels.push(m),this.outputs.push(y)}static parse(r,l){if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(r[1],1,Ze);if(!h)return null;const m=[];let y=null;l.expectedType&&l.expectedType.kind!=="value"&&(y=l.expectedType);for(let x=1;x<r.length;x+=2){const b=x===1?-1/0:r[x],E=r[x+1],k=x,R=x+1;if(typeof b!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=b)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const O=l.parse(E,R,y);if(!O)return null;y=y||O.type,m.push([b,O])}return new Ra(y,h,m)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const m=this.input.evaluate(r);if(m<=l[0])return h[0].evaluate(r);const y=l.length;return m>=l[y-1]?h[y-1].evaluate(r):h[Pa(l,m)].evaluate(r)}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Ad(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var kd=_u;function _u(s,r,l,h){this.cx=3*s,this.bx=3*(l-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=l,this.p2y=h}_u.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var l=s,h=0;h<8;h++){var m=this.sampleCurveX(l)-s;if(Math.abs(m)<r)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var x=0,b=1;for(l=s,h=0;h<20&&(m=this.sampleCurveX(l),!(Math.abs(m-s)<r));h++)s>m?x=l:b=l,l=.5*(b-x)+x;return l},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var Zs=Ad(kd);function ri(s,r,l){return s+l*(r-s)}function Ma(s,r,l){return s.map((h,m)=>ri(h,r[m],l))}const Or={number:ri,color:function(s,r,l,h="rgb"){switch(h){case"rgb":{const[m,y,x,b]=Ma(s.rgb,r.rgb,l);return new nn(m,y,x,b,!1)}case"hcl":{const[m,y,x,b]=s.hcl,[E,k,R,O]=r.hcl;let V,$;if(isNaN(m)||isNaN(E))isNaN(m)?isNaN(E)?V=NaN:(V=E,x!==1&&x!==0||($=k)):(V=m,R!==1&&R!==0||($=y));else{let ke=E-m;E>m&&ke>180?ke-=360:E<m&&m-E>180&&(ke+=360),V=m+l*ke}const[W,Z,ce,ge]=function([ke,xe,Ce,ze]){return ke=isNaN(ke)?0:ke*Gt,Rt([Ce,Math.cos(ke)*xe,Math.sin(ke)*xe,ze])}([V,$??ri(y,k,l),ri(x,R,l),ri(b,O,l)]);return new nn(W,Z,ce,ge,!1)}case"lab":{const[m,y,x,b]=Rt(Ma(s.lab,r.lab,l));return new nn(m,y,x,b,!1)}}},array:Ma,padding:function(s,r,l){return new sr(Ma(s.values,r.values,l))},variableAnchorOffsetCollection:function(s,r,l){const h=s.values,m=r.values;if(h.length!==m.length)throw new Gn(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${r.toString()}`);const y=[];for(let x=0;x<h.length;x+=2){if(h[x]!==m[x])throw new Gn(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${h[x]}, to[${x}]: ${m[x]}`);y.push(h[x]);const[b,E]=h[x+1],[k,R]=m[x+1];y.push([ri(b,k,l),ri(E,R,l)])}return new ni(y)}};class ii{constructor(r,l,h,m,y){this.type=r,this.operator=l,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[x,b]of y)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(r,l,h,m){let y=0;if(r.name==="exponential")y=rs(l,r.base,h,m);else if(r.name==="linear")y=rs(l,1,h,m);else if(r.name==="cubic-bezier"){const x=r.controlPoints;y=new Zs(x[0],x[1],x[2],x[3]).solve(rs(l,1,h,m))}return y}static parse(r,l){let[h,m,y,...x]=r;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const k=m[1];if(typeof k!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:k}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const k=m.slice(1);if(k.length!==4||k.some(R=>typeof R!="number"||R<0||R>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:k}}}if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(y=l.parse(y,2,Ze),!y)return null;const b=[];let E=null;h==="interpolate-hcl"||h==="interpolate-lab"?E=Cr:l.expectedType&&l.expectedType.kind!=="value"&&(E=l.expectedType);for(let k=0;k<x.length;k+=2){const R=x[k],O=x[k+1],V=k+3,$=k+4;if(typeof R!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(b.length&&b[b.length-1][0]>=R)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const W=l.parse(O,$,E);if(!W)return null;E=E||W.type,b.push([R,W])}return ye(E,Ze)||ye(E,Cr)||ye(E,Wt)||ye(E,j)||ye(E,U(Ze))?new ii(E,h,m,y,b):l.error(`Type ${q(E)} is not interpolatable.`)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const m=this.input.evaluate(r);if(m<=l[0])return h[0].evaluate(r);const y=l.length;if(m>=l[y-1])return h[y-1].evaluate(r);const x=Pa(l,m),b=ii.interpolationFactor(this.interpolation,m,l[x],l[x+1]),E=h[x].evaluate(r),k=h[x+1].evaluate(r);switch(this.operator){case"interpolate":return Or[this.type.kind](E,k,b);case"interpolate-hcl":return Or.color(E,k,b,"hcl");case"interpolate-lab":return Or.color(E,k,b,"lab")}}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function rs(s,r,l,h){const m=h-l,y=s-l;return m===0?0:r===1?y/m:(Math.pow(r,y)-1)/(Math.pow(r,m)-1)}class dl{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expectected at least one argument.");let h=null;const m=l.expectedType;m&&m.kind!=="value"&&(h=m);const y=[];for(const b of r.slice(1)){const E=l.parse(b,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!E)return null;h=h||E.type,y.push(E)}if(!h)throw new Error("No output type");const x=m&&y.some(b=>ve(m,b.type));return new dl(x?Ot:h,y)}evaluate(r){let l,h=null,m=0;for(const y of this.args)if(m++,h=y.evaluate(r),h&&h instanceof Si&&!h.available&&(l||(l=h.name),h=null,m===this.args.length&&(h=l)),h!==null)break;return h}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function vu(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function xu(s,r,l,h){return h.compare(r,l)===0}function Ti(s,r,l){const h=s!=="=="&&s!=="!=";return class dA{constructor(y,x,b){this.type=Pt,this.lhs=y,this.rhs=x,this.collator=b,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const b=y[0];let E=x.parse(y[1],1,Ot);if(!E)return null;if(!vu(b,E.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${q(E.type)}'.`);let k=x.parse(y[2],2,Ot);if(!k)return null;if(!vu(b,k.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${q(k.type)}'.`);if(E.type.kind!==k.type.kind&&E.type.kind!=="value"&&k.type.kind!=="value")return x.error(`Cannot compare types '${q(E.type)}' and '${q(k.type)}'.`);h&&(E.type.kind==="value"&&k.type.kind!=="value"?E=new io(k.type,[E]):E.type.kind!=="value"&&k.type.kind==="value"&&(k=new io(E.type,[k])));let R=null;if(y.length===4){if(E.type.kind!=="string"&&k.type.kind!=="string"&&E.type.kind!=="value"&&k.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(R=x.parse(y[3],3,Fi),!R)return null}return new dA(E,k,R)}evaluate(y){const x=this.lhs.evaluate(y),b=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const E=Zn(x),k=Zn(b);if(E.kind!==k.kind||E.kind!=="string"&&E.kind!=="number")throw new Gn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${E.kind}, ${k.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const E=Zn(x),k=Zn(b);if(E.kind!=="string"||k.kind!=="string")return r(y,x,b)}return this.collator?l(y,x,b,this.collator.evaluate(y)):r(y,x,b)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Pd=Ti("==",function(s,r,l){return r===l},xu),Tc=Ti("!=",function(s,r,l){return r!==l},function(s,r,l,h){return!xu(0,r,l,h)}),Xs=Ti("<",function(s,r,l){return r<l},function(s,r,l,h){return h.compare(r,l)<0}),pl=Ti(">",function(s,r,l){return r>l},function(s,r,l,h){return h.compare(r,l)>0}),Ec=Ti("<=",function(s,r,l){return r<=l},function(s,r,l,h){return h.compare(r,l)<=0}),La=Ti(">=",function(s,r,l){return r>=l},function(s,r,l,h){return h.compare(r,l)>=0});class is{constructor(r,l,h){this.type=Fi,this.locale=h,this.caseSensitive=r,this.diacriticSensitive=l}static parse(r,l){if(r.length!==2)return l.error("Expected one argument.");const h=r[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");const m=l.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Pt);if(!m)return null;const y=l.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Pt);if(!y)return null;let x=null;return h.locale&&(x=l.parse(h.locale,1,Bt),!x)?null:new is(m,y,x)}evaluate(r){return new cl(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class fl{constructor(r,l,h,m,y){this.type=Bt,this.number=r,this.locale=l,this.currency=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(r,l){if(r.length!==3)return l.error("Expected two arguments.");const h=l.parse(r[1],1,Ze);if(!h)return null;const m=r[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=l.parse(m.locale,1,Bt),!y))return null;let x=null;if(m.currency&&(x=l.parse(m.currency,1,Bt),!x))return null;let b=null;if(m["min-fraction-digits"]&&(b=l.parse(m["min-fraction-digits"],1,Ze),!b))return null;let E=null;return m["max-fraction-digits"]&&(E=l.parse(m["max-fraction-digits"],1,Ze),!E)?null:new fl(h,y,x,b,E)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Ys{constructor(r){this.type=Ni,this.sections=r}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");const m=[];let y=!1;for(let x=1;x<=r.length-1;++x){const b=r[x];if(y&&typeof b=="object"&&!Array.isArray(b)){y=!1;let E=null;if(b["font-scale"]&&(E=l.parse(b["font-scale"],1,Ze),!E))return null;let k=null;if(b["text-font"]&&(k=l.parse(b["text-font"],1,U(Bt)),!k))return null;let R=null;if(b["text-color"]&&(R=l.parse(b["text-color"],1,Cr),!R))return null;const O=m[m.length-1];O.scale=E,O.font=k,O.textColor=R}else{const E=l.parse(r[x],1,Ot);if(!E)return null;const k=E.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:E,scale:null,font:null,textColor:null})}}return new Ys(m)}evaluate(r){return new Ar(this.sections.map(l=>{const h=l.content.evaluate(r);return Zn(h)===ne?new Ca("",h,null,null,null):new Ca(Ts(h),null,l.scale?l.scale.evaluate(r):null,l.font?l.font.evaluate(r).join(","):null,l.textColor?l.textColor.evaluate(r):null)}))}eachChild(r){for(const l of this.sections)r(l.content),l.scale&&r(l.scale),l.font&&r(l.font),l.textColor&&r(l.textColor)}outputDefined(){return!1}}class Bn{constructor(r){this.type=ne,this.input=r}static parse(r,l){if(r.length!==2)return l.error("Expected two arguments.");const h=l.parse(r[1],1,Bt);return h?new Bn(h):l.error("No image name provided.")}evaluate(r){const l=this.input.evaluate(r),h=Si.fromString(l);return h&&r.availableImages&&(h.available=r.availableImages.indexOf(l)>-1),h}eachChild(r){r(this.input)}outputDefined(){return!1}}class Da{constructor(r){this.type=Ze,this.input=r}static parse(r,l){if(r.length!==2)return l.error(`Expected 1 argument, but found ${r.length-1} instead.`);const h=l.parse(r[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${q(h.type)} instead.`):new Da(h):null}evaluate(r){const l=this.input.evaluate(r);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Gn(`Expected value to be of type string or array, but found ${q(Zn(l))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Ei=8192;function rn(s,r){const l=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,m=Math.pow(2,r.z);return[Math.round(l*m*Ei),Math.round(h*m*Ei)]}function ml(s,r){const l=Math.pow(2,r.z);return[(m=(s[0]/Ei+r.x)/l,360*m-180),(h=(s[1]/Ei+r.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,m}function Qs(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function os(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Ic(s,r,l){const h=s[0]-r[0],m=s[1]-r[1],y=s[0]-l[0],x=s[1]-l[1];return h*x-y*m==0&&h*y<=0&&m*x<=0}function Vi(s,r,l,h){return(m=[h[0]-l[0],h[1]-l[1]])[0]*(y=[r[0]-s[0],r[1]-s[1]])[1]-m[1]*y[0]!=0&&!(!Oa(s,r,l,h)||!Oa(l,h,s,r));var m,y}function Cc(s,r,l){for(const h of l)for(let m=0;m<h.length-1;++m)if(Vi(s,r,h[m],h[m+1]))return!0;return!1}function Js(s,r,l=!1){let h=!1;for(const b of r)for(let E=0;E<b.length-1;E++){if(Ic(s,b[E],b[E+1]))return l;(y=b[E])[1]>(m=s)[1]!=(x=b[E+1])[1]>m[1]&&m[0]<(x[0]-y[0])*(m[1]-y[1])/(x[1]-y[1])+y[0]&&(h=!h)}var m,y,x;return h}function za(s,r){for(const l of r)if(Js(s,l))return!0;return!1}function wu(s,r){for(const l of s)if(!Js(l,r))return!1;for(let l=0;l<s.length-1;++l)if(Cc(s[l],s[l+1],r))return!1;return!0}function bu(s,r){for(const l of r)if(wu(s,l))return!0;return!1}function Oa(s,r,l,h){const m=h[0]-l[0],y=h[1]-l[1],x=(s[0]-l[0])*y-m*(s[1]-l[1]),b=(r[0]-l[0])*y-m*(r[1]-l[1]);return x>0&&b<0||x<0&&b>0}function gl(s,r,l){const h=[];for(let m=0;m<s.length;m++){const y=[];for(let x=0;x<s[m].length;x++){const b=rn(s[m][x],l);Qs(r,b),y.push(b)}h.push(y)}return h}function Fa(s,r,l){const h=[];for(let m=0;m<s.length;m++){const y=gl(s[m],r,l);h.push(y)}return h}function Ac(s,r,l,h){if(s[0]<l[0]||s[0]>l[2]){const m=.5*h;let y=s[0]-l[0]>m?-h:l[0]-s[0]>m?h:0;y===0&&(y=s[0]-l[2]>m?-h:l[2]-s[0]>m?h:0),s[0]+=y}Qs(r,s)}function Su(s,r,l,h){const m=Math.pow(2,h.z)*Ei,y=[h.x*Ei,h.y*Ei],x=[];for(const b of s)for(const E of b){const k=[E.x+y[0],E.y+y[1]];Ac(k,r,l,m),x.push(k)}return x}function ea(s,r,l,h){const m=Math.pow(2,h.z)*Ei,y=[h.x*Ei,h.y*Ei],x=[];for(const E of s){const k=[];for(const R of E){const O=[R.x+y[0],R.y+y[1]];Qs(r,O),k.push(O)}x.push(k)}if(r[2]-r[0]<=m/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of x)for(const k of E)Ac(k,r,l,m)}var b;return x}class ss{constructor(r,l){this.type=Pt,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(_o(r[1])){const h=r[1];if(h.type==="FeatureCollection"){const m=[];for(const y of h.features){const{type:x,coordinates:b}=y.geometry;x==="Polygon"&&m.push(b),x==="MultiPolygon"&&m.push(...b)}if(m.length)return new ss(h,{type:"MultiPolygon",coordinates:m})}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new ss(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new ss(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(h.type==="Polygon"){const b=gl(h.coordinates,y,x),E=Su(l.geometry(),m,y,x);if(!os(m,y))return!1;for(const k of E)if(!Js(k,b))return!1}if(h.type==="MultiPolygon"){const b=Fa(h.coordinates,y,x),E=Su(l.geometry(),m,y,x);if(!os(m,y))return!1;for(const k of E)if(!za(k,b))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(h.type==="Polygon"){const b=gl(h.coordinates,y,x),E=ea(l.geometry(),m,y,x);if(!os(m,y))return!1;for(const k of E)if(!wu(k,b))return!1}if(h.type==="MultiPolygon"){const b=Fa(h.coordinates,y,x),E=ea(l.geometry(),m,y,x);if(!os(m,y))return!1;for(const k of E)if(!bu(k,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Tu=class{constructor(s=[],r=Eu){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:l}=this,h=r[s];for(;s>0;){const m=s-1>>1,y=r[m];if(l(h,y)>=0)break;r[s]=y,s=m}r[s]=h}_down(s){const{data:r,compare:l}=this,h=this.length>>1,m=r[s];for(;s<h;){let y=1+(s<<1),x=r[y];const b=y+1;if(b<this.length&&l(r[b],x)<0&&(y=b,x=r[b]),l(x,m)>=0)break;r[s]=x,s=y}r[s]=m}};function Eu(s,r){return s<r?-1:s>r?1:0}function Iu(s,r,l,h,m){Cu(s,r,l,h||s.length-1,m||kc)}function Cu(s,r,l,h,m){for(;h>l;){if(h-l>600){var y=h-l+1,x=r-l+1,b=Math.log(y),E=.5*Math.exp(2*b/3),k=.5*Math.sqrt(b*E*(y-E)/y)*(x-y/2<0?-1:1);Cu(s,r,Math.max(l,Math.floor(r-x*E/y+k)),Math.min(h,Math.floor(r+(y-x)*E/y+k)),m)}var R=s[r],O=l,V=h;for(as(s,l,r),m(s[h],R)>0&&as(s,l,h);O<V;){for(as(s,O,V),O++,V--;m(s[O],R)<0;)O++;for(;m(s[V],R)>0;)V--}m(s[l],R)===0?as(s,l,V):as(s,++V,h),V<=r&&(l=V+1),r<=V&&(h=V-1)}}function as(s,r,l){var h=s[r];s[r]=s[l],s[l]=h}function kc(s,r){return s<r?-1:s>r?1:0}function Na(s,r){if(s.length<=1)return[s];const l=[];let h,m;for(const y of s){const x=Pc(y);x!==0&&(y.area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(h&&l.push(h),h=[y]):h.push(y))}if(h&&l.push(h),r>1)for(let y=0;y<l.length;y++)l[y].length<=r||(Iu(l[y],r,1,l[y].length-1,As),l[y]=l[y].slice(0,r));return l}function As(s,r){return r.area-s.area}function Pc(s){let r=0;for(let l,h,m=0,y=s.length,x=y-1;m<y;x=m++)l=s[m],h=s[x],r+=(h.x-l.x)*(l.y+h.y);return r}const Au=1/298.257223563,ku=Au*(2-Au),Pu=Math.PI/180;class ta{constructor(r){const l=6378.137*Pu*1e3,h=Math.cos(r*Pu),m=1/(1-ku*(1-h*h)),y=Math.sqrt(m);this.kx=l*y*h,this.ky=l*y*m*(1-ku)}distance(r,l){const h=this.wrap(r[0]-l[0])*this.kx,m=(r[1]-l[1])*this.ky;return Math.sqrt(h*h+m*m)}pointOnLine(r,l){let h,m,y,x,b=1/0;for(let E=0;E<r.length-1;E++){let k=r[E][0],R=r[E][1],O=this.wrap(r[E+1][0]-k)*this.kx,V=(r[E+1][1]-R)*this.ky,$=0;O===0&&V===0||($=(this.wrap(l[0]-k)*this.kx*O+(l[1]-R)*this.ky*V)/(O*O+V*V),$>1?(k=r[E+1][0],R=r[E+1][1]):$>0&&(k+=O/this.kx*$,R+=V/this.ky*$)),O=this.wrap(l[0]-k)*this.kx,V=(l[1]-R)*this.ky;const W=O*O+V*V;W<b&&(b=W,h=k,m=R,y=E,x=$)}return{point:[h,m],index:y,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function oi(s,r){return r[0]-s[0]}function ks(s){return s[1]-s[0]+1}function vo(s,r){return s[1]>=s[0]&&s[1]<r}function ls(s,r){if(s[0]>s[1])return[null,null];const l=ks(s);if(r){if(l===2)return[s,null];const m=Math.floor(l/2);return[[s[0],s[0]+m],[s[0]+m,s[1]]]}if(l===1)return[s,null];const h=Math.floor(l/2)-1;return[[s[0],s[0]+h],[s[0]+h+1,s[1]]]}function w(s,r){if(!vo(r,s.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let h=r[0];h<=r[1];++h)Qs(l,s[h]);return l}function P(s){const r=[1/0,1/0,-1/0,-1/0];for(const l of s)for(const h of l)Qs(r,h);return r}function F(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Q(s,r,l){if(!F(s)||!F(r))return NaN;let h=0,m=0;return s[2]<r[0]&&(h=r[0]-s[2]),s[0]>r[2]&&(h=s[0]-r[2]),s[1]>r[3]&&(m=s[1]-r[3]),s[3]<r[1]&&(m=r[1]-s[3]),l.distance([0,0],[h,m])}function Se(s,r,l){const h=l.pointOnLine(r,s);return l.distance(s,h.point)}function Fe(s,r,l,h,m){const y=Math.min(Se(s,[l,h],m),Se(r,[l,h],m)),x=Math.min(Se(l,[s,r],m),Se(h,[s,r],m));return Math.min(y,x)}function We(s,r,l,h,m){if(!vo(r,s.length)||!vo(h,l.length))return 1/0;let y=1/0;for(let x=r[0];x<r[1];++x){const b=s[x],E=s[x+1];for(let k=h[0];k<h[1];++k){const R=l[k],O=l[k+1];if(Vi(b,E,R,O))return 0;y=Math.min(y,Fe(b,E,R,O,m))}}return y}function Lt(s,r,l,h,m){if(!vo(r,s.length)||!vo(h,l.length))return NaN;let y=1/0;for(let x=r[0];x<=r[1];++x)for(let b=h[0];b<=h[1];++b)if(y=Math.min(y,m.distance(s[x],l[b])),y===0)return y;return y}function ar(s,r,l){if(Js(s,r,!0))return 0;let h=1/0;for(const m of r){const y=m[0],x=m[m.length-1];if(y!==x&&(h=Math.min(h,Se(s,[x,y],l)),h===0))return h;const b=l.pointOnLine(m,s);if(h=Math.min(h,l.distance(s,b.point)),h===0)return h}return h}function on(s,r,l,h){if(!vo(r,s.length))return NaN;for(let y=r[0];y<=r[1];++y)if(Js(s[y],l,!0))return 0;let m=1/0;for(let y=r[0];y<r[1];++y){const x=s[y],b=s[y+1];for(const E of l)for(let k=0,R=E.length,O=R-1;k<R;O=k++){const V=E[O],$=E[k];if(Vi(x,b,V,$))return 0;m=Math.min(m,Fe(x,b,V,$,h))}}return m}function wr(s,r){for(const l of s)for(const h of l)if(Js(h,r,!0))return!0;return!1}function Fr(s,r,l,h=1/0){const m=P(s),y=P(r);if(h!==1/0&&Q(m,y,l)>=h)return h;if(os(m,y)){if(wr(s,r))return 0}else if(wr(r,s))return 0;let x=1/0;for(const b of s)for(let E=0,k=b.length,R=k-1;E<k;R=E++){const O=b[R],V=b[E];for(const $ of r)for(let W=0,Z=$.length,ce=Z-1;W<Z;ce=W++){const ge=$[ce],ke=$[W];if(Vi(O,V,ge,ke))return 0;x=Math.min(x,Fe(O,V,ge,ke,l))}}return x}function Ps(s,r,l,h,m,y){if(!y)return;const x=Q(w(h,y),m,l);x<r&&s.push([x,y,[0,0]])}function si(s,r,l,h,m,y,x){if(!y||!x)return;const b=Q(w(h,y),w(m,x),l);b<r&&s.push([b,y,x])}function Rs(s,r,l,h,m=1/0){let y=Math.min(h.distance(s[0],l[0][0]),m);if(y===0)return y;const x=new Tu([[0,[0,s.length-1],[0,0]]],oi),b=P(l);for(;x.length>0;){const E=x.pop();if(E[0]>=y)continue;const k=E[1],R=r?50:100;if(ks(k)<=R){if(!vo(k,s.length))return NaN;if(r){const O=on(s,k,l,h);if(isNaN(O)||O===0)return O;y=Math.min(y,O)}else for(let O=k[0];O<=k[1];++O){const V=ar(s[O],l,h);if(y=Math.min(y,V),y===0)return 0}}else{const O=ls(k,r);Ps(x,y,h,s,b,O[0]),Ps(x,y,h,s,b,O[1])}}return y}function Ms(s,r,l,h,m,y=1/0){let x=Math.min(y,m.distance(s[0],l[0]));if(x===0)return x;const b=new Tu([[0,[0,s.length-1],[0,l.length-1]]],oi);for(;b.length>0;){const E=b.pop();if(E[0]>=x)continue;const k=E[1],R=E[2],O=r?50:100,V=h?50:100;if(ks(k)<=O&&ks(R)<=V){if(!vo(k,s.length)&&vo(R,l.length))return NaN;let $;if(r&&h)$=We(s,k,l,R,m),x=Math.min(x,$);else if(r&&!h){const W=s.slice(k[0],k[1]+1);for(let Z=R[0];Z<=R[1];++Z)if($=Se(l[Z],W,m),x=Math.min(x,$),x===0)return x}else if(!r&&h){const W=l.slice(R[0],R[1]+1);for(let Z=k[0];Z<=k[1];++Z)if($=Se(s[Z],W,m),x=Math.min(x,$),x===0)return x}else $=Lt(s,k,l,R,m),x=Math.min(x,$)}else{const $=ls(k,r),W=ls(R,h);si(b,x,m,s,l,$[0],W[0]),si(b,x,m,s,l,$[0],W[1]),si(b,x,m,s,l,$[1],W[0]),si(b,x,m,s,l,$[1],W[1])}}return x}function Rc(s){return s.type==="MultiPolygon"?s.coordinates.map(r=>({type:"Polygon",coordinates:r})):s.type==="MultiLineString"?s.coordinates.map(r=>({type:"LineString",coordinates:r})):s.type==="MultiPoint"?s.coordinates.map(r=>({type:"Point",coordinates:r})):[s]}class na{constructor(r,l){this.type=Ze,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(_o(r[1])){const h=r[1];if(h.type==="FeatureCollection")return new na(h,h.features.map(m=>Rc(m.geometry)).flat());if(h.type==="Feature")return new na(h,Rc(h.geometry));if("type"in h&&"coordinates"in h)return new na(h,Rc(h))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,h){const m=l.geometry(),y=m.flat().map(E=>ml([E.x,E.y],l.canonical));if(m.length===0)return NaN;const x=new ta(y[0][1]);let b=1/0;for(const E of h){switch(E.type){case"Point":b=Math.min(b,Ms(y,!1,[E.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,Ms(y,!1,E.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,Rs(y,!1,E.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,h){const m=l.geometry(),y=m.flat().map(E=>ml([E.x,E.y],l.canonical));if(m.length===0)return NaN;const x=new ta(y[0][1]);let b=1/0;for(const E of h){switch(E.type){case"Point":b=Math.min(b,Ms(y,!0,[E.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,Ms(y,!0,E.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,Rs(y,!0,E.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="Polygon")return function(l,h){const m=l.geometry();if(m.length===0||m[0].length===0)return NaN;const y=Na(m,0).map(E=>E.map(k=>k.map(R=>ml([R.x,R.y],l.canonical)))),x=new ta(y[0][0][0][1]);let b=1/0;for(const E of h)for(const k of y){switch(E.type){case"Point":b=Math.min(b,Rs([E.coordinates],!1,k,x,b));break;case"LineString":b=Math.min(b,Rs(E.coordinates,!0,k,x,b));break;case"Polygon":b=Math.min(b,Fr(k,E.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ba={"==":Pd,"!=":Tc,">":pl,"<":Xs,">=":La,"<=":Ec,array:io,at:hl,boolean:io,case:ns,coalesce:dl,collator:is,format:Ys,image:Bn,in:Tn,"index-of":ts,interpolate:ii,"interpolate-hcl":ii,"interpolate-lab":ii,length:Da,let:Is,literal:es,match:Cs,number:io,"number-format":fl,object:io,slice:ka,step:Ra,string:io,"to-boolean":oo,"to-color":oo,"to-number":oo,"to-string":oo,var:zo,within:ss,distance:na};class ji{constructor(r,l,h,m){this.name=r,this.type=l,this._evaluate=h,this.args=m}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,l){const h=r[0],m=ji.definitions[h];if(!m)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=x.filter(([k])=>!Array.isArray(k)||k.length===r.length-1);let E=null;for(const[k,R]of b){E=new Zt(l.registry,Mc,l.path,null,l.scope);const O=[];let V=!1;for(let $=1;$<r.length;$++){const W=r[$],Z=Array.isArray(k)?k[$-1]:k.type,ce=E.parse(W,1+O.length,Z);if(!ce){V=!0;break}O.push(ce)}if(!V)if(Array.isArray(k)&&k.length!==O.length)E.error(`Expected ${k.length} arguments, but found ${O.length} instead.`);else{for(let $=0;$<O.length;$++){const W=Array.isArray(k)?k[$]:k.type,Z=O[$];E.concat($+1).checkSubtype(W,Z.type)}if(E.errors.length===0)return new ji(h,y,R,O)}}if(b.length===1)l.errors.push(...E.errors);else{const k=(b.length?b:x).map(([O])=>{return V=O,Array.isArray(V)?`(${V.map(q).join(", ")})`:`(${q(V.type)}...)`;var V}).join(" | "),R=[];for(let O=1;O<r.length;O++){const V=l.parse(r[O],1+R.length);if(!V)return null;R.push(q(V.type))}l.error(`Expected arguments of type ${k}, but found (${R.join(", ")}) instead.`)}return null}static register(r,l){ji.definitions=l;for(const h in l)r[h]=ji}}function Wf(s,[r,l,h,m]){r=r.evaluate(s),l=l.evaluate(s),h=h.evaluate(s);const y=m?m.evaluate(s):1,x=gu(r,l,h,y);if(x)throw new Gn(x);return new nn(r/255,l/255,h/255,y,!1)}function Gf(s,r){return s in r}function Rd(s,r){const l=r[s];return l===void 0?null:l}function Va(s){return{type:s}}function Mc(s){if(s instanceof zo)return Mc(s.boundExpression);if(s instanceof ji&&s.name==="error"||s instanceof is||s instanceof ss||s instanceof na)return!1;const r=s instanceof oo||s instanceof io;let l=!0;return s.eachChild(h=>{l=r?l&&Mc(h):l&&h instanceof es}),!!l&&Lc(s)&&Dc(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Lc(s){if(s instanceof ji&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof ss||s instanceof na)return!1;let r=!0;return s.eachChild(l=>{r&&!Lc(l)&&(r=!1)}),r}function Ru(s){if(s instanceof ji&&s.name==="feature-state")return!1;let r=!0;return s.eachChild(l=>{r&&!Ru(l)&&(r=!1)}),r}function Dc(s,r){if(s instanceof ji&&r.indexOf(s.name)>=0)return!1;let l=!0;return s.eachChild(h=>{l&&!Dc(h,r)&&(l=!1)}),l}function Md(s){return{result:"success",value:s}}function ja(s){return{result:"error",value:s}}function Ls(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Kf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function zc(s){return!!s.expression&&s.expression.interpolated}function hn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function yl(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Oc(s){return s}function Mu(s,r){const l=r.type==="color",h=s.stops&&typeof s.stops[0][0]=="object",m=h||!(h||s.property!==void 0),y=s.type||(zc(r)?"exponential":"interval");if(l||r.type==="padding"){const R=l?nn.parse:sr.parse;(s=Ir({},s)).stops&&(s.stops=s.stops.map(O=>[O[0],R(O[1])])),s.default=R(s.default?s.default:r.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let b,E,k;if(y==="exponential")b=Dd;else if(y==="interval")b=Zf;else if(y==="categorical"){b=Ld,E=Object.create(null);for(const R of s.stops)E[R[0]]=R[1];k=typeof s.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=Fc}if(h){const R={},O=[];for(let W=0;W<s.stops.length;W++){const Z=s.stops[W],ce=Z[0].zoom;R[ce]===void 0&&(R[ce]={zoom:ce,type:s.type,property:s.property,default:s.default,stops:[]},O.push(ce)),R[ce].stops.push([Z[0].value,Z[1]])}const V=[];for(const W of O)V.push([R[W].zoom,Mu(R[W],r)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:ii.interpolationFactor.bind(void 0,$),zoomStops:V.map(W=>W[0]),evaluate:({zoom:W},Z)=>Dd({stops:V,base:s.base},r,W).evaluate(W,Z)}}if(m){const R=y==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:ii.interpolationFactor.bind(void 0,R),zoomStops:s.stops.map(O=>O[0]),evaluate:({zoom:O})=>b(s,r,O,E,k)}}return{kind:"source",evaluate(R,O){const V=O&&O.properties?O.properties[s.property]:void 0;return V===void 0?_l(s.default,r.default):b(s,r,V,E,k)}}}function _l(s,r,l){return s!==void 0?s:r!==void 0?r:l!==void 0?l:void 0}function Ld(s,r,l,h,m){return _l(typeof l===m?h[l]:void 0,s.default,r.default)}function Zf(s,r,l){if(hn(l)!=="number")return _l(s.default,r.default);const h=s.stops.length;if(h===1||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[h-1][0])return s.stops[h-1][1];const m=Pa(s.stops.map(y=>y[0]),l);return s.stops[m][1]}function Dd(s,r,l){const h=s.base!==void 0?s.base:1;if(hn(l)!=="number")return _l(s.default,r.default);const m=s.stops.length;if(m===1||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[m-1][0])return s.stops[m-1][1];const y=Pa(s.stops.map(R=>R[0]),l),x=function(R,O,V,$){const W=$-V,Z=R-V;return W===0?0:O===1?Z/W:(Math.pow(O,Z)-1)/(Math.pow(O,W)-1)}(l,h,s.stops[y][0],s.stops[y+1][0]),b=s.stops[y][1],E=s.stops[y+1][1],k=Or[r.type]||Oc;return typeof b.evaluate=="function"?{evaluate(...R){const O=b.evaluate.apply(void 0,R),V=E.evaluate.apply(void 0,R);if(O!==void 0&&V!==void 0)return k(O,V,x,s.colorSpace)}}:k(b,E,x,s.colorSpace)}function Fc(s,r,l){switch(r.type){case"color":l=nn.parse(l);break;case"formatted":l=Ar.fromString(l.toString());break;case"resolvedImage":l=Si.fromString(l.toString());break;case"padding":l=sr.parse(l);break;default:hn(l)===r.type||r.type==="enum"&&r.values[l]||(l=void 0)}return _l(l,s.default,r.default)}ji.register(Ba,{error:[{kind:"error"},[Bt],(s,[r])=>{throw new Gn(r.evaluate(s))}],typeof:[Bt,[Ot],(s,[r])=>q(Zn(r.evaluate(s)))],"to-rgba":[U(Ze,4),[Cr],(s,[r])=>{const[l,h,m,y]=r.evaluate(s).rgb;return[255*l,255*h,255*m,y]}],rgb:[Cr,[Ze,Ze,Ze],Wf],rgba:[Cr,[Ze,Ze,Ze,Ze],Wf],has:{type:Pt,overloads:[[[Bt],(s,[r])=>Gf(r.evaluate(s),s.properties())],[[Bt,xr],(s,[r,l])=>Gf(r.evaluate(s),l.evaluate(s))]]},get:{type:Ot,overloads:[[[Bt],(s,[r])=>Rd(r.evaluate(s),s.properties())],[[Bt,xr],(s,[r,l])=>Rd(r.evaluate(s),l.evaluate(s))]]},"feature-state":[Ot,[Bt],(s,[r])=>Rd(r.evaluate(s),s.featureState||{})],properties:[xr,[],s=>s.properties()],"geometry-type":[Bt,[],s=>s.geometryType()],id:[Ot,[],s=>s.id()],zoom:[Ze,[],s=>s.globals.zoom],"heatmap-density":[Ze,[],s=>s.globals.heatmapDensity||0],"line-progress":[Ze,[],s=>s.globals.lineProgress||0],accumulated:[Ot,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Ze,Va(Ze),(s,r)=>{let l=0;for(const h of r)l+=h.evaluate(s);return l}],"*":[Ze,Va(Ze),(s,r)=>{let l=1;for(const h of r)l*=h.evaluate(s);return l}],"-":{type:Ze,overloads:[[[Ze,Ze],(s,[r,l])=>r.evaluate(s)-l.evaluate(s)],[[Ze],(s,[r])=>-r.evaluate(s)]]},"/":[Ze,[Ze,Ze],(s,[r,l])=>r.evaluate(s)/l.evaluate(s)],"%":[Ze,[Ze,Ze],(s,[r,l])=>r.evaluate(s)%l.evaluate(s)],ln2:[Ze,[],()=>Math.LN2],pi:[Ze,[],()=>Math.PI],e:[Ze,[],()=>Math.E],"^":[Ze,[Ze,Ze],(s,[r,l])=>Math.pow(r.evaluate(s),l.evaluate(s))],sqrt:[Ze,[Ze],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[Ze,[Ze],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[Ze,[Ze],(s,[r])=>Math.log(r.evaluate(s))],log2:[Ze,[Ze],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[Ze,[Ze],(s,[r])=>Math.sin(r.evaluate(s))],cos:[Ze,[Ze],(s,[r])=>Math.cos(r.evaluate(s))],tan:[Ze,[Ze],(s,[r])=>Math.tan(r.evaluate(s))],asin:[Ze,[Ze],(s,[r])=>Math.asin(r.evaluate(s))],acos:[Ze,[Ze],(s,[r])=>Math.acos(r.evaluate(s))],atan:[Ze,[Ze],(s,[r])=>Math.atan(r.evaluate(s))],min:[Ze,Va(Ze),(s,r)=>Math.min(...r.map(l=>l.evaluate(s)))],max:[Ze,Va(Ze),(s,r)=>Math.max(...r.map(l=>l.evaluate(s)))],abs:[Ze,[Ze],(s,[r])=>Math.abs(r.evaluate(s))],round:[Ze,[Ze],(s,[r])=>{const l=r.evaluate(s);return l<0?-Math.round(-l):Math.round(l)}],floor:[Ze,[Ze],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[Ze,[Ze],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Pt,[Bt,Ot],(s,[r,l])=>s.properties()[r.value]===l.value],"filter-id-==":[Pt,[Ot],(s,[r])=>s.id()===r.value],"filter-type-==":[Pt,[Bt],(s,[r])=>s.geometryType()===r.value],"filter-<":[Pt,[Bt,Ot],(s,[r,l])=>{const h=s.properties()[r.value],m=l.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Pt,[Ot],(s,[r])=>{const l=s.id(),h=r.value;return typeof l==typeof h&&l<h}],"filter->":[Pt,[Bt,Ot],(s,[r,l])=>{const h=s.properties()[r.value],m=l.value;return typeof h==typeof m&&h>m}],"filter-id->":[Pt,[Ot],(s,[r])=>{const l=s.id(),h=r.value;return typeof l==typeof h&&l>h}],"filter-<=":[Pt,[Bt,Ot],(s,[r,l])=>{const h=s.properties()[r.value],m=l.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Pt,[Ot],(s,[r])=>{const l=s.id(),h=r.value;return typeof l==typeof h&&l<=h}],"filter->=":[Pt,[Bt,Ot],(s,[r,l])=>{const h=s.properties()[r.value],m=l.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Pt,[Ot],(s,[r])=>{const l=s.id(),h=r.value;return typeof l==typeof h&&l>=h}],"filter-has":[Pt,[Ot],(s,[r])=>r.value in s.properties()],"filter-has-id":[Pt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Pt,[U(Bt)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Pt,[U(Ot)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Pt,[Bt,U(Ot)],(s,[r,l])=>l.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Pt,[Bt,U(Ot)],(s,[r,l])=>function(h,m,y,x){for(;y<=x;){const b=y+x>>1;if(m[b]===h)return!0;m[b]>h?x=b-1:y=b+1}return!1}(s.properties()[r.value],l.value,0,l.value.length-1)],all:{type:Pt,overloads:[[[Pt,Pt],(s,[r,l])=>r.evaluate(s)&&l.evaluate(s)],[Va(Pt),(s,r)=>{for(const l of r)if(!l.evaluate(s))return!1;return!0}]]},any:{type:Pt,overloads:[[[Pt,Pt],(s,[r,l])=>r.evaluate(s)||l.evaluate(s)],[Va(Pt),(s,r)=>{for(const l of r)if(l.evaluate(s))return!0;return!1}]]},"!":[Pt,[Pt],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Pt,[Bt],(s,[r])=>{const l=s.globals&&s.globals.isSupportedScript;return!l||l(r.evaluate(s))}],upcase:[Bt,[Bt],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[Bt,[Bt],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[Bt,Va(Ot),(s,r)=>r.map(l=>Ts(l.evaluate(s))).join("")],"resolved-locale":[Bt,[Fi],(s,[r])=>r.evaluate(s).resolvedLocale()]});class zd{constructor(r,l){var h;this.expression=r,this._warningHistory={},this._evaluator=new Bi,this._defaultValue=l?(h=l).type==="color"&&yl(h.default)?new nn(0,0,0,0):h.type==="color"?nn.parse(h.default)||null:h.type==="padding"?sr.parse(h.default)||null:h.type==="variableAnchorOffsetCollection"?ni.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(r,l,h,m,y,x){return this._evaluator.globals=r,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,l,h,m,y,x){this._evaluator.globals=r,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Gn(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Nc(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Ba}function Bc(s,r){const l=new Zt(Ba,Mc,[],r?function(m){const y={color:Cr,string:Bt,number:Ze,enum:Bt,boolean:Pt,formatted:Ni,padding:Wt,resolvedImage:ne,variableAnchorOffsetCollection:j};return m.type==="array"?U(y[m.value]||Ot,m.length):y[m.type]}(r):void 0),h=l.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Md(new zd(h,r)):ja(l.errors)}class Od{constructor(r,l){this.kind=r,this._styleExpression=l,this.isStateDependent=r!=="constant"&&!Ru(l.expression)}evaluateWithoutErrorHandling(r,l,h,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,m,y,x)}evaluate(r,l,h,m,y,x){return this._styleExpression.evaluate(r,l,h,m,y,x)}}class Fd{constructor(r,l,h,m){this.kind=r,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=r!=="camera"&&!Ru(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(r,l,h,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,m,y,x)}evaluate(r,l,h,m,y,x){return this._styleExpression.evaluate(r,l,h,m,y,x)}interpolationFactor(r,l,h){return this.interpolationType?ii.interpolationFactor(this.interpolationType,r,l,h):0}}function Lu(s,r){const l=Bc(s,r);if(l.result==="error")return l;const h=l.value.expression,m=Lc(h);if(!m&&!Ls(r))return ja([new dr("","data expressions not supported")]);const y=Dc(h,["zoom"]);if(!y&&!Kf(r))return ja([new dr("","zoom expressions not supported")]);const x=ai(h);return x||y?x instanceof dr?ja([x]):x instanceof ii&&!zc(r)?ja([new dr("",'"interpolate" expressions cannot be used with this property')]):Md(x?new Fd(m?"camera":"composite",l.value,x.labels,x instanceof ii?x.interpolation:void 0):new Od(m?"constant":"source",l.value)):ja([new dr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ua{constructor(r,l){this._parameters=r,this._specification=l,Ir(this,Mu(this._parameters,this._specification))}static deserialize(r){return new Ua(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function ai(s){let r=null;if(s instanceof Is)r=ai(s.result);else if(s instanceof dl){for(const l of s.args)if(r=ai(l),r)break}else(s instanceof Ra||s instanceof ii)&&s.input instanceof ji&&s.input.name==="zoom"&&(r=s);return r instanceof dr||s.eachChild(l=>{const h=ai(l);h instanceof dr?r=h:!r&&h?r=new dr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&h&&r!==h&&(r=new dr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function $a(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!$a(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Xf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nd(s){if(s==null)return{filter:()=>!0,needGeometry:!1};$a(s)||(s=Du(s));const r=Bc(s,Xf);if(r.result==="error")throw new Error(r.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,h,m)=>r.value.evaluate(l,h,{},m),needGeometry:vl(s)}}function T_(s,r){return s<r?-1:s>r?1:0}function vl(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(vl(s[r]))return!0;return!1}function Du(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?zu(s[1],s[2],"=="):r==="!="?jc(zu(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?zu(s[1],s[2],r):r==="any"?(l=s.slice(1),["any"].concat(l.map(Du))):r==="all"?["all"].concat(s.slice(1).map(Du)):r==="none"?["all"].concat(s.slice(1).map(Du).map(jc)):r==="in"?Yf(s[1],s.slice(2)):r==="!in"?jc(Yf(s[1],s.slice(2))):r==="has"?Vc(s[1]):r!=="!has"||jc(Vc(s[1]));var l}function zu(s,r,l){switch(s){case"$type":return[`filter-type-${l}`,r];case"$id":return[`filter-id-${l}`,r];default:return[`filter-${l}`,s,r]}}function Yf(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(l=>typeof l!=typeof r[0])?["filter-in-large",s,["literal",r.sort(T_)]]:["filter-in-small",s,["literal",r]]}}function Vc(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function jc(s){return["!",s]}function qa(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let m="[";for(const y of s)m+=`${qa(y)},`;return`${m}]`}const l=Object.keys(s).sort();let h="{";for(let m=0;m<l.length;m++)h+=`${JSON.stringify(l[m])}:${qa(s[l[m]])},`;return`${h}}`}function E_(s){let r="";for(const l of ro)r+=`/${qa(s[l])}`;return r}function Uc(s){const r=s.value;return r?[new Ke(s.key,r,"constants have been deprecated as of v8")]:[]}function Jn(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Ds(s){if(Array.isArray(s))return s.map(Ds);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const l in s)r[l]=Ds(s[l]);return r}return Jn(s)}function so(s){const r=s.key,l=s.value,h=s.valueSpec||{},m=s.objectElementValidators||{},y=s.style,x=s.styleSpec,b=s.validateSpec;let E=[];const k=hn(l);if(k!=="object")return[new Ke(r,l,`object expected, ${k} found`)];for(const R in l){const O=R.split(".")[0],V=h[O]||h["*"];let $;if(m[O])$=m[O];else if(h[O])$=b;else if(m["*"])$=m["*"];else{if(!h["*"]){E.push(new Ke(r,l[R],`unknown property "${R}"`));continue}$=b}E=E.concat($({key:(r&&`${r}.`)+R,value:l[R],valueSpec:V,style:y,styleSpec:x,object:l,objectKey:R,validateSpec:b},l))}for(const R in h)m[R]||h[R].required&&h[R].default===void 0&&l[R]===void 0&&E.push(new Ke(r,l,`missing required property "${R}"`));return E}function $c(s){const r=s.value,l=s.valueSpec,h=s.style,m=s.styleSpec,y=s.key,x=s.arrayElementValidator||s.validateSpec;if(hn(r)!=="array")return[new Ke(y,r,`array expected, ${hn(r)} found`)];if(l.length&&r.length!==l.length)return[new Ke(y,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new Ke(y,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let b={type:l.value,values:l.values};m.$version<7&&(b.function=l.function),hn(l.value)==="object"&&(b=l.value);let E=[];for(let k=0;k<r.length;k++)E=E.concat(x({array:r,arrayIndex:k,value:r[k],valueSpec:b,validateSpec:s.validateSpec,style:h,styleSpec:m,key:`${y}[${k}]`}));return E}function Bd(s){const r=s.key,l=s.value,h=s.valueSpec;let m=hn(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new Ke(r,l,`number expected, ${m} found`)]:"minimum"in h&&l<h.minimum?[new Ke(r,l,`${l} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&l>h.maximum?[new Ke(r,l,`${l} is greater than the maximum value ${h.maximum}`)]:[]}function qc(s){const r=s.valueSpec,l=Jn(s.value.type);let h,m,y,x={};const b=l!=="categorical"&&s.value.property===void 0,E=!b,k=hn(s.value.stops)==="array"&&hn(s.value.stops[0])==="array"&&hn(s.value.stops[0][0])==="object",R=so({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function($){if(l==="identity")return[new Ke($.key,$.value,'identity function may not have a "stops" property')];let W=[];const Z=$.value;return W=W.concat($c({key:$.key,value:Z,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:O})),hn(Z)==="array"&&Z.length===0&&W.push(new Ke($.key,Z,"array must have at least one stop")),W},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:r,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return l==="identity"&&b&&R.push(new Ke(s.key,s.value,'missing required property "property"')),l==="identity"||s.value.stops||R.push(new Ke(s.key,s.value,'missing required property "stops"')),l==="exponential"&&s.valueSpec.expression&&!zc(s.valueSpec)&&R.push(new Ke(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(E&&!Ls(s.valueSpec)?R.push(new Ke(s.key,s.value,"property functions not supported")):b&&!Kf(s.valueSpec)&&R.push(new Ke(s.key,s.value,"zoom functions not supported"))),l!=="categorical"&&!k||s.value.property!==void 0||R.push(new Ke(s.key,s.value,'"property" property is required')),R;function O($){let W=[];const Z=$.value,ce=$.key;if(hn(Z)!=="array")return[new Ke(ce,Z,`array expected, ${hn(Z)} found`)];if(Z.length!==2)return[new Ke(ce,Z,`array length 2 expected, length ${Z.length} found`)];if(k){if(hn(Z[0])!=="object")return[new Ke(ce,Z,`object expected, ${hn(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Ke(ce,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Ke(ce,Z,"object stop key must have value")];if(y&&y>Jn(Z[0].zoom))return[new Ke(ce,Z[0].zoom,"stop zoom values must appear in ascending order")];Jn(Z[0].zoom)!==y&&(y=Jn(Z[0].zoom),m=void 0,x={}),W=W.concat(so({key:`${ce}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Bd,value:V}}))}else W=W.concat(V({key:`${ce}[0]`,value:Z[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},Z));return Nc(Ds(Z[1]))?W.concat([new Ke(`${ce}[1]`,Z[1],"expressions are not allowed in function stops.")]):W.concat($.validateSpec({key:`${ce}[1]`,value:Z[1],valueSpec:r,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function V($,W){const Z=hn($.value),ce=Jn($.value),ge=$.value!==null?$.value:W;if(h){if(Z!==h)return[new Ke($.key,ge,`${Z} stop domain type must match previous stop domain type ${h}`)]}else h=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Ke($.key,ge,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&l!=="categorical"){let ke=`number expected, ${Z} found`;return Ls(r)&&l===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ke($.key,ge,ke)]}return l!=="categorical"||Z!=="number"||isFinite(ce)&&Math.floor(ce)===ce?l!=="categorical"&&Z==="number"&&m!==void 0&&ce<m?[new Ke($.key,ge,"stop domain values must appear in ascending order")]:(m=ce,l==="categorical"&&ce in x?[new Ke($.key,ge,"stop domain values must be unique")]:(x[ce]=!0,[])):[new Ke($.key,ge,`integer expected, found ${ce}`)]}}function zs(s){const r=(s.expressionContext==="property"?Lu:Bc)(Ds(s.value),s.valueSpec);if(r.result==="error")return r.value.map(h=>new Ke(`${s.key}${h.key}`,s.value,h.message));const l=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!l.outputDefined())return[new Ke(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Ru(l))return[new Ke(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Ru(l))return[new Ke(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Dc(l,["zoom","feature-state"]))return[new Ke(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Lc(l))return[new Ke(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xl(s){const r=s.key,l=s.value,h=s.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(Jn(l))===-1&&m.push(new Ke(r,l,`expected one of [${h.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(h.values).indexOf(Jn(l))===-1&&m.push(new Ke(r,l,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function Hc(s){return $a(Ds(s.value))?zs(Ir({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Vd(s)}function Vd(s){const r=s.value,l=s.key;if(hn(r)!=="array")return[new Ke(l,r,`array expected, ${hn(r)} found`)];const h=s.styleSpec;let m,y=[];if(r.length<1)return[new Ke(l,r,"filter array must have at least 1 element")];switch(y=y.concat(xl({key:`${l}[0]`,value:r[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),Jn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Jn(r[1])==="$type"&&y.push(new Ke(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&y.push(new Ke(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(m=hn(r[1]),m!=="string"&&y.push(new Ke(`${l}[1]`,r[1],`string expected, ${m} found`)));for(let x=2;x<r.length;x++)m=hn(r[x]),Jn(r[1])==="$type"?y=y.concat(xl({key:`${l}[${x}]`,value:r[x],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&y.push(new Ke(`${l}[${x}]`,r[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)y=y.concat(Vd({key:`${l}[${x}]`,value:r[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":m=hn(r[1]),r.length!==2?y.push(new Ke(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="string"&&y.push(new Ke(`${l}[1]`,r[1],`string expected, ${m} found`))}return y}function jd(s,r){const l=s.key,h=s.validateSpec,m=s.style,y=s.styleSpec,x=s.value,b=s.objectKey,E=y[`${r}_${s.layerType}`];if(!E)return[];const k=b.match(/^(.*)-transition$/);if(r==="paint"&&k&&E[k[1]]&&E[k[1]].transition)return h({key:l,value:x,valueSpec:y.transition,style:m,styleSpec:y});const R=s.valueSpec||E[b];if(!R)return[new Ke(l,x,`unknown property "${b}"`)];let O;if(hn(x)==="string"&&Ls(R)&&!R.tokens&&(O=/^{([^}]+)}$/.exec(x)))return[new Ke(l,x,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(O[1])} }\`.`)];const V=[];return s.layerType==="symbol"&&(b==="text-field"&&m&&!m.glyphs&&V.push(new Ke(l,x,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&yl(Ds(x))&&Jn(x.type)==="identity"&&V.push(new Ke(l,x,'"text-font" does not support identity functions'))),V.concat(h({key:s.key,value:x,valueSpec:R,style:m,styleSpec:y,expressionContext:"property",propertyType:r,propertyKey:b}))}function Wc(s){return jd(s,"paint")}function Ud(s){return jd(s,"layout")}function Qf(s){let r=[];const l=s.value,h=s.key,m=s.style,y=s.styleSpec;l.type||l.ref||r.push(new Ke(h,l,'either "type" or "ref" is required'));let x=Jn(l.type);const b=Jn(l.ref);if(l.id){const E=Jn(l.id);for(let k=0;k<s.arrayIndex;k++){const R=m.layers[k];Jn(R.id)===E&&r.push(new Ke(h,l.id,`duplicate layer id "${l.id}", previously used at line ${R.id.__line__}`))}}if("ref"in l){let E;["type","source","source-layer","filter","layout"].forEach(k=>{k in l&&r.push(new Ke(h,l[k],`"${k}" is prohibited for ref layers`))}),m.layers.forEach(k=>{Jn(k.id)===b&&(E=k)}),E?E.ref?r.push(new Ke(h,l.ref,"ref cannot reference another ref layer")):x=Jn(E.type):r.push(new Ke(h,l.ref,`ref layer "${b}" not found`))}else if(x!=="background")if(l.source){const E=m.sources&&m.sources[l.source],k=E&&Jn(E.type);E?k==="vector"&&x==="raster"?r.push(new Ke(h,l.source,`layer "${l.id}" requires a raster source`)):k!=="raster-dem"&&x==="hillshade"?r.push(new Ke(h,l.source,`layer "${l.id}" requires a raster-dem source`)):k==="raster"&&x!=="raster"?r.push(new Ke(h,l.source,`layer "${l.id}" requires a vector source`)):k!=="vector"||l["source-layer"]?k==="raster-dem"&&x!=="hillshade"?r.push(new Ke(h,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!l.paint||!l.paint["line-gradient"]||k==="geojson"&&E.lineMetrics||r.push(new Ke(h,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Ke(h,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new Ke(h,l.source,`source "${l.source}" not found`))}else r.push(new Ke(h,l,'missing required property "source"'));return r=r.concat(so({key:h,value:l,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${h}.type`,value:l.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:l,objectKey:"type"}),filter:Hc,layout:E=>so({layer:l,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":k=>Ud(Ir({layerType:x},k))}}),paint:E=>so({layer:l,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":k=>Wc(Ir({layerType:x},k))}})}})),r}function ra(s){const r=s.value,l=s.key,h=hn(r);return h!=="string"?[new Ke(l,r,`string expected, ${h} found`)]:[]}const Jf={promoteId:function({key:s,value:r}){if(hn(r)==="string")return ra({key:s,value:r});{const l=[];for(const h in r)l.push(...ra({key:`${s}.${h}`,value:r[h]}));return l}}};function $d(s){const r=s.value,l=s.key,h=s.styleSpec,m=s.style,y=s.validateSpec;if(!r.type)return[new Ke(l,r,'"type" is required')];const x=Jn(r.type);let b;switch(x){case"vector":case"raster":return b=so({key:l,value:r,valueSpec:h[`source_${x.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Jf,validateSpec:y}),b;case"raster-dem":return b=function(E){var k;const R=(k=E.sourceName)!==null&&k!==void 0?k:"",O=E.value,V=E.styleSpec,$=V.source_raster_dem,W=E.style;let Z=[];const ce=hn(O);if(O===void 0)return Z;if(ce!=="object")return Z.push(new Ke("source_raster_dem",O,`object expected, ${ce} found`)),Z;const ge=Jn(O.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],xe=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const Ce in O)!ge&&ke.includes(Ce)?Z.push(new Ke(Ce,O[Ce],`In "${R}": "${Ce}" is only valid when "encoding" is set to "custom". ${xe} encoding found`)):$[Ce]?Z=Z.concat(E.validateSpec({key:Ce,value:O[Ce],valueSpec:$[Ce],validateSpec:E.validateSpec,style:W,styleSpec:V})):Z.push(new Ke(Ce,O[Ce],`unknown property "${Ce}"`));return Z}({sourceName:l,value:r,style:s.style,styleSpec:h,validateSpec:y}),b;case"geojson":if(b=so({key:l,value:r,valueSpec:h.source_geojson,style:m,styleSpec:h,validateSpec:y,objectElementValidators:Jf}),r.cluster)for(const E in r.clusterProperties){const[k,R]=r.clusterProperties[E],O=typeof k=="string"?[k,["accumulated"],["get",E]]:k;b.push(...zs({key:`${l}.${E}.map`,value:R,validateSpec:y,expressionContext:"cluster-map"})),b.push(...zs({key:`${l}.${E}.reduce`,value:O,validateSpec:y,expressionContext:"cluster-reduce"}))}return b;case"video":return so({key:l,value:r,valueSpec:h.source_video,style:m,validateSpec:y,styleSpec:h});case"image":return so({key:l,value:r,valueSpec:h.source_image,style:m,validateSpec:y,styleSpec:h});case"canvas":return[new Ke(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xl({key:`${l}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:y,styleSpec:h})}}function qd(s){const r=s.value,l=s.styleSpec,h=l.light,m=s.style;let y=[];const x=hn(r);if(r===void 0)return y;if(x!=="object")return y=y.concat([new Ke("light",r,`object expected, ${x} found`)]),y;for(const b in r){const E=b.match(/^(.*)-transition$/);y=y.concat(E&&h[E[1]]&&h[E[1]].transition?s.validateSpec({key:b,value:r[b],valueSpec:l.transition,validateSpec:s.validateSpec,style:m,styleSpec:l}):h[b]?s.validateSpec({key:b,value:r[b],valueSpec:h[b],validateSpec:s.validateSpec,style:m,styleSpec:l}):[new Ke(b,r[b],`unknown property "${b}"`)])}return y}function Hd(s){const r=s.value,l=s.styleSpec,h=l.sky,m=s.style,y=hn(r);if(r===void 0)return[];if(y!=="object")return[new Ke("sky",r,`object expected, ${y} found`)];let x=[];for(const b in r)x=x.concat(h[b]?s.validateSpec({key:b,value:r[b],valueSpec:h[b],style:m,styleSpec:l}):[new Ke(b,r[b],`unknown property "${b}"`)]);return x}function em(s){const r=s.value,l=s.styleSpec,h=l.terrain,m=s.style;let y=[];const x=hn(r);if(r===void 0)return y;if(x!=="object")return y=y.concat([new Ke("terrain",r,`object expected, ${x} found`)]),y;for(const b in r)y=y.concat(h[b]?s.validateSpec({key:b,value:r[b],valueSpec:h[b],validateSpec:s.validateSpec,style:m,styleSpec:l}):[new Ke(b,r[b],`unknown property "${b}"`)]);return y}function tm(s){let r=[];const l=s.value,h=s.key;if(Array.isArray(l)){const m=[],y=[];for(const x in l)l[x].id&&m.includes(l[x].id)&&r.push(new Ke(h,l,`all the sprites' ids must be unique, but ${l[x].id} is duplicated`)),m.push(l[x].id),l[x].url&&y.includes(l[x].url)&&r.push(new Ke(h,l,`all the sprites' URLs must be unique, but ${l[x].url} is duplicated`)),y.push(l[x].url),r=r.concat(so({key:`${h}[${x}]`,value:l[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return ra({key:h,value:l})}const Wd={"*":()=>[],array:$c,boolean:function(s){const r=s.value,l=s.key,h=hn(r);return h!=="boolean"?[new Ke(l,r,`boolean expected, ${h} found`)]:[]},number:Bd,color:function(s){const r=s.key,l=s.value,h=hn(l);return h!=="string"?[new Ke(r,l,`color expected, ${h} found`)]:nn.parse(String(l))?[]:[new Ke(r,l,`color expected, "${l}" found`)]},constants:Uc,enum:xl,filter:Hc,function:qc,layer:Qf,object:so,source:$d,light:qd,sky:Hd,terrain:em,projection:function(s){const r=s.value,l=s.styleSpec,h=l.projection,m=s.style,y=hn(r);if(r===void 0)return[];if(y!=="object")return[new Ke("projection",r,`object expected, ${y} found`)];let x=[];for(const b in r)x=x.concat(h[b]?s.validateSpec({key:b,value:r[b],valueSpec:h[b],style:m,styleSpec:l}):[new Ke(b,r[b],`unknown property "${b}"`)]);return x},string:ra,formatted:function(s){return ra(s).length===0?[]:zs(s)},resolvedImage:function(s){return ra(s).length===0?[]:zs(s)},padding:function(s){const r=s.key,l=s.value;if(hn(l)==="array"){if(l.length<1||l.length>4)return[new Ke(r,l,`padding requires 1 to 4 values; ${l.length} values found`)];const h={type:"number"};let m=[];for(let y=0;y<l.length;y++)m=m.concat(s.validateSpec({key:`${r}[${y}]`,value:l[y],validateSpec:s.validateSpec,valueSpec:h}));return m}return Bd({key:r,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const r=s.key,l=s.value,h=hn(l),m=s.styleSpec;if(h!=="array"||l.length<1||l.length%2!=0)return[new Ke(r,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let x=0;x<l.length;x+=2)y=y.concat(xl({key:`${r}[${x}]`,value:l[x],valueSpec:m.layout_symbol["text-anchor"]})),y=y.concat($c({key:`${r}[${x+1}]`,value:l[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:m}));return y},sprite:tm};function wl(s){const r=s.value,l=s.valueSpec,h=s.styleSpec;return s.validateSpec=wl,l.expression&&yl(Jn(r))?qc(s):l.expression&&Nc(Ds(r))?zs(s):l.type&&Wd[l.type]?Wd[l.type](s):so(Ir({},s,{valueSpec:l.type?h[l.type]:l}))}function Gd(s){const r=s.value,l=s.key,h=ra(s);return h.length||(r.indexOf("{fontstack}")===-1&&h.push(new Ke(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&h.push(new Ke(l,r,'"glyphs" url must include a "{range}" token'))),h}function xo(s,r=Oe){let l=[];return l=l.concat(wl({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:wl,objectElementValidators:{glyphs:Gd,"*":()=>[]}})),s.constants&&(l=l.concat(Uc({key:"constants",value:s.constants,style:s,styleSpec:r,validateSpec:wl}))),nm(l)}function ao(s){return function(r){return s({...r,validateSpec:wl})}}function nm(s){return[].concat(s).sort((r,l)=>r.line-l.line)}function wo(s){return function(...r){return nm(s.apply(this,r))}}xo.source=wo(ao($d)),xo.sprite=wo(ao(tm)),xo.glyphs=wo(ao(Gd)),xo.light=wo(ao(qd)),xo.sky=wo(ao(Hd)),xo.terrain=wo(ao(em)),xo.layer=wo(ao(Qf)),xo.filter=wo(ao(Hc)),xo.paintProperty=wo(ao(Wc)),xo.layoutProperty=wo(ao(Ud));const Ou=xo,I_=Ou.light,rm=Ou.paintProperty,im=Ou.layoutProperty;function Kd(s,r){let l=!1;if(r&&r.length)for(const h of r)s.fire(new En(new Error(h.message))),l=!0;return l}class Fu{constructor(r,l,h){const m=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(l=x[1])+2*(h=x[2]);for(let E=0;E<this.d*this.d;E++){const k=x[3+E],R=x[3+E+1];m.push(k===R?null:x.subarray(k,R))}const b=x[3+m.length+1];this.keys=x.subarray(x[3+m.length],b),this.bboxes=x.subarray(b),this.insert=this._insertReadonly}else{this.d=l+2*h;for(let x=0;x<this.d*this.d;x++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=r,this.padding=h,this.scale=l/r,this.uid=0;const y=h/l*r;this.min=-y,this.max=r+y}insert(r,l,h,m,y){this._forEachCell(l,h,m,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,l,h,m,y,x){this.cells[y].push(x)}query(r,l,h,m,y){const x=this.min,b=this.max;if(r<=x&&l<=x&&b<=h&&b<=m&&!y)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(r,l,h,m,this._queryCell,E,{},y),E}}_queryCell(r,l,h,m,y,x,b,E){const k=this.cells[y];if(k!==null){const R=this.keys,O=this.bboxes;for(let V=0;V<k.length;V++){const $=k[V];if(b[$]===void 0){const W=4*$;(E?E(O[W+0],O[W+1],O[W+2],O[W+3]):r<=O[W+2]&&l<=O[W+3]&&h>=O[W+0]&&m>=O[W+1])?(b[$]=!0,x.push(R[$])):b[$]=!1}}}}_forEachCell(r,l,h,m,y,x,b,E){const k=this._convertToCellCoord(r),R=this._convertToCellCoord(l),O=this._convertToCellCoord(h),V=this._convertToCellCoord(m);for(let $=k;$<=O;$++)for(let W=R;W<=V;W++){const Z=this.d*W+$;if((!E||E(this._convertFromCellCoord($),this._convertFromCellCoord(W),this._convertFromCellCoord($+1),this._convertFromCellCoord(W+1)))&&y.call(this,r,l,h,m,Z,x,b,E))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,l=3+this.cells.length+1+1;let h=0;for(let x=0;x<this.cells.length;x++)h+=this.cells[x].length;const m=new Int32Array(l+h+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let y=l;for(let x=0;x<r.length;x++){const b=r[x];m[3+x]=y,m.set(b,y),y+=b.length}return m[3+r.length]=y,m.set(this.keys,y),y+=this.keys.length,m[3+r.length+1]=y,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer}static serialize(r,l){const h=r.toArrayBuffer();return l&&l.push(h),{buffer:h}}static deserialize(r){return new Fu(r.buffer)}}const ia={};function dt(s,r,l={}){if(ia[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),ia[s]={klass:r,omit:l.omit||[],shallow:l.shallow||[]}}dt("Object",Object),dt("TransferableGridIndex",Fu),dt("Color",nn),dt("Error",Error),dt("AJAXError",Pn),dt("ResolvedImage",Si),dt("StylePropertyFunction",Ua),dt("StyleExpression",zd,{omit:["_evaluator"]}),dt("ZoomDependentExpression",Fd),dt("ZoomConstantExpression",Od),dt("CompoundExpression",ji,{omit:["_evaluate"]});for(const s in Ba)Ba[s]._classRegistryKey||dt(`Expression_${s}`,Ba[s]);function om(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Nu(s,r){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error)return s;if(om(s)||tn(s))return r&&r.push(s),s;if(ArrayBuffer.isView(s)){const l=s;return r&&r.push(l.buffer),l}if(s instanceof ImageData)return r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const l=[];for(const h of s)l.push(Nu(h,r));return l}if(typeof s=="object"){const l=s.constructor,h=l._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${l.name}`);if(!ia[h])throw new Error(`${h} is not registered.`);const m=l.serialize?l.serialize(s,r):{};if(l.serialize){if(r&&m===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in s){if(!s.hasOwnProperty(y)||ia[h].omit.indexOf(y)>=0)continue;const x=s[y];m[y]=ia[h].shallow.indexOf(y)>=0?x:Nu(x,r)}s instanceof Error&&(m.message=s.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(m.$name=h),m}throw new Error("can't serialize object of type "+typeof s)}function us(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||om(s)||tn(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(us);if(typeof s=="object"){const r=s.$name||"Object";if(!ia[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:l}=ia[r];if(!l)throw new Error(`can't deserialize unregistered class ${r}`);if(l.deserialize)return l.deserialize(s);const h=Object.create(l.prototype);for(const m of Object.keys(s)){if(m==="$name")continue;const y=s[m];h[m]=ia[r].shallow.indexOf(m)>=0?y:us(y)}return h}throw new Error("can't deserialize object of type "+typeof s)}class sm{constructor(){this.first=!0}update(r,l){const h=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=l),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=h,!0))}}const st={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Zd(s){for(const r of s)if(Xd(r.charCodeAt(0)))return!0;return!1}function C_(s){for(const r of s)if(!am(r.charCodeAt(0)))return!1;return!0}function am(s){return!(st.Arabic(s)||st["Arabic Supplement"](s)||st["Arabic Extended-A"](s)||st["Arabic Presentation Forms-A"](s)||st["Arabic Presentation Forms-B"](s))}function Xd(s){return!(s!==746&&s!==747&&(s<4352||!(st["Bopomofo Extended"](s)||st.Bopomofo(s)||st["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||st["CJK Compatibility Ideographs"](s)||st["CJK Compatibility"](s)||st["CJK Radicals Supplement"](s)||st["CJK Strokes"](s)||!(!st["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||st["CJK Unified Ideographs Extension A"](s)||st["CJK Unified Ideographs"](s)||st["Enclosed CJK Letters and Months"](s)||st["Hangul Compatibility Jamo"](s)||st["Hangul Jamo Extended-A"](s)||st["Hangul Jamo Extended-B"](s)||st["Hangul Jamo"](s)||st["Hangul Syllables"](s)||st.Hiragana(s)||st["Ideographic Description Characters"](s)||st.Kanbun(s)||st["Kangxi Radicals"](s)||st["Katakana Phonetic Extensions"](s)||st.Katakana(s)&&s!==12540||!(!st["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!st["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||st["Unified Canadian Aboriginal Syllabics"](s)||st["Unified Canadian Aboriginal Syllabics Extended"](s)||st["Vertical Forms"](s)||st["Yijing Hexagram Symbols"](s)||st["Yi Syllables"](s)||st["Yi Radicals"](s))))}function lm(s){return!(Xd(s)||function(r){return!!(st["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||st["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||st["Letterlike Symbols"](r)||st["Number Forms"](r)||st["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||st["Control Pictures"](r)&&r!==9251||st["Optical Character Recognition"](r)||st["Enclosed Alphanumerics"](r)||st["Geometric Shapes"](r)||st["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||st["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||st["CJK Symbols and Punctuation"](r)||st.Katakana(r)||st["Private Use Area"](r)||st["CJK Compatibility Forms"](r)||st["Small Form Variants"](r)||st["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(s))}function oa(s){return s>=1424&&s<=2303||st["Arabic Presentation Forms-A"](s)||st["Arabic Presentation Forms-B"](s)}function um(s,r){return!(!r&&oa(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||st.Khmer(s))}function Yd(s){for(const r of s)if(oa(r.charCodeAt(0)))return!0;return!1}const sa=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class zn{constructor(r,l){this.zoom=r,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sm,this.transition={})}isSupportedScript(r){return function(l,h){for(const m of l)if(!um(m.charCodeAt(0),h))return!1;return!0}(r,sa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,l=r-Math.floor(r),h=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*l}}}class Gc{constructor(r,l){this.property=r,this.value=l,this.expression=function(h,m){if(yl(h))return new Ua(h,m);if(Nc(h)){const y=Lu(h,m);if(y.result==="error")throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=h;return m.type==="color"&&typeof h=="string"?y=nn.parse(h):m.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(h)&&(y=ni.parse(h)):y=sr.parse(h),{kind:"constant",evaluate:()=>y}}}(l===void 0?r.specification.default:l,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,l,h){return this.property.possiblyEvaluate(this,r,l,h)}}class bl{constructor(r){this.property=r,this.value=new Gc(r,void 0)}transitioned(r,l){return new cm(this.property,this.value,l,J({},r.transition,this.transition),r.now)}untransitioned(){return new cm(this.property,this.value,null,{},0)}}class Sl{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return de(this._values[r].value.value)}setValue(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new bl(this._values[r].property)),this._values[r].value=new Gc(this._values[r].property,l===null?void 0:de(l))}getTransition(r){return de(this._values[r].transition)}setTransition(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new bl(this._values[r].property)),this._values[r].transition=de(l)||void 0}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h);const m=this.getTransition(l);m!==void 0&&(r[`${l}-transition`]=m)}return r}transitioned(r,l){const h=new Qd(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(r,l._values[m]);return h}untransitioned(){const r=new Qd(this._properties);for(const l of Object.keys(this._values))r._values[l]=this._values[l].untransitioned();return r}}class cm{constructor(r,l,h,m,y){this.property=r,this.value=l,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,r.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(r,l,h){const m=r.now||0,y=this.value.possiblyEvaluate(r,l,h),x=this.prior;if(x){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return x.possiblyEvaluate(r,l,h);{const b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,l,h),y,function(E){if(E<=0)return 0;if(E>=1)return 1;const k=E*E,R=k*E;return 4*(E<.5?R:3*(E-k)+R-.75)}(b))}}return y}}class Qd{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,l,h){const m=new Kc(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(r,l,h);return m}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Bu{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return de(this._values[r].value)}setValue(r,l){this._values[r]=new Gc(this._values[r].property,l===null?void 0:de(l))}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h)}return r}possiblyEvaluate(r,l,h){const m=new Kc(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(r,l,h);return m}}class cs{constructor(r,l,h){this.property=r,this.value=l,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,l,h,m){return this.property.evaluate(this.value,this.parameters,r,l,h,m)}}class Kc{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class xt{constructor(r){this.specification=r}possiblyEvaluate(r,l){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(l)}interpolate(r,l,h){const m=Or[this.specification.type];return m?m(r,l,h):r}}class Ct{constructor(r,l){this.specification=r,this.overrides=l}possiblyEvaluate(r,l,h,m){return new cs(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(l,null,{},h,m)}:r.expression,l)}interpolate(r,l,h){if(r.value.kind!=="constant"||l.value.kind!=="constant")return r;if(r.value.value===void 0||l.value.value===void 0)return new cs(this,{kind:"constant",value:void 0},r.parameters);const m=Or[this.specification.type];if(m){const y=m(r.value.value,l.value.value,h);return new cs(this,{kind:"constant",value:y},r.parameters)}return r}evaluate(r,l,h,m,y,x){return r.kind==="constant"?r.value:r.evaluate(l,h,m,y,x)}}class _ extends Ct{possiblyEvaluate(r,l,h,m){if(r.value===void 0)return new cs(this,{kind:"constant",value:void 0},l);if(r.expression.kind==="constant"){const y=r.expression.evaluate(l,null,{},h,m),x=r.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,b=this._calculate(x,x,x,l);return new cs(this,{kind:"constant",value:b},l)}if(r.expression.kind==="camera"){const y=this._calculate(r.expression.evaluate({zoom:l.zoom-1}),r.expression.evaluate({zoom:l.zoom}),r.expression.evaluate({zoom:l.zoom+1}),l);return new cs(this,{kind:"constant",value:y},l)}return new cs(this,r.expression,l)}evaluate(r,l,h,m,y,x){if(r.kind==="source"){const b=r.evaluate(l,h,m,y,x);return this._calculate(b,b,b,l)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(l.zoom)-1},h,m),r.evaluate({zoom:Math.floor(l.zoom)},h,m),r.evaluate({zoom:Math.floor(l.zoom)+1},h,m),l):r.value}_calculate(r,l,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:h,to:l}}interpolate(r){return r}}class i{constructor(r){this.specification=r}possiblyEvaluate(r,l,h,m){if(r.value!==void 0){if(r.expression.kind==="constant"){const y=r.expression.evaluate(l,null,{},h,m);return this._calculate(y,y,y,l)}return this._calculate(r.expression.evaluate(new zn(Math.floor(l.zoom-1),l)),r.expression.evaluate(new zn(Math.floor(l.zoom),l)),r.expression.evaluate(new zn(Math.floor(l.zoom+1),l)),l)}}_calculate(r,l,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:h,to:l}}interpolate(r){return r}}class u{constructor(r){this.specification=r}possiblyEvaluate(r,l,h,m){return!!r.expression.evaluate(l,null,{},h,m)}interpolate(){return!1}}class f{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in r){const h=r[l];h.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new Gc(h,void 0),y=this.defaultTransitionablePropertyValues[l]=new bl(h);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}dt("DataDrivenProperty",Ct),dt("DataConstantProperty",xt),dt("CrossFadedDataDrivenProperty",_),dt("CrossFadedProperty",i),dt("ColorRampProperty",u);const g="-transition";class v extends no{constructor(r,l){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),l.layout&&(this._unevaluatedLayout=new Bu(l.layout)),l.paint)){this._transitionablePaint=new Sl(l.paint);for(const h in r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(const h in r.layout)this.setLayoutProperty(h,r.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Kc(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,l,h={}){l!=null&&this._validate(im,`layers.${this.id}.layout.${r}`,r,l,h)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,l):this.visibility=l)}getPaintProperty(r){return r.endsWith(g)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,l,h={}){if(l!=null&&this._validate(rm,`layers.${this.id}.paint.${r}`,r,l,h))return!1;if(r.endsWith(g))return this._transitionablePaint.setTransition(r.slice(0,-11),l||void 0),!1;{const m=this._transitionablePaint._values[r],y=m.property.specification["property-type"]==="cross-faded-data-driven",x=m.value.isDataDriven(),b=m.value;this._transitionablePaint.setValue(r,l),this._handleSpecialPaintPropertyUpdate(r);const E=this._transitionablePaint._values[r].value;return E.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(r,b,E)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,l,h){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,l){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ie(r,(l,h)=>!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length))}_validate(r,l,h,m,y={}){return(!y||y.validate!==!1)&&Kd(this,r.call(Ou,{key:l,layerType:this.type,objectKey:h,value:m,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const l=this.paint.get(r);if(l instanceof cs&&Ls(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const T={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class I{constructor(r,l){this._structArray=r,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class C{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,l){return r._trim(),l&&(r.isTransferred=!0,l.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const l=Object.create(this.prototype);return l.arrayBuffer=r.arrayBuffer,l.length=r.length,l.capacity=r.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function M(s,r=1){let l=0,h=0;return{members:s.map(m=>{const y=T[m.type].BYTES_PER_ELEMENT,x=l=B(l,Math.max(r,y)),b=m.components||1;return h=Math.max(h,y),l+=y*b,{name:m.name,type:m.type,components:b,offset:x}}),size:B(l,Math.max(h,r)),alignment:r}}function B(s,r){return Math.ceil(s/r)*r}class N extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const m=2*r;return this.int16[m+0]=l,this.int16[m+1]=h,r}}N.prototype.bytesPerElement=4,dt("StructArrayLayout2i4",N);class H extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,h)}emplace(r,l,h,m){const y=3*r;return this.int16[y+0]=l,this.int16[y+1]=h,this.int16[y+2]=m,r}}H.prototype.bytesPerElement=6,dt("StructArrayLayout3i6",H);class K extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,r,l,h,m)}emplace(r,l,h,m,y){const x=4*r;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=m,this.int16[x+3]=y,r}}K.prototype.bytesPerElement=8,dt("StructArrayLayout4i8",K);class oe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,l,h,m,y,x)}emplace(r,l,h,m,y,x,b){const E=6*r;return this.int16[E+0]=l,this.int16[E+1]=h,this.int16[E+2]=m,this.int16[E+3]=y,this.int16[E+4]=x,this.int16[E+5]=b,r}}oe.prototype.bytesPerElement=12,dt("StructArrayLayout2i4i12",oe);class fe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,l,h,m,y,x)}emplace(r,l,h,m,y,x,b){const E=4*r,k=8*r;return this.int16[E+0]=l,this.int16[E+1]=h,this.uint8[k+4]=m,this.uint8[k+5]=y,this.uint8[k+6]=x,this.uint8[k+7]=b,r}}fe.prototype.bytesPerElement=8,dt("StructArrayLayout2i4ub8",fe);class ae extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const m=2*r;return this.float32[m+0]=l,this.float32[m+1]=h,r}}ae.prototype.bytesPerElement=8,dt("StructArrayLayout2f8",ae);class _e extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x,b,E,k,R){const O=this.length;return this.resize(O+1),this.emplace(O,r,l,h,m,y,x,b,E,k,R)}emplace(r,l,h,m,y,x,b,E,k,R,O){const V=10*r;return this.uint16[V+0]=l,this.uint16[V+1]=h,this.uint16[V+2]=m,this.uint16[V+3]=y,this.uint16[V+4]=x,this.uint16[V+5]=b,this.uint16[V+6]=E,this.uint16[V+7]=k,this.uint16[V+8]=R,this.uint16[V+9]=O,r}}_e.prototype.bytesPerElement=20,dt("StructArrayLayout10ui20",_e);class Te extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x,b,E,k,R,O,V){const $=this.length;return this.resize($+1),this.emplace($,r,l,h,m,y,x,b,E,k,R,O,V)}emplace(r,l,h,m,y,x,b,E,k,R,O,V,$){const W=12*r;return this.int16[W+0]=l,this.int16[W+1]=h,this.int16[W+2]=m,this.int16[W+3]=y,this.uint16[W+4]=x,this.uint16[W+5]=b,this.uint16[W+6]=E,this.uint16[W+7]=k,this.int16[W+8]=R,this.int16[W+9]=O,this.int16[W+10]=V,this.int16[W+11]=$,r}}Te.prototype.bytesPerElement=24,dt("StructArrayLayout4i4ui4i24",Te);class he extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,h)}emplace(r,l,h,m){const y=3*r;return this.float32[y+0]=l,this.float32[y+1]=h,this.float32[y+2]=m,r}}he.prototype.bytesPerElement=12,dt("StructArrayLayout3f12",he);class Ie extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint32[1*r+0]=l,r}}Ie.prototype.bytesPerElement=4,dt("StructArrayLayout1ul4",Ie);class Pe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x,b,E,k){const R=this.length;return this.resize(R+1),this.emplace(R,r,l,h,m,y,x,b,E,k)}emplace(r,l,h,m,y,x,b,E,k,R){const O=10*r,V=5*r;return this.int16[O+0]=l,this.int16[O+1]=h,this.int16[O+2]=m,this.int16[O+3]=y,this.int16[O+4]=x,this.int16[O+5]=b,this.uint32[V+3]=E,this.uint16[O+8]=k,this.uint16[O+9]=R,r}}Pe.prototype.bytesPerElement=20,dt("StructArrayLayout6i1ul2ui20",Pe);class De extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,l,h,m,y,x)}emplace(r,l,h,m,y,x,b){const E=6*r;return this.int16[E+0]=l,this.int16[E+1]=h,this.int16[E+2]=m,this.int16[E+3]=y,this.int16[E+4]=x,this.int16[E+5]=b,r}}De.prototype.bytesPerElement=12,dt("StructArrayLayout2i2i2i12",De);class $e extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,r,l,h,m,y)}emplace(r,l,h,m,y,x){const b=4*r,E=8*r;return this.float32[b+0]=l,this.float32[b+1]=h,this.float32[b+2]=m,this.int16[E+6]=y,this.int16[E+7]=x,r}}$e.prototype.bytesPerElement=16,dt("StructArrayLayout2f1f2i16",$e);class Ge extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,l,h,m,y,x)}emplace(r,l,h,m,y,x,b){const E=16*r,k=4*r,R=8*r;return this.uint8[E+0]=l,this.uint8[E+1]=h,this.float32[k+1]=m,this.float32[k+2]=y,this.int16[R+6]=x,this.int16[R+7]=b,r}}Ge.prototype.bytesPerElement=16,dt("StructArrayLayout2ub2f2i16",Ge);class at extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,h)}emplace(r,l,h,m){const y=3*r;return this.uint16[y+0]=l,this.uint16[y+1]=h,this.uint16[y+2]=m,r}}at.prototype.bytesPerElement=6,dt("StructArrayLayout3ui6",at);class lt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge){const ke=this.length;return this.resize(ke+1),this.emplace(ke,r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge)}emplace(r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge,ke){const xe=24*r,Ce=12*r,ze=48*r;return this.int16[xe+0]=l,this.int16[xe+1]=h,this.uint16[xe+2]=m,this.uint16[xe+3]=y,this.uint32[Ce+2]=x,this.uint32[Ce+3]=b,this.uint32[Ce+4]=E,this.uint16[xe+10]=k,this.uint16[xe+11]=R,this.uint16[xe+12]=O,this.float32[Ce+7]=V,this.float32[Ce+8]=$,this.uint8[ze+36]=W,this.uint8[ze+37]=Z,this.uint8[ze+38]=ce,this.uint32[Ce+10]=ge,this.int16[xe+22]=ke,r}}lt.prototype.bytesPerElement=48,dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",lt);class Xe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge,ke,xe,Ce,ze,qe,rt,Et,ot,nt,vt,ft){const ct=this.length;return this.resize(ct+1),this.emplace(ct,r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge,ke,xe,Ce,ze,qe,rt,Et,ot,nt,vt,ft)}emplace(r,l,h,m,y,x,b,E,k,R,O,V,$,W,Z,ce,ge,ke,xe,Ce,ze,qe,rt,Et,ot,nt,vt,ft,ct){const je=32*r,wt=16*r;return this.int16[je+0]=l,this.int16[je+1]=h,this.int16[je+2]=m,this.int16[je+3]=y,this.int16[je+4]=x,this.int16[je+5]=b,this.int16[je+6]=E,this.int16[je+7]=k,this.uint16[je+8]=R,this.uint16[je+9]=O,this.uint16[je+10]=V,this.uint16[je+11]=$,this.uint16[je+12]=W,this.uint16[je+13]=Z,this.uint16[je+14]=ce,this.uint16[je+15]=ge,this.uint16[je+16]=ke,this.uint16[je+17]=xe,this.uint16[je+18]=Ce,this.uint16[je+19]=ze,this.uint16[je+20]=qe,this.uint16[je+21]=rt,this.uint16[je+22]=Et,this.uint32[wt+12]=ot,this.float32[wt+13]=nt,this.float32[wt+14]=vt,this.uint16[je+30]=ft,this.uint16[je+31]=ct,r}}Xe.prototype.bytesPerElement=64,dt("StructArrayLayout8i15ui1ul2f2ui64",Xe);class Ye extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.float32[1*r+0]=l,r}}Ye.prototype.bytesPerElement=4,dt("StructArrayLayout1f4",Ye);class gt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,h)}emplace(r,l,h,m){const y=3*r;return this.uint16[6*r+0]=l,this.float32[y+1]=h,this.float32[y+2]=m,r}}gt.prototype.bytesPerElement=12,dt("StructArrayLayout1ui2f12",gt);class Nt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,h)}emplace(r,l,h,m){const y=4*r;return this.uint32[2*r+0]=l,this.uint16[y+2]=h,this.uint16[y+3]=m,r}}Nt.prototype.bytesPerElement=8,dt("StructArrayLayout1ul2ui8",Nt);class tt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const m=2*r;return this.uint16[m+0]=l,this.uint16[m+1]=h,r}}tt.prototype.bytesPerElement=4,dt("StructArrayLayout2ui4",tt);class it extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint16[1*r+0]=l,r}}it.prototype.bytesPerElement=2,dt("StructArrayLayout1ui2",it);class Dt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,r,l,h,m)}emplace(r,l,h,m,y){const x=4*r;return this.float32[x+0]=l,this.float32[x+1]=h,this.float32[x+2]=m,this.float32[x+3]=y,r}}Dt.prototype.bytesPerElement=16,dt("StructArrayLayout4f16",Dt);class Vn extends I{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new L(this.anchorPointX,this.anchorPointY)}}Vn.prototype.size=20;class Ht extends Pe{get(r){return new Vn(this,r)}}dt("CollisionBoxArray",Ht);class Yt extends I{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Yt.prototype.size=48;class jn extends lt{get(r){return new Yt(this,r)}}dt("PlacedSymbolArray",jn);class li extends I{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}li.prototype.size=64;class Oo extends Xe{get(r){return new li(this,r)}}dt("SymbolInstanceArray",Oo);class Un extends Ye{getoffsetX(r){return this.float32[1*r+0]}}dt("GlyphOffsetArray",Un);class Ui extends H{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}dt("SymbolLineVertexArray",Ui);class Ii extends I{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ii.prototype.size=12;class ui extends gt{get(r){return new Ii(this,r)}}dt("TextAnchorOffsetArray",ui);class ci extends I{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ci.prototype.size=8;class Fo extends Nt{get(r){return new ci(this,r)}}dt("FeatureIndexArray",Fo);class Ha extends N{}class Zc extends N{}class Tl extends N{}class Wa extends oe{}class Xc extends fe{}class Jd extends ae{}class Zr extends _e{}class No extends Te{}class aa extends he{}class El extends Ie{}class hi extends De{}class di extends Ge{}class Nr extends at{}class Xn extends tt{}const Il=M([{name:"a_pos",components:2,type:"Int16"}],4),{members:ep}=Il;class kr{constructor(r=[]){this.segments=r}prepareSegment(r,l,h,m){let y=this.segments[this.segments.length-1];return r>kr.MAX_VERTEX_ARRAY_LENGTH&&se(`Max vertices per segment is ${kr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!y||y.vertexLength+r>kr.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},m!==void 0&&(y.sortKey=m),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const r of this.segments)for(const l in r.vaos)r.vaos[l].destroy()}static simpleSegment(r,l,h,m){return new kr([{vertexOffset:r,primitiveOffset:l,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function hm(s,r){return 256*(s=Le(Math.floor(s),0,255))+Le(Math.floor(r),0,255)}kr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dt("SegmentVector",kr);const Yc=M([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Qc={exports:{}},la={exports:{}};la.exports=function(s,r){var l,h,m,y,x,b,E,k;for(h=s.length-(l=3&s.length),m=r,x=3432918353,b=461845907,k=0;k<h;)E=255&s.charCodeAt(k)|(255&s.charCodeAt(++k))<<8|(255&s.charCodeAt(++k))<<16|(255&s.charCodeAt(++k))<<24,++k,m=27492+(65535&(y=5*(65535&(m=(m^=E=(65535&(E=(E=(65535&E)*x+(((E>>>16)*x&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(E=0,l){case 3:E^=(255&s.charCodeAt(k+2))<<16;case 2:E^=(255&s.charCodeAt(k+1))<<8;case 1:m^=E=(65535&(E=(E=(65535&(E^=255&s.charCodeAt(k)))*x+(((E>>>16)*x&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return m^=s.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var dm=la.exports,tp={exports:{}};tp.exports=function(s,r){for(var l,h=s.length,m=r^h,y=0;h>=4;)l=1540483477*(65535&(l=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:m^=(255&s.charCodeAt(y+2))<<16;case 2:m^=(255&s.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&s.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var np=dm,rp=tp.exports;Qc.exports=np,Qc.exports.murmur3=np,Qc.exports.murmur2=rp;var Jc=S(Qc.exports);class Cl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,l,h,m){this.ids.push(jw(r)),this.positions.push(l,h,m)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=jw(r);let h=0,m=this.ids.length-1;for(;h<m;){const x=h+m>>1;this.ids[x]>=l?m=x:h=x+1}const y=[];for(;this.ids[h]===l;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(r,l){const h=new Float64Array(r.ids),m=new Uint32Array(r.positions);return A_(h,m,0,h.length-1),l&&l.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(r){const l=new Cl;return l.ids=r.ids,l.positions=r.positions,l.indexed=!0,l}}function jw(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Jc(String(s))}function A_(s,r,l,h){for(;l<h;){const m=s[l+h>>1];let y=l-1,x=h+1;for(;;){do y++;while(s[y]<m);do x--;while(s[x]>m);if(y>=x)break;pm(s,y,x),pm(r,3*y,3*x),pm(r,3*y+1,3*x+1),pm(r,3*y+2,3*x+2)}x-l<h-x?(A_(s,r,l,x),l=x+1):(A_(s,r,x+1,h),h=x)}}function pm(s,r,l){const h=s[r];s[r]=s[l],s[l]=h}dt("FeaturePositionMap",Cl);class Vu{constructor(r,l){this.gl=r.gl,this.location=l}}class fm extends Vu{constructor(r,l){super(r,l),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Uw extends Vu{constructor(r,l){super(r,l),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class $w extends Vu{constructor(r,l){super(r,l),this.current=nn.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const N5=new Float32Array(16);function k_(s){return[hm(255*s.r,255*s.g),hm(255*s.b,255*s.a)]}class ip{constructor(r,l,h){this.value=r,this.uniformNames=l.map(m=>`u_${m}`),this.type=h}setUniform(r,l,h){r.set(h.constantOr(this.value))}getBinding(r,l,h){return this.type==="color"?new $w(r,l):new fm(r,l)}}class eh{constructor(r,l){this.uniformNames=l.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=r.tlbr}setUniform(r,l,h,m){const y=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&r.set(y)}getBinding(r,l,h){return h.substr(0,9)==="u_pattern"?new Uw(r,l):new fm(r,l)}}class Ga{constructor(r,l,h,m){this.expression=r,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(r,l,h,m,y){const x=this.paintVertexArray.length,b=this.expression.evaluate(new zn(0),l,{},m,[],y);this.paintVertexArray.resize(r),this._setPaintValue(x,r,b)}updatePaintArray(r,l,h,m){const y=this.expression.evaluate({zoom:0},h,m);this._setPaintValue(r,l,y)}_setPaintValue(r,l,h){if(this.type==="color"){const m=k_(h);for(let y=r;y<l;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=r;m<l;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Os{constructor(r,l,h,m,y,x){this.expression=r,this.uniformNames=l.map(b=>`u_${b}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(b=>({name:`a_${b}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,l,h,m,y){const x=this.expression.evaluate(new zn(this.zoom),l,{},m,[],y),b=this.expression.evaluate(new zn(this.zoom+1),l,{},m,[],y),E=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(E,r,x,b)}updatePaintArray(r,l,h,m){const y=this.expression.evaluate({zoom:this.zoom},h,m),x=this.expression.evaluate({zoom:this.zoom+1},h,m);this._setPaintValue(r,l,y,x)}_setPaintValue(r,l,h,m){if(this.type==="color"){const y=k_(h),x=k_(m);for(let b=r;b<l;b++)this.paintVertexArray.emplace(b,y[0],y[1],x[0],x[1])}else{for(let y=r;y<l;y++)this.paintVertexArray.emplace(y,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,l){const h=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=Le(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);r.set(m)}getBinding(r,l,h){return new fm(r,l)}}class Al{constructor(r,l,h,m,y,x){this.expression=r,this.type=l,this.useIntegerZoom=h,this.zoom=m,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(r,l,h){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(m,r,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(r,l,h,m,y){this._setPaintValues(r,l,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(r,l,h,m){if(!m||!h)return;const{min:y,mid:x,max:b}=h,E=m[y],k=m[x],R=m[b];if(E&&k&&R)for(let O=r;O<l;O++)this.zoomInPaintVertexArray.emplace(O,k.tl[0],k.tl[1],k.br[0],k.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],k.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(O,k.tl[0],k.tl[1],k.br[0],k.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],k.pixelRatio,R.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Yc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Yc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class qw{constructor(r,l,h){this.binders={},this._buffers=[];const m=[];for(const y in r.paint._values){if(!h(y))continue;const x=r.paint.get(y);if(!(x instanceof cs&&Ls(x.property.specification)))continue;const b=B5(y,r.type),E=x.value,k=x.property.specification.type,R=x.property.useIntegerZoom,O=x.property.specification["property-type"],V=O==="cross-faded"||O==="cross-faded-data-driven";if(E.kind==="constant")this.binders[y]=V?new eh(E.value,b):new ip(E.value,b,k),m.push(`/u_${y}`);else if(E.kind==="source"||V){const $=Hw(y,k,"source");this.binders[y]=V?new Al(E,k,R,l,$,r.id):new Ga(E,b,k,$),m.push(`/a_${y}`)}else{const $=Hw(y,k,"composite");this.binders[y]=new Os(E,b,k,R,l,$),m.push(`/z_${y}`)}}this.cacheKey=m.sort().join("")}getMaxValue(r){const l=this.binders[r];return l instanceof Ga||l instanceof Os?l.maxValue:0}populatePaintArrays(r,l,h,m,y){for(const x in this.binders){const b=this.binders[x];(b instanceof Ga||b instanceof Os||b instanceof Al)&&b.populatePaintArray(r,l,h,m,y)}}setConstantPatternPositions(r,l){for(const h in this.binders){const m=this.binders[h];m instanceof eh&&m.setConstantPatternPositions(r,l)}}updatePaintArrays(r,l,h,m,y){let x=!1;for(const b in r){const E=l.getPositions(b);for(const k of E){const R=h.feature(k.index);for(const O in this.binders){const V=this.binders[O];if((V instanceof Ga||V instanceof Os||V instanceof Al)&&V.expression.isStateDependent===!0){const $=m.paint.get(O);V.expression=$.value,V.updatePaintArray(k.start,k.end,R,r[b],y),x=!0}}}}return x}defines(){const r=[];for(const l in this.binders){const h=this.binders[l];(h instanceof ip||h instanceof eh)&&r.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return r}getBinderAttributes(){const r=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Ga||h instanceof Os)for(let m=0;m<h.paintVertexAttributes.length;m++)r.push(h.paintVertexAttributes[m].name);else if(h instanceof Al)for(let m=0;m<Yc.members.length;m++)r.push(Yc.members[m].name)}return r}getBinderUniforms(){const r=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof ip||h instanceof eh||h instanceof Os)for(const m of h.uniformNames)r.push(m)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,l){const h=[];for(const m in this.binders){const y=this.binders[m];if(y instanceof ip||y instanceof eh||y instanceof Os){for(const x of y.uniformNames)if(l[x]){const b=y.getBinding(r,l[x],x);h.push({name:x,property:m,binding:b})}}}return h}setUniforms(r,l,h,m){for(const{name:y,property:x,binding:b}of l)this.binders[x].setUniform(b,m,h.get(x),y)}updatePaintBuffers(r){this._buffers=[];for(const l in this.binders){const h=this.binders[l];if(r&&h instanceof Al){const m=r.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(h instanceof Ga||h instanceof Os)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(r){for(const l in this.binders){const h=this.binders[l];(h instanceof Ga||h instanceof Os||h instanceof Al)&&h.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const l=this.binders[r];(l instanceof Ga||l instanceof Os||l instanceof Al)&&l.destroy()}}}class ju{constructor(r,l,h=()=>!0){this.programConfigurations={};for(const m of r)this.programConfigurations[m.id]=new qw(m,l,h);this.needsUpload=!1,this._featureMap=new Cl,this._bufferOffset=0}populatePaintArrays(r,l,h,m,y,x){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,l,m,y,x);l.id!==void 0&&this._featureMap.add(l.id,h,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,l,h,m){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(r,this._featureMap,l,y,m)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function B5(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function Hw(s,r,l){const h={color:{source:ae,composite:Dt},number:{source:Ye,composite:ae}},m=function(y){return{"line-pattern":{source:Zr,composite:Zr},"fill-pattern":{source:Zr,composite:Zr},"fill-extrusion-pattern":{source:Zr,composite:Zr}}[y]}(s);return m&&m[l]||h[r][l]}dt("ConstantBinder",ip),dt("CrossFadedConstantBinder",eh),dt("SourceExpressionBinder",Ga),dt("CrossFadedCompositeBinder",Al),dt("CompositeExpressionBinder",Os),dt("ProgramConfiguration",qw,{omit:["_buffers"]}),dt("ProgramConfigurationSet",ju);const br=8192,P_=Math.pow(2,14)-1,Ww=-P_-1;function Uu(s){const r=br/s.extent,l=s.loadGeometry();for(let h=0;h<l.length;h++){const m=l[h];for(let y=0;y<m.length;y++){const x=m[y],b=Math.round(x.x*r),E=Math.round(x.y*r);x.x=Le(b,Ww,P_),x.y=Le(E,Ww,P_),(b<x.x||b>x.x+1||E<x.y||E>x.y+1)&&se("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function $u(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?Uu(s):[]}}function mm(s,r,l,h,m){s.emplaceBack(2*r+(h+1)/2,2*l+(m+1)/2)}class R_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Zc,this.indexArray=new Nr,this.segments=new kr,this.programConfigurations=new ju(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){const m=this.layers[0],y=[];let x=null,b=!1;m.type==="circle"&&(x=m.layout.get("circle-sort-key"),b=!x.isConstant());for(const{feature:E,id:k,index:R,sourceLayerIndex:O}of r){const V=this.layers[0]._featureFilter.needGeometry,$=$u(E,V);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),$,h))continue;const W=b?x.evaluate($,{},h):void 0,Z={id:k,properties:E.properties,type:E.type,sourceLayerIndex:O,index:R,geometry:V?$.geometry:Uu(E),patterns:{},sortKey:W};y.push(Z)}b&&y.sort((E,k)=>E.sortKey-k.sortKey);for(const E of y){const{geometry:k,index:R,sourceLayerIndex:O}=E,V=r[R].feature;this.addFeature(E,k,R,h),l.featureIndex.insert(V,k,R,O,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ep),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,l,h,m){for(const y of l)for(const x of y){const b=x.x,E=x.y;if(b<0||b>=br||E<0||E>=br)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),R=k.vertexLength;mm(this.layoutVertexArray,b,E,-1,-1),mm(this.layoutVertexArray,b,E,1,-1),mm(this.layoutVertexArray,b,E,1,1),mm(this.layoutVertexArray,b,E,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,{},m)}}function Gw(s,r){for(let l=0;l<s.length;l++)if(th(r,s[l]))return!0;for(let l=0;l<r.length;l++)if(th(s,r[l]))return!0;return!!M_(s,r)}function V5(s,r,l){return!!th(s,r)||!!L_(r,s,l)}function Kw(s,r){if(s.length===1)return Xw(r,s[0]);for(let l=0;l<r.length;l++){const h=r[l];for(let m=0;m<h.length;m++)if(th(s,h[m]))return!0}for(let l=0;l<s.length;l++)if(Xw(r,s[l]))return!0;for(let l=0;l<r.length;l++)if(M_(s,r[l]))return!0;return!1}function j5(s,r,l){if(s.length>1){if(M_(s,r))return!0;for(let h=0;h<r.length;h++)if(L_(r[h],s,l))return!0}for(let h=0;h<s.length;h++)if(L_(s[h],r,l))return!0;return!1}function M_(s,r){if(s.length===0||r.length===0)return!1;for(let l=0;l<s.length-1;l++){const h=s[l],m=s[l+1];for(let y=0;y<r.length-1;y++)if(U5(h,m,r[y],r[y+1]))return!0}return!1}function U5(s,r,l,h){return ut(s,l,h)!==ut(r,l,h)&&ut(s,r,l)!==ut(s,r,h)}function L_(s,r,l){const h=l*l;if(r.length===1)return s.distSqr(r[0])<h;for(let m=1;m<r.length;m++)if(Zw(s,r[m-1],r[m])<h)return!0;return!1}function Zw(s,r,l){const h=r.distSqr(l);if(h===0)return s.distSqr(r);const m=((s.x-r.x)*(l.x-r.x)+(s.y-r.y)*(l.y-r.y))/h;return s.distSqr(m<0?r:m>1?l:l.sub(r)._mult(m)._add(r))}function Xw(s,r){let l,h,m,y=!1;for(let x=0;x<s.length;x++){l=s[x];for(let b=0,E=l.length-1;b<l.length;E=b++)h=l[b],m=l[E],h.y>r.y!=m.y>r.y&&r.x<(m.x-h.x)*(r.y-h.y)/(m.y-h.y)+h.x&&(y=!y)}return y}function th(s,r){let l=!1;for(let h=0,m=s.length-1;h<s.length;m=h++){const y=s[h],x=s[m];y.y>r.y!=x.y>r.y&&r.x<(x.x-y.x)*(r.y-y.y)/(x.y-y.y)+y.x&&(l=!l)}return l}function $5(s,r,l){const h=l[0],m=l[2];if(s.x<h.x&&r.x<h.x||s.x>m.x&&r.x>m.x||s.y<h.y&&r.y<h.y||s.y>m.y&&r.y>m.y)return!1;const y=ut(s,r,l[0]);return y!==ut(s,r,l[1])||y!==ut(s,r,l[2])||y!==ut(s,r,l[3])}function op(s,r,l){const h=r.paint.get(s).value;return h.kind==="constant"?h.value:l.programConfigurations.get(r.id).getMaxValue(s)}function gm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function ym(s,r,l,h,m){if(!r[0]&&!r[1])return s;const y=L.convert(r)._mult(m);l==="viewport"&&y._rotate(-h);const x=[];for(let b=0;b<s.length;b++)x.push(s[b].sub(y));return x}let Yw,Qw;dt("CircleBucket",R_,{omit:["layers"]});var q5={get paint(){return Qw=Qw||new f({"circle-radius":new Ct(Oe.paint_circle["circle-radius"]),"circle-color":new Ct(Oe.paint_circle["circle-color"]),"circle-blur":new Ct(Oe.paint_circle["circle-blur"]),"circle-opacity":new Ct(Oe.paint_circle["circle-opacity"]),"circle-translate":new xt(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new xt(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xt(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xt(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ct(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ct(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ct(Oe.paint_circle["circle-stroke-opacity"])})},get layout(){return Yw=Yw||new f({"circle-sort-key":new Ct(Oe.layout_circle["circle-sort-key"])})}},$i=1e-6,nh=typeof Float32Array<"u"?Float32Array:Array;function D_(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Jw(s,r,l){var h=r[0],m=r[1],y=r[2],x=r[3],b=r[4],E=r[5],k=r[6],R=r[7],O=r[8],V=r[9],$=r[10],W=r[11],Z=r[12],ce=r[13],ge=r[14],ke=r[15],xe=l[0],Ce=l[1],ze=l[2],qe=l[3];return s[0]=xe*h+Ce*b+ze*O+qe*Z,s[1]=xe*m+Ce*E+ze*V+qe*ce,s[2]=xe*y+Ce*k+ze*$+qe*ge,s[3]=xe*x+Ce*R+ze*W+qe*ke,s[4]=(xe=l[4])*h+(Ce=l[5])*b+(ze=l[6])*O+(qe=l[7])*Z,s[5]=xe*m+Ce*E+ze*V+qe*ce,s[6]=xe*y+Ce*k+ze*$+qe*ge,s[7]=xe*x+Ce*R+ze*W+qe*ke,s[8]=(xe=l[8])*h+(Ce=l[9])*b+(ze=l[10])*O+(qe=l[11])*Z,s[9]=xe*m+Ce*E+ze*V+qe*ce,s[10]=xe*y+Ce*k+ze*$+qe*ge,s[11]=xe*x+Ce*R+ze*W+qe*ke,s[12]=(xe=l[12])*h+(Ce=l[13])*b+(ze=l[14])*O+(qe=l[15])*Z,s[13]=xe*m+Ce*E+ze*V+qe*ce,s[14]=xe*y+Ce*k+ze*$+qe*ge,s[15]=xe*x+Ce*R+ze*W+qe*ke,s}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var sp,H5=Jw;function _m(s,r,l){var h=r[0],m=r[1],y=r[2],x=r[3];return s[0]=l[0]*h+l[4]*m+l[8]*y+l[12]*x,s[1]=l[1]*h+l[5]*m+l[9]*y+l[13]*x,s[2]=l[2]*h+l[6]*m+l[10]*y+l[14]*x,s[3]=l[3]*h+l[7]*m+l[11]*y+l[15]*x,s}sp=new nh(4),nh!=Float32Array&&(sp[0]=0,sp[1]=0,sp[2]=0,sp[3]=0);class W5 extends v{constructor(r){super(r,q5)}createBucket(r){return new R_(r)}queryRadius(r){const l=r;return op("circle-radius",this,l)+op("circle-stroke-width",this,l)+gm(this.paint.get("circle-translate"))}queryIntersectsFeature(r,l,h,m,y,x,b,E){const k=ym(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,b),R=this.paint.get("circle-radius").evaluate(l,h)+this.paint.get("circle-stroke-width").evaluate(l,h),O=this.paint.get("circle-pitch-alignment")==="map",V=O?k:function(W,Z){return W.map(ce=>eb(ce,Z))}(k,E),$=O?R*b:R;for(const W of m)for(const Z of W){const ce=O?Z:eb(Z,E);let ge=$;const ke=_m([],[Z.x,Z.y,0,1],E);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ge*=ke[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ge*=x.cameraToCenterDistance/ke[3]),V5(V,ce,ge))return!0}return!1}}function eb(s,r){const l=_m([],[s.x,s.y,0,1],r);return new L(l[0]/l[3],l[1]/l[3])}class tb extends R_{}let nb;dt("HeatmapBucket",tb,{omit:["layers"]});var G5={get paint(){return nb=nb||new f({"heatmap-radius":new Ct(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ct(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xt(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new u(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xt(Oe.paint_heatmap["heatmap-opacity"])})}};function z_(s,{width:r,height:l},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==r*l*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${r*l*h}`)}else m=new Uint8Array(r*l*h);return s.width=r,s.height=l,s.data=m,s}function rb(s,{width:r,height:l},h){if(r===s.width&&l===s.height)return;const m=z_({},{width:r,height:l},h);O_(s,m,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,l)},h),s.width=r,s.height=l,s.data=m.data}function O_(s,r,l,h,m,y){if(m.width===0||m.height===0)return r;if(m.width>s.width||m.height>s.height||l.x>s.width-m.width||l.y>s.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>r.width||m.height>r.height||h.x>r.width-m.width||h.y>r.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,b=r.data;if(x===b)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<m.height;E++){const k=((l.y+E)*s.width+l.x)*y,R=((h.y+E)*r.width+h.x)*y;for(let O=0;O<m.width*y;O++)b[R+O]=x[k+O]}return r}class ap{constructor(r,l){z_(this,r,1,l)}resize(r){rb(this,r,1)}clone(){return new ap({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,m,y){O_(r,l,h,m,y,1)}}class Bo{constructor(r,l){z_(this,r,4,l)}resize(r){rb(this,r,4)}replace(r,l){l?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Bo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,m,y){O_(r,l,h,m,y,4)}}function ib(s){const r={},l=s.resolution||256,h=s.clips?s.clips.length:1,m=s.image||new Bo({width:l,height:h});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const y=(x,b,E)=>{r[s.evaluationKey]=E;const k=s.expression.evaluate(r);m.data[x+b+0]=Math.floor(255*k.r/k.a),m.data[x+b+1]=Math.floor(255*k.g/k.a),m.data[x+b+2]=Math.floor(255*k.b/k.a),m.data[x+b+3]=Math.floor(255*k.a)};if(s.clips)for(let x=0,b=0;x<h;++x,b+=4*l)for(let E=0,k=0;E<l;E++,k+=4){const R=E/(l-1),{start:O,end:V}=s.clips[x];y(b,k,O*(1-R)+V*R)}else for(let x=0,b=0;x<l;x++,b+=4)y(0,b,x/(l-1));return m}dt("AlphaImage",ap),dt("RGBAImage",Bo);class K5 extends v{createBucket(r){return new tb(r)}constructor(r){super(r,G5),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ib({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ob;var Z5={get paint(){return ob=ob||new f({"hillshade-illumination-direction":new xt(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xt(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xt(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xt(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xt(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xt(Oe.paint_hillshade["hillshade-accent-color"])})}};class X5 extends v{constructor(r){super(r,Z5)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Y5=M([{name:"a_pos",components:2,type:"Int16"}],4),{members:Q5}=Y5;var F_={exports:{}};function vm(s,r,l){l=l||2;var h,m,y,x,b,E,k,R=r&&r.length,O=R?r[0]*l:s.length,V=sb(s,0,O,l,!0),$=[];if(!V||V.next===V.prev)return $;if(R&&(V=function(Z,ce,ge,ke){var xe,Ce,ze,qe=[];for(xe=0,Ce=ce.length;xe<Ce;xe++)(ze=sb(Z,ce[xe]*ke,xe<Ce-1?ce[xe+1]*ke:Z.length,ke,!1))===ze.next&&(ze.steiner=!0),qe.push(sR(ze));for(qe.sort(rR),xe=0;xe<qe.length;xe++)ge=iR(qe[xe],ge);return ge}(s,r,V,l)),s.length>80*l){h=y=s[0],m=x=s[1];for(var W=l;W<O;W+=l)(b=s[W])<h&&(h=b),(E=s[W+1])<m&&(m=E),b>y&&(y=b),E>x&&(x=E);k=(k=Math.max(y-h,x-m))!==0?32767/k:0}return lp(V,$,l,h,m,k,0),$}function sb(s,r,l,h,m){var y,x;if(m===V_(s,r,l,h)>0)for(y=r;y<l;y+=h)x=ub(y,s[y],s[y+1],x);else for(y=l-h;y>=r;y-=h)x=ub(y,s[y],s[y+1],x);return x&&xm(x,x.next)&&(cp(x),x=x.next),x}function qu(s,r){if(!s)return s;r||(r=s);var l,h=s;do if(l=!1,h.steiner||!xm(h,h.next)&&pr(h.prev,h,h.next)!==0)h=h.next;else{if(cp(h),(h=r=h.prev)===h.next)break;l=!0}while(l||h!==r);return r}function lp(s,r,l,h,m,y,x){if(s){!x&&y&&function(R,O,V,$){var W=R;do W.z===0&&(W.z=N_(W.x,W.y,O,V,$)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==R);W.prevZ.nextZ=null,W.prevZ=null,function(Z){var ce,ge,ke,xe,Ce,ze,qe,rt,Et=1;do{for(ge=Z,Z=null,Ce=null,ze=0;ge;){for(ze++,ke=ge,qe=0,ce=0;ce<Et&&(qe++,ke=ke.nextZ);ce++);for(rt=Et;qe>0||rt>0&&ke;)qe!==0&&(rt===0||!ke||ge.z<=ke.z)?(xe=ge,ge=ge.nextZ,qe--):(xe=ke,ke=ke.nextZ,rt--),Ce?Ce.nextZ=xe:Z=xe,xe.prevZ=Ce,Ce=xe;ge=ke}Ce.nextZ=null,Et*=2}while(ze>1)}(W)}(s,h,m,y);for(var b,E,k=s;s.prev!==s.next;)if(b=s.prev,E=s.next,y?eR(s,h,m,y):J5(s))r.push(b.i/l|0),r.push(s.i/l|0),r.push(E.i/l|0),cp(s),s=E.next,k=E.next;else if((s=E)===k){x?x===1?lp(s=tR(qu(s),r,l),r,l,h,m,y,2):x===2&&nR(s,r,l,h,m,y):lp(qu(s),r,l,h,m,y,1);break}}}function J5(s){var r=s.prev,l=s,h=s.next;if(pr(r,l,h)>=0)return!1;for(var m=r.x,y=l.x,x=h.x,b=r.y,E=l.y,k=h.y,R=m<y?m<x?m:x:y<x?y:x,O=b<E?b<k?b:k:E<k?E:k,V=m>y?m>x?m:x:y>x?y:x,$=b>E?b>k?b:k:E>k?E:k,W=h.next;W!==r;){if(W.x>=R&&W.x<=V&&W.y>=O&&W.y<=$&&rh(m,b,y,E,x,k,W.x,W.y)&&pr(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function eR(s,r,l,h){var m=s.prev,y=s,x=s.next;if(pr(m,y,x)>=0)return!1;for(var b=m.x,E=y.x,k=x.x,R=m.y,O=y.y,V=x.y,$=b<E?b<k?b:k:E<k?E:k,W=R<O?R<V?R:V:O<V?O:V,Z=b>E?b>k?b:k:E>k?E:k,ce=R>O?R>V?R:V:O>V?O:V,ge=N_($,W,r,l,h),ke=N_(Z,ce,r,l,h),xe=s.prevZ,Ce=s.nextZ;xe&&xe.z>=ge&&Ce&&Ce.z<=ke;){if(xe.x>=$&&xe.x<=Z&&xe.y>=W&&xe.y<=ce&&xe!==m&&xe!==x&&rh(b,R,E,O,k,V,xe.x,xe.y)&&pr(xe.prev,xe,xe.next)>=0||(xe=xe.prevZ,Ce.x>=$&&Ce.x<=Z&&Ce.y>=W&&Ce.y<=ce&&Ce!==m&&Ce!==x&&rh(b,R,E,O,k,V,Ce.x,Ce.y)&&pr(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;xe&&xe.z>=ge;){if(xe.x>=$&&xe.x<=Z&&xe.y>=W&&xe.y<=ce&&xe!==m&&xe!==x&&rh(b,R,E,O,k,V,xe.x,xe.y)&&pr(xe.prev,xe,xe.next)>=0)return!1;xe=xe.prevZ}for(;Ce&&Ce.z<=ke;){if(Ce.x>=$&&Ce.x<=Z&&Ce.y>=W&&Ce.y<=ce&&Ce!==m&&Ce!==x&&rh(b,R,E,O,k,V,Ce.x,Ce.y)&&pr(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function tR(s,r,l){var h=s;do{var m=h.prev,y=h.next.next;!xm(m,y)&&ab(m,h,h.next,y)&&up(m,y)&&up(y,m)&&(r.push(m.i/l|0),r.push(h.i/l|0),r.push(y.i/l|0),cp(h),cp(h.next),h=s=y),h=h.next}while(h!==s);return qu(h)}function nR(s,r,l,h,m,y){var x=s;do{for(var b=x.next.next;b!==x.prev;){if(x.i!==b.i&&aR(x,b)){var E=lb(x,b);return x=qu(x,x.next),E=qu(E,E.next),lp(x,r,l,h,m,y,0),void lp(E,r,l,h,m,y,0)}b=b.next}x=x.next}while(x!==s)}function rR(s,r){return s.x-r.x}function iR(s,r){var l=function(m,y){var x,b=y,E=m.x,k=m.y,R=-1/0;do{if(k<=b.y&&k>=b.next.y&&b.next.y!==b.y){var O=b.x+(k-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(O<=E&&O>R&&(R=O,x=b.x<b.next.x?b:b.next,O===E))return x}b=b.next}while(b!==y);if(!x)return null;var V,$=x,W=x.x,Z=x.y,ce=1/0;b=x;do E>=b.x&&b.x>=W&&E!==b.x&&rh(k<Z?E:R,k,W,Z,k<Z?R:E,k,b.x,b.y)&&(V=Math.abs(k-b.y)/(E-b.x),up(b,m)&&(V<ce||V===ce&&(b.x>x.x||b.x===x.x&&oR(x,b)))&&(x=b,ce=V)),b=b.next;while(b!==$);return x}(s,r);if(!l)return r;var h=lb(l,s);return qu(h,h.next),qu(l,l.next)}function oR(s,r){return pr(s.prev,s,r.prev)<0&&pr(r.next,s,s.next)<0}function N_(s,r,l,h,m){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-l)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-h)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function sR(s){var r=s,l=s;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==s);return l}function rh(s,r,l,h,m,y,x,b){return(m-x)*(r-b)>=(s-x)*(y-b)&&(s-x)*(h-b)>=(l-x)*(r-b)&&(l-x)*(y-b)>=(m-x)*(h-b)}function aR(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(l,h){var m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==h.i&&m.next.i!==h.i&&ab(m,m.next,l,h))return!0;m=m.next}while(m!==l);return!1}(s,r)&&(up(s,r)&&up(r,s)&&function(l,h){var m=l,y=!1,x=(l.x+h.x)/2,b=(l.y+h.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&x<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next;while(m!==l);return y}(s,r)&&(pr(s.prev,s,r.prev)||pr(s,r.prev,r))||xm(s,r)&&pr(s.prev,s,s.next)>0&&pr(r.prev,r,r.next)>0)}function pr(s,r,l){return(r.y-s.y)*(l.x-r.x)-(r.x-s.x)*(l.y-r.y)}function xm(s,r){return s.x===r.x&&s.y===r.y}function ab(s,r,l,h){var m=bm(pr(s,r,l)),y=bm(pr(s,r,h)),x=bm(pr(l,h,s)),b=bm(pr(l,h,r));return m!==y&&x!==b||!(m!==0||!wm(s,l,r))||!(y!==0||!wm(s,h,r))||!(x!==0||!wm(l,s,h))||!(b!==0||!wm(l,r,h))}function wm(s,r,l){return r.x<=Math.max(s.x,l.x)&&r.x>=Math.min(s.x,l.x)&&r.y<=Math.max(s.y,l.y)&&r.y>=Math.min(s.y,l.y)}function bm(s){return s>0?1:s<0?-1:0}function up(s,r){return pr(s.prev,s,s.next)<0?pr(s,r,s.next)>=0&&pr(s,s.prev,r)>=0:pr(s,r,s.prev)<0||pr(s,s.next,r)<0}function lb(s,r){var l=new B_(s.i,s.x,s.y),h=new B_(r.i,r.x,r.y),m=s.next,y=r.prev;return s.next=r,r.prev=s,l.next=m,m.prev=l,h.next=l,l.prev=h,y.next=h,h.prev=y,h}function ub(s,r,l,h){var m=new B_(s,r,l);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function cp(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function B_(s,r,l){this.i=s,this.x=r,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function V_(s,r,l,h){for(var m=0,y=r,x=l-h;y<l;y+=h)m+=(s[x]-s[y])*(s[y+1]+s[x+1]),x=y;return m}F_.exports=vm,F_.exports.default=vm,vm.deviation=function(s,r,l,h){var m=r&&r.length,y=Math.abs(V_(s,0,m?r[0]*l:s.length,l));if(m)for(var x=0,b=r.length;x<b;x++)y-=Math.abs(V_(s,r[x]*l,x<b-1?r[x+1]*l:s.length,l));var E=0;for(x=0;x<h.length;x+=3){var k=h[x]*l,R=h[x+1]*l,O=h[x+2]*l;E+=Math.abs((s[k]-s[O])*(s[R+1]-s[k+1])-(s[k]-s[R])*(s[O+1]-s[k+1]))}return y===0&&E===0?0:Math.abs((E-y)/y)},vm.flatten=function(s){for(var r=s[0][0].length,l={vertices:[],holes:[],dimensions:r},h=0,m=0;m<s.length;m++){for(var y=0;y<s[m].length;y++)for(var x=0;x<r;x++)l.vertices.push(s[m][y][x]);m>0&&l.holes.push(h+=s[m-1].length)}return l};var cb=S(F_.exports);function j_(s,r,l){const h=l.patternDependencies;let m=!1;for(const y of r){const x=y.paint.get(`${s}-pattern`);x.isConstant()||(m=!0);const b=x.constantOr(null);b&&(m=!0,h[b.to]=!0,h[b.from]=!0)}return m}function U_(s,r,l,h,m){const y=m.patternDependencies;for(const x of r){const b=x.paint.get(`${s}-pattern`).value;if(b.kind!=="constant"){let E=b.evaluate({zoom:h-1},l,{},m.availableImages),k=b.evaluate({zoom:h},l,{},m.availableImages),R=b.evaluate({zoom:h+1},l,{},m.availableImages);E=E&&E.name?E.name:E,k=k&&k.name?k.name:k,R=R&&R.name?R.name:R,y[E]=!0,y[k]=!0,y[R]=!0,l.patterns[x.id]={min:E,mid:k,max:R}}}return l}class $_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Tl,this.indexArray=new Nr,this.indexArray2=new Xn,this.programConfigurations=new ju(r.layers,r.zoom),this.segments=new kr,this.segments2=new kr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.hasPattern=j_("fill",this.layers,l);const m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),x=[];for(const{feature:b,id:E,index:k,sourceLayerIndex:R}of r){const O=this.layers[0]._featureFilter.needGeometry,V=$u(b,O);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),V,h))continue;const $=y?m.evaluate(V,{},h,l.availableImages):void 0,W={id:E,properties:b.properties,type:b.type,sourceLayerIndex:R,index:k,geometry:O?V.geometry:Uu(b),patterns:{},sortKey:$};x.push(W)}y&&x.sort((b,E)=>b.sortKey-E.sortKey);for(const b of x){const{geometry:E,index:k,sourceLayerIndex:R}=b;if(this.hasPattern){const O=U_("fill",this.layers,b,this.zoom,l);this.patternFeatures.push(O)}else this.addFeature(b,E,k,h,{});l.featureIndex.insert(r[k].feature,E,k,R,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}addFeatures(r,l,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Q5),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,l,h,m,y){for(const x of Na(l,500)){let b=0;for(const $ of x)b+=$.length;const E=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),k=E.vertexLength,R=[],O=[];for(const $ of x){if($.length===0)continue;$!==x[0]&&O.push(R.length/2);const W=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),Z=W.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(Z+$.length-1,Z),R.push($[0].x),R.push($[0].y);for(let ce=1;ce<$.length;ce++)this.layoutVertexArray.emplaceBack($[ce].x,$[ce].y),this.indexArray2.emplaceBack(Z+ce-1,Z+ce),R.push($[ce].x),R.push($[ce].y);W.vertexLength+=$.length,W.primitiveLength+=$.length}const V=cb(R,O);for(let $=0;$<V.length;$+=3)this.indexArray.emplaceBack(k+V[$],k+V[$+1],k+V[$+2]);E.vertexLength+=b,E.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,y,m)}}let hb,db;dt("FillBucket",$_,{omit:["layers","patternFeatures"]});var lR={get paint(){return db=db||new f({"fill-antialias":new xt(Oe.paint_fill["fill-antialias"]),"fill-opacity":new Ct(Oe.paint_fill["fill-opacity"]),"fill-color":new Ct(Oe.paint_fill["fill-color"]),"fill-outline-color":new Ct(Oe.paint_fill["fill-outline-color"]),"fill-translate":new xt(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new xt(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new _(Oe.paint_fill["fill-pattern"])})},get layout(){return hb=hb||new f({"fill-sort-key":new Ct(Oe.layout_fill["fill-sort-key"])})}};class uR extends v{constructor(r){super(r,lR)}recalculate(r,l){super.recalculate(r,l);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new $_(r)}queryRadius(){return gm(this.paint.get("fill-translate"))}queryIntersectsFeature(r,l,h,m,y,x,b){return Kw(ym(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,b),m)}isTileClipped(){return!0}}const cR=M([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),hR=M([{name:"a_centroid",components:2,type:"Int16"}],4),{members:dR}=cR;var kl={},pR=A,pb=ih;function ih(s,r,l,h,m){this.properties={},this.extent=l,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=m,s.readFields(fR,this,r)}function fR(s,r,l){s==1?r.id=l.readVarint():s==2?function(h,m){for(var y=h.readVarint()+h.pos;h.pos<y;){var x=m._keys[h.readVarint()],b=m._values[h.readVarint()];m.properties[x]=b}}(l,r):s==3?r.type=l.readVarint():s==4&&(r._geometry=l.pos)}function mR(s){for(var r,l,h=0,m=0,y=s.length,x=y-1;m<y;x=m++)h+=((l=s[x]).x-(r=s[m]).x)*(r.y+l.y);return h}ih.types=["Unknown","Point","LineString","Polygon"],ih.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,l=s.readVarint()+s.pos,h=1,m=0,y=0,x=0,b=[];s.pos<l;){if(m<=0){var E=s.readVarint();h=7&E,m=E>>3}if(m--,h===1||h===2)y+=s.readSVarint(),x+=s.readSVarint(),h===1&&(r&&b.push(r),r=[]),r.push(new pR(y,x));else{if(h!==7)throw new Error("unknown command "+h);r&&r.push(r[0].clone())}}return r&&b.push(r),b},ih.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,l=1,h=0,m=0,y=0,x=1/0,b=-1/0,E=1/0,k=-1/0;s.pos<r;){if(h<=0){var R=s.readVarint();l=7&R,h=R>>3}if(h--,l===1||l===2)(m+=s.readSVarint())<x&&(x=m),m>b&&(b=m),(y+=s.readSVarint())<E&&(E=y),y>k&&(k=y);else if(l!==7)throw new Error("unknown command "+l)}return[x,E,b,k]},ih.prototype.toGeoJSON=function(s,r,l){var h,m,y=this.extent*Math.pow(2,l),x=this.extent*s,b=this.extent*r,E=this.loadGeometry(),k=ih.types[this.type];function R($){for(var W=0;W<$.length;W++){var Z=$[W];$[W]=[360*(Z.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+b)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(h=0;h<E.length;h++)O[h]=E[h][0];R(E=O);break;case 2:for(h=0;h<E.length;h++)R(E[h]);break;case 3:for(E=function($){var W=$.length;if(W<=1)return[$];for(var Z,ce,ge=[],ke=0;ke<W;ke++){var xe=mR($[ke]);xe!==0&&(ce===void 0&&(ce=xe<0),ce===xe<0?(Z&&ge.push(Z),Z=[$[ke]]):Z.push($[ke]))}return Z&&ge.push(Z),ge}(E),h=0;h<E.length;h++)for(m=0;m<E[h].length;m++)R(E[h][m])}E.length===1?E=E[0]:k="Multi"+k;var V={type:"Feature",geometry:{type:k,coordinates:E},properties:this.properties};return"id"in this&&(V.id=this.id),V};var gR=pb,fb=mb;function mb(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(yR,this,r),this.length=this._features.length}function yR(s,r,l){s===15?r.version=l.readVarint():s===1?r.name=l.readString():s===5?r.extent=l.readVarint():s===2?r._features.push(l.pos):s===3?r._keys.push(l.readString()):s===4&&r._values.push(function(h){for(var m=null,y=h.readVarint()+h.pos;h.pos<y;){var x=h.readVarint()>>3;m=x===1?h.readString():x===2?h.readFloat():x===3?h.readDouble():x===4?h.readVarint64():x===5?h.readVarint():x===6?h.readSVarint():x===7?h.readBoolean():null}return m}(l))}mb.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new gR(this._pbf,r,this.extent,this._keys,this._values)};var _R=fb;function vR(s,r,l){if(s===3){var h=new _R(l,l.readVarint()+l.pos);h.length&&(r[h.name]=h)}}kl.VectorTile=function(s,r){this.layers=s.readFields(vR,{},r)},kl.VectorTileFeature=pb,kl.VectorTileLayer=fb;const xR=kl.VectorTileFeature.types,q_=Math.pow(2,13);function hp(s,r,l,h,m,y,x,b){s.emplaceBack(r,l,2*Math.floor(h*q_)+x,m*q_*2,y*q_*2,Math.round(b))}class H_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Wa,this.centroidVertexArray=new Ha,this.indexArray=new Nr,this.programConfigurations=new ju(r.layers,r.zoom),this.segments=new kr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.features=[],this.hasPattern=j_("fill-extrusion",this.layers,l);for(const{feature:m,id:y,index:x,sourceLayerIndex:b}of r){const E=this.layers[0]._featureFilter.needGeometry,k=$u(m,E);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),k,h))continue;const R={id:y,sourceLayerIndex:b,index:x,geometry:E?k.geometry:Uu(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(U_("fill-extrusion",this.layers,R,this.zoom,l)):this.addFeature(R,R.geometry,x,h,{}),l.featureIndex.insert(m,R.geometry,x,b,this.index,!0)}}addFeatures(r,l,h){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,l,h)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,dR),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,hR.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,l,h,m,y){for(const x of Na(l,500)){const b={x:0,y:0,vertexCount:0};let E=0;for(const W of x)E+=W.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const W of x){if(W.length===0||bR(W))continue;let Z=0;for(let ce=0;ce<W.length;ce++){const ge=W[ce];if(ce>=1){const ke=W[ce-1];if(!wR(ge,ke)){k.vertexLength+4>kr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const xe=ge.sub(ke)._perp()._unit(),Ce=ke.dist(ge);Z+Ce>32768&&(Z=0),hp(this.layoutVertexArray,ge.x,ge.y,xe.x,xe.y,0,0,Z),hp(this.layoutVertexArray,ge.x,ge.y,xe.x,xe.y,0,1,Z),b.x+=2*ge.x,b.y+=2*ge.y,b.vertexCount+=2,Z+=Ce,hp(this.layoutVertexArray,ke.x,ke.y,xe.x,xe.y,0,0,Z),hp(this.layoutVertexArray,ke.x,ke.y,xe.x,xe.y,0,1,Z),b.x+=2*ke.x,b.y+=2*ke.y,b.vertexCount+=2;const ze=k.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+E>kr.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray)),xR[r.type]!=="Polygon")continue;const R=[],O=[],V=k.vertexLength;for(const W of x)if(W.length!==0){W!==x[0]&&O.push(R.length/2);for(let Z=0;Z<W.length;Z++){const ce=W[Z];hp(this.layoutVertexArray,ce.x,ce.y,0,0,1,1,0),b.x+=ce.x,b.y+=ce.y,b.vertexCount+=1,R.push(ce.x),R.push(ce.y)}}const $=cb(R,O);for(let W=0;W<$.length;W+=3)this.indexArray.emplaceBack(V+$[W],V+$[W+2],V+$[W+1]);k.primitiveLength+=$.length/3,k.vertexLength+=E;for(let W=0;W<b.vertexCount;W++){const Z=Math.floor(b.x/b.vertexCount),ce=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(Z,ce)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,y,m)}}function wR(s,r){return s.x===r.x&&(s.x<0||s.x>br)||s.y===r.y&&(s.y<0||s.y>br)}function bR(s){return s.every(r=>r.x<0)||s.every(r=>r.x>br)||s.every(r=>r.y<0)||s.every(r=>r.y>br)}let gb;dt("FillExtrusionBucket",H_,{omit:["layers","features"]});var SR={get paint(){return gb=gb||new f({"fill-extrusion-opacity":new xt(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ct(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xt(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xt(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ct(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ct(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xt(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class TR extends v{constructor(r){super(r,SR)}createBucket(r){return new H_(r)}queryRadius(){return gm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,l,h,m,y,x,b,E){const k=ym(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,b),R=this.paint.get("fill-extrusion-height").evaluate(l,h),O=this.paint.get("fill-extrusion-base").evaluate(l,h),V=function(W,Z,ce,ge){const ke=[];for(const xe of W){const Ce=[xe.x,xe.y,0,1];_m(Ce,Ce,Z),ke.push(new L(Ce[0]/Ce[3],Ce[1]/Ce[3]))}return ke}(k,E),$=function(W,Z,ce,ge){const ke=[],xe=[],Ce=ge[8]*Z,ze=ge[9]*Z,qe=ge[10]*Z,rt=ge[11]*Z,Et=ge[8]*ce,ot=ge[9]*ce,nt=ge[10]*ce,vt=ge[11]*ce;for(const ft of W){const ct=[],je=[];for(const wt of ft){const _t=wt.x,Ft=wt.y,Rn=ge[0]*_t+ge[4]*Ft+ge[12],Cn=ge[1]*_t+ge[5]*Ft+ge[13],Br=ge[2]*_t+ge[6]*Ft+ge[14],hs=ge[3]*_t+ge[7]*Ft+ge[15],fi=Br+qe,lr=hs+rt,qi=Rn+Et,Hi=Cn+ot,Wi=Br+nt,ur=hs+vt,Vr=new L((Rn+Ce)/lr,(Cn+ze)/lr);Vr.z=fi/lr,ct.push(Vr);const Ci=new L(qi/ur,Hi/ur);Ci.z=Wi/ur,je.push(Ci)}ke.push(ct),xe.push(je)}return[ke,xe]}(m,O,R,E);return function(W,Z,ce){let ge=1/0;Kw(ce,Z)&&(ge=yb(ce,Z[0]));for(let ke=0;ke<Z.length;ke++){const xe=Z[ke],Ce=W[ke];for(let ze=0;ze<xe.length-1;ze++){const qe=xe[ze],rt=[qe,xe[ze+1],Ce[ze+1],Ce[ze],qe];Gw(ce,rt)&&(ge=Math.min(ge,yb(ce,rt)))}}return ge!==1/0&&ge}($[0],$[1],V)}}function dp(s,r){return s.x*r.x+s.y*r.y}function yb(s,r){if(s.length===1){let l=0;const h=r[l++];let m;for(;!m||h.equals(m);)if(m=r[l++],!m)return 1/0;for(;l<r.length;l++){const y=r[l],x=s[0],b=m.sub(h),E=y.sub(h),k=x.sub(h),R=dp(b,b),O=dp(b,E),V=dp(E,E),$=dp(k,b),W=dp(k,E),Z=R*V-O*O,ce=(V*$-O*W)/Z,ge=(R*W-O*$)/Z,ke=h.z*(1-ce-ge)+m.z*ce+y.z*ge;if(isFinite(ke))return ke}return 1/0}{let l=1/0;for(const h of r)l=Math.min(l,h.z);return l}}const ER=M([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:IR}=ER,CR=M([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:AR}=CR,kR=kl.VectorTileFeature.types,PR=Math.cos(Math.PI/180*37.5),_b=Math.pow(2,14)/.5;class W_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Xc,this.layoutVertexArray2=new Jd,this.indexArray=new Nr,this.programConfigurations=new ju(r.layers,r.zoom),this.segments=new kr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.hasPattern=j_("line",this.layers,l);const m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),x=[];for(const{feature:b,id:E,index:k,sourceLayerIndex:R}of r){const O=this.layers[0]._featureFilter.needGeometry,V=$u(b,O);if(!this.layers[0]._featureFilter.filter(new zn(this.zoom),V,h))continue;const $=y?m.evaluate(V,{},h):void 0,W={id:E,properties:b.properties,type:b.type,sourceLayerIndex:R,index:k,geometry:O?V.geometry:Uu(b),patterns:{},sortKey:$};x.push(W)}y&&x.sort((b,E)=>b.sortKey-E.sortKey);for(const b of x){const{geometry:E,index:k,sourceLayerIndex:R}=b;if(this.hasPattern){const O=U_("line",this.layers,b,this.zoom,l);this.patternFeatures.push(O)}else this.addFeature(b,E,k,h,{});l.featureIndex.insert(r[k].feature,E,k,R,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}addFeatures(r,l,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,AR)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,IR),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,l,h,m,y){const x=this.layers[0].layout,b=x.get("line-join").evaluate(r,{}),E=x.get("line-cap"),k=x.get("line-miter-limit"),R=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const O of l)this.addLine(O,r,b,E,k,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,y,m)}addLine(r,l,h,m,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<r.length-1;ge++)this.totalDistance+=r[ge].dist(r[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=kR[l.type]==="Polygon";let E=r.length;for(;E>=2&&r[E-1].equals(r[E-2]);)E--;let k=0;for(;k<E-1&&r[k].equals(r[k+1]);)k++;if(E<(b?3:2))return;h==="bevel"&&(y=1.05);const R=this.overscaling<=16?15*br/(512*this.overscaling):0,O=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let V,$,W,Z,ce;this.e1=this.e2=-1,b&&(V=r[E-2],ce=r[k].sub(V)._unit()._perp());for(let ge=k;ge<E;ge++){if(W=ge===E-1?b?r[k+1]:void 0:r[ge+1],W&&r[ge].equals(W))continue;ce&&(Z=ce),V&&($=V),V=r[ge],ce=W?W.sub(V)._unit()._perp():Z,Z=Z||ce;let ke=Z.add(ce);ke.x===0&&ke.y===0||ke._unit();const xe=Z.x*ce.x+Z.y*ce.y,Ce=ke.x*ce.x+ke.y*ce.y,ze=Ce!==0?1/Ce:1/0,qe=2*Math.sqrt(2-2*Ce),rt=Ce<PR&&$&&W,Et=Z.x*ce.y-Z.y*ce.x>0;if(rt&&ge>k){const vt=V.dist($);if(vt>2*R){const ft=V.sub(V.sub($)._mult(R/vt)._round());this.updateDistance($,ft),this.addCurrentVertex(ft,Z,0,0,O),$=ft}}const ot=$&&W;let nt=ot?h:b?"butt":m;if(ot&&nt==="round"&&(ze<x?nt="miter":ze<=2&&(nt="fakeround")),nt==="miter"&&ze>y&&(nt="bevel"),nt==="bevel"&&(ze>2&&(nt="flipbevel"),ze<y&&(nt="miter")),$&&this.updateDistance($,V),nt==="miter")ke._mult(ze),this.addCurrentVertex(V,ke,0,0,O);else if(nt==="flipbevel"){if(ze>100)ke=ce.mult(-1);else{const vt=ze*Z.add(ce).mag()/Z.sub(ce).mag();ke._perp()._mult(vt*(Et?-1:1))}this.addCurrentVertex(V,ke,0,0,O),this.addCurrentVertex(V,ke.mult(-1),0,0,O)}else if(nt==="bevel"||nt==="fakeround"){const vt=-Math.sqrt(ze*ze-1),ft=Et?vt:0,ct=Et?0:vt;if($&&this.addCurrentVertex(V,Z,ft,ct,O),nt==="fakeround"){const je=Math.round(180*qe/Math.PI/20);for(let wt=1;wt<je;wt++){let _t=wt/je;if(_t!==.5){const Rn=_t-.5;_t+=_t*Rn*(_t-1)*((1.0904+xe*(xe*(3.55645-1.43519*xe)-3.2452))*Rn*Rn+(.848013+xe*(.215638*xe-1.06021)))}const Ft=ce.sub(Z)._mult(_t)._add(Z)._unit()._mult(Et?-1:1);this.addHalfVertex(V,Ft.x,Ft.y,!1,Et,0,O)}}W&&this.addCurrentVertex(V,ce,-ft,-ct,O)}else if(nt==="butt")this.addCurrentVertex(V,ke,0,0,O);else if(nt==="square"){const vt=$?1:-1;this.addCurrentVertex(V,ke,vt,vt,O)}else nt==="round"&&($&&(this.addCurrentVertex(V,Z,0,0,O),this.addCurrentVertex(V,Z,1,1,O,!0)),W&&(this.addCurrentVertex(V,ce,-1,-1,O,!0),this.addCurrentVertex(V,ce,0,0,O)));if(rt&&ge<E-1){const vt=V.dist(W);if(vt>2*R){const ft=V.add(W.sub(V)._mult(R/vt)._round());this.updateDistance(V,ft),this.addCurrentVertex(ft,ce,0,0,O),V=ft}}}}addCurrentVertex(r,l,h,m,y,x=!1){const b=l.y*m-l.x,E=-l.y-l.x*m;this.addHalfVertex(r,l.x+l.y*h,l.y-l.x*h,x,!1,h,y),this.addHalfVertex(r,b,E,x,!0,-m,y),this.distance>_b/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,l,h,m,y,x))}addHalfVertex({x:r,y:l},h,m,y,x,b,E){const k=.5*(this.lineClips?this.scaledDistance*(_b-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(y?1:0),(l<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),E.primitiveLength++),x?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,l){this.distance+=r.dist(l),this.updateScaledDistance()}}let vb,xb;dt("LineBucket",W_,{omit:["layers","patternFeatures"]});var wb={get paint(){return xb=xb||new f({"line-opacity":new Ct(Oe.paint_line["line-opacity"]),"line-color":new Ct(Oe.paint_line["line-color"]),"line-translate":new xt(Oe.paint_line["line-translate"]),"line-translate-anchor":new xt(Oe.paint_line["line-translate-anchor"]),"line-width":new Ct(Oe.paint_line["line-width"]),"line-gap-width":new Ct(Oe.paint_line["line-gap-width"]),"line-offset":new Ct(Oe.paint_line["line-offset"]),"line-blur":new Ct(Oe.paint_line["line-blur"]),"line-dasharray":new i(Oe.paint_line["line-dasharray"]),"line-pattern":new _(Oe.paint_line["line-pattern"]),"line-gradient":new u(Oe.paint_line["line-gradient"])})},get layout(){return vb=vb||new f({"line-cap":new xt(Oe.layout_line["line-cap"]),"line-join":new Ct(Oe.layout_line["line-join"]),"line-miter-limit":new xt(Oe.layout_line["line-miter-limit"]),"line-round-limit":new xt(Oe.layout_line["line-round-limit"]),"line-sort-key":new Ct(Oe.layout_line["line-sort-key"])})}};class RR extends Ct{possiblyEvaluate(r,l){return l=new zn(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(r,l)}evaluate(r,l,h,m){return l=J({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(r,l,h,m)}}let Sm;class MR extends v{constructor(r){super(r,wb),this.gradientVersion=0,Sm||(Sm=new RR(wb.paint.properties["line-width"].specification),Sm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof Ra,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,l){super.recalculate(r,l),this.paint._values["line-floorwidth"]=Sm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new W_(r)}queryRadius(r){const l=r,h=bb(op("line-width",this,l),op("line-gap-width",this,l)),m=op("line-offset",this,l);return h/2+Math.abs(m)+gm(this.paint.get("line-translate"))}queryIntersectsFeature(r,l,h,m,y,x,b){const E=ym(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,b),k=b/2*bb(this.paint.get("line-width").evaluate(l,h),this.paint.get("line-gap-width").evaluate(l,h)),R=this.paint.get("line-offset").evaluate(l,h);return R&&(m=function(O,V){const $=[];for(let W=0;W<O.length;W++){const Z=O[W],ce=[];for(let ge=0;ge<Z.length;ge++){const ke=Z[ge-1],xe=Z[ge],Ce=Z[ge+1],ze=ge===0?new L(0,0):xe.sub(ke)._unit()._perp(),qe=ge===Z.length-1?new L(0,0):Ce.sub(xe)._unit()._perp(),rt=ze._add(qe)._unit(),Et=rt.x*qe.x+rt.y*qe.y;Et!==0&&rt._mult(1/Et),ce.push(rt._mult(V)._add(xe))}$.push(ce)}return $}(m,R*b)),function(O,V,$){for(let W=0;W<V.length;W++){const Z=V[W];if(O.length>=3){for(let ce=0;ce<Z.length;ce++)if(th(O,Z[ce]))return!0}if(j5(O,Z,$))return!0}return!1}(E,m,k)}isTileClipped(){return!0}}function bb(s,r){return r>0?r+2*s:s}const LR=M([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),DR=M([{name:"a_projected_pos",components:3,type:"Float32"}],4);M([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zR=M([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);M([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Sb=M([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),OR=M([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function FR(s,r,l){return s.sections.forEach(h=>{h.text=function(m,y,x){const b=y.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),sa.applyArabicShaping&&(m=sa.applyArabicShaping(m)),m}(h.text,r,l)}),s}M([{name:"triangle",components:3,type:"Uint16"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),M([{type:"Float32",name:"offsetX"}]),M([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),M([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const pp={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Pr=24,Tb=In,Eb=function(s,r,l,h,m){var y,x,b=8*m-h-1,E=(1<<b)-1,k=E>>1,R=-7,O=m-1,V=-1,$=s[r+O];for(O+=V,y=$&(1<<-R)-1,$>>=-R,R+=b;R>0;y=256*y+s[r+O],O+=V,R-=8);for(x=y&(1<<-R)-1,y>>=-R,R+=h;R>0;x=256*x+s[r+O],O+=V,R-=8);if(y===0)y=1-k;else{if(y===E)return x?NaN:1/0*($?-1:1);x+=Math.pow(2,h),y-=k}return($?-1:1)*x*Math.pow(2,y-h)},Ib=function(s,r,l,h,m,y){var x,b,E,k=8*y-m-1,R=(1<<k)-1,O=R>>1,V=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=0,W=1,Z=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,x=R):(x=Math.floor(Math.log(r)/Math.LN2),r*(E=Math.pow(2,-x))<1&&(x--,E*=2),(r+=x+O>=1?V/E:V*Math.pow(2,1-O))*E>=2&&(x++,E/=2),x+O>=R?(b=0,x=R):x+O>=1?(b=(r*E-1)*Math.pow(2,m),x+=O):(b=r*Math.pow(2,O-1)*Math.pow(2,m),x=0));m>=8;s[l+$]=255&b,$+=W,b/=256,m-=8);for(x=x<<m|b,k+=m;k>0;s[l+$]=255&x,$+=W,x/=256,k-=8);s[l+$-W]|=128*Z};function In(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}In.Varint=0,In.Fixed64=1,In.Bytes=2,In.Fixed32=5;var G_=4294967296,Cb=1/G_,Ab=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ka(s){return s.type===In.Bytes?s.readVarint()+s.pos:s.pos+1}function oh(s,r,l){return l?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function kb(s,r,l){var h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));l.realloc(h);for(var m=l.pos-1;m>=s;m--)l.buf[m+h]=l.buf[m]}function NR(s,r){for(var l=0;l<s.length;l++)r.writeVarint(s[l])}function BR(s,r){for(var l=0;l<s.length;l++)r.writeSVarint(s[l])}function VR(s,r){for(var l=0;l<s.length;l++)r.writeFloat(s[l])}function jR(s,r){for(var l=0;l<s.length;l++)r.writeDouble(s[l])}function UR(s,r){for(var l=0;l<s.length;l++)r.writeBoolean(s[l])}function $R(s,r){for(var l=0;l<s.length;l++)r.writeFixed32(s[l])}function qR(s,r){for(var l=0;l<s.length;l++)r.writeSFixed32(s[l])}function HR(s,r){for(var l=0;l<s.length;l++)r.writeFixed64(s[l])}function WR(s,r){for(var l=0;l<s.length;l++)r.writeSFixed64(s[l])}function Tm(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function sh(s,r,l){s[l]=r,s[l+1]=r>>>8,s[l+2]=r>>>16,s[l+3]=r>>>24}function Pb(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}In.prototype={destroy:function(){this.buf=null},readFields:function(s,r,l){for(l=l||this.length;this.pos<l;){var h=this.readVarint(),m=h>>3,y=this.pos;this.type=7&h,s(m,r,this),this.pos===y&&this.skip(h)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=Tm(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=Pb(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Tm(this.buf,this.pos)+Tm(this.buf,this.pos+4)*G_;return this.pos+=8,s},readSFixed64:function(){var s=Tm(this.buf,this.pos)+Pb(this.buf,this.pos+4)*G_;return this.pos+=8,s},readFloat:function(){var s=Eb(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Eb(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,l,h=this.buf;return r=127&(l=h[this.pos++]),l<128?r:(r|=(127&(l=h[this.pos++]))<<7,l<128?r:(r|=(127&(l=h[this.pos++]))<<14,l<128?r:(r|=(127&(l=h[this.pos++]))<<21,l<128?r:function(m,y,x){var b,E,k=x.buf;if(b=(112&(E=k[x.pos++]))>>4,E<128||(b|=(127&(E=k[x.pos++]))<<3,E<128)||(b|=(127&(E=k[x.pos++]))<<10,E<128)||(b|=(127&(E=k[x.pos++]))<<17,E<128)||(b|=(127&(E=k[x.pos++]))<<24,E<128)||(b|=(1&(E=k[x.pos++]))<<31,E<128))return oh(m,b,y);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(l=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&Ab?function(l,h,m){return Ab.decode(l.subarray(h,m))}(this.buf,r,s):function(l,h,m){for(var y="",x=h;x<m;){var b,E,k,R=l[x],O=null,V=R>239?4:R>223?3:R>191?2:1;if(x+V>m)break;V===1?R<128&&(O=R):V===2?(192&(b=l[x+1]))==128&&(O=(31&R)<<6|63&b)<=127&&(O=null):V===3?(E=l[x+2],(192&(b=l[x+1]))==128&&(192&E)==128&&((O=(15&R)<<12|(63&b)<<6|63&E)<=2047||O>=55296&&O<=57343)&&(O=null)):V===4&&(E=l[x+2],k=l[x+3],(192&(b=l[x+1]))==128&&(192&E)==128&&(192&k)==128&&((O=(15&R)<<18|(63&b)<<12|(63&E)<<6|63&k)<=65535||O>=1114112)&&(O=null)),O===null?(O=65533,V=1):O>65535&&(O-=65536,y+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),y+=String.fromCharCode(O),x+=V}return y}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==In.Bytes)return s.push(this.readVarint(r));var l=Ka(this);for(s=s||[];this.pos<l;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==In.Bytes)return s.push(this.readSVarint());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==In.Bytes)return s.push(this.readBoolean());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==In.Bytes)return s.push(this.readFloat());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==In.Bytes)return s.push(this.readDouble());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==In.Bytes)return s.push(this.readFixed32());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==In.Bytes)return s.push(this.readSFixed32());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==In.Bytes)return s.push(this.readFixed64());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==In.Bytes)return s.push(this.readSFixed64());var r=Ka(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===In.Varint)for(;this.buf[this.pos++]>127;);else if(r===In.Bytes)this.pos=this.readVarint()+this.pos;else if(r===In.Fixed32)this.pos+=4;else{if(r!==In.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),sh(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),sh(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),sh(this.buf,-1&s,this.pos),sh(this.buf,Math.floor(s*Cb),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),sh(this.buf,-1&s,this.pos),sh(this.buf,Math.floor(s*Cb),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,l){var h,m;if(r>=0?(h=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(y,x,b){b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,b.buf[b.pos]=127&(y>>>=7)}(h,0,l),function(y,x){var b=(7&y)<<4;x.buf[x.pos++]|=b|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(m,l)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(h,m,y){for(var x,b,E=0;E<m.length;E++){if((x=m.charCodeAt(E))>55295&&x<57344){if(!b){x>56319||E+1===m.length?(h[y++]=239,h[y++]=191,h[y++]=189):b=x;continue}if(x<56320){h[y++]=239,h[y++]=191,h[y++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(h[y++]=239,h[y++]=191,h[y++]=189,b=null);x<128?h[y++]=x:(x<2048?h[y++]=x>>6|192:(x<65536?h[y++]=x>>12|224:(h[y++]=x>>18|240,h[y++]=x>>12&63|128),h[y++]=x>>6&63|128),h[y++]=63&x|128)}return y}(this.buf,s,this.pos);var l=this.pos-r;l>=128&&kb(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeFloat:function(s){this.realloc(4),Ib(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Ib(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var l=0;l<r;l++)this.buf[this.pos++]=s[l]},writeRawMessage:function(s,r){this.pos++;var l=this.pos;s(r,this);var h=this.pos-l;h>=128&&kb(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,r,l){this.writeTag(s,In.Bytes),this.writeRawMessage(r,l)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,NR,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,BR,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,UR,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,VR,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,jR,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,$R,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,qR,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,HR,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,WR,r)},writeBytesField:function(s,r){this.writeTag(s,In.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,In.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,In.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,In.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,In.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,In.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,In.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,In.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,In.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,In.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var K_=S(Tb);const Z_=3;function GR(s,r,l){s===1&&l.readMessage(KR,r)}function KR(s,r,l){if(s===3){const{id:h,bitmap:m,width:y,height:x,left:b,top:E,advance:k}=l.readMessage(ZR,{});r.push({id:h,bitmap:new ap({width:y+2*Z_,height:x+2*Z_},m),metrics:{width:y,height:x,left:b,top:E,advance:k}})}}function ZR(s,r,l){s===1?r.id=l.readVarint():s===2?r.bitmap=l.readBytes():s===3?r.width=l.readVarint():s===4?r.height=l.readVarint():s===5?r.left=l.readSVarint():s===6?r.top=l.readSVarint():s===7&&(r.advance=l.readVarint())}const Rb=Z_;function Mb(s){let r=0,l=0;for(const x of s)r+=x.w*x.h,l=Math.max(l,x.w);s.sort((x,b)=>b.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),l),h:1/0}];let m=0,y=0;for(const x of s)for(let b=h.length-1;b>=0;b--){const E=h[b];if(!(x.w>E.w||x.h>E.h)){if(x.x=E.x,x.y=E.y,y=Math.max(y,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===E.w&&x.h===E.h){const k=h.pop();b<h.length&&(h[b]=k)}else x.h===E.h?(E.x+=x.w,E.w-=x.w):x.w===E.w?(E.y+=x.h,E.h-=x.h):(h.push({x:E.x+x.w,y:E.y,w:E.w-x.w,h:x.h}),E.y+=x.h,E.h-=x.h);break}}return{w:m,h:y,fill:r/(m*y)||0}}const lo=1;class X_{constructor(r,{pixelRatio:l,version:h,stretchX:m,stretchY:y,content:x,textFitWidth:b,textFitHeight:E}){this.paddedRect=r,this.pixelRatio=l,this.stretchX=m,this.stretchY=y,this.content=x,this.version=h,this.textFitWidth=b,this.textFitHeight=E}get tl(){return[this.paddedRect.x+lo,this.paddedRect.y+lo]}get br(){return[this.paddedRect.x+this.paddedRect.w-lo,this.paddedRect.y+this.paddedRect.h-lo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*lo)/this.pixelRatio,(this.paddedRect.h-2*lo)/this.pixelRatio]}}class Lb{constructor(r,l){const h={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(r,h,y),this.addImages(l,m,y);const{w:x,h:b}=Mb(y),E=new Bo({width:x||1,height:b||1});for(const k in r){const R=r[k],O=h[k].paddedRect;Bo.copy(R.data,E,{x:0,y:0},{x:O.x+lo,y:O.y+lo},R.data)}for(const k in l){const R=l[k],O=m[k].paddedRect,V=O.x+lo,$=O.y+lo,W=R.data.width,Z=R.data.height;Bo.copy(R.data,E,{x:0,y:0},{x:V,y:$},R.data),Bo.copy(R.data,E,{x:0,y:Z-1},{x:V,y:$-1},{width:W,height:1}),Bo.copy(R.data,E,{x:0,y:0},{x:V,y:$+Z},{width:W,height:1}),Bo.copy(R.data,E,{x:W-1,y:0},{x:V-1,y:$},{width:1,height:Z}),Bo.copy(R.data,E,{x:0,y:0},{x:V+W,y:$},{width:1,height:Z})}this.image=E,this.iconPositions=h,this.patternPositions=m}addImages(r,l,h){for(const m in r){const y=r[m],x={x:0,y:0,w:y.data.width+2*lo,h:y.data.height+2*lo};h.push(x),l[m]=new X_(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(r,l){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in r.updatedImages)this.patchUpdatedImage(this.iconPositions[h],r.getImage(h),l),this.patchUpdatedImage(this.patternPositions[h],r.getImage(h),l)}patchUpdatedImage(r,l,h){if(!r||!l||r.version===l.version)return;r.version=l.version;const[m,y]=r.tl;h.update(l.data,void 0,{x:m,y})}}var Pl;dt("ImagePosition",X_),dt("ImageAtlas",Lb),p.ah=void 0,(Pl=p.ah||(p.ah={}))[Pl.none=0]="none",Pl[Pl.horizontal=1]="horizontal",Pl[Pl.vertical=2]="vertical",Pl[Pl.horizontalOnly=3]="horizontalOnly";const fp=-17;class mp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,l){const h=new mp;return h.scale=r||1,h.fontStack=l,h}static forImage(r){const l=new mp;return l.imageName=r,l}}class ah{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,l){const h=new ah;for(let m=0;m<r.sections.length;m++){const y=r.sections[m];y.image?h.addImageSection(y):h.addTextSection(y,l)}return h}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let l="";for(let h=0;h<r.length;h++){const m=r.charCodeAt(h+1)||null,y=r.charCodeAt(h-1)||null;l+=m&&lm(m)&&!pp[r[h+1]]||y&&lm(y)&&!pp[r[h-1]]||!pp[r[h]]?r[h]:pp[r[h]]}return l}(this.text)}trim(){let r=0;for(let h=0;h<this.text.length&&Im[this.text.charCodeAt(h)];h++)r++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=r&&Im[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(r,l),this.sectionIndex=this.sectionIndex.slice(r,l)}substring(r,l){const h=new ah;return h.text=this.text.substring(r,l),h.sectionIndex=this.sectionIndex.slice(r,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,l)=>Math.max(r,this.sections[l].scale),0)}addTextSection(r,l){this.text+=r.text,this.sections.push(mp.forText(r.scale,r.fontStack||l));const h=this.sections.length-1;for(let m=0;m<r.text.length;++m)this.sectionIndex.push(h)}addImageSection(r){const l=r.image?r.image.name:"";if(l.length===0)return void se("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(mp.forImage(l)),this.sectionIndex.push(this.sections.length-1)):se("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Em(s,r,l,h,m,y,x,b,E,k,R,O,V,$,W){const Z=ah.fromFeature(s,m);let ce;O===p.ah.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:ge,processStyledBidirectionalText:ke}=sa;if(ge&&Z.sections.length===1){ce=[];const ze=ge(Z.toString(),Y_(Z,k,y,r,h,$));for(const qe of ze){const rt=new ah;rt.text=qe,rt.sections=Z.sections;for(let Et=0;Et<qe.length;Et++)rt.sectionIndex.push(0);ce.push(rt)}}else if(ke){ce=[];const ze=ke(Z.text,Z.sectionIndex,Y_(Z,k,y,r,h,$));for(const qe of ze){const rt=new ah;rt.text=qe[0],rt.sectionIndex=qe[1],rt.sections=Z.sections,ce.push(rt)}}else ce=function(ze,qe){const rt=[],Et=ze.text;let ot=0;for(const nt of qe)rt.push(ze.substring(ot,nt)),ot=nt;return ot<Et.length&&rt.push(ze.substring(ot,Et.length)),rt}(Z,Y_(Z,k,y,r,h,$));const xe=[],Ce={positionedLines:xe,text:Z.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:O,iconsInText:!1,verticalizable:!1};return function(ze,qe,rt,Et,ot,nt,vt,ft,ct,je,wt,_t){let Ft=0,Rn=fp,Cn=0,Br=0;const hs=ft==="right"?1:ft==="left"?0:.5;let fi=0;for(const ur of ot){ur.trim();const Vr=ur.getMaxScale(),Ci=(Vr-1)*Pr,mi={positionedGlyphs:[],lineOffset:0};ze.positionedLines[fi]=mi;const Gi=mi.positionedGlyphs;let gi=0;if(!ur.length()){Rn+=nt,++fi;continue}for(let uo=0;uo<ur.length();uo++){const dn=ur.getSection(uo),On=ur.getSectionIndex(uo),$n=ur.getCharCode(uo);let bo=0,er=null,hh=null,ca=null,ha=Pr;const ds=!(ct===p.ah.horizontal||!wt&&!Xd($n)||wt&&(Im[$n]||(lr=$n,st.Arabic(lr)||st["Arabic Supplement"](lr)||st["Arabic Extended-A"](lr)||st["Arabic Presentation Forms-A"](lr)||st["Arabic Presentation Forms-B"](lr))));if(dn.imageName){const Uo=Et[dn.imageName];if(!Uo)continue;ca=dn.imageName,ze.iconsInText=ze.iconsInText||!0,hh=Uo.paddedRect;const Xr=Uo.displaySize;dn.scale=dn.scale*Pr/_t,er={width:Xr[0],height:Xr[1],left:lo,top:-Rb,advance:ds?Xr[1]:Xr[0]},bo=Ci+(Pr-Xr[1]*dn.scale),ha=er.advance;const Za=ds?Xr[0]*dn.scale-Pr*Vr:Xr[1]*dn.scale-Pr*Vr;Za>0&&Za>gi&&(gi=Za)}else{const Uo=rt[dn.fontStack],Xr=Uo&&Uo[$n];if(Xr&&Xr.rect)hh=Xr.rect,er=Xr.metrics;else{const Za=qe[dn.fontStack],xp=Za&&Za[$n];if(!xp)continue;er=xp.metrics}bo=(Vr-dn.scale)*Pr}ds?(ze.verticalizable=!0,Gi.push({glyph:$n,imageName:ca,x:Ft,y:Rn+bo,vertical:ds,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:On,metrics:er,rect:hh}),Ft+=ha*dn.scale+je):(Gi.push({glyph:$n,imageName:ca,x:Ft,y:Rn+bo,vertical:ds,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:On,metrics:er,rect:hh}),Ft+=er.advance*dn.scale+je)}Gi.length!==0&&(Cn=Math.max(Ft-je,Cn),JR(Gi,0,Gi.length-1,hs,gi)),Ft=0;const jo=nt*Vr+gi;mi.lineOffset=Math.max(gi,Ci),Rn+=jo,Br=Math.max(jo,Br),++fi}var lr;const qi=Rn-fp,{horizontalAlign:Hi,verticalAlign:Wi}=Q_(vt);(function(ur,Vr,Ci,mi,Gi,gi,jo,uo,dn){const On=(Vr-Ci)*Gi;let $n=0;$n=gi!==jo?-uo*mi-fp:(-mi*dn+.5)*jo;for(const bo of ur)for(const er of bo.positionedGlyphs)er.x+=On,er.y+=$n})(ze.positionedLines,hs,Hi,Wi,Cn,Br,nt,qi,ot.length),ze.top+=-Wi*qi,ze.bottom=ze.top+qi,ze.left+=-Hi*Cn,ze.right=ze.left+Cn}(Ce,r,l,h,ce,x,b,E,O,k,V,W),!function(ze){for(const qe of ze)if(qe.positionedGlyphs.length!==0)return!1;return!0}(xe)&&Ce}const Im={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},XR={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},YR={40:!0};function Db(s,r,l,h,m,y){if(r.imageName){const x=h[r.imageName];return x?x.displaySize[0]*r.scale*Pr/y+m:0}{const x=l[r.fontStack],b=x&&x[s];return b?b.metrics.advance*r.scale+m:0}}function zb(s,r,l,h){const m=Math.pow(s-r,2);return h?s<r?m/2:2*m:m+Math.abs(l)*l}function QR(s,r,l){let h=0;return s===10&&(h-=1e4),l&&(h+=150),s!==40&&s!==65288||(h+=50),r!==41&&r!==65289||(h+=50),h}function Ob(s,r,l,h,m,y){let x=null,b=zb(r,l,m,y);for(const E of h){const k=zb(r-E.x,l,m,y)+E.badness;k<=b&&(x=E,b=k)}return{index:s,x:r,priorBreak:x,badness:b}}function Fb(s){return s?Fb(s.priorBreak).concat(s.index):[]}function Y_(s,r,l,h,m,y){if(!s)return[];const x=[],b=function(O,V,$,W,Z,ce){let ge=0;for(let ke=0;ke<O.length();ke++){const xe=O.getSection(ke);ge+=Db(O.getCharCode(ke),xe,W,Z,V,ce)}return ge/Math.max(1,Math.ceil(ge/$))}(s,r,l,h,m,y),E=s.text.indexOf("")>=0;let k=0;for(let O=0;O<s.length();O++){const V=s.getSection(O),$=s.getCharCode(O);if(Im[$]||(k+=Db($,V,h,m,r,y)),O<s.length()-1){const W=!((R=$)<11904||!(st["Bopomofo Extended"](R)||st.Bopomofo(R)||st["CJK Compatibility Forms"](R)||st["CJK Compatibility Ideographs"](R)||st["CJK Compatibility"](R)||st["CJK Radicals Supplement"](R)||st["CJK Strokes"](R)||st["CJK Symbols and Punctuation"](R)||st["CJK Unified Ideographs Extension A"](R)||st["CJK Unified Ideographs"](R)||st["Enclosed CJK Letters and Months"](R)||st["Halfwidth and Fullwidth Forms"](R)||st.Hiragana(R)||st["Ideographic Description Characters"](R)||st["Kangxi Radicals"](R)||st["Katakana Phonetic Extensions"](R)||st.Katakana(R)||st["Vertical Forms"](R)||st["Yi Radicals"](R)||st["Yi Syllables"](R)));(XR[$]||W||V.imageName||O!==s.length()-2&&YR[s.getCharCode(O+1)])&&x.push(Ob(O+1,k,b,x,QR($,s.getCharCode(O+1),W&&E),!1))}}var R;return Fb(Ob(s.length(),k,b,x,0,!0))}function Q_(s){let r=.5,l=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:r,verticalAlign:l}}function JR(s,r,l,h,m){if(!h&&!m)return;const y=s[l],x=(s[l].x+y.metrics.advance*y.scale)*h;for(let b=r;b<=l;b++)s[b].x-=x,s[b].y+=m}function eM(s,r,l){const{horizontalAlign:h,verticalAlign:m}=Q_(l),y=r[0]-s.displaySize[0]*h,x=r[1]-s.displaySize[1]*m;return{image:s,top:x,bottom:x+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function Nb(s){var r,l;let h=s.left,m=s.top,y=s.right-h,x=s.bottom-m;const b=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",E=(l=s.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",k=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(E==="proportional"){if(b==="stretchOnly"&&y/x<k||b==="proportional"){const R=Math.ceil(x*k);h*=R/y,y=R}}else if(b==="proportional"&&E==="stretchOnly"&&k!==0&&y/x>k){const R=Math.ceil(y/k);m*=R/x,x=R}return{x1:h,y1:m,x2:h+y,y2:m+x}}function Bb(s,r,l,h,m,y){const x=s.image;let b;if(x.content){const ce=x.content,ge=x.pixelRatio||1;b=[ce[0]/ge,ce[1]/ge,x.displaySize[0]-ce[2]/ge,x.displaySize[1]-ce[3]/ge]}const E=r.left*y,k=r.right*y;let R,O,V,$;l==="width"||l==="both"?($=m[0]+E-h[3],O=m[0]+k+h[1]):($=m[0]+(E+k-x.displaySize[0])/2,O=$+x.displaySize[0]);const W=r.top*y,Z=r.bottom*y;return l==="height"||l==="both"?(R=m[1]+W-h[0],V=m[1]+Z+h[2]):(R=m[1]+(W+Z-x.displaySize[1])/2,V=R+x.displaySize[1]),{image:x,top:R,right:O,bottom:V,left:$,collisionPadding:b}}const gp=255,ua=128,Rl=gp*ua;function Vb(s,r){const{expression:l}=r;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new zn(s+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=l;let y=0;for(;y<h.length&&h[y]<=s;)y++;y=Math.max(0,y-1);let x=y;for(;x<h.length&&h[x]<s+1;)x++;x=Math.min(h.length-1,x);const b=h[y],E=h[x];return l.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:E,minSize:l.evaluate(new zn(b)),maxSize:l.evaluate(new zn(E)),interpolationType:m}}}function J_(s,r,l){let h="never";const m=s.get(r);return m?h=m:s.get(l)&&(h="always"),h}const tM=kl.VectorTileFeature.types,nM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cm(s,r,l,h,m,y,x,b,E,k,R,O,V){const $=b?Math.min(Rl,Math.round(b[0])):0,W=b?Math.min(Rl,Math.round(b[1])):0;s.emplaceBack(r,l,Math.round(32*h),Math.round(32*m),y,x,($<<1)+(E?1:0),W,16*k,16*R,256*O,256*V)}function e0(s,r,l){s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l)}function rM(s){for(const r of s.sections)if(Yd(r.text))return!0;return!1}class t0{constructor(r){this.layoutVertexArray=new No,this.indexArray=new Nr,this.programConfigurations=r,this.segments=new kr,this.dynamicLayoutVertexArray=new aa,this.opacityVertexArray=new El,this.hasVisibleVertices=!1,this.placedSymbolArray=new jn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,l,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,LR.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,DR.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,nM,!0),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}dt("SymbolBuffers",t0);class n0{constructor(r,l,h){this.layoutVertexArray=new r,this.layoutAttributes=l,this.indexArray=new h,this.segments=new kr,this.collisionVertexArray=new di}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,zR.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}dt("CollisionBuffers",n0);class lh{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=D_([]),this.placementViewportMatrix=D_([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vb(this.zoom,l["text-size"]),this.iconSizeData=Vb(this.zoom,l["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=J_(h,"text-overlap","text-allow-overlap")!=="never"||J_(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(x=>p.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new t0(new ju(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new t0(new ju(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new Un,this.lineVertexArray=new Ui,this.symbolInstances=new Oo,this.textAnchorOffsets=new ui}calculateGlyphDependencies(r,l,h,m,y){for(let x=0;x<r.length;x++)if(l[r.charCodeAt(x)]=!0,(h||m)&&y){const b=pp[r.charAt(x)];b&&(l[b.charCodeAt(0)]=!0)}}populate(r,l,h){const m=this.layers[0],y=m.layout,x=y.get("text-font"),b=y.get("text-field"),E=y.get("icon-image"),k=(b.value.kind!=="constant"||b.value.value instanceof Ar&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),R=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,O=y.get("symbol-sort-key");if(this.features=[],!k&&!R)return;const V=l.iconDependencies,$=l.glyphDependencies,W=l.availableImages,Z=new zn(this.zoom);for(const{feature:ce,id:ge,index:ke,sourceLayerIndex:xe}of r){const Ce=m._featureFilter.needGeometry,ze=$u(ce,Ce);if(!m._featureFilter.filter(Z,ze,h))continue;let qe,rt;if(Ce||(ze.geometry=Uu(ce)),k){const ot=m.getValueAndResolveTokens("text-field",ze,h,W),nt=Ar.factory(ot),vt=this.hasRTLText=this.hasRTLText||rM(nt);(!vt||sa.getRTLTextPluginStatus()==="unavailable"||vt&&sa.isParsed())&&(qe=FR(nt,m,ze))}if(R){const ot=m.getValueAndResolveTokens("icon-image",ze,h,W);rt=ot instanceof Si?ot:Si.fromString(ot)}if(!qe&&!rt)continue;const Et=this.sortFeaturesByKey?O.evaluate(ze,{},h):void 0;if(this.features.push({id:ge,text:qe,icon:rt,index:ke,sourceLayerIndex:xe,geometry:ze.geometry,properties:ce.properties,type:tM[ce.type],sortKey:Et}),rt&&(V[rt.name]=!0),qe){const ot=x.evaluate(ze,{},h).join(","),nt=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(p.ah.vertical)>=0;for(const vt of qe.sections)if(vt.image)V[vt.image.name]=!0;else{const ft=Zd(qe.toString()),ct=vt.fontStack||ot,je=$[ct]=$[ct]||{};this.calculateGlyphDependencies(vt.text,je,nt,this.allowVerticalPlacement,ft)}}}y.get("symbol-placement")==="line"&&(this.features=function(ce){const ge={},ke={},xe=[];let Ce=0;function ze(ot){xe.push(ce[ot]),Ce++}function qe(ot,nt,vt){const ft=ke[ot];return delete ke[ot],ke[nt]=ft,xe[ft].geometry[0].pop(),xe[ft].geometry[0]=xe[ft].geometry[0].concat(vt[0]),ft}function rt(ot,nt,vt){const ft=ge[nt];return delete ge[nt],ge[ot]=ft,xe[ft].geometry[0].shift(),xe[ft].geometry[0]=vt[0].concat(xe[ft].geometry[0]),ft}function Et(ot,nt,vt){const ft=vt?nt[0][nt[0].length-1]:nt[0][0];return`${ot}:${ft.x}:${ft.y}`}for(let ot=0;ot<ce.length;ot++){const nt=ce[ot],vt=nt.geometry,ft=nt.text?nt.text.toString():null;if(!ft){ze(ot);continue}const ct=Et(ft,vt),je=Et(ft,vt,!0);if(ct in ke&&je in ge&&ke[ct]!==ge[je]){const wt=rt(ct,je,vt),_t=qe(ct,je,xe[wt].geometry);delete ge[ct],delete ke[je],ke[Et(ft,xe[_t].geometry,!0)]=_t,xe[wt].geometry=null}else ct in ke?qe(ct,je,vt):je in ge?rt(ct,je,vt):(ze(ot),ge[ct]=Ce-1,ke[je]=Ce-1)}return xe.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,ge)=>ce.sortKey-ge.sortKey)}update(r,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,l,this.layers,h),this.icon.programConfigurations.updatePaintArrays(r,l,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,l){const h=this.lineVertexArray.length;if(r.segment!==void 0){let m=r.dist(l[r.segment+1]),y=r.dist(l[r.segment]);const x={};for(let b=r.segment+1;b<l.length;b++)x[b]={x:l[b].x,y:l[b].y,tileUnitDistanceFromAnchor:m},b<l.length-1&&(m+=l[b+1].dist(l[b]));for(let b=r.segment||0;b>=0;b--)x[b]={x:l[b].x,y:l[b].y,tileUnitDistanceFromAnchor:y},b>0&&(y+=l[b-1].dist(l[b]));for(let b=0;b<l.length;b++){const E=x[b];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(r,l,h,m,y,x,b,E,k,R,O,V){const $=r.indexArray,W=r.layoutVertexArray,Z=r.segments.prepareSegment(4*l.length,W,$,this.canOverlap?x.sortKey:void 0),ce=this.glyphOffsetArray.length,ge=Z.vertexLength,ke=this.allowVerticalPlacement&&b===p.ah.vertical?Math.PI/2:0,xe=x.text&&x.text.sections;for(let Ce=0;Ce<l.length;Ce++){const{tl:ze,tr:qe,bl:rt,br:Et,tex:ot,pixelOffsetTL:nt,pixelOffsetBR:vt,minFontScaleX:ft,minFontScaleY:ct,glyphOffset:je,isSDF:wt,sectionIndex:_t}=l[Ce],Ft=Z.vertexLength,Rn=je[1];Cm(W,E.x,E.y,ze.x,Rn+ze.y,ot.x,ot.y,h,wt,nt.x,nt.y,ft,ct),Cm(W,E.x,E.y,qe.x,Rn+qe.y,ot.x+ot.w,ot.y,h,wt,vt.x,nt.y,ft,ct),Cm(W,E.x,E.y,rt.x,Rn+rt.y,ot.x,ot.y+ot.h,h,wt,nt.x,vt.y,ft,ct),Cm(W,E.x,E.y,Et.x,Rn+Et.y,ot.x+ot.w,ot.y+ot.h,h,wt,vt.x,vt.y,ft,ct),e0(r.dynamicLayoutVertexArray,E,ke),$.emplaceBack(Ft,Ft+1,Ft+2),$.emplaceBack(Ft+1,Ft+2,Ft+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(je[0]),Ce!==l.length-1&&_t===l[Ce+1].sectionIndex||r.programConfigurations.populatePaintArrays(W.length,x,x.index,{},V,xe&&xe[_t])}r.placedSymbolArray.emplaceBack(E.x,E.y,ce,this.glyphOffsetArray.length-ce,ge,k,R,E.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],b,0,!1,0,O)}_addCollisionDebugVertex(r,l,h,m,y,x){return l.emplaceBack(0,0),r.emplaceBack(h.x,h.y,m,y,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,l,h,m,y,x,b){const E=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=E.vertexLength,R=y.layoutVertexArray,O=y.collisionVertexArray,V=b.anchorX,$=b.anchorY;this._addCollisionDebugVertex(R,O,x,V,$,new L(r,l)),this._addCollisionDebugVertex(R,O,x,V,$,new L(h,l)),this._addCollisionDebugVertex(R,O,x,V,$,new L(h,m)),this._addCollisionDebugVertex(R,O,x,V,$,new L(r,m)),E.vertexLength+=4;const W=y.indexArray;W.emplaceBack(k,k+1),W.emplaceBack(k+1,k+2),W.emplaceBack(k+2,k+3),W.emplaceBack(k+3,k),E.primitiveLength+=4}addDebugCollisionBoxes(r,l,h,m){for(let y=r;y<l;y++){const x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,m?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new n0(hi,Sb.members,Xn),this.iconCollisionBox=new n0(hi,Sb.members,Xn);for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(r,l,h,m,y,x,b,E,k){const R={};for(let O=l;O<h;O++){const V=r.get(O);R.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},R.textFeatureIndex=V.featureIndex;break}for(let O=m;O<y;O++){const V=r.get(O);R.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},R.verticalTextFeatureIndex=V.featureIndex;break}for(let O=x;O<b;O++){const V=r.get(O);R.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},R.iconFeatureIndex=V.featureIndex;break}for(let O=E;O<k;O++){const V=r.get(O);R.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},R.verticalIconFeatureIndex=V.featureIndex;break}return R}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,l){const h=r.placedSymbolArray.get(l),m=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<m;y+=4)r.indexArray.emplaceBack(y,y+1,y+2),r.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(r),h=Math.cos(r),m=[],y=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const E=this.symbolInstances.get(b);m.push(0|Math.round(l*E.anchorX+h*E.anchorY)),y.push(E.featureIndex)}return x.sort((b,E)=>m[b]-m[E]||y[E]-y[b]),x}addToSortKeyRanges(r,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((m,y,x)=>{m>=0&&x.indexOf(m)===y&&this.addIndicesForPlacedSymbol(this.text,m)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let jb,Ub;dt("SymbolBucket",lh,{omit:["layers","collisionBoxArray","features","compareText"]}),lh.MAX_GLYPHS=65535,lh.addDynamicAttributes=e0;var r0={get paint(){return Ub=Ub||new f({"icon-opacity":new Ct(Oe.paint_symbol["icon-opacity"]),"icon-color":new Ct(Oe.paint_symbol["icon-color"]),"icon-halo-color":new Ct(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ct(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ct(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new xt(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new xt(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ct(Oe.paint_symbol["text-opacity"]),"text-color":new Ct(Oe.paint_symbol["text-color"],{runtimeType:Cr,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Ct(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new Ct(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new Ct(Oe.paint_symbol["text-halo-blur"]),"text-translate":new xt(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new xt(Oe.paint_symbol["text-translate-anchor"])})},get layout(){return jb=jb||new f({"symbol-placement":new xt(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new xt(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xt(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ct(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xt(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xt(Oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new xt(Oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new xt(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new xt(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xt(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ct(Oe.layout_symbol["icon-size"]),"icon-text-fit":new xt(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xt(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ct(Oe.layout_symbol["icon-image"]),"icon-rotate":new Ct(Oe.layout_symbol["icon-rotate"]),"icon-padding":new Ct(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new xt(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new Ct(Oe.layout_symbol["icon-offset"]),"icon-anchor":new Ct(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xt(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xt(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xt(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new Ct(Oe.layout_symbol["text-field"]),"text-font":new Ct(Oe.layout_symbol["text-font"]),"text-size":new Ct(Oe.layout_symbol["text-size"]),"text-max-width":new Ct(Oe.layout_symbol["text-max-width"]),"text-line-height":new xt(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new Ct(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new Ct(Oe.layout_symbol["text-justify"]),"text-radial-offset":new Ct(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xt(Oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ct(Oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ct(Oe.layout_symbol["text-anchor"]),"text-max-angle":new xt(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new xt(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new Ct(Oe.layout_symbol["text-rotate"]),"text-padding":new xt(Oe.layout_symbol["text-padding"]),"text-keep-upright":new xt(Oe.layout_symbol["text-keep-upright"]),"text-transform":new Ct(Oe.layout_symbol["text-transform"]),"text-offset":new Ct(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new xt(Oe.layout_symbol["text-allow-overlap"]),"text-overlap":new xt(Oe.layout_symbol["text-overlap"]),"text-ignore-placement":new xt(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new xt(Oe.layout_symbol["text-optional"])})}};class $b{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:bi,this.defaultValue=r}evaluate(r){if(r.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(r.formattedSection))return l.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dt("FormatSectionOverride",$b,{omit:["defaultValue"]});class Am extends v{constructor(r){super(r,r0)}recalculate(r,l){if(super.recalculate(r,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const y of h)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,l,h,m){const y=this.layout.get(r).evaluate(l,{},h,m),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||Nc(x.value)||!y?y:function(b,E){return E.replace(/{([^{}]+)}/g,(k,R)=>b&&R in b?String(b[R]):"")}(l.properties,y)}createBucket(r){return new lh(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of r0.paint.overridableProperties){if(!Am.hasPaintOverride(this.layout,r))continue;const l=this.paint.get(r),h=new $b(l),m=new zd(h,l.property.specification);let y=null;y=l.value.kind==="constant"||l.value.kind==="source"?new Od("source",m):new Fd("composite",m,l.value.zoomStops),this.paint._values[r]=new cs(l.property,y,l.parameters)}}_handleOverridablePaintPropertyUpdate(r,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&Am.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,l){const h=r.get("text-field"),m=r0.paint.properties[l];let y=!1;const x=b=>{for(const E of b)if(m.overrides&&m.overrides.hasOverride(E))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Ar)x(h.value.value.sections);else if(h.value.kind==="source"){const b=k=>{y||(k instanceof es&&Zn(k.value)===Ni?x(k.value.sections):k instanceof Ys?x(k.sections):k.eachChild(b))},E=h.value;E._styleExpression&&b(E._styleExpression.expression)}return y}}let qb;var iM={get paint(){return qb=qb||new f({"background-color":new xt(Oe.paint_background["background-color"]),"background-pattern":new i(Oe.paint_background["background-pattern"]),"background-opacity":new xt(Oe.paint_background["background-opacity"])})}};class oM extends v{constructor(r){super(r,iM)}}let Hb;var sM={get paint(){return Hb=Hb||new f({"raster-opacity":new xt(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new xt(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xt(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xt(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new xt(Oe.paint_raster["raster-saturation"]),"raster-contrast":new xt(Oe.paint_raster["raster-contrast"]),"raster-resampling":new xt(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new xt(Oe.paint_raster["raster-fade-duration"])})}};class aM extends v{constructor(r){super(r,sM)}}class lM extends v{constructor(r){super(r,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class uM{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const i0=63710088e-1;class Ml{constructor(r,l){if(isNaN(r)||isNaN(l))throw new Error(`Invalid LngLat object: (${r}, ${l})`);if(this.lng=+r,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ml(Me(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const l=Math.PI/180,h=this.lat*l,m=r.lat*l,y=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((r.lng-this.lng)*l);return i0*Math.acos(Math.min(y,1))}static convert(r){if(r instanceof Ml)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new Ml(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new Ml(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Wb=2*Math.PI*i0;function Gb(s){return Wb*Math.cos(s*Math.PI/180)}function Kb(s){return(180+s)/360}function Zb(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Xb(s,r){return s/Gb(r)}function o0(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class km{constructor(r,l,h=0){this.x=+r,this.y=+l,this.z=+h}static fromLngLat(r,l=0){const h=Ml.convert(r);return new km(Kb(h.lng),Zb(h.lat),Xb(l,h.lat))}toLngLat(){return new Ml(360*this.x-180,o0(this.y))}toAltitude(){return this.z*Gb(o0(this.y))}meterInMercatorCoordinateUnits(){return 1/Wb*(r=o0(this.y),1/Math.cos(r*Math.PI/180));var r}}function Yb(s,r,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[s*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}class s0{constructor(r,l,h){if(r<0||r>25||h<0||h>=Math.pow(2,r)||l<0||l>=Math.pow(2,r))throw new Error(`x=${l}, y=${h}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=l,this.y=h,this.key=yp(0,r,r,l,h)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,l,h){const m=(x=this.y,b=this.z,E=Yb(256*(y=this.x),256*(x=Math.pow(2,b)-x-1),b),k=Yb(256*(y+1),256*(x+1),b),E[0]+","+E[1]+","+k[0]+","+k[1]);var y,x,b,E,k;const R=function(O,V,$){let W,Z="";for(let ce=O;ce>0;ce--)W=1<<ce-1,Z+=(V&W?1:0)+($&W?2:0);return Z}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,m)}isChildOf(r){const l=this.z-r.z;return l>0&&r.x===this.x>>l&&r.y===this.y>>l}getTilePoint(r){const l=Math.pow(2,this.z);return new L((r.x*l-this.x)*br,(r.y*l-this.y)*br)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qb{constructor(r,l){this.wrap=r,this.canonical=l,this.key=yp(r,l.z,l.z,l.x,l.y)}}class Vo{constructor(r,l,h,m,y){if(r<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${h}`);this.overscaledZ=r,this.wrap=l,this.canonical=new s0(h,+m,+y),this.key=yp(l,r,h,m,y)}clone(){return new Vo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-r;return r>this.canonical.z?new Vo(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Vo(r,this.wrap,r,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(r,l){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-r;return r>this.canonical.z?yp(this.wrap*+l,r,this.canonical.z,this.canonical.x,this.canonical.y):yp(this.wrap*+l,r,r,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const l=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>l&&r.canonical.y===this.canonical.y>>l}children(r){if(this.overscaledZ>=r)return[new Vo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new Vo(l,this.wrap,l,h,m),new Vo(l,this.wrap,l,h+1,m),new Vo(l,this.wrap,l,h,m+1),new Vo(l,this.wrap,l,h+1,m+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Vo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Vo(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new km(r.x-this.wrap,r.y))}}function yp(s,r,l,h,m){(s*=2)<0&&(s=-1*s-1);const y=1<<l;return(y*y*s+y*m+h).toString(36)+l.toString(36)+r.toString(36)}dt("CanonicalTileID",s0),dt("OverscaledTileID",Vo,{omit:["posMatrix"]});class Jb{constructor(r,l,h,m=1,y=1,x=1,b=0){if(this.uid=r,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void se(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const E=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=y,this.blueFactor=x,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<E;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(E,k)]=this.data[this._idx(E-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,E)]=this.data[this._idx(k,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<E;k++)for(let R=0;R<E;R++){const O=this.get(k,R);O>this.max&&(this.max=O),O<this.min&&(this.min=O)}}get(r,l){const h=new Uint8Array(this.data.buffer),m=4*this._idx(r,l);return this.unpack(h[m],h[m+1],h[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,l){if(r<-1||r>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(r+1)}unpack(r,l,h){return r*this.redFactor+l*this.greenFactor+h*this.blueFactor-this.baseShift}getPixels(){return new Bo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,l,h){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,y=l*this.dim+this.dim,x=h*this.dim,b=h*this.dim+this.dim;switch(l){case-1:m=y-1;break;case 1:y=m+1}switch(h){case-1:x=b-1;break;case 1:b=x+1}const E=-l*this.dim,k=-h*this.dim;for(let R=x;R<b;R++)for(let O=m;O<y;O++)this.data[this._idx(O,R)]=r.data[this._idx(O+E,R+k)]}}dt("DEMData",Jb);class e2{constructor(r){this._stringToNumber={},this._numberToString=[];for(let l=0;l<r.length;l++){const h=r[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class t2{constructor(r,l,h,m,y){this.type="Feature",this._vectorTileFeature=r,r._z=l,r._x=h,r._y=m,this.properties=r.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(r[l]=this[l]);return r}}class n2{constructor(r,l){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Fu(br,16,0),this.grid3D=new Fu(br,16,0),this.featureIndexArray=new Fo,this.promoteId=l}insert(r,l,h,m,y,x){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,y);const E=x?this.grid3D:this.grid;for(let k=0;k<l.length;k++){const R=l[k],O=[1/0,1/0,-1/0,-1/0];for(let V=0;V<R.length;V++){const $=R[V];O[0]=Math.min(O[0],$.x),O[1]=Math.min(O[1],$.y),O[2]=Math.max(O[2],$.x),O[3]=Math.max(O[3],$.y)}O[0]<br&&O[1]<br&&O[2]>=0&&O[3]>=0&&E.insert(b,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new kl.VectorTile(new K_(this.rawTileData)).layers,this.sourceLayerCoder=new e2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,l,h,m){this.loadVTLayers();const y=r.params||{},x=br/r.tileSize/r.scale,b=Nd(y.filter),E=r.queryGeometry,k=r.queryPadding*x,R=i2(E),O=this.grid.query(R.minX-k,R.minY-k,R.maxX+k,R.maxY+k),V=i2(r.cameraQueryGeometry),$=this.grid3D.query(V.minX-k,V.minY-k,V.maxX+k,V.maxY+k,(ce,ge,ke,xe)=>function(Ce,ze,qe,rt,Et){for(const nt of Ce)if(ze<=nt.x&&qe<=nt.y&&rt>=nt.x&&Et>=nt.y)return!0;const ot=[new L(ze,qe),new L(ze,Et),new L(rt,Et),new L(rt,qe)];if(Ce.length>2){for(const nt of ot)if(th(Ce,nt))return!0}for(let nt=0;nt<Ce.length-1;nt++)if($5(Ce[nt],Ce[nt+1],ot))return!0;return!1}(r.cameraQueryGeometry,ce-k,ge-k,ke+k,xe+k));for(const ce of $)O.push(ce);O.sort(cM);const W={};let Z;for(let ce=0;ce<O.length;ce++){const ge=O[ce];if(ge===Z)continue;Z=ge;const ke=this.featureIndexArray.get(ge);let xe=null;this.loadMatchingFeature(W,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,b,y.layers,y.availableImages,l,h,m,(Ce,ze,qe)=>(xe||(xe=Uu(Ce)),ze.queryIntersectsFeature(E,Ce,qe,xe,this.z,r.transform,x,r.pixelPosMatrix)))}return W}loadMatchingFeature(r,l,h,m,y,x,b,E,k,R,O){const V=this.bucketLayerIDs[l];if(x&&!function(ce,ge){for(let ke=0;ke<ce.length;ke++)if(ge.indexOf(ce[ke])>=0)return!0;return!1}(x,V))return;const $=this.sourceLayerCoder.decode(h),W=this.vtLayers[$].feature(m);if(y.needGeometry){const ce=$u(W,!0);if(!y.filter(new zn(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!y.filter(new zn(this.tileID.overscaledZ),W))return;const Z=this.getId(W,$);for(let ce=0;ce<V.length;ce++){const ge=V[ce];if(x&&x.indexOf(ge)<0)continue;const ke=E[ge];if(!ke)continue;let xe={};Z&&R&&(xe=R.getState(ke.sourceLayer||"_geojsonTileLayer",Z));const Ce=J({},k[ge]);Ce.paint=r2(Ce.paint,ke.paint,W,xe,b),Ce.layout=r2(Ce.layout,ke.layout,W,xe,b);const ze=!O||O(W,ke,xe);if(!ze)continue;const qe=new t2(W,this.z,this.x,this.y,Z);qe.layer=Ce;let rt=r[ge];rt===void 0&&(rt=r[ge]=[]),rt.push({featureIndex:m,feature:qe,intersectionZ:ze})}}lookupSymbolFeatures(r,l,h,m,y,x,b,E){const k={};this.loadVTLayers();const R=Nd(y);for(const O of r)this.loadMatchingFeature(k,h,m,O,R,x,b,E,l);return k}hasLayer(r){for(const l of this.bucketLayerIDs)for(const h of l)if(r===h)return!0;return!1}getId(r,l){let h=r.id;return this.promoteId&&(h=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof h=="boolean"&&(h=Number(h))),h}}function r2(s,r,l,h,m){return Y(s,(y,x)=>{const b=r instanceof Kc?r.get(x):null;return b&&b.evaluate?b.evaluate(l,h,m):b})}function i2(s){let r=1/0,l=1/0,h=-1/0,m=-1/0;for(const y of s)r=Math.min(r,y.x),l=Math.min(l,y.y),h=Math.max(h,y.x),m=Math.max(m,y.y);return{minX:r,minY:l,maxX:h,maxY:m}}function cM(s,r){return r-s}function o2(s,r,l,h,m){const y=[];for(let x=0;x<s.length;x++){const b=s[x];let E;for(let k=0;k<b.length-1;k++){let R=b[k],O=b[k+1];R.x<r&&O.x<r||(R.x<r?R=new L(r,R.y+(r-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x<r&&(O=new L(r,R.y+(r-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y<l&&O.y<l||(R.y<l?R=new L(R.x+(l-R.y)/(O.y-R.y)*(O.x-R.x),l)._round():O.y<l&&(O=new L(R.x+(l-R.y)/(O.y-R.y)*(O.x-R.x),l)._round()),R.x>=h&&O.x>=h||(R.x>=h?R=new L(h,R.y+(h-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x>=h&&(O=new L(h,R.y+(h-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y>=m&&O.y>=m||(R.y>=m?R=new L(R.x+(m-R.y)/(O.y-R.y)*(O.x-R.x),m)._round():O.y>=m&&(O=new L(R.x+(m-R.y)/(O.y-R.y)*(O.x-R.x),m)._round()),E&&R.equals(E[E.length-1])||(E=[R],y.push(E)),E.push(O)))))}}return y}dt("FeatureIndex",n2,{omit:["rawTileData","sourceLayerCoder"]});class Ll extends L{constructor(r,l,h,m){super(r,l),this.angle=h,m!==void 0&&(this.segment=m)}clone(){return new Ll(this.x,this.y,this.angle,this.segment)}}function s2(s,r,l,h,m){if(r.segment===void 0||l===0)return!0;let y=r,x=r.segment+1,b=0;for(;b>-l/2;){if(x--,x<0)return!1;b-=s[x].dist(y),y=s[x]}b+=s[x].dist(s[x+1]),x++;const E=[];let k=0;for(;b<l/2;){const R=s[x],O=s[x+1];if(!O)return!1;let V=s[x-1].angleTo(R)-R.angleTo(O);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:V}),k+=V;b-E[0].distance>h;)k-=E.shift().angleDelta;if(k>m)return!1;x++,b+=R.dist(O)}return!0}function a2(s){let r=0;for(let l=0;l<s.length-1;l++)r+=s[l].dist(s[l+1]);return r}function l2(s,r,l){return s?.6*r*l:0}function u2(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function hM(s,r,l,h,m,y){const x=l2(l,m,y),b=u2(l,h)*y;let E=0;const k=a2(s)/2;for(let R=0;R<s.length-1;R++){const O=s[R],V=s[R+1],$=O.dist(V);if(E+$>k){const W=(k-E)/$,Z=Or.number(O.x,V.x,W),ce=Or.number(O.y,V.y,W),ge=new Ll(Z,ce,V.angleTo(O),R);return ge._round(),!x||s2(s,ge,b,x,r)?ge:void 0}E+=$}}function dM(s,r,l,h,m,y,x,b,E){const k=l2(h,y,x),R=u2(h,m),O=R*x,V=s[0].x===0||s[0].x===E||s[0].y===0||s[0].y===E;return r-O<r/4&&(r=O+r/4),c2(s,V?r/2*b%r:(R/2+2*y)*x*b%r,r,k,l,O,V,!1,E)}function c2(s,r,l,h,m,y,x,b,E){const k=y/2,R=a2(s);let O=0,V=r-l,$=[];for(let W=0;W<s.length-1;W++){const Z=s[W],ce=s[W+1],ge=Z.dist(ce),ke=ce.angleTo(Z);for(;V+l<O+ge;){V+=l;const xe=(V-O)/ge,Ce=Or.number(Z.x,ce.x,xe),ze=Or.number(Z.y,ce.y,xe);if(Ce>=0&&Ce<E&&ze>=0&&ze<E&&V-k>=0&&V+k<=R){const qe=new Ll(Ce,ze,ke,W);qe._round(),h&&!s2(s,qe,y,h,m)||$.push(qe)}}O+=ge}return b||$.length||x||($=c2(s,O/2,l,h,m,y,x,!0,E)),$}dt("Anchor",Ll);const uh=lo;function h2(s,r,l,h){const m=[],y=s.image,x=y.pixelRatio,b=y.paddedRect.w-2*uh,E=y.paddedRect.h-2*uh;let k={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const R=y.stretchX||[[0,b]],O=y.stretchY||[[0,E]],V=(je,wt)=>je+wt[1]-wt[0],$=R.reduce(V,0),W=O.reduce(V,0),Z=b-$,ce=E-W;let ge=0,ke=$,xe=0,Ce=W,ze=0,qe=Z,rt=0,Et=ce;if(y.content&&h){const je=y.content,wt=je[2]-je[0],_t=je[3]-je[1];(y.textFitWidth||y.textFitHeight)&&(k=Nb(s)),ge=Pm(R,0,je[0]),xe=Pm(O,0,je[1]),ke=Pm(R,je[0],je[2]),Ce=Pm(O,je[1],je[3]),ze=je[0]-ge,rt=je[1]-xe,qe=wt-ke,Et=_t-Ce}const ot=k.x1,nt=k.y1,vt=k.x2-ot,ft=k.y2-nt,ct=(je,wt,_t,Ft)=>{const Rn=Rm(je.stretch-ge,ke,vt,ot),Cn=Mm(je.fixed-ze,qe,je.stretch,$),Br=Rm(wt.stretch-xe,Ce,ft,nt),hs=Mm(wt.fixed-rt,Et,wt.stretch,W),fi=Rm(_t.stretch-ge,ke,vt,ot),lr=Mm(_t.fixed-ze,qe,_t.stretch,$),qi=Rm(Ft.stretch-xe,Ce,ft,nt),Hi=Mm(Ft.fixed-rt,Et,Ft.stretch,W),Wi=new L(Rn,Br),ur=new L(fi,Br),Vr=new L(fi,qi),Ci=new L(Rn,qi),mi=new L(Cn/x,hs/x),Gi=new L(lr/x,Hi/x),gi=r*Math.PI/180;if(gi){const dn=Math.sin(gi),On=Math.cos(gi),$n=[On,-dn,dn,On];Wi._matMult($n),ur._matMult($n),Ci._matMult($n),Vr._matMult($n)}const jo=je.stretch+je.fixed,uo=wt.stretch+wt.fixed;return{tl:Wi,tr:ur,bl:Ci,br:Vr,tex:{x:y.paddedRect.x+uh+jo,y:y.paddedRect.y+uh+uo,w:_t.stretch+_t.fixed-jo,h:Ft.stretch+Ft.fixed-uo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mi,pixelOffsetBR:Gi,minFontScaleX:qe/x/vt,minFontScaleY:Et/x/ft,isSDF:l}};if(h&&(y.stretchX||y.stretchY)){const je=d2(R,Z,$),wt=d2(O,ce,W);for(let _t=0;_t<je.length-1;_t++){const Ft=je[_t],Rn=je[_t+1];for(let Cn=0;Cn<wt.length-1;Cn++)m.push(ct(Ft,wt[Cn],Rn,wt[Cn+1]))}}else m.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return m}function Pm(s,r,l){let h=0;for(const m of s)h+=Math.max(r,Math.min(l,m[1]))-Math.max(r,Math.min(l,m[0]));return h}function d2(s,r,l){const h=[{fixed:-uh,stretch:0}];for(const[m,y]of s){const x=h[h.length-1];h.push({fixed:m-x.stretch,stretch:x.stretch}),h.push({fixed:m-x.stretch,stretch:x.stretch+(y-m)})}return h.push({fixed:r+uh,stretch:l}),h}function Rm(s,r,l,h){return s/r*l+h}function Mm(s,r,l,h){return s-r*l/h}class Lm{constructor(r,l,h,m,y,x,b,E,k,R){var O;if(this.boxStartIndex=r.length,k){let V=x.top,$=x.bottom;const W=x.collisionPadding;W&&(V-=W[1],$+=W[3]);let Z=$-V;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const V=!((O=x.image)===null||O===void 0)&&O.content&&(x.image.textFitWidth||x.image.textFitHeight)?Nb(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};V.y1=V.y1*b-E[0],V.y2=V.y2*b+E[2],V.x1=V.x1*b-E[3],V.x2=V.x2*b+E[1];const $=x.collisionPadding;if($&&(V.x1-=$[0]*b,V.y1-=$[1]*b,V.x2+=$[2]*b,V.y2+=$[3]*b),R){const W=new L(V.x1,V.y1),Z=new L(V.x2,V.y1),ce=new L(V.x1,V.y2),ge=new L(V.x2,V.y2),ke=R*Math.PI/180;W._rotate(ke),Z._rotate(ke),ce._rotate(ke),ge._rotate(ke),V.x1=Math.min(W.x,Z.x,ce.x,ge.x),V.x2=Math.max(W.x,Z.x,ce.x,ge.x),V.y1=Math.min(W.y,Z.y,ce.y,ge.y),V.y2=Math.max(W.y,Z.y,ce.y,ge.y)}r.emplaceBack(l.x,l.y,V.x1,V.y1,V.x2,V.y2,h,m,y)}this.boxEndIndex=r.length}}class pM{constructor(r=[],l=fM){if(this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:l,compare:h}=this,m=l[r];for(;r>0;){const y=r-1>>1,x=l[y];if(h(m,x)>=0)break;l[r]=x,r=y}l[r]=m}_down(r){const{data:l,compare:h}=this,m=this.length>>1,y=l[r];for(;r<m;){let x=1+(r<<1),b=l[x];const E=x+1;if(E<this.length&&h(l[E],b)<0&&(x=E,b=l[E]),h(b,y)>=0)break;l[r]=b,r=x}l[r]=y}}function fM(s,r){return s<r?-1:s>r?1:0}function mM(s,r=1,l=!1){let h=1/0,m=1/0,y=-1/0,x=-1/0;const b=s[0];for(let $=0;$<b.length;$++){const W=b[$];(!$||W.x<h)&&(h=W.x),(!$||W.y<m)&&(m=W.y),(!$||W.x>y)&&(y=W.x),(!$||W.y>x)&&(x=W.y)}const E=Math.min(y-h,x-m);let k=E/2;const R=new pM([],gM);if(E===0)return new L(h,m);for(let $=h;$<y;$+=E)for(let W=m;W<x;W+=E)R.push(new ch($+k,W+k,k,s));let O=function($){let W=0,Z=0,ce=0;const ge=$[0];for(let ke=0,xe=ge.length,Ce=xe-1;ke<xe;Ce=ke++){const ze=ge[ke],qe=ge[Ce],rt=ze.x*qe.y-qe.x*ze.y;Z+=(ze.x+qe.x)*rt,ce+=(ze.y+qe.y)*rt,W+=3*rt}return new ch(Z/W,ce/W,0,$)}(s),V=R.length;for(;R.length;){const $=R.pop();($.d>O.d||!O.d)&&(O=$,l&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,V)),$.max-O.d<=r||(k=$.h/2,R.push(new ch($.p.x-k,$.p.y-k,k,s)),R.push(new ch($.p.x+k,$.p.y-k,k,s)),R.push(new ch($.p.x-k,$.p.y+k,k,s)),R.push(new ch($.p.x+k,$.p.y+k,k,s)),V+=4)}return l&&(console.log(`num probes: ${V}`),console.log(`best distance: ${O.d}`)),O.p}function gM(s,r){return r.max-s.max}function ch(s,r,l,h){this.p=new L(s,r),this.h=l,this.d=function(m,y){let x=!1,b=1/0;for(let E=0;E<y.length;E++){const k=y[E];for(let R=0,O=k.length,V=O-1;R<O;V=R++){const $=k[R],W=k[V];$.y>m.y!=W.y>m.y&&m.x<(W.x-$.x)*(m.y-$.y)/(W.y-$.y)+$.x&&(x=!x),b=Math.min(b,Zw(m,$,W))}}return(x?1:-1)*Math.sqrt(b)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var pi;p.aq=void 0,(pi=p.aq||(p.aq={}))[pi.center=1]="center",pi[pi.left=2]="left",pi[pi.right=3]="right",pi[pi.top=4]="top",pi[pi.bottom=5]="bottom",pi[pi["top-left"]=6]="top-left",pi[pi["top-right"]=7]="top-right",pi[pi["bottom-left"]=8]="bottom-left",pi[pi["bottom-right"]=9]="bottom-right";const Dl=7,a0=Number.POSITIVE_INFINITY;function p2(s,r){return r[1]!==a0?function(l,h,m){let y=0,x=0;switch(h=Math.abs(h),m=Math.abs(m),l){case"top-right":case"top-left":case"top":x=m-Dl;break;case"bottom-right":case"bottom-left":case"bottom":x=-m+Dl}switch(l){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,x]}(s,r[0],r[1]):function(l,h){let m=0,y=0;h<0&&(h=0);const x=h/Math.SQRT2;switch(l){case"top-right":case"top-left":y=x-Dl;break;case"bottom-right":case"bottom-left":y=-x+Dl;break;case"bottom":y=-h+Dl;break;case"top":y=h-Dl}switch(l){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=h;break;case"right":m=-h}return[m,y]}(s,r[0])}function f2(s,r,l){var h;const m=s.layout,y=(h=m.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(r,{},l);if(y){const b=y.values,E=[];for(let k=0;k<b.length;k+=2){const R=E[k]=b[k],O=b[k+1].map(V=>V*Pr);R.startsWith("top")?O[1]-=Dl:R.startsWith("bottom")&&(O[1]+=Dl),E[k+1]=O}return new ni(E)}const x=m.get("text-variable-anchor");if(x){let b;b=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(r,{},l)*Pr,a0]:m.get("text-offset").evaluate(r,{},l).map(k=>k*Pr);const E=[];for(const k of x)E.push(k,p2(k,b));return new ni(E)}return null}function l0(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function yM(s,r,l,h,m,y,x,b,E,k,R){let O=y.textMaxSize.evaluate(r,{});O===void 0&&(O=x);const V=s.layers[0].layout,$=V.get("icon-offset").evaluate(r,{},R),W=g2(l.horizontal),Z=x/24,ce=s.tilePixelRatio*Z,ge=s.tilePixelRatio*O/24,ke=s.tilePixelRatio*b,xe=s.tilePixelRatio*V.get("symbol-spacing"),Ce=V.get("text-padding")*s.tilePixelRatio,ze=function(je,wt,_t,Ft=1){const Rn=je.get("icon-padding").evaluate(wt,{},_t),Cn=Rn&&Rn.values;return[Cn[0]*Ft,Cn[1]*Ft,Cn[2]*Ft,Cn[3]*Ft]}(V,r,R,s.tilePixelRatio),qe=V.get("text-max-angle")/180*Math.PI,rt=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",Et=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",ot=V.get("symbol-placement"),nt=xe/2,vt=V.get("icon-text-fit");let ft;h&&vt!=="none"&&(s.allowVerticalPlacement&&l.vertical&&(ft=Bb(h,l.vertical,vt,V.get("icon-text-fit-padding"),$,Z)),W&&(h=Bb(h,W,vt,V.get("icon-text-fit-padding"),$,Z)));const ct=(je,wt)=>{wt.x<0||wt.x>=br||wt.y<0||wt.y>=br||function(_t,Ft,Rn,Cn,Br,hs,fi,lr,qi,Hi,Wi,ur,Vr,Ci,mi,Gi,gi,jo,uo,dn,On,$n,bo,er,hh){const ca=_t.addToLineVertexArray(Ft,Rn);let ha,ds,Uo,Xr,Za=0,xp=0,x2=0,w2=0,g0=-1,y0=-1;const Xa={};let b2=Jc("");if(_t.allowVerticalPlacement&&Cn.vertical){const Ai=lr.layout.get("text-rotate").evaluate(On,{},er)+90;Uo=new Lm(qi,Ft,Hi,Wi,ur,Cn.vertical,Vr,Ci,mi,Ai),fi&&(Xr=new Lm(qi,Ft,Hi,Wi,ur,fi,gi,jo,mi,Ai))}if(Br){const Ai=lr.layout.get("icon-rotate").evaluate(On,{}),$o=lr.layout.get("icon-text-fit")!=="none",Hu=h2(Br,Ai,bo,$o),Ns=fi?h2(fi,Ai,bo,$o):void 0;ds=new Lm(qi,Ft,Hi,Wi,ur,Br,gi,jo,!1,Ai),Za=4*Hu.length;const Wu=_t.iconSizeData;let da=null;Wu.kind==="source"?(da=[ua*lr.layout.get("icon-size").evaluate(On,{})],da[0]>Rl&&se(`${_t.layerIds[0]}: Value for "icon-size" is >= ${gp}. Reduce your "icon-size".`)):Wu.kind==="composite"&&(da=[ua*$n.compositeIconSizes[0].evaluate(On,{},er),ua*$n.compositeIconSizes[1].evaluate(On,{},er)],(da[0]>Rl||da[1]>Rl)&&se(`${_t.layerIds[0]}: Value for "icon-size" is >= ${gp}. Reduce your "icon-size".`)),_t.addSymbols(_t.icon,Hu,da,dn,uo,On,p.ah.none,Ft,ca.lineStartIndex,ca.lineLength,-1,er),g0=_t.icon.placedSymbolArray.length-1,Ns&&(xp=4*Ns.length,_t.addSymbols(_t.icon,Ns,da,dn,uo,On,p.ah.vertical,Ft,ca.lineStartIndex,ca.lineLength,-1,er),y0=_t.icon.placedSymbolArray.length-1)}const S2=Object.keys(Cn.horizontal);for(const Ai of S2){const $o=Cn.horizontal[Ai];if(!ha){b2=Jc($o.text);const Ns=lr.layout.get("text-rotate").evaluate(On,{},er);ha=new Lm(qi,Ft,Hi,Wi,ur,$o,Vr,Ci,mi,Ns)}const Hu=$o.positionedLines.length===1;if(x2+=m2(_t,Ft,$o,hs,lr,mi,On,Gi,ca,Cn.vertical?p.ah.horizontal:p.ah.horizontalOnly,Hu?S2:[Ai],Xa,g0,$n,er),Hu)break}Cn.vertical&&(w2+=m2(_t,Ft,Cn.vertical,hs,lr,mi,On,Gi,ca,p.ah.vertical,["vertical"],Xa,y0,$n,er));const xM=ha?ha.boxStartIndex:_t.collisionBoxArray.length,wM=ha?ha.boxEndIndex:_t.collisionBoxArray.length,bM=Uo?Uo.boxStartIndex:_t.collisionBoxArray.length,SM=Uo?Uo.boxEndIndex:_t.collisionBoxArray.length,TM=ds?ds.boxStartIndex:_t.collisionBoxArray.length,EM=ds?ds.boxEndIndex:_t.collisionBoxArray.length,IM=Xr?Xr.boxStartIndex:_t.collisionBoxArray.length,CM=Xr?Xr.boxEndIndex:_t.collisionBoxArray.length;let Fs=-1;const zm=(Ai,$o)=>Ai&&Ai.circleDiameter?Math.max(Ai.circleDiameter,$o):$o;Fs=zm(ha,Fs),Fs=zm(Uo,Fs),Fs=zm(ds,Fs),Fs=zm(Xr,Fs);const T2=Fs>-1?1:0;T2&&(Fs*=hh/Pr),_t.glyphOffsetArray.length>=lh.MAX_GLYPHS&&se("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),On.sortKey!==void 0&&_t.addToSortKeyRanges(_t.symbolInstances.length,On.sortKey);const AM=f2(lr,On,er),[kM,PM]=function(Ai,$o){const Hu=Ai.length,Ns=$o==null?void 0:$o.values;if((Ns==null?void 0:Ns.length)>0)for(let Wu=0;Wu<Ns.length;Wu+=2){const da=Ns[Wu+1];Ai.emplaceBack(p.aq[Ns[Wu]],da[0],da[1])}return[Hu,Ai.length]}(_t.textAnchorOffsets,AM);_t.symbolInstances.emplaceBack(Ft.x,Ft.y,Xa.right>=0?Xa.right:-1,Xa.center>=0?Xa.center:-1,Xa.left>=0?Xa.left:-1,Xa.vertical||-1,g0,y0,b2,xM,wM,bM,SM,TM,EM,IM,CM,Hi,x2,w2,Za,xp,T2,0,Vr,Fs,kM,PM)}(s,wt,je,l,h,m,ft,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,ce,[Ce,Ce,Ce,Ce],rt,E,ke,ze,Et,$,r,y,k,R,x)};if(ot==="line")for(const je of o2(r.geometry,0,0,br,br)){const wt=dM(je,xe,qe,l.vertical||W,h,24,ge,s.overscaling,br);for(const _t of wt)W&&_M(s,W.text,nt,_t)||ct(je,_t)}else if(ot==="line-center"){for(const je of r.geometry)if(je.length>1){const wt=hM(je,qe,l.vertical||W,h,24,ge);wt&&ct(je,wt)}}else if(r.type==="Polygon")for(const je of Na(r.geometry,0)){const wt=mM(je,16);ct(je[0],new Ll(wt.x,wt.y,0))}else if(r.type==="LineString")for(const je of r.geometry)ct(je,new Ll(je[0].x,je[0].y,0));else if(r.type==="Point")for(const je of r.geometry)for(const wt of je)ct([wt],new Ll(wt.x,wt.y,0))}function m2(s,r,l,h,m,y,x,b,E,k,R,O,V,$,W){const Z=function(ke,xe,Ce,ze,qe,rt,Et,ot){const nt=ze.layout.get("text-rotate").evaluate(rt,{})*Math.PI/180,vt=[];for(const ft of xe.positionedLines)for(const ct of ft.positionedGlyphs){if(!ct.rect)continue;const je=ct.rect||{};let wt=Rb+1,_t=!0,Ft=1,Rn=0;const Cn=(qe||ot)&&ct.vertical,Br=ct.metrics.advance*ct.scale/2;if(ot&&xe.verticalizable&&(Rn=ft.lineOffset/2-(ct.imageName?-(Pr-ct.metrics.width*ct.scale)/2:(ct.scale-1)*Pr)),ct.imageName){const dn=Et[ct.imageName];_t=dn.sdf,Ft=dn.pixelRatio,wt=lo/Ft}const hs=qe?[ct.x+Br,ct.y]:[0,0];let fi=qe?[0,0]:[ct.x+Br+Ce[0],ct.y+Ce[1]-Rn],lr=[0,0];Cn&&(lr=fi,fi=[0,0]);const qi=ct.metrics.isDoubleResolution?2:1,Hi=(ct.metrics.left-wt)*ct.scale-Br+fi[0],Wi=(-ct.metrics.top-wt)*ct.scale+fi[1],ur=Hi+je.w/qi*ct.scale/Ft,Vr=Wi+je.h/qi*ct.scale/Ft,Ci=new L(Hi,Wi),mi=new L(ur,Wi),Gi=new L(Hi,Vr),gi=new L(ur,Vr);if(Cn){const dn=new L(-Br,Br-fp),On=-Math.PI/2,$n=Pr/2-Br,bo=new L(5-fp-$n,-(ct.imageName?$n:0)),er=new L(...lr);Ci._rotateAround(On,dn)._add(bo)._add(er),mi._rotateAround(On,dn)._add(bo)._add(er),Gi._rotateAround(On,dn)._add(bo)._add(er),gi._rotateAround(On,dn)._add(bo)._add(er)}if(nt){const dn=Math.sin(nt),On=Math.cos(nt),$n=[On,-dn,dn,On];Ci._matMult($n),mi._matMult($n),Gi._matMult($n),gi._matMult($n)}const jo=new L(0,0),uo=new L(0,0);vt.push({tl:Ci,tr:mi,bl:Gi,br:gi,tex:je,writingMode:xe.writingMode,glyphOffset:hs,sectionIndex:ct.sectionIndex,isSDF:_t,pixelOffsetTL:jo,pixelOffsetBR:uo,minFontScaleX:0,minFontScaleY:0})}return vt}(0,l,b,m,y,x,h,s.allowVerticalPlacement),ce=s.textSizeData;let ge=null;ce.kind==="source"?(ge=[ua*m.layout.get("text-size").evaluate(x,{})],ge[0]>Rl&&se(`${s.layerIds[0]}: Value for "text-size" is >= ${gp}. Reduce your "text-size".`)):ce.kind==="composite"&&(ge=[ua*$.compositeTextSizes[0].evaluate(x,{},W),ua*$.compositeTextSizes[1].evaluate(x,{},W)],(ge[0]>Rl||ge[1]>Rl)&&se(`${s.layerIds[0]}: Value for "text-size" is >= ${gp}. Reduce your "text-size".`)),s.addSymbols(s.text,Z,ge,b,y,x,k,r,E.lineStartIndex,E.lineLength,V,W);for(const ke of R)O[ke]=s.text.placedSymbolArray.length-1;return 4*Z.length}function g2(s){for(const r in s)return s[r];return null}function _M(s,r,l,h){const m=s.compareText;if(r in m){const y=m[r];for(let x=y.length-1;x>=0;x--)if(h.dist(y[x])<l)return!0}else m[r]=[];return m[r].push(h),!1}const y2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class u0{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,h]=new Uint8Array(r,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const y=y2[15&h];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new u0(b,x,y,r)}constructor(r,l=64,h=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=h,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const y=y2.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+E,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+E),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+E,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=r)}add(r,l){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=r,this.coords[this._pos++]=l,h}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return c0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,l,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:b}=this,E=[0,y.length-1,0],k=[];for(;E.length;){const R=E.pop()||0,O=E.pop()||0,V=E.pop()||0;if(O-V<=b){for(let ce=V;ce<=O;ce++){const ge=x[2*ce],ke=x[2*ce+1];ge>=r&&ge<=h&&ke>=l&&ke<=m&&k.push(y[ce])}continue}const $=V+O>>1,W=x[2*$],Z=x[2*$+1];W>=r&&W<=h&&Z>=l&&Z<=m&&k.push(y[$]),(R===0?r<=W:l<=Z)&&(E.push(V),E.push($-1),E.push(1-R)),(R===0?h>=W:m>=Z)&&(E.push($+1),E.push(O),E.push(1-R))}return k}within(r,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:x}=this,b=[0,m.length-1,0],E=[],k=h*h;for(;b.length;){const R=b.pop()||0,O=b.pop()||0,V=b.pop()||0;if(O-V<=x){for(let ce=V;ce<=O;ce++)v2(y[2*ce],y[2*ce+1],r,l)<=k&&E.push(m[ce]);continue}const $=V+O>>1,W=y[2*$],Z=y[2*$+1];v2(W,Z,r,l)<=k&&E.push(m[$]),(R===0?r-h<=W:l-h<=Z)&&(b.push(V),b.push($-1),b.push(1-R)),(R===0?r+h>=W:l+h>=Z)&&(b.push($+1),b.push(O),b.push(1-R))}return E}}function c0(s,r,l,h,m,y){if(m-h<=l)return;const x=h+m>>1;_2(s,r,x,h,m,y),c0(s,r,l,h,x-1,1-y),c0(s,r,l,x+1,m,1-y)}function _2(s,r,l,h,m,y){for(;m>h;){if(m-h>600){const k=m-h+1,R=l-h+1,O=Math.log(k),V=.5*Math.exp(2*O/3),$=.5*Math.sqrt(O*V*(k-V)/k)*(R-k/2<0?-1:1);_2(s,r,l,Math.max(h,Math.floor(l-R*V/k+$)),Math.min(m,Math.floor(l+(k-R)*V/k+$)),y)}const x=r[2*l+y];let b=h,E=m;for(_p(s,r,h,l),r[2*m+y]>x&&_p(s,r,h,m);b<E;){for(_p(s,r,b,E),b++,E--;r[2*b+y]<x;)b++;for(;r[2*E+y]>x;)E--}r[2*h+y]===x?_p(s,r,h,E):(E++,_p(s,r,E,m)),E<=l&&(h=E+1),l<=E&&(m=E-1)}}function _p(s,r,l,h){h0(s,l,h),h0(r,2*l,2*h),h0(r,2*l+1,2*h+1)}function h0(s,r,l){const h=s[r];s[r]=s[l],s[l]=h}function v2(s,r,l,h){const m=s-l,y=r-h;return m*m+y*y}var d0;p.be=void 0,(d0=p.be||(p.be={})).create="create",d0.load="load",d0.fullLoad="fullLoad";let Dm=null,vp=[];const p0=1e3/60,f0="loadTime",m0="fullLoadTime",vM={mark(s){performance.mark(s)},frame(s){const r=s;Dm!=null&&vp.push(r-Dm),Dm=r},clearMetrics(){Dm=null,vp=[],performance.clearMeasures(f0),performance.clearMeasures(m0);for(const s in p.be)performance.clearMarks(p.be[s])},getPerformanceMetrics(){performance.measure(f0,p.be.create,p.be.load),performance.measure(m0,p.be.create,p.be.fullLoad);const s=performance.getEntriesByName(f0)[0].duration,r=performance.getEntriesByName(m0)[0].duration,l=vp.length,h=1/(vp.reduce((y,x)=>y+x,0)/l/1e3),m=vp.filter(y=>y>p0).reduce((y,x)=>y+(x-p0)/p0,0);return{loadTime:s,fullLoadTime:r,fps:h,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};p.$=kr,p.A=nh,p.B=function(s){if(cn==null){const r=s.navigator?s.navigator.userAgent:null;cn=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return cn},p.C=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new uM(()=>this.process()),this.subscription=function(l,h,m,y){return l.addEventListener(h,m,!1),{unsubscribe:()=>{l.removeEventListener(h,m,!1)}}}(this.target,"message",l=>this.receive(l)),this.globalScope=un(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}sendAsync(s,r){return new Promise((l,h)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:l,reject:h},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const b={id:m,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const y=[],x=Object.assign(Object.assign({},s),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Nu(s.data,y)});this.target.postMessage(x,{transfer:y})})}receive(s){const r=s.data,l=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[l];const h=this.abortControllers[l];return delete this.abortControllers[l],void(h&&h.abort())}if(un(self)||r.mustQueue)return this.tasks[l]=r,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const m=this.resolveRejects[s];return delete this.resolveRejects[s],m?void(r.error?m.reject(us(r.error)):m.resolve(us(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=us(r.data),h=new AbortController;this.abortControllers[s]=h;try{const m=yield this.messageHandlers[r.type](r.sourceMapId,l,h);this.completeTask(s,null,m)}catch(m){this.completeTask(s,m)}})}completeTask(s,r,l){const h=[];delete this.abortControllers[s];const m={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Nu(r):null,data:Nu(l,h)};this.target.postMessage(m,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},p.D=xt,p.E=no,p.F=function(){var s=new nh(16);return nh!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},p.G=kn,p.H=function(s,r,l){var h,m,y,x,b,E,k,R,O,V,$,W,Z=l[0],ce=l[1],ge=l[2];return r===s?(s[12]=r[0]*Z+r[4]*ce+r[8]*ge+r[12],s[13]=r[1]*Z+r[5]*ce+r[9]*ge+r[13],s[14]=r[2]*Z+r[6]*ce+r[10]*ge+r[14],s[15]=r[3]*Z+r[7]*ce+r[11]*ge+r[15]):(m=r[1],y=r[2],x=r[3],b=r[4],E=r[5],k=r[6],R=r[7],O=r[8],V=r[9],$=r[10],W=r[11],s[0]=h=r[0],s[1]=m,s[2]=y,s[3]=x,s[4]=b,s[5]=E,s[6]=k,s[7]=R,s[8]=O,s[9]=V,s[10]=$,s[11]=W,s[12]=h*Z+b*ce+O*ge+r[12],s[13]=m*Z+E*ce+V*ge+r[13],s[14]=y*Z+k*ce+$*ge+r[14],s[15]=x*Z+R*ce+W*ge+r[15]),s},p.I=X_,p.J=function(s,r,l){var h=l[0],m=l[1],y=l[2];return s[0]=r[0]*h,s[1]=r[1]*h,s[2]=r[2]*h,s[3]=r[3]*h,s[4]=r[4]*m,s[5]=r[5]*m,s[6]=r[6]*m,s[7]=r[7]*m,s[8]=r[8]*y,s[9]=r[9]*y,s[10]=r[10]*y,s[11]=r[11]*y,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},p.K=Jw,p.L=function(s,r){const l={};for(let h=0;h<r.length;h++){const m=r[h];m in s&&(l[m]=s[m])}return l},p.M=Ml,p.N=Kb,p.O=Zb,p.P=L,p.Q=Vo,p.R=Bo,p.S=te,p.T=Sl,p.U=G,p.V=ht,p.W=br,p.X=M,p.Y=km,p.Z=class extends K{},p._=c,p.a=Hn,p.a$=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},p.a0=s0,p.a1=Ke,p.a2=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(l=>{r.onloadstart=()=>{l(r)};for(const h of s){const m=window.document.createElement("source");Dr(h)||(r.crossOrigin="Anonymous"),m.src=h,r.appendChild(m)}})},p.a3=function(){return X++},p.a4=Ht,p.a5=lh,p.a6=Nd,p.a7=$u,p.a8=zn,p.a9=t2,p.aA=function(s){if(s.type==="custom")return new lM(s);switch(s.type){case"background":return new oM(s);case"circle":return new W5(s);case"fill":return new uR(s);case"fill-extrusion":return new TR(s);case"heatmap":return new K5(s);case"hillshade":return new X5(s);case"line":return new MR(s);case"raster":return new aM(s);case"symbol":return new Am(s)}},p.aB=de,p.aC=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let l=[];try{if(!Vt(s.version,r.version))return[{command:"setStyle",args:[r]}];Vt(s.center,r.center)||l.push({command:"setCenter",args:[r.center]}),Vt(s.zoom,r.zoom)||l.push({command:"setZoom",args:[r.zoom]}),Vt(s.bearing,r.bearing)||l.push({command:"setBearing",args:[r.bearing]}),Vt(s.pitch,r.pitch)||l.push({command:"setPitch",args:[r.pitch]}),Vt(s.sprite,r.sprite)||l.push({command:"setSprite",args:[r.sprite]}),Vt(s.glyphs,r.glyphs)||l.push({command:"setGlyphs",args:[r.glyphs]}),Vt(s.transition,r.transition)||l.push({command:"setTransition",args:[r.transition]}),Vt(s.light,r.light)||l.push({command:"setLight",args:[r.light]}),Vt(s.terrain,r.terrain)||l.push({command:"setTerrain",args:[r.terrain]}),Vt(s.sky,r.sky)||l.push({command:"setSky",args:[r.sky]}),Vt(s.projection,r.projection)||l.push({command:"setProjection",args:[r.projection]});const h={},m=[];(function(x,b,E,k){let R;for(R in b=b||{},x=x||{})Object.prototype.hasOwnProperty.call(x,R)&&(Object.prototype.hasOwnProperty.call(b,R)||Do(R,E,k));for(R in b)Object.prototype.hasOwnProperty.call(b,R)&&(Object.prototype.hasOwnProperty.call(x,R)?Vt(x[R],b[R])||(x[R].type==="geojson"&&b[R].type==="geojson"&&ti(x,b,R)?en(E,{command:"setGeoJSONSourceData",args:[R,b[R].data]}):Qn(R,b,E,k)):wi(R,b,E))})(s.sources,r.sources,m,h);const y=[];s.layers&&s.layers.forEach(x=>{"source"in x&&h[x.source]?l.push({command:"removeLayer",args:[x.id]}):y.push(x)}),l=l.concat(m),function(x,b,E){b=b||[];const k=(x=x||[]).map(mn),R=b.map(mn),O=x.reduce(Kn,{}),V=b.reduce(Kn,{}),$=k.slice(),W=Object.create(null);let Z,ce,ge,ke,xe;for(let Ce=0,ze=0;Ce<k.length;Ce++)Z=k[Ce],Object.prototype.hasOwnProperty.call(V,Z)?ze++:(en(E,{command:"removeLayer",args:[Z]}),$.splice($.indexOf(Z,ze),1));for(let Ce=0,ze=0;Ce<R.length;Ce++)Z=R[R.length-1-Ce],$[$.length-1-Ce]!==Z&&(Object.prototype.hasOwnProperty.call(O,Z)?(en(E,{command:"removeLayer",args:[Z]}),$.splice($.lastIndexOf(Z,$.length-ze),1)):ze++,ke=$[$.length-Ce],en(E,{command:"addLayer",args:[V[Z],ke]}),$.splice($.length-Ce,0,Z),W[Z]=!0);for(let Ce=0;Ce<R.length;Ce++)if(Z=R[Ce],ce=O[Z],ge=V[Z],!W[Z]&&!Vt(ce,ge))if(Vt(ce.source,ge.source)&&Vt(ce["source-layer"],ge["source-layer"])&&Vt(ce.type,ge.type)){for(xe in Gr(ce.layout,ge.layout,E,Z,null,"setLayoutProperty"),Gr(ce.paint,ge.paint,E,Z,null,"setPaintProperty"),Vt(ce.filter,ge.filter)||en(E,{command:"setFilter",args:[Z,ge.filter]}),Vt(ce.minzoom,ge.minzoom)&&Vt(ce.maxzoom,ge.maxzoom)||en(E,{command:"setLayerZoomRange",args:[Z,ge.minzoom,ge.maxzoom]}),ce)Object.prototype.hasOwnProperty.call(ce,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Gr(ce[xe],ge[xe],E,Z,xe.slice(6),"setPaintProperty"):Vt(ce[xe],ge[xe])||en(E,{command:"setLayerProperty",args:[Z,xe,ge[xe]]}));for(xe in ge)Object.prototype.hasOwnProperty.call(ge,xe)&&!Object.prototype.hasOwnProperty.call(ce,xe)&&xe!=="layout"&&xe!=="paint"&&xe!=="filter"&&xe!=="metadata"&&xe!=="minzoom"&&xe!=="maxzoom"&&(xe.indexOf("paint.")===0?Gr(ce[xe],ge[xe],E,Z,xe.slice(6),"setPaintProperty"):Vt(ce[xe],ge[xe])||en(E,{command:"setLayerProperty",args:[Z,xe,ge[xe]]}))}else en(E,{command:"removeLayer",args:[Z]}),ke=$[$.lastIndexOf(Z)+1],en(E,{command:"addLayer",args:[ge,ke]})}(y,r.layers,l)}catch(h){console.warn("Unable to compute style diff:",h),l=[{command:"setStyle",args:[r]}]}return l},p.aD=function(s){const r=[],l=s.id;return l===void 0&&r.push({message:`layers.${l}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${l}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),r},p.aE=function s(r,l){if(Array.isArray(r)){if(!Array.isArray(l)||r.length!==l.length)return!1;for(let h=0;h<r.length;h++)if(!s(r[h],l[h]))return!1;return!0}if(typeof r=="object"&&r!==null&&l!==null){if(typeof l!="object"||Object.keys(r).length!==Object.keys(l).length)return!1;for(const h in r)if(!s(r[h],l[h]))return!1;return!0}return r===l},p.aF=Y,p.aG=ie,p.aH=class extends Vu{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},p.aI=fm,p.aJ=class extends Vu{constructor(s,r){super(s,r),this.current=N5}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},p.aK=Uw,p.aL=class extends Vu{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},p.aM=class extends Vu{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},p.aN=$w,p.aO=function(s,r,l,h,m,y,x){var b=1/(r-l),E=1/(h-m),k=1/(y-x);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*k,s[11]=0,s[12]=(r+l)*b,s[13]=(m+h)*E,s[14]=(x+y)*k,s[15]=1,s},p.aP=nn,p.aQ=H5,p.aR=class extends $e{},p.aS=OR,p.aT=class extends at{},p.aU=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},p.aV=ib,p.aW=Ha,p.aX=class extends it{},p.aY=Nr,p.aZ=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},p.a_=function(s,r){var l=s[0],h=s[1],m=s[2],y=s[3],x=s[4],b=s[5],E=s[6],k=s[7],R=s[8],O=s[9],V=s[10],$=s[11],W=s[12],Z=s[13],ce=s[14],ge=s[15],ke=r[0],xe=r[1],Ce=r[2],ze=r[3],qe=r[4],rt=r[5],Et=r[6],ot=r[7],nt=r[8],vt=r[9],ft=r[10],ct=r[11],je=r[12],wt=r[13],_t=r[14],Ft=r[15];return Math.abs(l-ke)<=$i*Math.max(1,Math.abs(l),Math.abs(ke))&&Math.abs(h-xe)<=$i*Math.max(1,Math.abs(h),Math.abs(xe))&&Math.abs(m-Ce)<=$i*Math.max(1,Math.abs(m),Math.abs(Ce))&&Math.abs(y-ze)<=$i*Math.max(1,Math.abs(y),Math.abs(ze))&&Math.abs(x-qe)<=$i*Math.max(1,Math.abs(x),Math.abs(qe))&&Math.abs(b-rt)<=$i*Math.max(1,Math.abs(b),Math.abs(rt))&&Math.abs(E-Et)<=$i*Math.max(1,Math.abs(E),Math.abs(Et))&&Math.abs(k-ot)<=$i*Math.max(1,Math.abs(k),Math.abs(ot))&&Math.abs(R-nt)<=$i*Math.max(1,Math.abs(R),Math.abs(nt))&&Math.abs(O-vt)<=$i*Math.max(1,Math.abs(O),Math.abs(vt))&&Math.abs(V-ft)<=$i*Math.max(1,Math.abs(V),Math.abs(ft))&&Math.abs($-ct)<=$i*Math.max(1,Math.abs($),Math.abs(ct))&&Math.abs(W-je)<=$i*Math.max(1,Math.abs(W),Math.abs(je))&&Math.abs(Z-wt)<=$i*Math.max(1,Math.abs(Z),Math.abs(wt))&&Math.abs(ce-_t)<=$i*Math.max(1,Math.abs(ce),Math.abs(_t))&&Math.abs(ge-Ft)<=$i*Math.max(1,Math.abs(ge),Math.abs(Ft))},p.aa=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,m,y)=>{const x=m||y;return r[h]=!x||x.toLowerCase(),""}),r["max-age"]){const l=parseInt(r["max-age"],10);isNaN(l)?delete r["max-age"]:r["max-age"]=l}return r},p.ab=function(s,r){const l=[];for(const h in s)h in r||l.push(h);return l},p.ac=Le,p.ad=function(s,r,l){var h=Math.sin(l),m=Math.cos(l),y=r[0],x=r[1],b=r[2],E=r[3],k=r[4],R=r[5],O=r[6],V=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=y*m+k*h,s[1]=x*m+R*h,s[2]=b*m+O*h,s[3]=E*m+V*h,s[4]=k*m-y*h,s[5]=R*m-x*h,s[6]=O*m-b*h,s[7]=V*m-E*h,s},p.ae=function(s){var r=new nh(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},p.af=_m,p.ag=function(s,r){let l=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:m,minZoom:y,maxZoom:x}=s,b=m?Le(ii.interpolationFactor(m,r,y,x),0,1):0;s.kind==="camera"?h=Or.number(s.minSize,s.maxSize,b):l=b}return{uSizeT:l,uSize:h}},p.ai=function(s,{uSize:r,uSizeT:l},{lowerSize:h,upperSize:m}){return s.kind==="source"?h/ua:s.kind==="composite"?Or.number(h/ua,m/ua,l):r},p.aj=e0,p.ak=function(s,r,l,h){const m=r.y-s.y,y=r.x-s.x,x=h.y-l.y,b=h.x-l.x,E=x*y-b*m;if(E===0)return null;const k=(b*(s.y-l.y)-x*(s.x-l.x))/E;return new L(s.x+k*y,s.y+k*m)},p.al=o2,p.am=Gw,p.an=D_,p.ao=function(s){let r=1/0,l=1/0,h=-1/0,m=-1/0;for(const y of s)r=Math.min(r,y.x),l=Math.min(l,y.y),h=Math.max(h,y.x),m=Math.max(m,y.y);return[r,l,h,m]},p.ap=Pr,p.ar=J_,p.as=function(s,r){var l=r[0],h=r[1],m=r[2],y=r[3],x=r[4],b=r[5],E=r[6],k=r[7],R=r[8],O=r[9],V=r[10],$=r[11],W=r[12],Z=r[13],ce=r[14],ge=r[15],ke=l*b-h*x,xe=l*E-m*x,Ce=l*k-y*x,ze=h*E-m*b,qe=h*k-y*b,rt=m*k-y*E,Et=R*Z-O*W,ot=R*ce-V*W,nt=R*ge-$*W,vt=O*ce-V*Z,ft=O*ge-$*Z,ct=V*ge-$*ce,je=ke*ct-xe*ft+Ce*vt+ze*nt-qe*ot+rt*Et;return je?(s[0]=(b*ct-E*ft+k*vt)*(je=1/je),s[1]=(m*ft-h*ct-y*vt)*je,s[2]=(Z*rt-ce*qe+ge*ze)*je,s[3]=(V*qe-O*rt-$*ze)*je,s[4]=(E*nt-x*ct-k*ot)*je,s[5]=(l*ct-m*nt+y*ot)*je,s[6]=(ce*Ce-W*rt-ge*xe)*je,s[7]=(R*rt-V*Ce+$*xe)*je,s[8]=(x*ft-b*nt+k*Et)*je,s[9]=(h*nt-l*ft-y*Et)*je,s[10]=(W*qe-Z*Ce+ge*ke)*je,s[11]=(O*Ce-R*qe-$*ke)*je,s[12]=(b*ot-x*vt-E*Et)*je,s[13]=(l*vt-h*ot+m*Et)*je,s[14]=(Z*xe-W*ze-ce*ke)*je,s[15]=(R*ze-O*xe+V*ke)*je,s):null},p.at=l0,p.au=Q_,p.av=u0,p.aw=function(){const s={},r=Oe.$version;for(const l in Oe.$root){const h=Oe.$root[l];if(h.required){let m=null;m=l==="version"?r:h.type==="array"?[]:{},m!=null&&(s[l]=m)}}return s},p.ax=sm,p.ay=vr,p.az=function(s){s=s.slice();const r=Object.create(null);for(let l=0;l<s.length;l++)r[s[l].id]=s[l];for(let l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=Wr(s[l],r[s[l].ref]));return s},p.b=tn,p.b0=function(s,r,l){return s[0]=r[0]*l[0],s[1]=r[1]*l[1],s[2]=r[2]*l[2],s[3]=r[3]*l[3],s},p.b1=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]*r[3]},p.b2=Me,p.b3=Qb,p.b4=Xb,p.b5=function(s,r,l,h,m){var y,x=1/Math.tan(r/2);return s[0]=x/l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,m!=null&&m!==1/0?(s[10]=(m+h)*(y=1/(h-m)),s[14]=2*m*h*y):(s[10]=-1,s[14]=-2*h),s},p.b6=function(s,r,l){var h=Math.sin(l),m=Math.cos(l),y=r[4],x=r[5],b=r[6],E=r[7],k=r[8],R=r[9],O=r[10],V=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=y*m+k*h,s[5]=x*m+R*h,s[6]=b*m+O*h,s[7]=E*m+V*h,s[8]=k*m-y*h,s[9]=R*m-x*h,s[10]=O*m-b*h,s[11]=V*m-E*h,s},p.b7=re,p.b8=be,p.b9=function(s){return s*Math.PI/180},p.bA=Bc,p.bB=sa,p.ba=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},p.bb=class extends H{},p.bc=i0,p.bd=vM,p.bf=Pn,p.bg=function(s,r){Hn.REGISTERED_PROTOCOLS[s]=r},p.bh=function(s){delete Hn.REGISTERED_PROTOCOLS[s]},p.bi=function(s,r){const l={};for(let m=0;m<s.length;m++){const y=r&&r[s[m].id]||E_(s[m]);r&&(r[s[m].id]=y);let x=l[y];x||(x=l[y]=[]),x.push(s[m])}const h=[];for(const m in l)h.push(l[m]);return h},p.bj=dt,p.bk=e2,p.bl=n2,p.bm=Lb,p.bn=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=br/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const r=s.bucket.layers[0],l=r.layout,h=r._unevaluatedLayout._values,m={layoutIconSize:h["icon-size"].possiblyEvaluate(new zn(s.bucket.zoom+1),s.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new zn(s.bucket.zoom+1),s.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new zn(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:R}=s.bucket.textSizeData;m.compositeTextSizes=[h["text-size"].possiblyEvaluate(new zn(k),s.canonical),h["text-size"].possiblyEvaluate(new zn(R),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:R}=s.bucket.iconSizeData;m.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new zn(k),s.canonical),h["icon-size"].possiblyEvaluate(new zn(R),s.canonical)]}const y=l.get("text-line-height")*Pr,x=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",b=l.get("text-keep-upright"),E=l.get("text-size");for(const k of s.bucket.features){const R=l.get("text-font").evaluate(k,{},s.canonical).join(","),O=E.evaluate(k,{},s.canonical),V=m.layoutTextSize.evaluate(k,{},s.canonical),$=m.layoutIconSize.evaluate(k,{},s.canonical),W={horizontal:{},vertical:void 0},Z=k.text;let ce,ge=[0,0];if(Z){const Ce=Z.toString(),ze=l.get("text-letter-spacing").evaluate(k,{},s.canonical)*Pr,qe=C_(Ce)?ze:0,rt=l.get("text-anchor").evaluate(k,{},s.canonical),Et=f2(r,k,s.canonical);if(!Et){const ft=l.get("text-radial-offset").evaluate(k,{},s.canonical);ge=ft?p2(rt,[ft*Pr,a0]):l.get("text-offset").evaluate(k,{},s.canonical).map(ct=>ct*Pr)}let ot=x?"center":l.get("text-justify").evaluate(k,{},s.canonical);const nt=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(k,{},s.canonical)*Pr:1/0,vt=()=>{s.bucket.allowVerticalPlacement&&Zd(Ce)&&(W.vertical=Em(Z,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,y,rt,"left",qe,ge,p.ah.vertical,!0,V,O))};if(!x&&Et){const ft=new Set;if(ot==="auto")for(let je=0;je<Et.values.length;je+=2)ft.add(l0(Et.values[je]));else ft.add(ot);let ct=!1;for(const je of ft)if(!W.horizontal[je])if(ct)W.horizontal[je]=W.horizontal[0];else{const wt=Em(Z,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,y,"center",je,qe,ge,p.ah.horizontal,!1,V,O);wt&&(W.horizontal[je]=wt,ct=wt.positionedLines.length===1)}vt()}else{ot==="auto"&&(ot=l0(rt));const ft=Em(Z,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,y,rt,ot,qe,ge,p.ah.horizontal,!1,V,O);ft&&(W.horizontal[ot]=ft),vt(),Zd(Ce)&&x&&b&&(W.vertical=Em(Z,s.glyphMap,s.glyphPositions,s.imagePositions,R,nt,y,rt,ot,qe,ge,p.ah.vertical,!1,V,O))}}let ke=!1;if(k.icon&&k.icon.name){const Ce=s.imageMap[k.icon.name];Ce&&(ce=eM(s.imagePositions[k.icon.name],l.get("icon-offset").evaluate(k,{},s.canonical),l.get("icon-anchor").evaluate(k,{},s.canonical)),ke=!!Ce.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ke:s.bucket.sdfIcons!==ke&&se("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ce.pixelRatio!==s.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const xe=g2(W.horizontal)||W.vertical;s.bucket.iconsInText=!!xe&&xe.iconsInText,(xe||ce)&&yM(s.bucket,k,W,ce,s.imageMap,m,V,$,ge,ke,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},p.bo=W_,p.bp=$_,p.bq=H_,p.br=kl,p.bs=K_,p.bt=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},p.bu=function(s,r,l,h,m){return c(this,void 0,void 0,function*(){if(G())try{return yield ht(s,r,l,h,m)}catch{}return function(y,x,b,E,k){const R=y.width,O=y.height;Tt&&kt||(Tt=new OffscreenCanvas(R,O),kt=Tt.getContext("2d",{willReadFrequently:!0})),Tt.width=R,Tt.height=O,kt.drawImage(y,0,0,R,O);const V=kt.getImageData(x,b,E,k);return kt.clearRect(0,0,R,O),V.data}(s,r,l,h,m)})},p.bv=Jb,p.bw=S,p.bx=A,p.by=Tb,p.bz=function(s){return s.message===At},p.c=jt,p.d=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),p.e=J,p.f=s=>new Promise((r,l)=>{const h=new Image;h.onload=()=>{r(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=et})},h.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(s)],{type:"image/png"});h.src=s.byteLength?URL.createObjectURL(m):et}),p.g=fn,p.h=(s,r)=>Lr(J(s,{type:"json"}),r),p.i=un,p.j=En,p.k=Oi,p.l=(s,r)=>Lr(J(s,{type:"arrayBuffer"}),r),p.m=Lr,p.n=function(s){return new K_(s).readFields(GR,[])},p.o=ap,p.p=Mb,p.q=f,p.r=I_,p.s=Dr,p.t=Kd,p.u=st,p.v=Oe,p.w=se,p.x=Ou,p.y=function([s,r,l]){return r+=90,r*=Math.PI/180,l*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(l),y:s*Math.sin(r)*Math.sin(l),z:s*Math.cos(l)}},p.z=Or}),a("worker",["./shared"],function(p){class c{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,U){for(const le of j){this._layerConfigs[le.id]=le;const ve=this._layers[le.id]=p.aA(le);ve._featureFilter=p.a6(ve.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of U)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const q=p.bi(Object.values(this._layerConfigs),this.keyCache);for(const le of q){const ve=le.map(Ne=>this._layers[Ne.id]),Ee=ve[0];if(Ee.visibility==="none")continue;const Ae=Ee.source||"";let ye=this.familiesBySource[Ae];ye||(ye=this.familiesBySource[Ae]={});const Re=Ee.sourceLayer||"_geojsonTileLayer";let Ue=ye[Re];Ue||(Ue=ye[Re]=[]),Ue.push(ve)}}}class S{constructor(j){const U={},q=[];for(const Ae in j){const ye=j[Ae],Re=U[Ae]={};for(const Ue in ye){const Ne=ye[+Ue];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Be={x:0,y:0,w:Ne.bitmap.width+2,h:Ne.bitmap.height+2};q.push(Be),Re[Ue]={rect:Be,metrics:Ne.metrics}}}const{w:le,h:ve}=p.p(q),Ee=new p.o({width:le||1,height:ve||1});for(const Ae in j){const ye=j[Ae];for(const Re in ye){const Ue=ye[+Re];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Ne=U[Ae][Re].rect;p.o.copy(Ue.bitmap,Ee,{x:0,y:0},{x:Ne.x+1,y:Ne.y+1},Ue.bitmap)}}this.image=Ee,this.positions=U}}p.bj("GlyphAtlas",S);class A{constructor(j){this.tileID=new p.Q(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId,this.inFlightDependencies=[]}parse(j,U,q,le){return p._(this,void 0,void 0,function*(){this.status="parsing",this.data=j,this.collisionBoxArray=new p.a4;const ve=new p.bk(Object.keys(j.layers).sort()),Ee=new p.bl(this.tileID,this.promoteId);Ee.bucketLayerIDs=[];const Ae={},ye={featureIndex:Ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Re=U.familiesBySource[this.source];for(const Rt in Re){const Dn=j.layers[Rt];if(!Dn)continue;Dn.version===1&&p.w(`Vector tile source "${this.source}" layer "${Rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ir=ve.encode(Rt),zr=[];for(let Kr=0;Kr<Dn.length;Kr++){const or=Dn.feature(Kr),bs=Ee.getId(or,Rt);zr.push({feature:or,id:bs,index:Kr,sourceLayerIndex:ir})}for(const Kr of Re[Rt]){const or=Kr[0];or.source!==this.source&&p.w(`layer.source = ${or.source} does not equal this.source = ${this.source}`),or.minzoom&&this.zoom<Math.floor(or.minzoom)||or.maxzoom&&this.zoom>=or.maxzoom||or.visibility!=="none"&&(D(Kr,this.zoom,q),(Ae[or.id]=or.createBucket({index:Ee.bucketLayerIDs.length,layers:Kr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ir,sourceID:this.source})).populate(zr,ye,this.tileID.canonical),Ee.bucketLayerIDs.push(Kr.map(bs=>bs.id)))}}const Ue=p.aF(ye.glyphDependencies,Rt=>Object.keys(Rt).map(Number));this.inFlightDependencies.forEach(Rt=>Rt==null?void 0:Rt.abort()),this.inFlightDependencies=[];let Ne=Promise.resolve({});if(Object.keys(Ue).length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),Ne=le.sendAsync({type:"GG",data:{stacks:Ue,source:this.source,tileID:this.tileID,type:"glyphs"}},Rt)}const Be=Object.keys(ye.iconDependencies);let bt=Promise.resolve({});if(Be.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),bt=le.sendAsync({type:"GI",data:{icons:Be,source:this.source,tileID:this.tileID,type:"icons"}},Rt)}const yt=Object.keys(ye.patternDependencies);let Gt=Promise.resolve({});if(yt.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),Gt=le.sendAsync({type:"GI",data:{icons:yt,source:this.source,tileID:this.tileID,type:"patterns"}},Rt)}const[Mt,Kt,gn]=yield Promise.all([Ne,bt,Gt]),Sn=new S(Mt),Wn=new p.bm(Kt,gn);for(const Rt in Ae){const Dn=Ae[Rt];Dn instanceof p.a5?(D(Dn.layers,this.zoom,q),p.bn({bucket:Dn,glyphMap:Mt,glyphPositions:Sn.positions,imageMap:Kt,imagePositions:Wn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Dn.hasPattern&&(Dn instanceof p.bo||Dn instanceof p.bp||Dn instanceof p.bq)&&(D(Dn.layers,this.zoom,q),Dn.addFeatures(ye,this.tileID.canonical,Wn.patternPositions))}return this.status="done",{buckets:Object.values(Ae).filter(Rt=>!Rt.isEmpty()),featureIndex:Ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Sn.image,imageAtlas:Wn,glyphMap:this.returnDependencies?Mt:null,iconMap:this.returnDependencies?Kt:null,glyphPositions:this.returnDependencies?Sn.positions:null}})}}function D(ne,j,U){const q=new p.a8(j);for(const le of ne)le.recalculate(q,U)}class L{constructor(j,U,q){this.actor=j,this.layerIndex=U,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(j,U){return p._(this,void 0,void 0,function*(){const q=yield p.l(j.request,U);try{return{vectorTile:new p.br.VectorTile(new p.bs(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(le){const ve=new Uint8Array(q.data);let Ee=`Unable to parse the tile at ${j.request.url}, `;throw Ee+=ve[0]===31&&ve[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(Ee)}})}loadTile(j){return p._(this,void 0,void 0,function*(){const U=j.uid,q=!!(j&&j.request&&j.request.collectResourceTiming)&&new p.bt(j.request),le=new A(j);this.loading[U]=le;const ve=new AbortController;le.abort=ve;try{const Ee=yield this.loadVectorTile(j,ve);if(delete this.loading[U],!Ee)return null;const Ae=Ee.rawData,ye={};Ee.expires&&(ye.expires=Ee.expires),Ee.cacheControl&&(ye.cacheControl=Ee.cacheControl);const Re={};if(q){const Ne=q.finish();Ne&&(Re.resourceTiming=JSON.parse(JSON.stringify(Ne)))}le.vectorTile=Ee.vectorTile;const Ue=le.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[U]=le,this.fetching[U]={rawTileData:Ae,cacheControl:ye,resourceTiming:Re};try{const Ne=yield Ue;return p.e({rawTileData:Ae.slice(0)},Ne,ye,Re)}finally{delete this.fetching[U]}}catch(Ee){throw delete this.loading[U],le.status="done",this.loaded[U]=le,Ee}})}reloadTile(j){return p._(this,void 0,void 0,function*(){const U=j.uid;if(!this.loaded||!this.loaded[U])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const q=this.loaded[U];if(q.showCollisionBoxes=j.showCollisionBoxes,q.status==="parsing"){const le=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor);let ve;if(this.fetching[U]){const{rawTileData:Ee,cacheControl:Ae,resourceTiming:ye}=this.fetching[U];delete this.fetching[U],ve=p.e({rawTileData:Ee.slice(0)},le,Ae,ye)}else ve=le;return ve}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(j){return p._(this,void 0,void 0,function*(){const U=this.loading,q=j.uid;U&&U[q]&&U[q].abort&&(U[q].abort.abort(),delete U[q])})}removeTile(j){return p._(this,void 0,void 0,function*(){this.loaded&&this.loaded[j.uid]&&delete this.loaded[j.uid]})}}class z{constructor(){this.loaded={}}loadTile(j){return p._(this,void 0,void 0,function*(){const{uid:U,encoding:q,rawImageData:le,redFactor:ve,greenFactor:Ee,blueFactor:Ae,baseShift:ye}=j,Re=le.width+2,Ue=le.height+2,Ne=p.b(le)?new p.R({width:Re,height:Ue},yield p.bu(le,-1,-1,Re,Ue)):le,Be=new p.bv(U,Ne,q,ve,Ee,Ae,ye);return this.loaded=this.loaded||{},this.loaded[U]=Be,Be})}removeTile(j){const U=this.loaded,q=j.uid;U&&U[q]&&delete U[q]}}function ee(ne,j){if(ne.length!==0){pe(ne[0],j);for(var U=1;U<ne.length;U++)pe(ne[U],!j)}}function pe(ne,j){for(var U=0,q=0,le=0,ve=ne.length,Ee=ve-1;le<ve;Ee=le++){var Ae=(ne[le][0]-ne[Ee][0])*(ne[Ee][1]+ne[le][1]),ye=U+Ae;q+=Math.abs(U)>=Math.abs(Ae)?U-ye+Ae:Ae-ye+U,U=ye}U+q>=0!=!!j&&ne.reverse()}var ue=p.bw(function ne(j,U){var q,le=j&&j.type;if(le==="FeatureCollection")for(q=0;q<j.features.length;q++)ne(j.features[q],U);else if(le==="GeometryCollection")for(q=0;q<j.geometries.length;q++)ne(j.geometries[q],U);else if(le==="Feature")ne(j.geometry,U);else if(le==="Polygon")ee(j.coordinates,U);else if(le==="MultiPolygon")for(q=0;q<j.coordinates.length;q++)ee(j.coordinates[q],U);return j});const me=p.br.VectorTileFeature.prototype.toGeoJSON;var te={exports:{}},G=p.bx,re=p.br.VectorTileFeature,be=Le;function Le(ne,j){this.options=j||{},this.features=ne,this.length=ne.length}function Me(ne,j){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=j||4096}Le.prototype.feature=function(ne){return new Me(this.features[ne],this.options.extent)},Me.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var j=0;j<ne.length;j++){for(var U=ne[j],q=[],le=0;le<U.length;le++)q.push(new G(U[le][0],U[le][1]));this.geometry.push(q)}return this.geometry},Me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,j=1/0,U=-1/0,q=1/0,le=-1/0,ve=0;ve<ne.length;ve++)for(var Ee=ne[ve],Ae=0;Ae<Ee.length;Ae++){var ye=Ee[Ae];j=Math.min(j,ye.x),U=Math.max(U,ye.x),q=Math.min(q,ye.y),le=Math.max(le,ye.y)}return[j,q,U,le]},Me.prototype.toGeoJSON=re.prototype.toGeoJSON;var J=p.by,X=be;function Y(ne){var j=new J;return function(U,q){for(var le in U.layers)q.writeMessage(3,ie,U.layers[le])}(ne,j),j.finish()}function ie(ne,j){var U;j.writeVarintField(15,ne.version||1),j.writeStringField(1,ne.name||""),j.writeVarintField(5,ne.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<ne.length;U++)q.feature=ne.feature(U),j.writeMessage(2,de,q);var le=q.keys;for(U=0;U<le.length;U++)j.writeStringField(3,le[U]);var ve=q.values;for(U=0;U<ve.length;U++)j.writeMessage(4,cn,ve[U])}function de(ne,j){var U=ne.feature;U.id!==void 0&&j.writeVarintField(1,U.id),j.writeMessage(2,we,ne),j.writeVarintField(3,U.type),j.writeMessage(4,un,U)}function we(ne,j){var U=ne.feature,q=ne.keys,le=ne.values,ve=ne.keycache,Ee=ne.valuecache;for(var Ae in U.properties){var ye=U.properties[Ae],Re=ve[Ae];if(ye!==null){Re===void 0&&(q.push(Ae),ve[Ae]=Re=q.length-1),j.writeVarint(Re);var Ue=typeof ye;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(ye=JSON.stringify(ye));var Ne=Ue+":"+ye,Be=Ee[Ne];Be===void 0&&(le.push(ye),Ee[Ne]=Be=le.length-1),j.writeVarint(Be)}}}function se(ne,j){return(j<<3)+(7&ne)}function ut(ne){return ne<<1^ne>>31}function un(ne,j){for(var U=ne.loadGeometry(),q=ne.type,le=0,ve=0,Ee=U.length,Ae=0;Ae<Ee;Ae++){var ye=U[Ae],Re=1;q===1&&(Re=ye.length),j.writeVarint(se(1,Re));for(var Ue=q===3?ye.length-1:ye.length,Ne=0;Ne<Ue;Ne++){Ne===1&&q!==1&&j.writeVarint(se(2,Ue-1));var Be=ye[Ne].x-le,bt=ye[Ne].y-ve;j.writeVarint(ut(Be)),j.writeVarint(ut(bt)),le+=Be,ve+=bt}q===3&&j.writeVarint(se(7,1))}}function cn(ne,j){var U=typeof ne;U==="string"?j.writeStringField(1,ne):U==="boolean"?j.writeBooleanField(7,ne):U==="number"&&(ne%1!=0?j.writeDoubleField(3,ne):ne<0?j.writeSVarintField(6,ne):j.writeVarintField(5,ne))}te.exports=Y,te.exports.fromVectorTileJs=Y,te.exports.fromGeojsonVt=function(ne,j){j=j||{};var U={};for(var q in ne)U[q]=new X(ne[q].features,j),U[q].name=q,U[q].version=j.version,U[q].extent=j.extent;return Y({layers:U})},te.exports.GeoJSONWrapper=X;var tn=p.bw(te.exports);const et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},ht=Math.fround||(Tt=new Float32Array(1),ne=>(Tt[0]=+ne,Tt[0]));var Tt;const kt=3,At=5,jt=6;class Hn{constructor(j){this.options=Object.assign(Object.create(et),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:U,minZoom:q,maxZoom:le}=this.options;U&&console.time("total time");const ve=`prepare ${j.length} points`;U&&console.time(ve),this.points=j;const Ee=[];for(let ye=0;ye<j.length;ye++){const Re=j[ye];if(!Re.geometry)continue;const[Ue,Ne]=Re.geometry.coordinates,Be=ht(Pn(Ue)),bt=ht(vr(Ne));Ee.push(Be,bt,1/0,ye,-1,1),this.options.reduce&&Ee.push(0)}let Ae=this.trees[le+1]=this._createTree(Ee);U&&console.timeEnd(ve);for(let ye=le;ye>=q;ye--){const Re=+Date.now();Ae=this.trees[ye]=this._createTree(this._cluster(Ae,ye)),U&&console.log("z%d: %d clusters in %dms",ye,Ae.numItems,+Date.now()-Re)}return U&&console.timeEnd("total time"),this}getClusters(j,U){let q=((j[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,j[1]));let ve=j[2]===180?180:((j[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)q=-180,ve=180;else if(q>ve){const Ne=this.getClusters([q,le,180,Ee],U),Be=this.getClusters([-180,le,ve,Ee],U);return Ne.concat(Be)}const Ae=this.trees[this._limitZoom(U)],ye=Ae.range(Pn(q),vr(Ee),Pn(ve),vr(le)),Re=Ae.data,Ue=[];for(const Ne of ye){const Be=this.stride*Ne;Ue.push(Re[Be+At]>1?fn(Re,Be,this.clusterProps):this.points[Re[Be+kt]])}return Ue}getChildren(j){const U=this._getOriginId(j),q=this._getOriginZoom(j),le="No cluster with the specified id.",ve=this.trees[q];if(!ve)throw new Error(le);const Ee=ve.data;if(U*this.stride>=Ee.length)throw new Error(le);const Ae=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ye=ve.within(Ee[U*this.stride],Ee[U*this.stride+1],Ae),Re=[];for(const Ue of ye){const Ne=Ue*this.stride;Ee[Ne+4]===j&&Re.push(Ee[Ne+At]>1?fn(Ee,Ne,this.clusterProps):this.points[Ee[Ne+kt]])}if(Re.length===0)throw new Error(le);return Re}getLeaves(j,U,q){const le=[];return this._appendLeaves(le,j,U=U||10,q=q||0,0),le}getTile(j,U,q){const le=this.trees[this._limitZoom(j)],ve=Math.pow(2,j),{extent:Ee,radius:Ae}=this.options,ye=Ae/Ee,Re=(q-ye)/ve,Ue=(q+1+ye)/ve,Ne={features:[]};return this._addTileFeatures(le.range((U-ye)/ve,Re,(U+1+ye)/ve,Ue),le.data,U,q,ve,Ne),U===0&&this._addTileFeatures(le.range(1-ye/ve,Re,1,Ue),le.data,ve,q,ve,Ne),U===ve-1&&this._addTileFeatures(le.range(0,Re,ye/ve,Ue),le.data,-1,q,ve,Ne),Ne.features.length?Ne:null}getClusterExpansionZoom(j){let U=this._getOriginZoom(j)-1;for(;U<=this.options.maxZoom;){const q=this.getChildren(j);if(U++,q.length!==1)break;j=q[0].properties.cluster_id}return U}_appendLeaves(j,U,q,le,ve){const Ee=this.getChildren(U);for(const Ae of Ee){const ye=Ae.properties;if(ye&&ye.cluster?ve+ye.point_count<=le?ve+=ye.point_count:ve=this._appendLeaves(j,ye.cluster_id,q,le,ve):ve<le?ve++:j.push(Ae),j.length===q)break}return ve}_createTree(j){const U=new p.av(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<j.length;q+=this.stride)U.add(j[q],j[q+1]);return U.finish(),U.data=j,U}_addTileFeatures(j,U,q,le,ve,Ee){for(const Ae of j){const ye=Ae*this.stride,Re=U[ye+At]>1;let Ue,Ne,Be;if(Re)Ue=kn(U,ye,this.clusterProps),Ne=U[ye],Be=U[ye+1];else{const Gt=this.points[U[ye+kt]];Ue=Gt.properties;const[Mt,Kt]=Gt.geometry.coordinates;Ne=Pn(Mt),Be=vr(Kt)}const bt={type:1,geometry:[[Math.round(this.options.extent*(Ne*ve-q)),Math.round(this.options.extent*(Be*ve-le))]],tags:Ue};let yt;yt=Re||this.options.generateId?U[ye+kt]:this.points[U[ye+kt]].id,yt!==void 0&&(bt.id=yt),Ee.features.push(bt)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,U){const{radius:q,extent:le,reduce:ve,minPoints:Ee}=this.options,Ae=q/(le*Math.pow(2,U)),ye=j.data,Re=[],Ue=this.stride;for(let Ne=0;Ne<ye.length;Ne+=Ue){if(ye[Ne+2]<=U)continue;ye[Ne+2]=U;const Be=ye[Ne],bt=ye[Ne+1],yt=j.within(ye[Ne],ye[Ne+1],Ae),Gt=ye[Ne+At];let Mt=Gt;for(const Kt of yt){const gn=Kt*Ue;ye[gn+2]>U&&(Mt+=ye[gn+At])}if(Mt>Gt&&Mt>=Ee){let Kt,gn=Be*Gt,Sn=bt*Gt,Wn=-1;const Rt=((Ne/Ue|0)<<5)+(U+1)+this.points.length;for(const Dn of yt){const ir=Dn*Ue;if(ye[ir+2]<=U)continue;ye[ir+2]=U;const zr=ye[ir+At];gn+=ye[ir]*zr,Sn+=ye[ir+1]*zr,ye[ir+4]=Rt,ve&&(Kt||(Kt=this._map(ye,Ne,!0),Wn=this.clusterProps.length,this.clusterProps.push(Kt)),ve(Kt,this._map(ye,ir)))}ye[Ne+4]=Rt,Re.push(gn/Mt,Sn/Mt,1/0,Rt,-1,Mt),ve&&Re.push(Wn)}else{for(let Kt=0;Kt<Ue;Kt++)Re.push(ye[Ne+Kt]);if(Mt>1)for(const Kt of yt){const gn=Kt*Ue;if(!(ye[gn+2]<=U)){ye[gn+2]=U;for(let Sn=0;Sn<Ue;Sn++)Re.push(ye[gn+Sn])}}}}return Re}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,U,q){if(j[U+At]>1){const Ee=this.clusterProps[j[U+jt]];return q?Object.assign({},Ee):Ee}const le=this.points[j[U+kt]].properties,ve=this.options.map(le);return q&&ve===le?Object.assign({},ve):ve}}function fn(ne,j,U){return{type:"Feature",id:ne[j+kt],properties:kn(ne,j,U),geometry:{type:"Point",coordinates:[(q=ne[j],360*(q-.5)),Lr(ne[j+1])]}};var q}function kn(ne,j,U){const q=ne[j+At],le=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,ve=ne[j+jt],Ee=ve===-1?{}:Object.assign({},U[ve]);return Object.assign(Ee,{cluster:!0,cluster_id:ne[j+kt],point_count:q,point_count_abbreviated:le})}function Pn(ne){return ne/360+.5}function vr(ne){const j=Math.sin(ne*Math.PI/180),U=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return U<0?0:U>1?1:U}function Lr(ne){const j=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function Dr(ne,j,U,q){for(var le,ve=q,Ee=U-j>>1,Ae=U-j,ye=ne[j],Re=ne[j+1],Ue=ne[U],Ne=ne[U+1],Be=j+3;Be<U;Be+=3){var bt=ei(ne[Be],ne[Be+1],ye,Re,Ue,Ne);if(bt>ve)le=Be,ve=bt;else if(bt===ve){var yt=Math.abs(Be-Ee);yt<Ae&&(le=Be,Ae=yt)}}ve>q&&(le-j>3&&Dr(ne,j,le,q),ne[le+2]=ve,U-le>3&&Dr(ne,le,U,q))}function ei(ne,j,U,q,le,ve){var Ee=le-U,Ae=ve-q;if(Ee!==0||Ae!==0){var ye=((ne-U)*Ee+(j-q)*Ae)/(Ee*Ee+Ae*Ae);ye>1?(U=le,q=ve):ye>0&&(U+=Ee*ye,q+=Ae*ye)}return(Ee=ne-U)*Ee+(Ae=j-q)*Ae}function Nn(ne,j,U,q){var le={id:ne===void 0?null:ne,type:j,geometry:U,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var Ee=ve.geometry,Ae=ve.type;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")Oi(ve,Ee);else if(Ae==="Polygon"||Ae==="MultiLineString")for(var ye=0;ye<Ee.length;ye++)Oi(ve,Ee[ye]);else if(Ae==="MultiPolygon")for(ye=0;ye<Ee.length;ye++)for(var Re=0;Re<Ee[ye].length;Re++)Oi(ve,Ee[ye][Re])}(le),le}function Oi(ne,j){for(var U=0;U<j.length;U+=3)ne.minX=Math.min(ne.minX,j[U]),ne.minY=Math.min(ne.minY,j[U+1]),ne.maxX=Math.max(ne.maxX,j[U]),ne.maxY=Math.max(ne.maxY,j[U+1])}function En(ne,j,U,q){if(j.geometry){var le=j.geometry.coordinates,ve=j.geometry.type,Ee=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),Ae=[],ye=j.id;if(U.promoteId?ye=j.properties[U.promoteId]:U.generateId&&(ye=q||0),ve==="Point")no(le,Ae);else if(ve==="MultiPoint")for(var Re=0;Re<le.length;Re++)no(le[Re],Ae);else if(ve==="LineString")Oe(le,Ae,Ee,!1);else if(ve==="MultiLineString"){if(U.lineMetrics){for(Re=0;Re<le.length;Re++)Oe(le[Re],Ae=[],Ee,!1),ne.push(Nn(ye,"LineString",Ae,j.properties));return}ro(le,Ae,Ee,!1)}else if(ve==="Polygon")ro(le,Ae,Ee,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(Re=0;Re<j.geometry.geometries.length;Re++)En(ne,{id:ye,geometry:j.geometry.geometries[Re],properties:j.properties},U,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Re=0;Re<le.length;Re++){var Ue=[];ro(le[Re],Ue,Ee,!0),Ae.push(Ue)}}ne.push(Nn(ye,ve,Ae,j.properties))}}function no(ne,j){j.push(Wr(ne[0])),j.push(Vt(ne[1])),j.push(0)}function Oe(ne,j,U,q){for(var le,ve,Ee=0,Ae=0;Ae<ne.length;Ae++){var ye=Wr(ne[Ae][0]),Re=Vt(ne[Ae][1]);j.push(ye),j.push(Re),j.push(0),Ae>0&&(Ee+=q?(le*Re-ye*ve)/2:Math.sqrt(Math.pow(ye-le,2)+Math.pow(Re-ve,2))),le=ye,ve=Re}var Ue=j.length-3;j[2]=1,Dr(j,0,Ue,U),j[Ue+2]=1,j.size=Math.abs(Ee),j.start=0,j.end=j.size}function ro(ne,j,U,q){for(var le=0;le<ne.length;le++){var ve=[];Oe(ne[le],ve,U,q),j.push(ve)}}function Wr(ne){return ne/360+.5}function Vt(ne){var j=Math.sin(ne*Math.PI/180),U=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return U<0?0:U>1?1:U}function en(ne,j,U,q,le,ve,Ee,Ae){if(q/=j,ve>=(U/=j)&&Ee<q)return ne;if(Ee<U||ve>=q)return null;for(var ye=[],Re=0;Re<ne.length;Re++){var Ue=ne[Re],Ne=Ue.geometry,Be=Ue.type,bt=le===0?Ue.minX:Ue.minY,yt=le===0?Ue.maxX:Ue.maxY;if(bt>=U&&yt<q)ye.push(Ue);else if(!(yt<U||bt>=q)){var Gt=[];if(Be==="Point"||Be==="MultiPoint")wi(Ne,Gt,U,q,le);else if(Be==="LineString")Do(Ne,Gt,U,q,le,!1,Ae.lineMetrics);else if(Be==="MultiLineString")ti(Ne,Gt,U,q,le,!1);else if(Be==="Polygon")ti(Ne,Gt,U,q,le,!0);else if(Be==="MultiPolygon")for(var Mt=0;Mt<Ne.length;Mt++){var Kt=[];ti(Ne[Mt],Kt,U,q,le,!0),Kt.length&&Gt.push(Kt)}if(Gt.length){if(Ae.lineMetrics&&Be==="LineString"){for(Mt=0;Mt<Gt.length;Mt++)ye.push(Nn(Ue.id,Be,Gt[Mt],Ue.tags));continue}Be!=="LineString"&&Be!=="MultiLineString"||(Gt.length===1?(Be="LineString",Gt=Gt[0]):Be="MultiLineString"),Be!=="Point"&&Be!=="MultiPoint"||(Be=Gt.length===3?"Point":"MultiPoint"),ye.push(Nn(Ue.id,Be,Gt,Ue.tags))}}}return ye.length?ye:null}function wi(ne,j,U,q,le){for(var ve=0;ve<ne.length;ve+=3){var Ee=ne[ve+le];Ee>=U&&Ee<=q&&(j.push(ne[ve]),j.push(ne[ve+1]),j.push(ne[ve+2]))}}function Do(ne,j,U,q,le,ve,Ee){for(var Ae,ye,Re=Qn(ne),Ue=le===0?mn:Kn,Ne=ne.start,Be=0;Be<ne.length-3;Be+=3){var bt=ne[Be],yt=ne[Be+1],Gt=ne[Be+2],Mt=ne[Be+3],Kt=ne[Be+4],gn=le===0?bt:yt,Sn=le===0?Mt:Kt,Wn=!1;Ee&&(Ae=Math.sqrt(Math.pow(bt-Mt,2)+Math.pow(yt-Kt,2))),gn<U?Sn>U&&(ye=Ue(Re,bt,yt,Mt,Kt,U),Ee&&(Re.start=Ne+Ae*ye)):gn>q?Sn<q&&(ye=Ue(Re,bt,yt,Mt,Kt,q),Ee&&(Re.start=Ne+Ae*ye)):Gr(Re,bt,yt,Gt),Sn<U&&gn>=U&&(ye=Ue(Re,bt,yt,Mt,Kt,U),Wn=!0),Sn>q&&gn<=q&&(ye=Ue(Re,bt,yt,Mt,Kt,q),Wn=!0),!ve&&Wn&&(Ee&&(Re.end=Ne+Ae*ye),j.push(Re),Re=Qn(ne)),Ee&&(Ne+=Ae)}var Rt=ne.length-3;bt=ne[Rt],yt=ne[Rt+1],Gt=ne[Rt+2],(gn=le===0?bt:yt)>=U&&gn<=q&&Gr(Re,bt,yt,Gt),Rt=Re.length-3,ve&&Rt>=3&&(Re[Rt]!==Re[0]||Re[Rt+1]!==Re[1])&&Gr(Re,Re[0],Re[1],Re[2]),Re.length&&j.push(Re)}function Qn(ne){var j=[];return j.size=ne.size,j.start=ne.start,j.end=ne.end,j}function ti(ne,j,U,q,le,ve){for(var Ee=0;Ee<ne.length;Ee++)Do(ne[Ee],j,U,q,le,ve,!1)}function Gr(ne,j,U,q){ne.push(j),ne.push(U),ne.push(q)}function mn(ne,j,U,q,le,ve){var Ee=(ve-j)/(q-j);return ne.push(ve),ne.push(U+(le-U)*Ee),ne.push(1),Ee}function Kn(ne,j,U,q,le,ve){var Ee=(ve-U)/(le-U);return ne.push(j+(q-j)*Ee),ne.push(ve),ne.push(1),Ee}function Ke(ne,j){for(var U=[],q=0;q<ne.length;q++){var le,ve=ne[q],Ee=ve.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")le=Ir(ve.geometry,j);else if(Ee==="MultiLineString"||Ee==="Polygon"){le=[];for(var Ae=0;Ae<ve.geometry.length;Ae++)le.push(Ir(ve.geometry[Ae],j))}else if(Ee==="MultiPolygon")for(le=[],Ae=0;Ae<ve.geometry.length;Ae++){for(var ye=[],Re=0;Re<ve.geometry[Ae].length;Re++)ye.push(Ir(ve.geometry[Ae][Re],j));le.push(ye)}U.push(Nn(ve.id,Ee,le,ve.tags))}return U}function Ir(ne,j){var U=[];U.size=ne.size,ne.start!==void 0&&(U.start=ne.start,U.end=ne.end);for(var q=0;q<ne.length;q+=3)U.push(ne[q]+j,ne[q+1],ne[q+2]);return U}function dr(ne,j){if(ne.transformed)return ne;var U,q,le,ve=1<<ne.z,Ee=ne.x,Ae=ne.y;for(U=0;U<ne.features.length;U++){var ye=ne.features[U],Re=ye.geometry,Ue=ye.type;if(ye.geometry=[],Ue===1)for(q=0;q<Re.length;q+=2)ye.geometry.push(Jo(Re[q],Re[q+1],j,ve,Ee,Ae));else for(q=0;q<Re.length;q++){var Ne=[];for(le=0;le<Re[q].length;le+=2)Ne.push(Jo(Re[q][le],Re[q][le+1],j,ve,Ee,Ae));ye.geometry.push(Ne)}}return ne.transformed=!0,ne}function Jo(ne,j,U,q,le,ve){return[Math.round(U*(ne*q-le)),Math.round(U*(j*q-ve))]}function bi(ne,j,U,q,le){for(var ve=j===le.maxZoom?0:le.tolerance/((1<<j)*le.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:q,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ae=0;Ae<ne.length;Ae++){Ee.numFeatures++,Ze(Ee,ne[Ae],ve,le);var ye=ne[Ae].minX,Re=ne[Ae].minY,Ue=ne[Ae].maxX,Ne=ne[Ae].maxY;ye<Ee.minX&&(Ee.minX=ye),Re<Ee.minY&&(Ee.minY=Re),Ue>Ee.maxX&&(Ee.maxX=Ue),Ne>Ee.maxY&&(Ee.maxY=Ne)}return Ee}function Ze(ne,j,U,q){var le=j.geometry,ve=j.type,Ee=[];if(ve==="Point"||ve==="MultiPoint")for(var Ae=0;Ae<le.length;Ae+=3)Ee.push(le[Ae]),Ee.push(le[Ae+1]),ne.numPoints++,ne.numSimplified++;else if(ve==="LineString")Bt(Ee,le,ne,U,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(Ae=0;Ae<le.length;Ae++)Bt(Ee,le[Ae],ne,U,ve==="Polygon",Ae===0);else if(ve==="MultiPolygon")for(var ye=0;ye<le.length;ye++){var Re=le[ye];for(Ae=0;Ae<Re.length;Ae++)Bt(Ee,Re[Ae],ne,U,!0,Ae===0)}if(Ee.length){var Ue=j.tags||null;if(ve==="LineString"&&q.lineMetrics){for(var Ne in Ue={},j.tags)Ue[Ne]=j.tags[Ne];Ue.mapbox_clip_start=le.start/le.size,Ue.mapbox_clip_end=le.end/le.size}var Be={geometry:Ee,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:Ue};j.id!==null&&(Be.id=j.id),ne.features.push(Be)}}function Bt(ne,j,U,q,le,ve){var Ee=q*q;if(q>0&&j.size<(le?Ee:q))U.numPoints+=j.length/3;else{for(var Ae=[],ye=0;ye<j.length;ye+=3)(q===0||j[ye+2]>Ee)&&(U.numSimplified++,Ae.push(j[ye]),Ae.push(j[ye+1])),U.numPoints++;le&&function(Re,Ue){for(var Ne=0,Be=0,bt=Re.length,yt=bt-2;Be<bt;yt=Be,Be+=2)Ne+=(Re[Be]-Re[yt])*(Re[Be+1]+Re[yt+1]);if(Ne>0===Ue)for(Be=0,bt=Re.length;Be<bt/2;Be+=2){var Gt=Re[Be],Mt=Re[Be+1];Re[Be]=Re[bt-2-Be],Re[Be+1]=Re[bt-1-Be],Re[bt-2-Be]=Gt,Re[bt-1-Be]=Mt}}(Ae,ve),ne.push(Ae)}}function Pt(ne,j){var U=(j=this.options=function(le,ve){for(var Ee in ve)le[Ee]=ve[Ee];return le}(Object.create(this.options),j)).debug;if(U&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var q=function(le,ve){var Ee=[];if(le.type==="FeatureCollection")for(var Ae=0;Ae<le.features.length;Ae++)En(Ee,le.features[Ae],ve,Ae);else En(Ee,le.type==="Feature"?le:{geometry:le},ve);return Ee}(ne,j);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),q=function(le,ve){var Ee=ve.buffer/ve.extent,Ae=le,ye=en(le,1,-1-Ee,Ee,0,-1,2,ve),Re=en(le,1,1-Ee,2+Ee,0,-1,2,ve);return(ye||Re)&&(Ae=en(le,1,-Ee,1+Ee,0,-1,2,ve)||[],ye&&(Ae=Ke(ye,1).concat(Ae)),Re&&(Ae=Ae.concat(Ke(Re,-1)))),Ae}(q,j),q.length&&this.splitTile(q,0,0,0),U&&(q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Cr(ne,j,U){return 32*((1<<ne)*U+j)+ne}function xr(ne,j){return j?ne.properties[j]:ne.id}function Ot(ne,j){if(ne==null)return!0;if(ne.type==="Feature")return xr(ne,j)!=null;if(ne.type==="FeatureCollection"){const U=new Set;for(const q of ne.features){const le=xr(q,j);if(le==null||U.has(le))return!1;U.add(le)}return!0}return!1}function Fi(ne,j){const U=new Map;if(ne!=null)if(ne.type==="Feature")U.set(xr(ne,j),ne);else for(const q of ne.features)U.set(xr(q,j),q);return U}Pt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Pt.prototype.splitTile=function(ne,j,U,q,le,ve,Ee){for(var Ae=[ne,j,U,q],ye=this.options,Re=ye.debug;Ae.length;){q=Ae.pop(),U=Ae.pop(),j=Ae.pop(),ne=Ae.pop();var Ue=1<<j,Ne=Cr(j,U,q),Be=this.tiles[Ne];if(!Be&&(Re>1&&console.time("creation"),Be=this.tiles[Ne]=bi(ne,j,U,q,ye),this.tileCoords.push({z:j,x:U,y:q}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,U,q,Be.numFeatures,Be.numPoints,Be.numSimplified),console.timeEnd("creation"));var bt="z"+j;this.stats[bt]=(this.stats[bt]||0)+1,this.total++}if(Be.source=ne,le){if(j===ye.maxZoom||j===le)continue;var yt=1<<le-j;if(U!==Math.floor(ve/yt)||q!==Math.floor(Ee/yt))continue}else if(j===ye.indexMaxZoom||Be.numPoints<=ye.indexMaxPoints)continue;if(Be.source=null,ne.length!==0){Re>1&&console.time("clipping");var Gt,Mt,Kt,gn,Sn,Wn,Rt=.5*ye.buffer/ye.extent,Dn=.5-Rt,ir=.5+Rt,zr=1+Rt;Gt=Mt=Kt=gn=null,Sn=en(ne,Ue,U-Rt,U+ir,0,Be.minX,Be.maxX,ye),Wn=en(ne,Ue,U+Dn,U+zr,0,Be.minX,Be.maxX,ye),ne=null,Sn&&(Gt=en(Sn,Ue,q-Rt,q+ir,1,Be.minY,Be.maxY,ye),Mt=en(Sn,Ue,q+Dn,q+zr,1,Be.minY,Be.maxY,ye),Sn=null),Wn&&(Kt=en(Wn,Ue,q-Rt,q+ir,1,Be.minY,Be.maxY,ye),gn=en(Wn,Ue,q+Dn,q+zr,1,Be.minY,Be.maxY,ye),Wn=null),Re>1&&console.timeEnd("clipping"),Ae.push(Gt||[],j+1,2*U,2*q),Ae.push(Mt||[],j+1,2*U,2*q+1),Ae.push(Kt||[],j+1,2*U+1,2*q),Ae.push(gn||[],j+1,2*U+1,2*q+1)}}},Pt.prototype.getTile=function(ne,j,U){var q=this.options,le=q.extent,ve=q.debug;if(ne<0||ne>24)return null;var Ee=1<<ne,Ae=Cr(ne,j=(j%Ee+Ee)%Ee,U);if(this.tiles[Ae])return dr(this.tiles[Ae],le);ve>1&&console.log("drilling down to z%d-%d-%d",ne,j,U);for(var ye,Re=ne,Ue=j,Ne=U;!ye&&Re>0;)Re--,Ue=Math.floor(Ue/2),Ne=Math.floor(Ne/2),ye=this.tiles[Cr(Re,Ue,Ne)];return ye&&ye.source?(ve>1&&console.log("found parent tile z%d-%d-%d",Re,Ue,Ne),ve>1&&console.time("drilling down"),this.splitTile(ye.source,Re,Ue,Ne,ne,j,U),ve>1&&console.timeEnd("drilling down"),this.tiles[Ae]?dr(this.tiles[Ae],le):null):null};class Ni extends L{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(j,U){return p._(this,void 0,void 0,function*(){const q=j.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!le)return null;const ve=new class{constructor(Ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.W,this.length=Ae.length,this._features=Ae}feature(Ae){return new class{constructor(ye){this._feature=ye,this.extent=p.W,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Re of this._feature.geometry)ye.push([new p.P(Re[0],Re[1])]);return ye}{const ye=[];for(const Re of this._feature.geometry){const Ue=[];for(const Ne of Re)Ue.push(new p.P(Ne[0],Ne[1]));ye.push(Ue)}return ye}}toGeoJSON(ye,Re,Ue){return me.call(this,ye,Re,Ue)}}(this._features[Ae])}}(le.features);let Ee=tn(ve);return Ee.byteOffset===0&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),{vectorTile:ve,rawData:Ee.buffer}})}loadData(j){return p._(this,void 0,void 0,function*(){var U;(U=this._pendingRequest)===null||U===void 0||U.abort();const q=!!(j&&j.request&&j.request.collectResourceTiming)&&new p.bt(j.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(j,this._pendingRequest),this._geoJSONIndex=j.cluster?new Hn(function({superclusterOptions:ve,clusterProperties:Ee}){if(!Ee||!ve)return ve;const Ae={},ye={},Re={accumulated:null,zoom:0},Ue={properties:null},Ne=Object.keys(Ee);for(const Be of Ne){const[bt,yt]=Ee[Be],Gt=p.bA(yt),Mt=p.bA(typeof bt=="string"?[bt,["accumulated"],["get",Be]]:bt);Ae[Be]=Gt.value,ye[Be]=Mt.value}return ve.map=Be=>{Ue.properties=Be;const bt={};for(const yt of Ne)bt[yt]=Ae[yt].evaluate(Re,Ue);return bt},ve.reduce=(Be,bt)=>{Ue.properties=bt;for(const yt of Ne)Re.accumulated=Be[yt],Be[yt]=ye[yt].evaluate(Re,Ue)},ve}(j)).load((yield this._pendingData).features):new Pt(yield this._pendingData,j.geojsonVtOptions),this.loaded={};const le={};if(q){const ve=q.finish();ve&&(le.resourceTiming={},le.resourceTiming[j.source]=JSON.parse(JSON.stringify(ve)))}return le}catch(le){if(delete this._pendingRequest,p.bz(le))return{abandoned:!0};throw le}})}getData(){return p._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(j){const U=this.loaded;return U&&U[j.uid]?super.reloadTile(j):this.loadTile(j)}loadAndProcessGeoJSON(j,U){return p._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(j,U);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(ue(q,!0),j.filter){const le=p.bA(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(Ee=>`${Ee.key}: ${Ee.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(Ee=>le.value.evaluate({zoom:0},Ee))}}return q})}loadGeoJSON(j,U){return p._(this,void 0,void 0,function*(){const{promoteId:q}=j;if(j.request){const le=yield p.h(j.request,U);return this._dataUpdateable=Ot(le.data,q)?Fi(le.data,q):void 0,le.data}if(typeof j.data=="string")try{const le=JSON.parse(j.data);return this._dataUpdateable=Ot(le,q)?Fi(le,q):void 0,le}catch{throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`)}if(!j.dataDiff)throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${j.source}`);return function(le,ve,Ee){var Ae,ye,Re,Ue;if(ve.removeAll&&le.clear(),ve.remove)for(const Ne of ve.remove)le.delete(Ne);if(ve.add)for(const Ne of ve.add){const Be=xr(Ne,Ee);Be!=null&&le.set(Be,Ne)}if(ve.update)for(const Ne of ve.update){let Be=le.get(Ne.id);if(Be==null)continue;const bt=!Ne.removeAllProperties&&(((Ae=Ne.removeProperties)===null||Ae===void 0?void 0:Ae.length)>0||((ye=Ne.addOrUpdateProperties)===null||ye===void 0?void 0:ye.length)>0);if((Ne.newGeometry||Ne.removeAllProperties||bt)&&(Be=Object.assign({},Be),le.set(Ne.id,Be),bt&&(Be.properties=Object.assign({},Be.properties))),Ne.newGeometry&&(Be.geometry=Ne.newGeometry),Ne.removeAllProperties)Be.properties={};else if(((Re=Ne.removeProperties)===null||Re===void 0?void 0:Re.length)>0)for(const yt of Ne.removeProperties)Object.prototype.hasOwnProperty.call(Be.properties,yt)&&delete Be.properties[yt];if(((Ue=Ne.addOrUpdateProperties)===null||Ue===void 0?void 0:Ue.length)>0)for(const{key:yt,value:Gt}of Ne.addOrUpdateProperties)Be.properties[yt]=Gt}}(this._dataUpdateable,j.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(j){return p._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(j){return this._geoJSONIndex.getClusterExpansionZoom(j.clusterId)}getClusterChildren(j){return this._geoJSONIndex.getChildren(j.clusterId)}getClusterLeaves(j){return this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset)}}class Wt{constructor(j){this.self=j,this.actor=new p.C(j),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(U,q)=>{if(this.externalWorkerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.externalWorkerSourceTypes[U]=q},this.self.addProtocol=p.bg,this.self.removeProtocol=p.bh,this.self.registerRTLTextPlugin=U=>{if(p.bB.isParsed())throw new Error("RTL text plugin already registered.");p.bB.setMethods(U)},this.actor.registerMessageHandler("LDT",(U,q)=>this._getDEMWorkerSource(U,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(U,q)=>p._(this,void 0,void 0,function*(){this._getDEMWorkerSource(U,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(U,q)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(U,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(U,q)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(U,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(U,q)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(U,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(U,q)=>this._getWorkerSource(U,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(U,q)=>this._getWorkerSource(U,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(U,q)=>this._getWorkerSource(U,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(U,q)=>this._getWorkerSource(U,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(U,q)=>this._getWorkerSource(U,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(U,q)=>this._getWorkerSource(U,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(U,q)=>p._(this,void 0,void 0,function*(){if(!this.workerSources[U]||!this.workerSources[U][q.type]||!this.workerSources[U][q.type][q.source])return;const le=this.workerSources[U][q.type][q.source];delete this.workerSources[U][q.type][q.source],le.removeSource!==void 0&&le.removeSource(q)})),this.actor.registerMessageHandler("RM",U=>p._(this,void 0,void 0,function*(){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U]})),this.actor.registerMessageHandler("SR",(U,q)=>p._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(U,q)=>this._syncRTLPluginState(U,q)),this.actor.registerMessageHandler("IS",(U,q)=>p._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(U,q)=>this._setImages(U,q)),this.actor.registerMessageHandler("UL",(U,q)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(U).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(U,q)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(U).replace(q)}))}_setImages(j,U){return p._(this,void 0,void 0,function*(){this.availableImages[j]=U;for(const q in this.workerSources[j]){const le=this.workerSources[j][q];for(const ve in le)le[ve].availableImages=U}})}_syncRTLPluginState(j,U){return p._(this,void 0,void 0,function*(){if(p.bB.isParsed())return p.bB.getState();if(U.pluginStatus!=="loading")return p.bB.setState(U),U;const q=U.pluginURL;if(this.self.importScripts(q),p.bB.isParsed()){const le={pluginStatus:"loaded",pluginURL:q};return p.bB.setState(le),le}throw p.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(j){let U=this.availableImages[j];return U||(U=[]),U}_getLayerIndex(j){let U=this.layerIndexes[j];return U||(U=this.layerIndexes[j]=new c),U}_getWorkerSource(j,U,q){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][U]||(this.workerSources[j][U]={}),!this.workerSources[j][U][q]){const le={sendAsync:(ve,Ee)=>(ve.targetMapId=j,this.actor.sendAsync(ve,Ee))};switch(U){case"vector":this.workerSources[j][U][q]=new L(le,this._getLayerIndex(j),this._getAvailableImages(j));break;case"geojson":this.workerSources[j][U][q]=new Ni(le,this._getLayerIndex(j),this._getAvailableImages(j));break;default:this.workerSources[j][U][q]=new this.externalWorkerSourceTypes[U](le,this._getLayerIndex(j),this._getAvailableImages(j))}}return this.workerSources[j][U][q]}_getDEMWorkerSource(j,U){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][U]||(this.demWorkerSources[j][U]=new z),this.demWorkerSources[j][U]}}return p.i(self)&&(self.worker=new Wt(self)),Wt}),a("index",["exports","./shared"],function(p,c){var S="4.4.1";let A,D;const L={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:_=>new Promise((i,u)=>{const f=requestAnimationFrame(i);_.signal.addEventListener("abort",()=>{cancelAnimationFrame(f),u(c.c())})}),getImageData(_,i=0){return this.getImageCanvasContext(_).getImageData(-i,-i,_.width+2*i,_.height+2*i)},getImageCanvasContext(_){const i=window.document.createElement("canvas"),u=i.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return i.width=_.width,i.height=_.height,u.drawImage(_,0,0,_.width,_.height),u},resolveURL:_=>(A||(A=document.createElement("a")),A.href=_,A.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(D==null&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}};class z{static testProp(i){if(!z.docStyle)return i[0];for(let u=0;u<i.length;u++)if(i[u]in z.docStyle)return i[u];return i[0]}static create(i,u,f){const g=window.document.createElement(i);return u!==void 0&&(g.className=u),f&&f.appendChild(g),g}static createNS(i,u){return window.document.createElementNS(i,u)}static disableDrag(){z.docStyle&&z.selectProp&&(z.userSelect=z.docStyle[z.selectProp],z.docStyle[z.selectProp]="none")}static enableDrag(){z.docStyle&&z.selectProp&&(z.docStyle[z.selectProp]=z.userSelect)}static setTransform(i,u){i.style[z.transformProp]=u}static addEventListener(i,u,f,g={}){i.addEventListener(u,f,"passive"in g?g:g.capture)}static removeEventListener(i,u,f,g={}){i.removeEventListener(u,f,"passive"in g?g:g.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",z.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",z.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",z.suppressClickInternal,!0)},0)}static getScale(i){const u=i.getBoundingClientRect();return{x:u.width/i.offsetWidth||1,y:u.height/i.offsetHeight||1,boundingClientRect:u}}static getPoint(i,u,f){const g=u.boundingClientRect;return new c.P((f.clientX-g.left)/u.x-i.clientLeft,(f.clientY-g.top)/u.y-i.clientTop)}static mousePos(i,u){const f=z.getScale(i);return z.getPoint(i,f,u)}static touchPos(i,u){const f=[],g=z.getScale(i);for(let v=0;v<u.length;v++)f.push(z.getPoint(i,g,u[v]));return f}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}z.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,z.selectProp=z.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),z.transformProp=z.testProp(["transform","WebkitTransform"]);const ee={supported:!1,testSupport:function(_){!me&&ue&&(te?G(_):pe=_)}};let pe,ue,me=!1,te=!1;function G(_){const i=_.createTexture();_.bindTexture(_.TEXTURE_2D,i);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,ue),_.isContextLost())return;ee.supported=!0}catch{}_.deleteTexture(i),me=!0}var re;typeof document<"u"&&(ue=document.createElement("img"),ue.onload=()=>{pe&&G(pe),pe=null,te=!0},ue.onerror=()=>{me=!0,pe=null},ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let i,u,f,g;_.resetRequestQueue=()=>{i=[],u=0,f=0,g={}},_.addThrottleControl=C=>{const M=f++;return g[M]=C,M},_.removeThrottleControl=C=>{delete g[C],T()},_.getImage=(C,M,B=!0)=>new Promise((N,H)=>{ee.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),c.e(C,{type:"image"}),i.push({abortController:M,requestParameters:C,supportImageRefresh:B,state:"queued",onError:K=>{H(K)},onSuccess:K=>{N(K)}}),T()});const v=C=>c._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:M,supportImageRefresh:B,onError:N,onSuccess:H,abortController:K}=C,oe=B===!1&&!c.i(self)&&!c.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce((_e,Te)=>_e&&Te==="accept",!0));u++;const fe=oe?I(M,K):c.m(M,K);try{const _e=yield fe;delete C.abortController,C.state="completed",_e.data instanceof HTMLImageElement||c.b(_e.data)?H(_e):_e.data&&H({data:yield(ae=_e.data,typeof createImageBitmap=="function"?c.d(ae):c.f(ae)),cacheControl:_e.cacheControl,expires:_e.expires})}catch(_e){delete C.abortController,N(_e)}finally{u--,T()}var ae}),T=()=>{const C=(()=>{for(const M of Object.keys(g))if(g[M]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=u;M<C&&i.length>0;M++){const B=i.shift();B.abortController.signal.aborted?M--:v(B)}},I=(C,M)=>new Promise((B,N)=>{const H=new Image,K=C.url,oe=C.credentials;oe&&oe==="include"?H.crossOrigin="use-credentials":(oe&&oe==="same-origin"||!c.s(K))&&(H.crossOrigin="anonymous"),M.signal.addEventListener("abort",()=>{H.src="",N(c.c())}),H.fetchPriority="high",H.onload=()=>{H.onerror=H.onload=null,B({data:H})},H.onerror=()=>{H.onerror=H.onload=null,M.signal.aborted||N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},H.src=K})}(re||(re={})),re.resetRequestQueue();class be{constructor(i){this._transformRequestFn=i}transformRequest(i,u){return this._transformRequestFn&&this._transformRequestFn(i,u)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function Le(_){var i=new c.A(3);return i[0]=_[0],i[1]=_[1],i[2]=_[2],i}var Me,J=function(_,i,u){return _[0]=i[0]-u[0],_[1]=i[1]-u[1],_[2]=i[2]-u[2],_};Me=new c.A(3),c.A!=Float32Array&&(Me[0]=0,Me[1]=0,Me[2]=0);var X=function(_){var i=_[0],u=_[1];return i*i+u*u};function Y(_){const i=[];if(typeof _=="string")i.push({id:"default",url:_});else if(_&&_.length>0){const u=[];for(const{id:f,url:g}of _){const v=`${f}${g}`;u.indexOf(v)===-1&&(u.push(v),i.push({id:f,url:g}))}}return i}function ie(_,i,u){const f=_.split("?");return f[0]+=`${i}${u}`,f.join("?")}(function(){var _=new c.A(2);c.A!=Float32Array&&(_[0]=0,_[1]=0)})();class de{constructor(i,u,f,g){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(u,g)}update(i,u,f){const{width:g,height:v}=i,T=!(this.size&&this.size[0]===g&&this.size[1]===v||f),{context:I}=this,{gl:C}=I;if(this.useMipmap=!!(u&&u.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!u||u.premultiply!==!1)),T)this.size=[g,v],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.b(i)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,i):C.texImage2D(C.TEXTURE_2D,0,this.format,g,v,0,this.format,C.UNSIGNED_BYTE,i.data);else{const{x:M,y:B}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.b(i)?C.texSubImage2D(C.TEXTURE_2D,0,M,B,C.RGBA,C.UNSIGNED_BYTE,i):C.texSubImage2D(C.TEXTURE_2D,0,M,B,g,v,C.RGBA,C.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(i,u,f){const{context:g}=this,{gl:v}=g;v.bindTexture(v.TEXTURE_2D,this.texture),f!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=v.LINEAR),i!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,i),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,f||i),this.filter=i),u!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function we(_){const{userImage:i}=_;return!!(i&&i.render&&i.render())&&(_.data.replace(new Uint8Array(i.data.buffer)),!0)}class se extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(i){const u=this.images[i];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(i,u){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let f=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new c.j(new Error(`Image "${i}" has invalid "content" value`))),f=!1),f}_validateStretch(i,u){if(!i)return!0;let f=0;for(const g of i){if(g[0]<f||g[1]<g[0]||u<g[1])return!1;f=g[1]}return!0}_validateContent(i,u){if(!i)return!0;if(i.length!==4)return!1;const f=u.spriteData,g=f&&f.width||u.data.width,v=f&&f.height||u.data.height;return!(i[0]<0||g<i[0]||i[1]<0||v<i[1]||i[2]<0||g<i[2]||i[3]<0||v<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,u,f=!0){const g=this.getImage(i);if(f&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((u,f)=>{let g=!0;if(!this.isLoaded())for(const v of i)this.images[v]||(g=!1);this.isLoaded()||g?u(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:u})})}_getImagesForIds(i){const u={};for(const f of i){let g=this.getImage(f);g||(this.fire(new c.k("styleimagemissing",{id:f})),g=this.getImage(f)),g?u[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],f=this.getImage(i);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new c.I(g,f);this.patterns[i]={bin:g,position:v}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new de(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const v in this.patterns)i.push(this.patterns[v].bin);const{w:u,h:f}=c.p(i),g=this.atlasImage;g.resize({width:u||1,height:f||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],I=T.x+1,C=T.y+1,M=this.getImage(v).data,B=M.width,N=M.height;c.R.copy(M,g,{x:0,y:0},{x:I,y:C},{width:B,height:N}),c.R.copy(M,g,{x:0,y:N-1},{x:I,y:C-1},{width:B,height:1}),c.R.copy(M,g,{x:0,y:0},{x:I,y:C+N},{width:B,height:1}),c.R.copy(M,g,{x:B-1,y:0},{x:I-1,y:C},{width:1,height:N}),c.R.copy(M,g,{x:0,y:0},{x:I+B,y:C},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||c.w(`Image with ID: "${u}" was not found`),we(f)&&this.updateImage(u,f)}}}const ut=1e20;function un(_,i,u,f,g,v,T,I,C){for(let M=i;M<i+f;M++)cn(_,u*v+M,v,g,T,I,C);for(let M=u;M<u+g;M++)cn(_,M*v+i,1,f,T,I,C)}function cn(_,i,u,f,g,v,T){v[0]=0,T[0]=-ut,T[1]=ut,g[0]=_[i];for(let I=1,C=0,M=0;I<f;I++){g[I]=_[i+I*u];const B=I*I;do{const N=v[C];M=(g[I]-g[N]+B-N*N)/(I-N)/2}while(M<=T[C]&&--C>-1);C++,v[C]=I,T[C]=M,T[C+1]=ut}for(let I=0,C=0;I<f;I++){for(;T[C+1]<I;)C++;const M=v[C],B=I-M;_[i+I*u]=g[M]+B*B}}class tn{constructor(i,u){this.requestManager=i,this.localIdeographFontFamily=u,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return c._(this,void 0,void 0,function*(){const u=[];for(const v in i)for(const T of i[v])u.push(this._getAndCacheGlyphsPromise(v,T));const f=yield Promise.all(u),g={};for(const{stack:v,id:T,glyph:I}of f)g[v]||(g[v]={}),g[v][T]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return g})}_getAndCacheGlyphsPromise(i,u){return c._(this,void 0,void 0,function*(){let f=this.entries[i];f||(f=this.entries[i]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[u];if(g!==void 0)return{stack:i,id:u,glyph:g};if(g=this._tinySDF(f,i,u),g)return f.glyphs[u]=g,{stack:i,id:u,glyph:g};const v=Math.floor(u/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[v])return{stack:i,id:u,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[v]){const I=tn.loadGlyphRange(i,v,this.url,this.requestManager);f.requests[v]=I}const T=yield f.requests[v];for(const I in T)this._doesCharSupportLocalGlyph(+I)||(f.glyphs[+I]=T[+I]);return f.ranges[v]=!0,{stack:i,id:u,glyph:T[u]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](i)||c.u["Hangul Syllables"](i)||c.u.Hiragana(i)||c.u.Katakana(i))}_tinySDF(i,u,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let v=i.tinySDF;if(!v){let I="400";/bold/i.test(u)?I="900":/medium/i.test(u)?I="500":/light/i.test(u)&&(I="200"),v=i.tinySDF=new tn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:I})}const T=v.draw(String.fromCharCode(f));return{id:f,bitmap:new c.o({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}tn.loadGlyphRange=function(_,i,u,f){return c._(this,void 0,void 0,function*(){const g=256*i,v=g+255,T=f.transformRequest(u.replace("{fontstack}",_).replace("{range}",`${g}-${v}`),"Glyphs"),I=yield c.l(T,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${i}, ${g}-${v}`);const C={};for(const M of c.n(I.data))C[M.id]=M;return C})},tn.TinySDF=class{constructor({fontSize:_=24,buffer:i=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:v="normal",fontStyle:T="normal"}={}){this.buffer=i,this.cutoff=f,this.radius=u;const I=this.size=_+4*i,C=this._createCanvas(I),M=this.ctx=C.getContext("2d",{willReadFrequently:!0});M.font=`${T} ${v} ${_}px ${g}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(_){const i=document.createElement("canvas");return i.width=i.height=_,i}draw(_){const{width:i,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:v}=this.ctx.measureText(_),T=Math.ceil(u),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-g))),C=Math.min(this.size-this.buffer,T+Math.ceil(f)),M=I+2*this.buffer,B=C+2*this.buffer,N=Math.max(M*B,0),H=new Uint8ClampedArray(N),K={data:H,width:M,height:B,glyphWidth:I,glyphHeight:C,glyphTop:T,glyphLeft:0,glyphAdvance:i};if(I===0||C===0)return K;const{ctx:oe,buffer:fe,gridInner:ae,gridOuter:_e}=this;oe.clearRect(fe,fe,I,C),oe.fillText(_,fe,fe+T);const Te=oe.getImageData(fe,fe,I,C);_e.fill(ut,0,N),ae.fill(0,0,N);for(let he=0;he<C;he++)for(let Ie=0;Ie<I;Ie++){const Pe=Te.data[4*(he*I+Ie)+3]/255;if(Pe===0)continue;const De=(he+fe)*M+Ie+fe;if(Pe===1)_e[De]=0,ae[De]=ut;else{const $e=.5-Pe;_e[De]=$e>0?$e*$e:0,ae[De]=$e<0?$e*$e:0}}un(_e,0,0,M,B,M,this.f,this.v,this.z),un(ae,fe,fe,I,C,M,this.f,this.v,this.z);for(let he=0;he<N;he++){const Ie=Math.sqrt(_e[he])-Math.sqrt(ae[he]);H[he]=Math.round(255-255*(Ie/this.radius+this.cutoff))}return K}};class et{constructor(){this.specification=c.v.light.position}possiblyEvaluate(i,u){return c.y(i.expression.evaluate(u))}interpolate(i,u,f){return{x:c.z.number(i.x,u.x,f),y:c.z.number(i.y,u.y,f),z:c.z.number(i.z,u.z,f)}}}let ht;class Tt extends c.E{constructor(i){super(),ht=ht||new c.q({anchor:new c.D(c.v.light.anchor),position:new et,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(ht),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(c.r,i,u))for(const f in i){const g=i[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,f){return(!f||f.validate!==!1)&&c.t(this,i.call(c.x,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}class kt{constructor(i,u){this.width=i,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,u){const f=i.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(i,u)),this.dashEntry[f]}getDashRanges(i,u,f){const g=[];let v=i.length%2==1?-i[i.length-1]*f:0,T=i[0]*f,I=!0;g.push({left:v,right:T,isDash:I,zeroLength:i[0]===0});let C=i[0];for(let M=1;M<i.length;M++){I=!I;const B=i[M];v=C*f,C+=B,T=C*f,g.push({left:v,right:T,isDash:I,zeroLength:B===0})}return g}addRoundDash(i,u,f){const g=u/2;for(let v=-f;v<=f;v++){const T=this.width*(this.nextRow+f+v);let I=0,C=i[I];for(let M=0;M<this.width;M++){M/C.right>1&&(C=i[++I]);const B=Math.abs(M-C.left),N=Math.abs(M-C.right),H=Math.min(B,N);let K;const oe=v/f*(g+1);if(C.isDash){const fe=g-Math.abs(oe);K=Math.sqrt(H*H+fe*fe)}else K=g-Math.sqrt(H*H+oe*oe);this.data[T+M]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(i){for(let I=i.length-1;I>=0;--I){const C=i[I],M=i[I+1];C.zeroLength?i.splice(I,1):M&&M.isDash===C.isDash&&(M.left=C.left,i.splice(I,1))}const u=i[0],f=i[i.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let v=0,T=i[v];for(let I=0;I<this.width;I++){I/T.right>1&&(T=i[++v]);const C=Math.abs(I-T.left),M=Math.abs(I-T.right),B=Math.min(C,M);this.data[g+I]=Math.max(0,Math.min(255,(T.isDash?B:-B)+128))}}addDash(i,u){const f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return c.w("LineAtlas out of space"),null;let v=0;for(let I=0;I<i.length;I++)v+=i[I];if(v!==0){const I=this.width/v,C=this.getDashRanges(i,this.width,I);u?this.addRoundDash(C,I,f):this.addRegularDash(C)}const T={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:v};return this.nextRow+=g,this.dirty=!0,T}bind(i){const u=i.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const At="maplibre_preloaded_worker_pool";class jt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<jt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[At]}numActive(){return Object.keys(this.active).length}}const Hn=Math.floor(L.hardwareConcurrency/2);let fn,kn;function Pn(){return fn||(fn=new jt),fn}jt.workerCount=c.B(globalThis)?Math.max(Math.min(Hn,3),1):1;class vr{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let g=0;g<f.length;g++){const v=new c.C(f[g],u);v.name=`Worker ${g}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,u){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:i,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,u){for(const f of this.actors)f.registerMessageHandler(i,u)}}function Lr(){return kn||(kn=new vr(Pn(),c.G),kn.registerMessageHandler("GR",(_,i,u)=>c.m(i,u))),kn}function Dr(_,i){const u=c.F();return c.H(u,u,[1,1,0]),c.J(u,u,[.5*_.width,.5*_.height,1]),c.K(u,u,_.calculatePosMatrix(i.toUnwrapped()))}function ei(_,i,u,f,g,v){const T=function(N,H,K){if(N)for(const oe of N){const fe=H[oe];if(fe&&fe.source===K&&fe.type==="fill-extrusion")return!0}else for(const oe in H){const fe=H[oe];if(fe.source===K&&fe.type==="fill-extrusion")return!0}return!1}(g&&g.layers,i,_.id),I=v.maxPitchScaleFactor(),C=_.tilesIn(f,I,T);C.sort(Nn);const M=[];for(const N of C)M.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(i,u,_._state,N.queryGeometry,N.cameraQueryGeometry,N.scale,g,v,I,Dr(_.transform,N.tileID))});const B=function(N){const H={},K={};for(const oe of N){const fe=oe.queryResults,ae=oe.wrappedTileID,_e=K[ae]=K[ae]||{};for(const Te in fe){const he=fe[Te],Ie=_e[Te]=_e[Te]||{},Pe=H[Te]=H[Te]||[];for(const De of he)Ie[De.featureIndex]||(Ie[De.featureIndex]=!0,Pe.push(De))}}return H}(M);for(const N in B)B[N].forEach(H=>{const K=H.feature,oe=_.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=oe});return B}function Nn(_,i){const u=_.tileID,f=i.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function Oi(_,i,u){return c._(this,void 0,void 0,function*(){let f=_;if(_.url?f=(yield c.h(i.transformRequest(_.url,"Source"),u)).data:yield L.frameAsync(u),!f)return null;const g=c.L(c.e(f,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map(v=>v.id)),g})}class En{constructor(i,u){i&&(u?this.setSouthWest(i).setNorthEast(u):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof c.M?new c.M(i.lng,i.lat):c.M.convert(i),this}setSouthWest(i){return this._sw=i instanceof c.M?new c.M(i.lng,i.lat):c.M.convert(i),this}extend(i){const u=this._sw,f=this._ne;let g,v;if(i instanceof c.M)g=i,v=i;else{if(!(i instanceof En))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(En.convert(i)):this.extend(c.M.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(c.M.convert(i)):this;if(g=i._sw,v=i._ne,!g||!v)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new c.M(g.lng,g.lat),this._ne=new c.M(v.lng,v.lat)),this}getCenter(){return new c.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.M(this.getWest(),this.getNorth())}getSouthEast(){return new c.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:u,lat:f}=c.M.convert(i);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(i){return i instanceof En?i:i&&new En(i)}static fromLngLat(i,u=0){const f=360*u/40075017,g=f/Math.cos(Math.PI/180*i.lat);return new En(new c.M(i.lng-g,i.lat-f),new c.M(i.lng+g,i.lat+f))}}class no{constructor(i,u,f){this.bounds=En.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),f=Math.floor(c.N(this.bounds.getWest())*u),g=Math.floor(c.O(this.bounds.getNorth())*u),v=Math.ceil(c.N(this.bounds.getEast())*u),T=Math.ceil(c.O(this.bounds.getSouth())*u);return i.x>=f&&i.x<v&&i.y>=g&&i.y<T}}class Oe extends c.E{constructor(i,u,f,g){if(super(),this.id=i,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.L(u,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield Oi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(c.e(this,i),i.bounds&&(this.tileBounds=new no(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new c.j(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(i){return c._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((v,T)=>{i.reloadPromise={resolve:v,reject:T}})}else i.actor=this.dispatcher.getActor(),g="LT";i.abortController=new AbortController;try{const v=yield i.actor.sendAsync({type:g,data:f},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,v)}catch(v){if(delete i.abortController,i.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,u){if(u&&u.resourceTiming&&(i.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&i.setExpiryData(u),i.loadVectorData(u,this.map.painter),i.reloadPromise){const f=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(f.resolve).catch(f.reject)}}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ro extends c.E{constructor(i,u,f,g){super(),this.id=i,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},u),c.e(this,c.L(u,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield Oi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(c.e(this,i),i.bounds&&(this.tileBounds=new no(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new c.j(i))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return c.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return c._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const f=yield re.getImage(this.map._requestManager.transformRequest(u,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&i.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,v=g.gl,T=f.data;i.texture=this.map.painter.getTileTexture(T.width),i.texture?i.texture.update(T,{useMipmap:!0}):(i.texture=new de(g,T,v.RGBA,{useMipmap:!0}),i.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&v.texParameterf(v.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),i.state="loaded"}}catch(f){if(delete i.abortController,i.aborted)i.state="unloaded";else if(f)throw i.state="errored",f}})}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class Wr extends ro{constructor(i,u,f,g){super(i,u,f,g),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(i){return c._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const g=yield re.getImage(f,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){const v=g.data;this.map._refreshExpiredTiles&&g.cacheControl&&g.expires&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const T=c.b(v)&&c.S()?v:yield this.readImageNow(v),I={type:this.type,uid:i.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const C=yield i.actor.sendAsync({type:"LDT",data:I});i.dem=C,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}})}readImageNow(i){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.U()){const u=i.width+2,f=i.height+2;try{return new c.R({width:u,height:f},yield c.V(i,-1,-1,u,f))}catch{}}return L.getImageData(i,1)})}_getNeighboringTiles(i){const u=i.canonical,f=Math.pow(2,u.z),g=(u.x-1+f)%f,v=u.x===0?i.wrap-1:i.wrap,T=(u.x+1+f)%f,I=u.x+1===f?i.wrap+1:i.wrap,C={};return C[new c.Q(i.overscaledZ,v,u.z,g,u.y).key]={backfilled:!1},C[new c.Q(i.overscaledZ,I,u.z,T,u.y).key]={backfilled:!1},u.y>0&&(C[new c.Q(i.overscaledZ,v,u.z,g,u.y-1).key]={backfilled:!1},C[new c.Q(i.overscaledZ,i.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},C[new c.Q(i.overscaledZ,I,u.z,T,u.y-1).key]={backfilled:!1}),u.y+1<f&&(C[new c.Q(i.overscaledZ,v,u.z,g,u.y+1).key]={backfilled:!1},C[new c.Q(i.overscaledZ,i.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},C[new c.Q(i.overscaledZ,I,u.z,T,u.y+1).key]={backfilled:!1}),C}unloadTile(i){return c._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class Vt extends c.E{constructor(i,u,f,g){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(g),this._data=u.data,this._options=c.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const v=c.W/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*v,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*v,extent:c.W,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:c.W,radius:(u.clusterRadius||50)*v,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return c._(this,void 0,void 0,function*(){const i=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:u,offset:f}})}_updateWorkerData(i){return c._(this,void 0,void 0,function*(){const u=c.e({type:this.type},this.workerOptions);i?u.dataDiff=i:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(L.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let g=null;f.resourceTiming&&f.resourceTiming[this.id]&&(g=f.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(v,{resourceTiming:g}),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(f))}})}loaded(){return this._pendingLoads===0}loadTile(i){return c._(this,void 0,void 0,function*(){const u=i.actor?"RT":"LT";i.actor=this.actor;const f={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;const g=yield this.actor.sendAsync({type:u,data:f},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(g,this.map.painter,u==="RT")})}abortTile(i){return c._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return c._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var en=c.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class wi extends c.E{constructor(i,u,f,g){super(),this.id=i,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}load(i){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,i&&(this.coordinates=i),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new c.j(u))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const u=i.map(c.Y.fromLngLat);this.tileID=function(g){let v=1/0,T=1/0,I=-1/0,C=-1/0;for(const H of g)v=Math.min(v,H.x),T=Math.min(T,H.y),I=Math.max(I,H.x),C=Math.max(C,H.y);const M=Math.max(I-v,C-T),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),N=Math.pow(2,B);return new c.a0(B,Math.floor((v+I)/2*N),Math.floor((T+C)/2*N))}(u),this.minzoom=this.maxzoom=this.tileID.z;const f=u.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new c.Z,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,c.W,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,c.W),this._boundsArray.emplaceBack(f[2].x,f[2].y,c.W,c.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new de(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Do extends wi{constructor(i,u,f,g){super(i,u,f,g),this.roundZoom=!0,this.type="video",this.options=u}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const u of i.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield c.a2(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new c.j(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const u=this.video.seekable;i<u.start(0)||i>u.end(0)?this.fire(new c.j(new c.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new de(i,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Qn extends wi{constructor(i,u,f,g){super(i,u,f,g),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(T=>typeof T!="number"))||this.fire(new c.j(new c.a1(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a1(`sources.${i}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new c.j(new c.a1(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a1(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a1(`sources.${i}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,en.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new de(u,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,g=!0)}g&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const ti={},Gr=_=>{switch(_){case"geojson":return Vt;case"image":return wi;case"raster":return ro;case"raster-dem":return Wr;case"vector":return Oe;case"video":return Do;case"canvas":return Qn}return ti[_]},mn="RTLPluginLoaded";class Kn extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Lr()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return c._(this,arguments,void 0,function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=L.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(mn))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ke=null;function Ir(){return Ke||(Ke=new Kn),Ke}class dr{constructor(i,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=c.a3(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const u=i+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(g,v){const T={};if(!v)return T;for(const I of g){const C=I.layerIds.map(M=>v.getLayer(M)).filter(Boolean);if(C.length!==0){I.layers=C,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(M=>C.filter(B=>B.id===M)[0]));for(const M of C)T[M.id]=I}}return T}(i.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const v=this.buckets[g];if(v instanceof c.a5){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const v=this.buckets[g];if(v instanceof c.a5&&v.hasRTLText){this.hasRTLText=!0,Ir().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const v=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(v))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(i)}const u=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new de(i,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new de(i,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,u,f,g,v,T,I,C,M,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:v,scale:T,tileSize:this.tileSize,pixelPosMatrix:B,transform:C,params:I,queryPadding:this.queryPadding*M},i,u,f):{}}querySourceFeatures(i,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),v=u&&u.sourceLayer?u.sourceLayer:"",T=g._geojsonTileLayer||g[v];if(!T)return;const I=c.a6(u&&u.filter),{z:C,x:M,y:B}=this.tileID.canonical,N={z:C,x:M,y:B};for(let H=0;H<T.length;H++){const K=T.feature(H);if(I.needGeometry){const ae=c.a7(K,!0);if(!I.filter(new c.a8(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!I.filter(new c.a8(this.tileID.overscaledZ),K))continue;const oe=f.getId(K,v),fe=new c.a9(K,C,M,B,oe);fe.tile=N,i.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const u=this.expirationTime;if(i.cacheControl){const f=c.aa(i.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const v=this.expirationTime-u;v?this.expirationTime=f+Math.max(v,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const v=this.buckets[g],T=v.layers[0].sourceLayer||"_geojsonTileLayer",I=f[T],C=i[T];if(!I||!C||Object.keys(C).length===0)continue;v.update(C,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=u&&u.style&&u.style.getLayer(g);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<L.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=L.now()+i}setDependencies(i,u){const f={};for(const g of u)f[g]=!0;this.dependencies[i]=f}hasDependency(i,u){for(const f of i){const g=this.dependencies[f];if(g){for(const v of u)if(g[v])return!0}}return!1}}class Jo{constructor(i,u){this.max=i,this.onRemove=u,this.reset()}reset(){for(const i in this.data)for(const u of this.data[i])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(i,u,f){const g=i.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const v={value:u,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(i,v)},f)),this.data[g].push(v),this.order.push(g),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const u=this.data[i].shift();return u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),u.value}getByKey(i){const u=this.data[i];return u?u[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,u){if(!this.has(i))return this;const f=i.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),v=this.data[f][g];return this.data[f].splice(g,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(i){const u=[];for(const f in this.data)for(const g of this.data[f])i(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class bi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,u,f){const g=String(u);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][g]=this.stateChanges[i][g]||{},c.e(this.stateChanges[i][g],f),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==g&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][g]===null){this.deletedStates[i][g]={};for(const v in this.state[i][g])f[v]||(this.deletedStates[i][g][v]=null)}else for(const v in f)this.deletedStates[i]&&this.deletedStates[i][g]&&this.deletedStates[i][g][v]===null&&delete this.deletedStates[i][g][v]}removeFeatureState(i,u,f){if(this.deletedStates[i]===null)return;const g=String(u);if(this.deletedStates[i]=this.deletedStates[i]||{},f&&u!==void 0)this.deletedStates[i][g]!==null&&(this.deletedStates[i][g]=this.deletedStates[i][g]||{},this.deletedStates[i][g][f]=null);else if(u!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][g])for(f in this.deletedStates[i][g]={},this.stateChanges[i][g])this.deletedStates[i][g][f]=null;else this.deletedStates[i][g]=null;else this.deletedStates[i]=null}getState(i,u){const f=String(u),g=c.e({},(this.state[i]||{})[f],(this.stateChanges[i]||{})[f]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const v=this.deletedStates[i][u];if(v===null)return{};for(const T in v)delete g[T]}return g}initializeTileState(i,u){i.setFeatureState(this.state,u)}coalesceChanges(i,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const v={};for(const T in this.stateChanges[g])this.state[g][T]||(this.state[g][T]={}),c.e(this.state[g][T],this.stateChanges[g][T]),v[T]=this.state[g][T];f[g]=v}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const v={};if(this.deletedStates[g]===null)for(const T in this.state[g])v[T]={},this.state[g][T]={};else for(const T in this.deletedStates[g]){if(this.deletedStates[g][T]===null)this.state[g][T]={};else for(const I of Object.keys(this.deletedStates[g][T]))delete this.state[g][T][I];v[T]=this.state[g][T]}f[g]=f[g]||{},c.e(f[g],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in i)i[g].setFeatureState(f,u)}}class Ze extends c.E{constructor(i,u,f){super(),this.id=i,this.dispatcher=f,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,v,T,I)=>{const C=new(Gr(v.type))(g,v,T,I);if(C.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${C.id}`);return C})(i,u,f,this),this._tiles={},this._cache=new Jo(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new bi,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const u=this._tiles[i];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,u,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,u,f)}catch(g){i.state="errored",g.status!==404?this._source.fire(new c.j(g,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new c.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(i),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(Bt).map(i=>i.key)}getRenderableIds(i){const u=[];for(const f in this._tiles)this._isIdRenderable(f,i)&&u.push(this._tiles[f]);return i?u.sort((f,g)=>{const v=f.tileID,T=g.tileID,I=new c.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),C=new c.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-T.overscaledZ||C.y-I.y||C.x-I.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(Bt).map(f=>f.key)}hasRenderableParent(i){const u=this.findLoadedParent(i,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(i,u){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(u||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,u){return c._(this,void 0,void 0,function*(){const f=this._tiles[i];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,i,u))})}_tileLoaded(i,u,f){i.timeAdded=L.now(),f==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(u,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const v=u[g];if(i.neighboringTiles&&i.neighboringTiles[v]){const T=this.getTileByID(v);f(i,T),f(T,i)}}function f(g,v){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let T=v.tileID.canonical.x-g.tileID.canonical.x;const I=v.tileID.canonical.y-g.tileID.canonical.y,C=Math.pow(2,g.tileID.canonical.z),M=v.tileID.key;T===0&&I===0||Math.abs(I)>1||(Math.abs(T)>1&&(Math.abs(T+C)===1?T+=C:Math.abs(T-C)===1&&(T-=C)),v.dem&&g.dem&&(g.dem.backfillBorder(v.dem,T,I),g.neighboringTiles&&g.neighboringTiles[M]&&(g.neighboringTiles[M].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,u,f,g){for(const v in this._tiles){let T=this._tiles[v];if(g[v]||!T.hasData()||T.tileID.overscaledZ<=u||T.tileID.overscaledZ>f)continue;let I=T.tileID;for(;T&&T.tileID.overscaledZ>u+1;){const M=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[M.key],T&&T.hasData()&&(I=M)}let C=I;for(;C.overscaledZ>u;)if(C=C.scaledTo(C.overscaledZ-1),i[C.key]){g[I.key]=I;break}}}findLoadedParent(i,u){if(i.key in this._loadedParentTiles){const f=this._loadedParentTiles[i.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=i.overscaledZ-1;f>=u;f--){const g=i.scaledTo(f),v=this._getLoadedTile(g);if(v)return v}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const u=this._tiles[i.key];return u&&u.hasData()?u:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const u=Math.ceil(i.width/this._source.tileSize)+1,f=Math.ceil(i.height/this._source.tileSize)+1,g=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(v)}handleWrapJump(i){const u=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,u){const f={};for(const g in this._tiles){const v=this._tiles[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),f[v.tileID.key]=v}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(i,u,f,g,v,T){const I={},C={},M=Object.keys(i),B=L.now();for(const N of M){const H=i[N],K=this._tiles[N];if(!K||K.fadeEndTime!==0&&K.fadeEndTime<=B)continue;const oe=this.findLoadedParent(H,u),fe=this.findLoadedSibling(H),ae=oe||fe||null;ae&&(this._addTile(ae.tileID),I[ae.tileID.key]=ae.tileID),C[N]=H}this._retainLoadedChildren(C,g,f,i);for(const N in I)i[N]||(this._coveredTiles[N]=!0,i[N]=I[N]);if(T){const N={},H={};for(const K of v)this._tiles[K.key].hasData()?N[K.key]=K:H[K.key]=K;for(const K in H){const oe=H[K].children(this._source.maxzoom);this._tiles[oe[0].key]&&this._tiles[oe[1].key]&&this._tiles[oe[2].key]&&this._tiles[oe[3].key]&&(N[oe[0].key]=i[oe[0].key]=oe[0],N[oe[1].key]=i[oe[1].key]=oe[1],N[oe[2].key]=i[oe[2].key]=oe[2],N[oe[3].key]=i[oe[3].key]=oe[3],delete H[K])}for(const K in H){const oe=H[K],fe=this.findLoadedParent(oe,this._source.minzoom),ae=this.findLoadedSibling(oe),_e=fe||ae||null;if(_e){N[_e.tileID.key]=i[_e.tileID.key]=_e.tileID;for(const Te in N)N[Te].isChildOf(_e.tileID)&&delete N[Te]}}for(const K in this._tiles)N[K]||(this._coveredTiles[K]=!0)}}update(i,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=i,this.terrain=u,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new c.Q(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(f=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(f=f.filter(B=>this._source.hasTile(B)))):f=[];const g=i.coveringZoomLevel(this._source),v=Math.max(g-Ze.maxOverzooming,this._source.minzoom),T=Math.max(g+Ze.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const B={};for(const N of f)if(N.canonical.z>this._source.minzoom){const H=N.scaledTo(N.canonical.z-1);B[H.key]=H;const K=N.scaledTo(Math.max(this._source.minzoom,Math.min(N.canonical.z,5)));B[K.key]=K}f=f.concat(Object.values(B))}const I=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(f,g);Pt(this._source.type)&&this._updateCoveredAndRetainedTiles(C,v,T,g,f,u);for(const B in C)this._tiles[B].clearFadeHold();const M=c.ab(this._tiles,C);for(const B of M){const N=this._tiles[B];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(B)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,u){var f;const g={},v={},T=Math.max(u-Ze.maxOverzooming,this._source.minzoom),I=Math.max(u+Ze.maxUnderzooming,this._source.minzoom),C={};for(const M of i){const B=this._addTile(M);g[M.key]=M,B.hasData()||u<this._source.maxzoom&&(C[M.key]=M)}this._retainLoadedChildren(C,u,I,g);for(const M of i){let B=this._tiles[M.key];if(B.hasData())continue;if(u+1>this._source.maxzoom){const H=M.children(this._source.maxzoom)[0],K=this.getTile(H);if(K&&K.hasData()){g[H.key]=H;continue}}else{const H=M.children(this._source.maxzoom);if(g[H[0].key]&&g[H[1].key]&&g[H[2].key]&&g[H[3].key])continue}let N=B.wasRequested();for(let H=M.overscaledZ-1;H>=T;--H){const K=M.scaledTo(H);if(v[K.key])break;if(v[K.key]=!0,B=this.getTile(K),!B&&N&&(B=this._addTile(K)),B){const oe=B.hasData();if((oe||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||N)&&(g[K.key]=K),N=B.wasRequested(),oe)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const u=[];let f,g=this._tiles[i].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const v=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;g=v}for(const v of u)this._loadedParentTiles[v]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const u=this._tiles[i].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(i){let u=this._tiles[i.key];if(u)return u;u=this._cache.getAndRemove(i),u&&(this._setTileReloadTimer(i.key,u),u.tileID=i,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,u)));const f=u;return u||(u=new dr(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(u,i.key,u.state)),u.uses++,this._tiles[i.key]=u,f||this._source.fire(new c.k("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(i,u){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const f=u.getExpiryTimeout();f&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},f))}_removeTile(i){const u=this._tiles[i];u&&(u.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(i){const u=i.sourceDataType;i.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&u==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,u,f){const g=[],v=this.transform;if(!v)return g;const T=f?v.getCameraQueryGeometry(i):i,I=i.map(oe=>v.pointCoordinate(oe,this.terrain)),C=T.map(oe=>v.pointCoordinate(oe,this.terrain)),M=this.getIds();let B=1/0,N=1/0,H=-1/0,K=-1/0;for(const oe of C)B=Math.min(B,oe.x),N=Math.min(N,oe.y),H=Math.max(H,oe.x),K=Math.max(K,oe.y);for(let oe=0;oe<M.length;oe++){const fe=this._tiles[M[oe]];if(fe.holdingForFade())continue;const ae=fe.tileID,_e=Math.pow(2,v.zoom-fe.tileID.overscaledZ),Te=u*fe.queryPadding*c.W/fe.tileSize/_e,he=[ae.getTilePoint(new c.Y(B,N)),ae.getTilePoint(new c.Y(H,K))];if(he[0].x-Te<c.W&&he[0].y-Te<c.W&&he[1].x+Te>=0&&he[1].y+Te>=0){const Ie=I.map(De=>ae.getTilePoint(De)),Pe=C.map(De=>ae.getTilePoint(De));g.push({tile:fe,tileID:ae,queryGeometry:Ie,cameraQueryGeometry:Pe,scale:_e})}}return g}getVisibleCoordinates(i){const u=this.getRenderableIds(i).map(f=>this._tiles[f].tileID);for(const f of u)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(Pt(this._source.type)){const i=L.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=i)return!0}return!1}setFeatureState(i,u,f){this._state.updateState(i=i||"_geojsonTileLayer",u,f)}removeFeatureState(i,u,f){this._state.removeFeatureState(i=i||"_geojsonTileLayer",u,f)}getFeatureState(i,u){return this._state.getState(i=i||"_geojsonTileLayer",u)}setDependencies(i,u,f){const g=this._tiles[i];g&&g.setDependencies(u,f)}reloadTilesForDependencies(i,u){for(const f in this._tiles)this._tiles[f].hasDependency(i,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(i,u))}}function Bt(_,i){const u=Math.abs(2*_.wrap)-+(_.wrap<0),f=Math.abs(2*i.wrap)-+(i.wrap<0);return _.overscaledZ-i.overscaledZ||f-u||i.canonical.y-_.canonical.y||i.canonical.x-_.canonical.x}function Pt(_){return _==="raster"||_==="image"||_==="video"}Ze.maxOverzooming=10,Ze.maxUnderzooming=3;class Cr{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=c.ac(i,0,1);let u=1,f=this._distances[u];const g=i*this.paddedLength+this.padding;for(;f<g&&u<this._distances.length;)f=this._distances[++u];const v=u-1,T=this._distances[v],I=f-T,C=I>0?(g-T)/I:0;return this.points[v].mult(1-C).add(this.points[u].mult(C))}}function xr(_,i){let u=!0;return _==="always"||_!=="never"&&i!=="never"||(u=!1),u}class Ot{constructor(i,u,f){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(u/f);for(let T=0;T<this.xCellCount*this.yCellCount;T++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,f,g,v){this._forEachCell(u,f,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(i,u,f,g){this._forEachCell(u-g,f-g,u+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(f),this.circles.push(g)}_insertBoxCell(i,u,f,g,v,T){this.boxCells[v].push(T)}_insertCircleCell(i,u,f,g,v,T){this.circleCells[v].push(T)}_query(i,u,f,g,v,T,I){if(f<0||i>this.width||g<0||u>this.height)return[];const C=[];if(i<=0&&u<=0&&this.width<=f&&this.height<=g){if(v)return[{key:null,x1:i,y1:u,x2:f,y2:g}];for(let M=0;M<this.boxKeys.length;M++)C.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],N=this.circles[3*M+1],H=this.circles[3*M+2];C.push({key:this.circleKeys[M],x1:B-H,y1:N-H,x2:B+H,y2:N+H})}}else this._forEachCell(i,u,f,g,this._queryCell,C,{hitTest:v,overlapMode:T,seenUids:{box:{},circle:{}}},I);return C}query(i,u,f,g){return this._query(i,u,f,g,!1,null)}hitTest(i,u,f,g,v,T){return this._query(i,u,f,g,!0,v,T).length>0}hitTestCircle(i,u,f,g,v){const T=i-f,I=i+f,C=u-f,M=u+f;if(I<0||T>this.width||M<0||C>this.height)return!1;const B=[];return this._forEachCell(T,C,I,M,this._queryCellCircle,B,{hitTest:!0,overlapMode:g,circle:{x:i,y:u,radius:f},seenUids:{box:{},circle:{}}},v),B.length>0}_queryCell(i,u,f,g,v,T,I,C){const{seenUids:M,hitTest:B,overlapMode:N}=I,H=this.boxCells[v];if(H!==null){const oe=this.bboxes;for(const fe of H)if(!M.box[fe]){M.box[fe]=!0;const ae=4*fe,_e=this.boxKeys[fe];if(i<=oe[ae+2]&&u<=oe[ae+3]&&f>=oe[ae+0]&&g>=oe[ae+1]&&(!C||C(_e))&&(!B||!xr(N,_e.overlapMode))&&(T.push({key:_e,x1:oe[ae],y1:oe[ae+1],x2:oe[ae+2],y2:oe[ae+3]}),B))return!0}}const K=this.circleCells[v];if(K!==null){const oe=this.circles;for(const fe of K)if(!M.circle[fe]){M.circle[fe]=!0;const ae=3*fe,_e=this.circleKeys[fe];if(this._circleAndRectCollide(oe[ae],oe[ae+1],oe[ae+2],i,u,f,g)&&(!C||C(_e))&&(!B||!xr(N,_e.overlapMode))){const Te=oe[ae],he=oe[ae+1],Ie=oe[ae+2];if(T.push({key:_e,x1:Te-Ie,y1:he-Ie,x2:Te+Ie,y2:he+Ie}),B)return!0}}}return!1}_queryCellCircle(i,u,f,g,v,T,I,C){const{circle:M,seenUids:B,overlapMode:N}=I,H=this.boxCells[v];if(H!==null){const oe=this.bboxes;for(const fe of H)if(!B.box[fe]){B.box[fe]=!0;const ae=4*fe,_e=this.boxKeys[fe];if(this._circleAndRectCollide(M.x,M.y,M.radius,oe[ae+0],oe[ae+1],oe[ae+2],oe[ae+3])&&(!C||C(_e))&&!xr(N,_e.overlapMode))return T.push(!0),!0}}const K=this.circleCells[v];if(K!==null){const oe=this.circles;for(const fe of K)if(!B.circle[fe]){B.circle[fe]=!0;const ae=3*fe,_e=this.circleKeys[fe];if(this._circlesCollide(oe[ae],oe[ae+1],oe[ae+2],M.x,M.y,M.radius)&&(!C||C(_e))&&!xr(N,_e.overlapMode))return T.push(!0),!0}}}_forEachCell(i,u,f,g,v,T,I,C){const M=this._convertToXCellCoord(i),B=this._convertToYCellCoord(u),N=this._convertToXCellCoord(f),H=this._convertToYCellCoord(g);for(let K=M;K<=N;K++)for(let oe=B;oe<=H;oe++)if(v.call(this,i,u,f,g,this.xCellCount*oe+K,T,I,C))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,f,g,v,T){const I=g-i,C=v-u,M=f+T;return M*M>I*I+C*C}_circleAndRectCollide(i,u,f,g,v,T,I){const C=(T-g)/2,M=Math.abs(i-(g+C));if(M>C+f)return!1;const B=(I-v)/2,N=Math.abs(u-(v+B));if(N>B+f)return!1;if(M<=C||N<=B)return!0;const H=M-C,K=N-B;return H*H+K*K<=f*f}}function Fi(_,i,u,f,g){const v=c.F();return i?(c.J(v,v,[1/g,1/g,1]),u||c.ad(v,v,f.angle)):c.K(v,f.labelPlaneMatrix,_),v}function Ni(_,i,u,f,g){if(i){const v=c.ae(_);return c.J(v,v,[g,g,1]),u||c.ad(v,v,-f.angle),v}return f.glCoordMatrix}function Wt(_,i,u){let f;u?(f=[_.x,_.y,u(_.x,_.y),1],c.af(f,f,i)):(f=[_.x,_.y,0,1],function(v,T,I){const C=T[0],M=T[1];v[0]=I[0]*C+I[4]*M+I[12],v[1]=I[1]*C+I[5]*M+I[13],v[3]=I[3]*C+I[7]*M+I[15]}(f,f,i));const g=f[3];return{point:new c.P(f[0]/g,f[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function ne(_,i){return .5+_/i*.5}function j(_,i){return _.x>=-i[0]&&_.x<=i[0]&&_.y>=-i[1]&&_.y<=i[1]}function U(_,i,u,f,g,v,T,I,C,M,B,N,H,K,oe){const fe=f?_.textSizeData:_.iconSizeData,ae=c.ag(fe,u.transform.zoom),_e=[256/u.width*2+1,256/u.height*2+1],Te=f?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Te.clear();const he=_.lineVertexArray,Ie=f?_.text.placedSymbolArray:_.icon.placedSymbolArray,Pe=u.transform.width/u.transform.height;let De=!1;for(let $e=0;$e<Ie.length;$e++){const Ge=Ie.get($e);if(Ge.hidden||Ge.writingMode===c.ah.vertical&&!De){bt(Ge.numGlyphs,Te);continue}De=!1;const at=Wt(new c.P(Ge.anchorX,Ge.anchorY),i,oe);if(!j(at.point,_e)){bt(Ge.numGlyphs,Te);continue}const lt=ne(u.transform.cameraToCenterDistance,at.signedDistanceFromCamera),Xe=c.ai(fe,ae,Ge),Ye=T?Xe/lt:Xe*lt,gt={getElevation:oe,labelPlaneMatrix:g,lineVertexArray:he,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:M,tileAnchorPoint:new c.P(Ge.anchorX,Ge.anchorY),unwrappedTileID:B,width:N,height:H,translation:K},Nt=ve(gt,Ge,Ye,!1,I,i,v,_.glyphOffsetArray,Te,Pe,C);De=Nt.useVertical,(Nt.notEnoughRoom||De||Nt.needsFlipping&&ve(gt,Ge,Ye,!0,I,i,v,_.glyphOffsetArray,Te,Pe,C).notEnoughRoom)&&bt(Ge.numGlyphs,Te)}f?_.text.dynamicLayoutVertexBuffer.updateData(Te):_.icon.dynamicLayoutVertexBuffer.updateData(Te)}function q(_,i,u,f,g,v,T,I){const C=v.glyphStartIndex+v.numGlyphs,M=v.lineStartIndex,B=v.lineStartIndex+v.lineLength,N=i.getoffsetX(v.glyphStartIndex),H=i.getoffsetX(C-1),K=Ne(_*N,u,f,g,v.segment,M,B,I,T);if(!K)return null;const oe=Ne(_*H,u,f,g,v.segment,M,B,I,T);return oe?I.projectionCache.anyProjectionOccluded?null:{first:K,last:oe}:null}function le(_,i,u,f){return _===c.ah.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*f?{useVertical:!0}:(_===c.ah.vertical?i.y<u.y:i.x>u.x)?{needsFlipping:!0}:null}function ve(_,i,u,f,g,v,T,I,C,M,B){const N=u/24,H=i.lineOffsetX*N,K=i.lineOffsetY*N;let oe;if(i.numGlyphs>1){const fe=i.glyphStartIndex+i.numGlyphs,ae=i.lineStartIndex,_e=i.lineStartIndex+i.lineLength,Te=q(N,I,H,K,f,i,B,_);if(!Te)return{notEnoughRoom:!0};const he=Wt(Te.first.point,T,_.getElevation).point,Ie=Wt(Te.last.point,T,_.getElevation).point;if(g&&!f){const Pe=le(i.writingMode,he,Ie,M);if(Pe)return Pe}oe=[Te.first];for(let Pe=i.glyphStartIndex+1;Pe<fe-1;Pe++)oe.push(Ne(N*I.getoffsetX(Pe),H,K,f,i.segment,ae,_e,_,B));oe.push(Te.last)}else{if(g&&!f){const ae=Wt(_.tileAnchorPoint,v,_.getElevation).point,_e=i.lineStartIndex+i.segment+1,Te=new c.P(_.lineVertexArray.getx(_e),_.lineVertexArray.gety(_e)),he=Wt(Te,v,_.getElevation),Ie=he.signedDistanceFromCamera>0?he.point:function(De,$e,Ge,at,lt,Xe){return Ee(De,$e,Ge,1,lt,Xe)}(_.tileAnchorPoint,Te,ae,0,v,_),Pe=le(i.writingMode,ae,Ie,M);if(Pe)return Pe}const fe=Ne(N*I.getoffsetX(i.glyphStartIndex),H,K,f,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,_,B);if(!fe||_.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};oe=[fe]}for(const fe of oe)c.aj(C,fe.point,fe.angle);return{}}function Ee(_,i,u,f,g,v){const T=_.add(_.sub(i)._unit()),I=g!==void 0?Wt(T,g,v.getElevation).point:ye(T.x,T.y,v).point,C=u.sub(I);return u.add(C._mult(f/C.mag()))}function Ae(_,i,u){const f=i.projectionCache;if(f.projections[_])return f.projections[_];const g=new c.P(i.lineVertexArray.getx(_),i.lineVertexArray.gety(_)),v=ye(g.x,g.y,i);if(v.signedDistanceFromCamera>0)return f.projections[_]=v.point,f.anyProjectionOccluded=f.anyProjectionOccluded||v.isOccluded,v.point;const T=_-u.direction;return function(I,C,M,B,N){return Ee(I,C,M,B,void 0,N)}(u.distanceFromAnchor===0?i.tileAnchorPoint:new c.P(i.lineVertexArray.getx(T),i.lineVertexArray.gety(T)),g,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,i)}function ye(_,i,u){const f=_+u.translation[0],g=i+u.translation[1];let v;return!u.pitchWithMap&&u.projection.useSpecialProjectionForSymbols?(v=u.projection.projectTileCoordinates(f,g,u.unwrappedTileID,u.getElevation),v.point.x=(.5*v.point.x+.5)*u.width,v.point.y=(.5*-v.point.y+.5)*u.height):(v=Wt(new c.P(f,g),u.labelPlaneMatrix,u.getElevation),v.isOccluded=!1),v}function Re(_,i,u){return _._unit()._perp()._mult(i*u)}function Ue(_,i,u,f,g,v,T,I,C){if(I.projectionCache.offsets[_])return I.projectionCache.offsets[_];const M=u.add(i);if(_+C.direction<f||_+C.direction>=g)return I.projectionCache.offsets[_]=M,M;const B=Ae(_+C.direction,I,C),N=Re(B.sub(u),T,C.direction),H=u.add(N),K=B.add(N);return I.projectionCache.offsets[_]=c.ak(v,M,H,K)||M,I.projectionCache.offsets[_]}function Ne(_,i,u,f,g,v,T,I,C){const M=f?_-i:_+i;let B=M>0?1:-1,N=0;f&&(B*=-1,N=Math.PI),B<0&&(N+=Math.PI);let H,K=B>0?v+g:v+g+1;I.projectionCache.cachedAnchorPoint?H=I.projectionCache.cachedAnchorPoint:(H=ye(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=H);let oe,fe,ae=H,_e=H,Te=0,he=0;const Ie=Math.abs(M),Pe=[];let De;for(;Te+he<=Ie;){if(K+=B,K<v||K>=T)return null;Te+=he,_e=ae,fe=oe;const at={absOffsetX:Ie,direction:B,distanceFromAnchor:Te,previousVertex:_e};if(ae=Ae(K,I,at),u===0)Pe.push(_e),De=ae.sub(_e);else{let lt;const Xe=ae.sub(_e);lt=Xe.mag()===0?Re(Ae(K+B,I,at).sub(ae),u,B):Re(Xe,u,B),fe||(fe=_e.add(lt)),oe=Ue(K,lt,ae,v,T,fe,u,I,at),Pe.push(fe),De=oe.sub(fe)}he=De.mag()}const $e=De._mult((Ie-Te)/he)._add(fe||_e),Ge=N+Math.atan2(ae.y-_e.y,ae.x-_e.x);return Pe.push($e),{point:$e,angle:C?Ge:0,path:Pe}}const Be=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function bt(_,i){for(let u=0;u<_;u++){const f=i.length;i.resize(f+4),i.float32.set(Be,3*f)}}const yt=100;class Gt{constructor(i,u,f=new Ot(i.width+200,i.height+200,25),g=new Ot(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=u,this.grid=f,this.ignoredGrid=g,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+yt,this.screenBottomBoundary=i.height+yt,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,u,f,g,v,T,I,C,M,B,N){const H=i.anchorPointX+C[0],K=i.anchorPointY+C[1],oe=this.projectAndGetPerspectiveRatio(g,H,K,v,B),fe=this._projectCollisionBox(i,f,g,v,T,I,C,oe,B,N),[ae,_e,Te,he]=fe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(T?fe.allPointsOccluded:this.mapProjection.isOccluded(H,K,v))||oe.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ae,_e,Te,he)||u!=="always"&&this.grid.hitTest(ae,_e,Te,he,u,M)?{box:[ae,_e,Te,he],placeable:!1,offscreen:!1}:{box:[ae,_e,Te,he],placeable:!0,offscreen:this.isOffscreen(ae,_e,Te,he)}}placeCollisionCircles(i,u,f,g,v,T,I,C,M,B,N,H,K,oe,fe,ae){const _e=[],Te=new c.P(u.anchorX,u.anchorY),he=this.getPerspectiveRatio(T,Te.x,Te.y,I,ae),Ie=(N?v/he:v*he)/c.ap,Pe={getElevation:ae,labelPlaneMatrix:C,lineVertexArray:f,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Te,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:fe},De=q(Ie,g,u.lineOffsetX*Ie,u.lineOffsetY*Ie,!1,u,!1,Pe);let $e=!1,Ge=!1,at=!0;if(De){const lt=.5*K*he+oe,Xe=new c.P(-100,-100),Ye=new c.P(this.screenRightBoundary,this.screenBottomBoundary),gt=new Cr,Nt=De.first,tt=De.last;let it=[];for(let Ht=Nt.path.length-1;Ht>=1;Ht--)it.push(Nt.path[Ht]);for(let Ht=1;Ht<tt.path.length;Ht++)it.push(tt.path[Ht]);const Dt=2.5*lt;if(M){const Ht=this.projectPathToScreenSpace(it,Pe,M);it=Ht.some(Yt=>Yt.signedDistanceFromCamera<=0)?[]:Ht.map(Yt=>Yt.point)}let Vn=[];if(it.length>0){const Ht=it[0].clone(),Yt=it[0].clone();for(let jn=1;jn<it.length;jn++)Ht.x=Math.min(Ht.x,it[jn].x),Ht.y=Math.min(Ht.y,it[jn].y),Yt.x=Math.max(Yt.x,it[jn].x),Yt.y=Math.max(Yt.y,it[jn].y);Vn=Ht.x>=Xe.x&&Yt.x<=Ye.x&&Ht.y>=Xe.y&&Yt.y<=Ye.y?[it]:Yt.x<Xe.x||Ht.x>Ye.x||Yt.y<Xe.y||Ht.y>Ye.y?[]:c.al([it],Xe.x,Xe.y,Ye.x,Ye.y)}for(const Ht of Vn){gt.reset(Ht,.25*lt);let Yt=0;Yt=gt.length<=.5*lt?1:Math.ceil(gt.paddedLength/Dt)+1;for(let jn=0;jn<Yt;jn++){const li=jn/Math.max(Yt-1,1),Oo=gt.lerp(li),Un=Oo.x+yt,Ui=Oo.y+yt;_e.push(Un,Ui,lt,0);const Ii=Un-lt,ui=Ui-lt,ci=Un+lt,Fo=Ui+lt;if(at=at&&this.isOffscreen(Ii,ui,ci,Fo),Ge=Ge||this.isInsideGrid(Ii,ui,ci,Fo),i!=="always"&&this.grid.hitTestCircle(Un,Ui,lt,i,H)&&($e=!0,!B))return{circles:[],offscreen:!1,collisionDetected:$e}}}}return{circles:!B&&$e||!Ge||he<this.perspectiveRatioCutoff?[]:_e,offscreen:at,collisionDetected:$e}}projectPathToScreenSpace(i,u,f){return i.map(g=>Wt(g,f,u.getElevation))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let f=1/0,g=1/0,v=-1/0,T=-1/0;for(const B of i){const N=new c.P(B.x+yt,B.y+yt);f=Math.min(f,N.x),g=Math.min(g,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),u.push(N)}const I=this.grid.query(f,g,v,T).concat(this.ignoredGrid.query(f,g,v,T)),C={},M={};for(const B of I){const N=B.key;if(C[N.bucketInstanceId]===void 0&&(C[N.bucketInstanceId]={}),C[N.bucketInstanceId][N.featureIndex])continue;const H=[new c.P(B.x1,B.y1),new c.P(B.x2,B.y1),new c.P(B.x2,B.y2),new c.P(B.x1,B.y2)];c.am(u,H)&&(C[N.bucketInstanceId][N.featureIndex]=!0,M[N.bucketInstanceId]===void 0&&(M[N.bucketInstanceId]=[]),M[N.bucketInstanceId].push(N.featureIndex))}return M}insertCollisionBox(i,u,f,g,v,T){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:v,collisionGroupID:T,overlapMode:u},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,f,g,v,T){const I=f?this.ignoredGrid:this.grid,C={bucketInstanceId:g,featureIndex:v,collisionGroupID:T,overlapMode:u};for(let M=0;M<i.length;M+=4)I.insertCircle(C,i[M],i[M+1],i[M+2])}projectAndGetPerspectiveRatio(i,u,f,g,v){const T=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,g,v):Wt(new c.P(u,f),i,v);return{point:new c.P((T.point.x+1)/2*this.transform.width+yt,(1-T.point.y)/2*this.transform.height+yt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5,isOccluded:T.isOccluded,signedDistanceFromCamera:T.signedDistanceFromCamera}}getPerspectiveRatio(i,u,f,g,v){const T=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(u,f,g,v):Wt(new c.P(u,f),i,v);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(i,u,f,g){return f<yt||i>=this.screenRightBoundary||g<yt||u>this.screenBottomBoundary}isInsideGrid(i,u,f,g){return f>=0&&i<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=c.an([]);return c.H(i,i,[-100,-100,0]),i}_projectCollisionBox(i,u,f,g,v,T,I,C,M,B){const N=u*C.perspectiveRatio;let H=new c.P(1,0),K=new c.P(0,1);const oe=new c.P(i.anchorPointX+I[0],i.anchorPointY+I[1]);if(T&&!v){const lt=this.projectAndGetPerspectiveRatio(f,oe.x+1,oe.y,g,M).point.sub(C.point).unit(),Xe=Math.atan(lt.y/lt.x)+(lt.x<0?Math.PI:0),Ye=Math.sin(Xe),gt=Math.cos(Xe);H=new c.P(gt,Ye),K=new c.P(-Ye,gt)}else if(!T&&v){const lt=-this.transform.angle,Xe=Math.sin(lt),Ye=Math.cos(lt);H=new c.P(Ye,Xe),K=new c.P(-Xe,Ye)}let fe=C.point,ae=N;if(v){fe=oe;const lt=this.transform.zoom-Math.floor(this.transform.zoom);ae=Math.pow(2,-lt),ae*=this.mapProjection.getPitchedTextCorrection(this.transform,oe,g),B||(ae*=c.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}B&&(fe=fe.add(H.mult(B.x*ae)).add(K.mult(B.y*ae)));const _e=i.x1*ae,Te=i.x2*ae,he=(_e+Te)/2,Ie=i.y1*ae,Pe=i.y2*ae,De=(Ie+Pe)/2,$e=[{offsetX:_e,offsetY:Ie},{offsetX:he,offsetY:Ie},{offsetX:Te,offsetY:Ie},{offsetX:Te,offsetY:De},{offsetX:Te,offsetY:Pe},{offsetX:he,offsetY:Pe},{offsetX:_e,offsetY:Pe},{offsetX:_e,offsetY:De}];let Ge=[];for(const{offsetX:lt,offsetY:Xe}of $e)Ge.push(new c.P(fe.x+H.x*lt+K.x*Xe,fe.y+H.y*lt+K.y*Xe));let at=!1;if(v){const lt=Ge.map(Xe=>this.projectAndGetPerspectiveRatio(f,Xe.x,Xe.y,g,M));at=lt.some(Xe=>!Xe.isOccluded),Ge=lt.map(Xe=>Xe.point)}else at=!0;return{box:c.ao(Ge),allPointsOccluded:!at}}}function Mt(_,i,u){return i*(c.W/(_.tileSize*Math.pow(2,u-_.tileID.overscaledZ)))}class Kt{constructor(i,u,f,g){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class gn{constructor(i,u,f,g,v){this.text=new Kt(i?i.text:null,u,f,v),this.icon=new Kt(i?i.icon:null,u,g,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Sn{constructor(i,u,f){this.text=i,this.icon=u,this.skipFade=f}}class Wn{constructor(){this.invProjMatrix=c.F(),this.viewportMatrix=c.F(),this.circles=[]}}class Rt{constructor(i,u,f,g,v){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=v}}class Dn{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[i]}}function ir(_,i,u,f,g){const{horizontalAlign:v,verticalAlign:T}=c.au(_);return new c.P(-(v-.5)*i+f[0]*g,-(T-.5)*u+f[1]*g)}class zr{constructor(i,u,f,g,v,T){this.transform=i.clone(),this.terrain=f,this.collisionIndex=new Gt(this.transform,u),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Dn(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const u=this.terrain;return u?(f,g)=>u.getElevation(i,f,g):null}getBucketParts(i,u,f,g){const v=f.getBucket(u),T=f.latestFeatureIndex;if(!v||!T||u.id!==v.layerIds[0])return;const I=f.collisionBoxArray,C=v.layers[0].layout,M=v.layers[0].paint,B=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),N=f.tileSize/c.W,H=f.tileID.toUnwrapped(),K=this.transform.calculatePosMatrix(H),oe=C.get("text-pitch-alignment")==="map",fe=C.get("text-rotation-alignment")==="map",ae=Mt(f,1,this.transform.zoom),_e=this.collisionIndex.mapProjection.translatePosition(this.transform,f,M.get("text-translate"),M.get("text-translate-anchor")),Te=this.collisionIndex.mapProjection.translatePosition(this.transform,f,M.get("icon-translate"),M.get("icon-translate-anchor")),he=Fi(K,oe,fe,this.transform,ae);let Ie=null;if(oe){const De=Ni(K,oe,fe,this.transform,ae);Ie=c.K([],this.transform.labelPlaneMatrix,De)}this.retainedQueryData[v.bucketInstanceId]=new Rt(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,f.tileID);const Pe={bucket:v,layout:C,translationText:_e,translationIcon:Te,posMatrix:K,unwrappedTileID:H,textLabelPlaneMatrix:he,labelToScreenMatrix:Ie,scale:B,textPixelRatio:N,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:c.ag(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(g)for(const De of v.sortKeyRanges){const{sortKey:$e,symbolInstanceStart:Ge,symbolInstanceEnd:at}=De;i.push({sortKey:$e,symbolInstanceStart:Ge,symbolInstanceEnd:at,parameters:Pe})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(i,u,f,g,v,T,I,C,M,B,N,H,K,oe,fe,ae,_e,Te,he){const Ie=c.aq[i.textAnchor],Pe=[i.textOffset0,i.textOffset1],De=ir(Ie,f,g,Pe,v),$e=this.collisionIndex.placeCollisionBox(u,H,C,M,B,I,T,ae,N.predicate,he,De);if((!Te||this.collisionIndex.placeCollisionBox(Te,H,C,M,B,I,T,_e,N.predicate,he,De).placeable)&&$e.placeable){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[K.crossTileID].anchor),K.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[K.crossTileID]={textOffset:Pe,width:f,height:g,anchor:Ie,textBoxScale:v,prevAnchor:Ge},this.markUsedJustification(oe,Ie,K,fe),oe.allowVerticalPlacement&&(this.markUsedOrientation(oe,fe,K),this.placedOrientations[K.crossTileID]=fe),{shift:De,placedGlyphBoxes:$e}}}placeLayerBucketPart(i,u,f){const{bucket:g,layout:v,translationText:T,translationIcon:I,posMatrix:C,unwrappedTileID:M,textLabelPlaneMatrix:B,labelToScreenMatrix:N,textPixelRatio:H,holdingForFade:K,collisionBoxArray:oe,partiallyEvaluatedTextSize:fe,collisionGroup:ae}=i.parameters,_e=v.get("text-optional"),Te=v.get("icon-optional"),he=c.ar(v,"text-overlap","text-allow-overlap"),Ie=he==="always",Pe=c.ar(v,"icon-overlap","icon-allow-overlap"),De=Pe==="always",$e=v.get("text-rotation-alignment")==="map",Ge=v.get("text-pitch-alignment")==="map",at=v.get("icon-text-fit")!=="none",lt=v.get("symbol-z-order")==="viewport-y",Xe=Ie&&(De||!g.hasIconData()||Te),Ye=De&&(Ie||!g.hasTextData()||_e);!g.collisionArrays&&oe&&g.deserializeCollisionBoxes(oe);const gt=this._getTerrainElevationFunc(this.retainedQueryData[g.bucketInstanceId].tileID),Nt=(tt,it,Dt)=>{var Vn,Ht;if(u[tt.crossTileID])return;if(K)return void(this.placements[tt.crossTileID]=new Sn(!1,!1,!1));let Yt=!1,jn=!1,li=!0,Oo=null,Un={box:null,placeable:!1,offscreen:null},Ui={box:null,placeable:!1,offscreen:null},Ii=null,ui=null,ci=null,Fo=0,Ha=0,Zc=0;it.textFeatureIndex?Fo=it.textFeatureIndex:tt.useRuntimeCollisionCircles&&(Fo=tt.featureIndex),it.verticalTextFeatureIndex&&(Ha=it.verticalTextFeatureIndex);const Tl=it.textBox;if(Tl){const Zr=hi=>{let di=c.ah.horizontal;if(g.allowVerticalPlacement&&!hi&&this.prevPlacement){const Nr=this.prevPlacement.placedOrientations[tt.crossTileID];Nr&&(this.placedOrientations[tt.crossTileID]=Nr,di=Nr,this.markUsedOrientation(g,di,tt))}return di},No=(hi,di)=>{if(g.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&it.verticalTextBox){for(const Nr of g.writingModes)if(Nr===c.ah.vertical?(Un=di(),Ui=Un):Un=hi(),Un&&Un.placeable)break}else Un=hi()},aa=tt.textAnchorOffsetStartIndex,El=tt.textAnchorOffsetEndIndex;if(El===aa){const hi=(di,Nr)=>{const Xn=this.collisionIndex.placeCollisionBox(di,he,H,C,M,Ge,$e,T,ae.predicate,gt);return Xn&&Xn.placeable&&(this.markUsedOrientation(g,Nr,tt),this.placedOrientations[tt.crossTileID]=Nr),Xn};No(()=>hi(Tl,c.ah.horizontal),()=>{const di=it.verticalTextBox;return g.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&di?hi(di,c.ah.vertical):{box:null,offscreen:null}}),Zr(Un&&Un.placeable)}else{let hi=c.aq[(Ht=(Vn=this.prevPlacement)===null||Vn===void 0?void 0:Vn.variableOffsets[tt.crossTileID])===null||Ht===void 0?void 0:Ht.anchor];const di=(Xn,Il,ep)=>{const kr=Xn.x2-Xn.x1,hm=Xn.y2-Xn.y1,Yc=tt.textBoxScale,Qc=at&&Pe==="never"?Il:null;let la=null,dm=he==="never"?1:2,tp="never";hi&&dm++;for(let np=0;np<dm;np++){for(let rp=aa;rp<El;rp++){const Jc=g.textAnchorOffsets.get(rp);if(hi&&Jc.textAnchor!==hi)continue;const Cl=this.attemptAnchorPlacement(Jc,Xn,kr,hm,Yc,$e,Ge,H,C,M,ae,tp,tt,g,ep,T,I,Qc,gt);if(Cl&&(la=Cl.placedGlyphBoxes,la&&la.placeable))return Yt=!0,Oo=Cl.shift,la}hi?hi=null:tp=he}return f&&!la&&(la={box:this.collisionIndex.placeCollisionBox(Tl,"always",H,C,M,Ge,$e,T,ae.predicate,gt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),la};No(()=>di(Tl,it.iconBox,c.ah.horizontal),()=>{const Xn=it.verticalTextBox;return g.allowVerticalPlacement&&(!Un||!Un.placeable)&&tt.numVerticalGlyphVertices>0&&Xn?di(Xn,it.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Un&&(Yt=Un.placeable,li=Un.offscreen);const Nr=Zr(Un&&Un.placeable);if(!Yt&&this.prevPlacement){const Xn=this.prevPlacement.variableOffsets[tt.crossTileID];Xn&&(this.variableOffsets[tt.crossTileID]=Xn,this.markUsedJustification(g,Xn.anchor,tt,Nr))}}}if(Ii=Un,Yt=Ii&&Ii.placeable,li=Ii&&Ii.offscreen,tt.useRuntimeCollisionCircles){const Zr=g.text.placedSymbolArray.get(tt.centerJustifiedTextSymbolIndex),No=c.ai(g.textSizeData,fe,Zr),aa=v.get("text-padding");ui=this.collisionIndex.placeCollisionCircles(he,Zr,g.lineVertexArray,g.glyphOffsetArray,No,C,M,B,N,f,Ge,ae.predicate,tt.collisionCircleDiameter,aa,T,gt),ui.circles.length&&ui.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),Yt=Ie||ui.circles.length>0&&!ui.collisionDetected,li=li&&ui.offscreen}if(it.iconFeatureIndex&&(Zc=it.iconFeatureIndex),it.iconBox){const Zr=No=>this.collisionIndex.placeCollisionBox(No,Pe,H,C,M,Ge,$e,I,ae.predicate,gt,at&&Oo?Oo:void 0);Ui&&Ui.placeable&&it.verticalIconBox?(ci=Zr(it.verticalIconBox),jn=ci.placeable):(ci=Zr(it.iconBox),jn=ci.placeable),li=li&&ci.offscreen}const Wa=_e||tt.numHorizontalGlyphVertices===0&&tt.numVerticalGlyphVertices===0,Xc=Te||tt.numIconVertices===0;Wa||Xc?Xc?Wa||(jn=jn&&Yt):Yt=jn&&Yt:jn=Yt=jn&&Yt;const Jd=jn&&ci.placeable;if(Yt&&Ii.placeable&&this.collisionIndex.insertCollisionBox(Ii.box,he,v.get("text-ignore-placement"),g.bucketInstanceId,Ui&&Ui.placeable&&Ha?Ha:Fo,ae.ID),Jd&&this.collisionIndex.insertCollisionBox(ci.box,Pe,v.get("icon-ignore-placement"),g.bucketInstanceId,Zc,ae.ID),ui&&Yt&&this.collisionIndex.insertCollisionCircles(ui.circles,he,v.get("text-ignore-placement"),g.bucketInstanceId,Fo,ae.ID),f&&this.storeCollisionData(g.bucketInstanceId,Dt,it,Ii,ci,ui),tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tt.crossTileID]=new Sn(Yt||Xe,jn||Ye,li||g.justReloaded),u[tt.crossTileID]=!0};if(lt){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tt=g.getSortedSymbolIndexes(this.transform.angle);for(let it=tt.length-1;it>=0;--it){const Dt=tt[it];Nt(g.symbolInstances.get(Dt),g.collisionArrays[Dt],Dt)}}else for(let tt=i.symbolInstanceStart;tt<i.symbolInstanceEnd;tt++)Nt(g.symbolInstances.get(tt),g.collisionArrays[tt],tt);if(f&&g.bucketInstanceId in this.collisionCircleArrays){const tt=this.collisionCircleArrays[g.bucketInstanceId];c.as(tt.invProjMatrix,C),tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}g.justReloaded=!1}storeCollisionData(i,u,f,g,v,T){if(f.textBox||f.iconBox){let I,C;this.collisionBoxArrays.has(i)?I=this.collisionBoxArrays.get(i):(I=new Map,this.collisionBoxArrays.set(i,I)),I.has(u)?C=I.get(u):(C={text:null,icon:null},I.set(u,C)),f.textBox&&(C.text=g.box),f.iconBox&&(C.icon=v.box)}if(T){let I=this.collisionCircleArrays[i];I===void 0&&(I=this.collisionCircleArrays[i]=new Wn);for(let C=0;C<T.circles.length;C+=4)I.circles.push(T.circles[C+0]),I.circles.push(T.circles[C+1]),I.circles.push(T.circles[C+2]),I.circles.push(T.collisionDetected?1:0)}}markUsedJustification(i,u,f,g){let v;v=g===c.ah.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.at(u)];const T=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const I of T)I>=0&&(i.text.placedSymbolArray.get(I).crossTileID=v>=0&&I!==v?0:f.crossTileID)}markUsedOrientation(i,u,f){const g=u===c.ah.horizontal||u===c.ah.horizontalOnly?u:0,v=u===c.ah.vertical?u:0,T=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const I of T)i.text.placedSymbolArray.get(I).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(i):1,v=u?u.opacities:{},T=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const C in this.placements){const M=this.placements[C],B=v[C];B?(this.opacities[C]=new gn(B,g,M.text,M.icon),f=f||M.text!==B.text.placed||M.icon!==B.icon.placed):(this.opacities[C]=new gn(null,g,M.text,M.icon,M.skipFade),f=f||M.text||M.icon)}for(const C in v){const M=v[C];if(!this.opacities[C]){const B=new gn(M,g,!1,!1);B.isHidden()||(this.opacities[C]=B,f=f||M.text.placed||M.icon.placed)}}for(const C in T)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=T[C]);for(const C in I)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=I[C]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const f={};for(const g of u){const v=g.getBucket(i);v&&g.latestFeatureIndex&&i.id===v.layerIds[0]&&this.updateBucketOpacities(v,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(i,u,f,g){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const v=i.layers[0],T=v.layout,I=new gn(null,0,!1,!1,!0),C=T.get("text-allow-overlap"),M=T.get("icon-allow-overlap"),B=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),N=T.get("text-rotation-alignment")==="map",H=T.get("text-pitch-alignment")==="map",K=T.get("icon-text-fit")!=="none",oe=new gn(null,0,C&&(M||!i.hasIconData()||T.get("icon-optional")),M&&(C||!i.hasTextData()||T.get("text-optional")),!0);!i.collisionArrays&&g&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(g);const fe=(_e,Te,he)=>{for(let Ie=0;Ie<Te/4;Ie++)_e.opacityVertexArray.emplaceBack(he);_e.hasVisibleVertices=_e.hasVisibleVertices||he!==Ss},ae=this.collisionBoxArrays.get(i.bucketInstanceId);for(let _e=0;_e<i.symbolInstances.length;_e++){const Te=i.symbolInstances.get(_e),{numHorizontalGlyphVertices:he,numVerticalGlyphVertices:Ie,crossTileID:Pe}=Te;let De=this.opacities[Pe];f[Pe]?De=I:De||(De=oe,this.opacities[Pe]=De),f[Pe]=!0;const $e=Te.numIconVertices>0,Ge=this.placedOrientations[Te.crossTileID],at=Ge===c.ah.vertical,lt=Ge===c.ah.horizontal||Ge===c.ah.horizontalOnly;if(he>0||Ie>0){const Ye=sr(De.text);fe(i.text,he,at?Ss:Ye),fe(i.text,Ie,lt?Ss:Ye);const gt=De.text.isHidden();[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(it=>{it>=0&&(i.text.placedSymbolArray.get(it).hidden=gt||at?1:0)}),Te.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(Te.verticalPlacedTextSymbolIndex).hidden=gt||lt?1:0);const Nt=this.variableOffsets[Te.crossTileID];Nt&&this.markUsedJustification(i,Nt.anchor,Te,Ge);const tt=this.placedOrientations[Te.crossTileID];tt&&(this.markUsedJustification(i,"left",Te,tt),this.markUsedOrientation(i,tt,Te))}if($e){const Ye=sr(De.icon),gt=!(K&&Te.verticalPlacedIconSymbolIndex&&at);Te.placedIconSymbolIndex>=0&&(fe(i.icon,Te.numIconVertices,gt?Ye:Ss),i.icon.placedSymbolArray.get(Te.placedIconSymbolIndex).hidden=De.icon.isHidden()),Te.verticalPlacedIconSymbolIndex>=0&&(fe(i.icon,Te.numVerticalIconVertices,gt?Ss:Ye),i.icon.placedSymbolArray.get(Te.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const Xe=ae&&ae.has(_e)?ae.get(_e):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Ye=i.collisionArrays[_e];if(Ye){let gt=new c.P(0,0);if(Ye.textBox||Ye.verticalTextBox){let Nt=!0;if(B){const tt=this.variableOffsets[Pe];tt?(gt=ir(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textBoxScale),N&&gt._rotate(H?this.transform.angle:-this.transform.angle)):Nt=!1}if(Ye.textBox||Ye.verticalTextBox){let tt;Ye.textBox&&(tt=at),Ye.verticalTextBox&&(tt=lt),Kr(i.textCollisionBox.collisionVertexArray,De.text.placed,!Nt||tt,Xe.text,gt.x,gt.y)}}if(Ye.iconBox||Ye.verticalIconBox){const Nt=!!(!lt&&Ye.verticalIconBox);let tt;Ye.iconBox&&(tt=Nt),Ye.verticalIconBox&&(tt=!Nt),Kr(i.iconCollisionBox.collisionVertexArray,De.icon.placed,tt,Xe.icon,K?gt.x:0,K?gt.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=_e.invProjMatrix,i.placementViewportMatrix=_e.viewportMatrix,i.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>i}setStale(){this.stale=!0}}function Kr(_,i,u,f,g,v){f&&f.length!==0||(f=[0,0,0,0]);const T=f[0]-yt,I=f[1]-yt,C=f[2]-yt,M=f[3]-yt;_.emplaceBack(i?1:0,u?1:0,g||0,v||0,T,I),_.emplaceBack(i?1:0,u?1:0,g||0,v||0,C,I),_.emplaceBack(i?1:0,u?1:0,g||0,v||0,C,M),_.emplaceBack(i?1:0,u?1:0,g||0,v||0,T,M)}const or=Math.pow(2,25),bs=Math.pow(2,24),Cd=Math.pow(2,17),nn=Math.pow(2,16),cl=Math.pow(2,9),Ca=Math.pow(2,8),Ar=Math.pow(2,1);function sr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const i=_.placed?1:0,u=Math.floor(127*_.opacity);return u*or+i*bs+u*Cd+i*nn+u*cl+i*Ca+u*Ar+i}const Ss=0;function ni(){return{isOccluded:(_,i,u)=>!1,getPitchedTextCorrection:(_,i,u)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(_,i,u,f){throw new Error("Not implemented.")},translatePosition:(_,i,u,f)=>function(g,v,T,I,C=!1){if(!T[0]&&!T[1])return[0,0];const M=C?I==="map"?g.angle:0:I==="viewport"?-g.angle:0;if(M){const B=Math.sin(M),N=Math.cos(M);T=[T[0]*N-T[1]*B,T[0]*B+T[1]*N]}return[C?T[0]:Mt(v,T[0],g.zoom),C?T[1]:Mt(v,T[1],g.zoom)]}(_,i,u,f),getCircleRadiusCorrection:_=>1}}class Si{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,f,g,v){const T=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(T,g,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((I,C)=>I.sortKey-C.sortKey));this._currentPartIndex<T.length;)if(u.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,v())return!0;return!1}}class gu{constructor(i,u,f,g,v,T,I,C){this.placement=new zr(i,ni(),u,T,I,C),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(i,u,f){const g=L.now(),v=()=>!this._forceFullPlacement&&L.now()-g>2;for(;this._currentPlacementIndex>=0;){const T=u[i[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=I)&&(!T.maxzoom||T.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Si(T)),this._inProgressLayer.continuePlacement(f[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const _o=512/c.W/2;class Zn{constructor(i,u,f){this.tileID=i,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let v=0;v<u.length;v++){const T=u.get(v),I=T.key,C=g.get(I);C?C.push(T):g.set(I,[T])}for(const[v,T]of g){const I={positions:T.map(C=>({x:Math.floor(C.anchorX*_o),y:Math.floor(C.anchorY*_o)})),crossTileIDs:T.map(C=>C.crossTileID)};if(I.positions.length>128){const C=new c.av(I.positions.length,16,Uint16Array);for(const{x:M,y:B}of I.positions)C.add(M,B);C.finish(),delete I.positions,I.index=C}this._symbolsByKey[v]=I}}getScaledCoordinates(i,u){const{x:f,y:g,z:v}=this.tileID.canonical,{x:T,y:I,z:C}=u.canonical,M=_o/Math.pow(2,C-v),B=(I*c.W+i.anchorY)*M,N=g*c.W*_o;return{x:Math.floor((T*c.W+i.anchorX)*M-f*c.W*_o),y:Math.floor(B-N)}}findMatches(i,u,f){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let v=0;v<i.length;v++){const T=i.get(v);if(T.crossTileID)continue;const I=this._symbolsByKey[T.key];if(!I)continue;const C=this.getScaledCoordinates(T,u);if(I.index){const M=I.index.range(C.x-g,C.y-g,C.x+g,C.y+g).sort();for(const B of M){const N=I.crossTileIDs[B];if(!f[N]){f[N]=!0,T.crossTileID=N;break}}}else if(I.positions)for(let M=0;M<I.positions.length;M++){const B=I.positions[M],N=I.crossTileIDs[M];if(Math.abs(B.x-C.x)<=g&&Math.abs(B.y-C.y)<=g&&!f[N]){f[N]=!0,T.crossTileID=N;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class Ts{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class es{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(u!==0)for(const f in this.indexes){const g=this.indexes[f],v={};for(const T in g){const I=g[T];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),v[I.tileID.key]=I}this.indexes[f]=v}this.lng=i}addBucket(i,u,f){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let v=0;v<u.symbolInstances.length;v++)u.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const g=this.usedCrossTileIDs[i.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>i.overscaledZ)for(const I in T){const C=T[I];C.tileID.isChildOf(i)&&C.findMatches(u.symbolInstances,i,g)}else{const I=T[i.scaledTo(Number(v)).key];I&&I.findMatches(u.symbolInstances,i,g)}}for(let v=0;v<u.symbolInstances.length;v++){const T=u.symbolInstances.get(v);T.crossTileID||(T.crossTileID=f.generate(),g[T.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Zn(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const f of u.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[i][g]}removeStaleBuckets(i){let u=!1;for(const f in this.indexes){const g=this.indexes[f];for(const v in g)i[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[v]),delete g[v],u=!0)}return u}}class Gn{constructor(){this.layerIndexes={},this.crossTileIDs=new Ts,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,f){let g=this.layerIndexes[i.id];g===void 0&&(g=this.layerIndexes[i.id]=new es);let v=!1;const T={};g.handleWrapJump(f);for(const I of u){const C=I.getBucket(i);C&&i.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(I.tileID,C,this.crossTileIDs)&&(v=!0),T[C.bucketInstanceId]=!0)}return g.removeStaleBuckets(T)&&(v=!0),v}pruneUnusedLayers(i){const u={};i.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}const Es=(_,i)=>c.t(_,i&&i.filter(u=>u.identifier!=="source.canvas")),io=c.aw();class Aa extends c.E{constructor(i,u={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const g=this.sourceCaches[f].getSource().type;g!=="vector"&&g!=="geojson"||this.sourceCaches[f].reload()}},this.map=i,this.dispatcher=new vr(Pn(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,g)=>this.getGlyphs(f,g)),this.dispatcher.registerMessageHandler("GI",(f,g)=>this.getImages(f,g)),this.imageManager=new se,this.imageManager.setEventedParent(this),this.glyphManager=new tn(i._requestManager,u.localIdeographFontFamily),this.lineAtlas=new kt(256,512),this.crossTileSymbolIndex=new Gn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),Ir().on(mn,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const g=this.sourceCaches[f.sourceId];if(!g)return;const v=g.getSource();if(v&&v.vectorLayerIds)for(const T in this._layers){const I=this._layers[T];I.source===v.id&&this._validateLayer(I)}})}loadURL(i,u={},f){this.fire(new c.k("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController,c.h(g,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,u,f)}).catch(v=>{this._loadStyleRequest=null,v&&this.fire(new c.j(v))})}loadJSON(i,u={},f){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(i,u,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(io,{validate:!1})}_load(i,u,f){var g;const v=u.transformStyle?u.transformStyle(f,i):i;if(!u.validate||!Es(this,c.x(v))){this._loaded=!0,this.stylesheet=v;for(const T in v.sources)this.addSource(T,v.sources[T],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Tt(this.stylesheet.light),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const i=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of i){const f=c.aA(u);f.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=f}}_loadSprite(i,u=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,T,I,C){return c._(this,void 0,void 0,function*(){const M=Y(v),B=I>1?"@2x":"",N={},H={};for(const{id:K,url:oe}of M){const fe=T.transformRequest(ie(oe,B,".json"),"SpriteJSON");N[K]=c.h(fe,C);const ae=T.transformRequest(ie(oe,B,".png"),"SpriteImage");H[K]=re.getImage(ae,C)}return yield Promise.all([...Object.values(N),...Object.values(H)]),function(K,oe){return c._(this,void 0,void 0,function*(){const fe={};for(const ae in K){fe[ae]={};const _e=L.getImageCanvasContext((yield oe[ae]).data),Te=(yield K[ae]).data;for(const he in Te){const{width:Ie,height:Pe,x:De,y:$e,sdf:Ge,pixelRatio:at,stretchX:lt,stretchY:Xe,content:Ye,textFitWidth:gt,textFitHeight:Nt}=Te[he];fe[ae][he]={data:null,pixelRatio:at,sdf:Ge,stretchX:lt,stretchY:Xe,content:Ye,textFitWidth:gt,textFitHeight:Nt,spriteData:{width:Ie,height:Pe,x:De,y:$e,context:_e}}}}return fe})}(N,H)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const T in v){this._spritesImagesIds[T]=[];const I=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter(C=>!(C in v)):[];for(const C of I)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in v[T]){const M=T==="default"?C:`${T}:${C}`;this._spritesImagesIds[T].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,v[T][C],!1):this.imageManager.addImage(M,v[T][C]),u&&(this._changedImages[M]=!0)}}}).catch(v=>{this._spriteRequest=null,g=v,this.fire(new c.j(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(i){const u=this.sourceCaches[i.source];if(!u)return;const f=i.sourceLayer;if(!f)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.j(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i){const u=this._serializedAllLayers();if(!i||i.length===0)return Object.values(u);const f=[];for(const g of i)u[g]&&f.push(u[g]);return f}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const g=this._layers[f];g.type!=="custom"&&(i[f]=g.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const u=this._changed;if(u){const g=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(g.length||v.length)&&this._updateWorkerLayers(g,v);for(const T in this._updatedSources){const I=this._updatedSources[T];if(I==="reload")this._reloadSource(T);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const v=this.sourceCaches[g];f[g]=v.used,v.used=!1}for(const g of this._order){const v=this._layers[g];v.recalculate(i,this._availableImages),!v.isHidden(i.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const g in f){const v=this.sourceCaches[g];!!f[g]!=!!v.used&&v.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(i),this.z=i.zoom,u&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,u={}){var f;this._checkLoaded();const g=this.serialize();if(i=u.transformStyle?u.transformStyle(g,i):i,((f=u.validate)===null||f===void 0||f)&&Es(this,c.x(i)))return!1;(i=c.aB(i)).layers=c.az(i.layers);const v=c.aC(g,i),T=this._getOperationsToPerform(v);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const I of T.operations)I();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const u=[],f=[];for(const g of i)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":u.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":u.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setTransition":u.push(()=>{});break;default:f.push(g.command)}return{operations:u,unimplemented:f}}addImage(i,u){if(this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,u),this._afterImageUpdated(i)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new c.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,u,f={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(c.x.source,`sources.${i}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[i]=new Ze(i,u,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:i})),g.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===i)return this.fire(new c.j(new Error(`Source "${i}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],u.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,u){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const f=this.sourceCaches[i].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,u,f={}){this._checkLoaded();const g=i.id;if(this.getLayer(g))return void this.fire(new c.j(new Error(`Layer "${g}" already exists on this map.`)));let v;if(i.type==="custom"){if(Es(this,c.aD(i)))return;v=c.aA(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(g,i.source),i=c.aB(i),i=c.e(i,{source:g})),this._validate(c.x.layer,`layers.${g}`,i,{arrayIndex:-1},f))return;v=c.aA(i),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}})}const T=u?this._order.indexOf(u):this._order.length;if(u&&T===-1)this.fire(new c.j(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(T,0,g),this._layerOrderChanged=!0,this._layers[g]=v,this._removedLayers[g]&&v.source&&v.type!=="custom"){const I=this._removedLayers[g];delete this._removedLayers[g],I.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new c.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const f=this._order.indexOf(i);this._order.splice(f,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new c.j(new Error(`Cannot move layer "${i}" before non-existing layer "${u}".`))):(this._order.splice(g,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${i}".`)));u.setEventedParent(null);const f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,u,f){this._checkLoaded();const g=this.getLayer(i);g?g.minzoom===u&&g.maxzoom===f||(u!=null&&(g.minzoom=u),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,u,f={}){this._checkLoaded();const g=this.getLayer(i);if(g){if(!c.aE(g.filter,u))return u==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(c.x.filter,`layers.${g.id}.filter`,u,null,f)||(g.filter=c.aB(u),this._updateLayer(g)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return c.aB(this.getLayer(i).filter)}setLayoutProperty(i,u,f,g={}){this._checkLoaded();const v=this.getLayer(i);v?c.aE(v.getLayoutProperty(u),f)||(v.setLayoutProperty(u,f,g),this._updateLayer(v)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,u){const f=this.getLayer(i);if(f)return f.getLayoutProperty(u);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,u,f,g={}){this._checkLoaded();const v=this.getLayer(i);v?c.aE(v.getPaintProperty(u),f)||(v.setPaintProperty(u,f,g)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,u){return this.getLayer(i).getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const f=i.source,g=i.sourceLayer,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const T=v.getSource().type;T==="geojson"&&g?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||g?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(g,i.id,u)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,u){this._checkLoaded();const f=i.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const v=g.getSource().type,T=v==="vector"?i.sourceLayer:void 0;v!=="vector"||T?u&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(T,i.id,u):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const u=i.source,f=i.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||f?(i.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,i.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=c.aF(this.sourceCaches,v=>v.serialize()),u=this._serializeByIds(this._order),f=this.map.getTerrain()||void 0,g=this.stylesheet;return c.aG({version:g.version,name:g.name,metadata:g.metadata,light:g.light,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,sources:i,layers:u,terrain:f},v=>v!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const u=T=>this._layers[T].type==="fill-extrusion",f={},g=[];for(let T=this._order.length-1;T>=0;T--){const I=this._order[T];if(u(I)){f[I]=T;for(const C of i){const M=C[I];if(M)for(const B of M)g.push(B)}}}g.sort((T,I)=>I.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const I=this._order[T];if(u(I))for(let C=g.length-1;C>=0;C--){const M=g[C].feature;if(f[M.layer.id]<T)break;v.push(M),g.pop()}else for(const C of i){const M=C[I];if(M)for(const B of M)v.push(B.feature)}}return v}queryRenderedFeatures(i,u,f){u&&u.filter&&this._validate(c.x.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const I of u.layers){const C=this._layers[I];if(!C)return this.fire(new c.j(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];g[C.source]=!0}}const v=[];u.availableImages=this._availableImages;const T=this._serializedAllLayers();for(const I in this.sourceCaches)u.layers&&!g[I]||v.push(ei(this.sourceCaches[I],this._layers,T,i,u,f));return this.placement&&v.push(function(I,C,M,B,N,H,K){const oe={},fe=H.queryRenderedSymbols(B),ae=[];for(const _e of Object.keys(fe).map(Number))ae.push(K[_e]);ae.sort(Nn);for(const _e of ae){const Te=_e.featureIndex.lookupSymbolFeatures(fe[_e.bucketInstanceId],C,_e.bucketIndex,_e.sourceLayerIndex,N.filter,N.layers,N.availableImages,I);for(const he in Te){const Ie=oe[he]=oe[he]||[],Pe=Te[he];Pe.sort((De,$e)=>{const Ge=_e.featureSortOrder;if(Ge){const at=Ge.indexOf(De.featureIndex);return Ge.indexOf($e.featureIndex)-at}return $e.featureIndex-De.featureIndex});for(const De of Pe)Ie.push(De)}}for(const _e in oe)oe[_e].forEach(Te=>{const he=Te.feature,Ie=M[I[_e].source].getFeatureState(he.layer["source-layer"],he.id);he.source=he.layer.source,he.layer["source-layer"]&&(he.sourceLayer=he.layer["source-layer"]),he.state=Ie});return oe}(this._layers,T,this.sourceCaches,i,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(i,u){u&&u.filter&&this._validate(c.x.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[i];return f?function(g,v){const T=g.getRenderableIds().map(M=>g.getTileByID(M)),I=[],C={};for(let M=0;M<T.length;M++){const B=T[M],N=B.tileID.canonical.key;C[N]||(C[N]=!0,B.querySourceFeatures(I,v))}return I}(f,u):[]}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const T in i)if(!c.aE(i[T],f[T])){g=!0;break}if(!g)return;const v={now:L.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(v)}_validate(i,u,f,g,v={}){return(!v||v.validate!==!1)&&Es(this,i.call(c.x,c.e({key:u,style:this.serialize(),value:f,styleSpec:c.v},g)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ir().off(mn,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const u in this.sourceCaches)this.sourceCaches[u].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,u,f,g,v=!1){let T=!1,I=!1;const C={};for(const M of this._order){const B=this._layers[M];if(B.type!=="symbol")continue;if(!C[B.source]){const H=this.sourceCaches[B.source];C[B.source]=H.getRenderableIds(!0).map(K=>H.getTileByID(K)).sort((K,oe)=>oe.tileID.overscaledZ-K.tileID.overscaledZ||(K.tileID.isLessThan(oe.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(B,C[B.source],i.center.lng);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(L.now(),i.zoom))&&(this.pauseablePlacement=new gu(i,this.map.terrain,this._order,v,u,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(L.now()),I=!0),T&&this.pauseablePlacement.placement.setStale()),I||T)for(const M of this._order){const B=this._layers[M];B.type==="symbol"&&this.placement.updateLayerOpacities(B,C[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(L.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,u.icons),f})}getGlyphs(i,u){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,u={}){this._checkLoaded(),i&&this._validate(c.x.glyphs,"glyphs",i,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,u,f={},g){this._checkLoaded();const v=[{id:i,url:u}],T=[...Y(this.stylesheet.sprite),...v];this._validate(c.x.sprite,"sprite",T,null,f)||(this.stylesheet.sprite=T,this._loadSprite(v,!0,g))}removeSprite(i){this._checkLoaded();const u=Y(this.stylesheet.sprite);if(u.find(f=>f.id===i)){if(this._spritesImagesIds[i])for(const f of this._spritesImagesIds[i])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===i),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Y(this.stylesheet.sprite)}setSprite(i,u={},f){this._checkLoaded(),i&&this._validate(c.x.sprite,"sprite",i,null,u)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,f):(this._unloadSprite(),f&&f(null)))}}var oo=c.X([{name:"a_pos",type:"Int16",components:2}]),yu="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Bi={prelude:Zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Zt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Zt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Zt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Zt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Zt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Zt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Zt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Zt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Zt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Zt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",yu),terrainDepth:Zt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",yu),terrainCoords:Zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",yu)};function Zt(_,i){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=i.match(/attribute ([\w]+) ([\w]+)/g),g=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=v?v.concat(g):g,I={};return{fragmentSource:_=_.replace(u,(C,M,B,N,H)=>(I[H]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${B} ${N} ${H};
#else
uniform ${B} ${N} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${B} ${N} ${H} = u_${H};
#endif
`)),vertexSource:i=i.replace(u,(C,M,B,N,H)=>{const K=N==="float"?"vec2":"vec4",oe=H.match(/color/)?"color":K;return I[H]?M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${B} ${K} a_${H};
varying ${B} ${N} ${H};
#else
uniform ${B} ${N} u_${H};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${B} ${N} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${oe}(a_${H}, u_${H}_t);
#else
    ${B} ${N} ${H} = u_${H};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${B} ${K} a_${H};
#else
uniform ${B} ${N} u_${H};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${B} ${N} ${H} = a_${H};
#else
    ${B} ${N} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${B} ${N} ${H} = unpack_mix_${oe}(a_${H}, u_${H}_t);
#else
    ${B} ${N} ${H} = u_${H};
#endif
`}),staticAttributes:f,staticUniforms:T}}class Is{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,u,f,g,v,T,I,C,M){this.context=i;let B=this.boundPaintVertexBuffers.length!==g.length;for(let N=0;!B&&N<g.length;N++)this.boundPaintVertexBuffers[N]!==g[N]&&(B=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||B||this.boundIndexBuffer!==v||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==M?this.freshBind(u,f,g,v,T,I,C,M):(i.bindVertexArray.set(this.vao),I&&I.bind(),v&&v.dynamicDraw&&v.bind(),C&&C.bind(),M&&M.bind())}freshBind(i,u,f,g,v,T,I,C){const M=i.numAttributes,B=this.context,N=B.gl;this.vao&&this.destroy(),this.vao=B.createVertexArray(),B.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=C,u.enableAttributes(N,i);for(const H of f)H.enableAttributes(N,i);T&&T.enableAttributes(N,i),I&&I.enableAttributes(N,i),C&&C.enableAttributes(N,i),u.bind(),u.setVertexAttribPointers(N,i,v);for(const H of f)H.bind(),H.setVertexAttribPointers(N,i,v);T&&(T.bind(),T.setVertexAttribPointers(N,i,v)),g&&g.bind(),I&&(I.bind(),I.setVertexAttribPointers(N,i,v)),C&&(C.bind(),C.setVertexAttribPointers(N,i,v)),B.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function zo(_){const i=[];for(let u=0;u<_.length;u++){if(_[u]===null)continue;const f=_[u].split(" ");i.push(f.pop())}return i}class hl{constructor(i,u,f,g,v,T){const I=i.gl;this.program=I.createProgram();const C=zo(u.staticAttributes),M=f?f.getBinderAttributes():[],B=C.concat(M),N=Bi.prelude.staticUniforms?zo(Bi.prelude.staticUniforms):[],H=u.staticUniforms?zo(u.staticUniforms):[],K=f?f.getBinderUniforms():[],oe=N.concat(H).concat(K),fe=[];for(const De of oe)fe.indexOf(De)<0&&fe.push(De);const ae=f?f.defines():[];v&&ae.push("#define OVERDRAW_INSPECTOR;"),T&&ae.push("#define TERRAIN3D;");const _e=ae.concat(Bi.prelude.fragmentSource,u.fragmentSource).join(`
`),Te=ae.concat(Bi.prelude.vertexSource,u.vertexSource).join(`
`),he=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(he,_e),I.compileShader(he),!I.getShaderParameter(he,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(he)}`);I.attachShader(this.program,he);const Ie=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(Ie,Te),I.compileShader(Ie),!I.getShaderParameter(Ie,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(Ie)}`);I.attachShader(this.program,Ie),this.attributes={};const Pe={};this.numAttributes=B.length;for(let De=0;De<this.numAttributes;De++)B[De]&&(I.bindAttribLocation(this.program,De,B[De]),this.attributes[B[De]]=De);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(Ie),I.deleteShader(he);for(let De=0;De<fe.length;De++){const $e=fe[De];if($e&&!Pe[$e]){const Ge=I.getUniformLocation(this.program,$e);Ge&&(Pe[$e]=Ge)}}this.fixedUniforms=g(i,Pe),this.terrainUniforms=((De,$e)=>({u_depth:new c.aH(De,$e.u_depth),u_terrain:new c.aH(De,$e.u_terrain),u_terrain_dim:new c.aI(De,$e.u_terrain_dim),u_terrain_matrix:new c.aJ(De,$e.u_terrain_matrix),u_terrain_unpack:new c.aK(De,$e.u_terrain_unpack),u_terrain_exaggeration:new c.aI(De,$e.u_terrain_exaggeration)}))(i,Pe),this.binderUniforms=f?f.getUniforms(i,Pe):[]}draw(i,u,f,g,v,T,I,C,M,B,N,H,K,oe,fe,ae,_e,Te){const he=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(f),i.setStencilMode(g),i.setColorMode(v),i.setCullFace(T),C){i.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,C.depthTexture),i.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,C.texture);for(const Pe in this.terrainUniforms)this.terrainUniforms[Pe].set(C[Pe])}for(const Pe in this.fixedUniforms)this.fixedUniforms[Pe].set(I[Pe]);fe&&fe.setUniforms(i,this.binderUniforms,K,{zoom:oe});let Ie=0;switch(u){case he.LINES:Ie=2;break;case he.TRIANGLES:Ie=3;break;case he.LINE_STRIP:Ie=1}for(const Pe of H.get()){const De=Pe.vaos||(Pe.vaos={});(De[M]||(De[M]=new Is)).bind(i,this,B,fe?fe.getPaintVertexBuffers():[],N,Pe.vertexOffset,ae,_e,Te),he.drawElements(u,Pe.primitiveLength*Ie,he.UNSIGNED_SHORT,Pe.primitiveOffset*Ie*2)}}}function Tn(_,i,u){const f=1/Mt(u,1,i.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,i.transform.tileZoom)/g,T=v*(u.tileID.canonical.x+u.tileID.wrap*g),I=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[T>>16,I>>16],u_pixel_coord_lower:[65535&T,65535&I]}}const ts=(_,i,u,f)=>{const g=i.style.light,v=g.properties.get("position"),T=[v.x,v.y,v.z],I=function(){var M=new c.A(9);return c.A!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M}();g.properties.get("anchor")==="viewport"&&function(M,B){var N=Math.sin(B),H=Math.cos(B);M[0]=H,M[1]=N,M[2]=0,M[3]=-N,M[4]=H,M[5]=0,M[6]=0,M[7]=0,M[8]=1}(I,-i.transform.angle),function(M,B,N){var H=B[0],K=B[1],oe=B[2];M[0]=H*N[0]+K*N[3]+oe*N[6],M[1]=H*N[1]+K*N[4]+oe*N[7],M[2]=H*N[2]+K*N[5]+oe*N[8]}(T,T,I);const C=g.properties.get("color");return{u_matrix:_,u_lightpos:T,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+u,u_opacity:f}},Cs=(_,i,u,f,g,v,T)=>c.e(ts(_,i,u,f),Tn(v,i,T),{u_height_factor:-Math.pow(2,g.overscaledZ)/T.tileSize/8}),ns=_=>({u_matrix:_}),ka=(_,i,u,f)=>c.e(ns(_),Tn(u,i,f)),Pa=(_,i)=>({u_matrix:_,u_world:i}),Ra=(_,i,u,f,g)=>c.e(ka(_,i,u,f),{u_world:g}),Ad=(_,i,u,f)=>{const g=_.transform;let v,T;if(f.paint.get("circle-pitch-alignment")==="map"){const I=Mt(u,1,g.zoom);v=!0,T=[I,I]}else v=!1,T=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(i.posMatrix,u,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:T}},kd=(_,i,u)=>({u_matrix:_,u_inv_matrix:i,u_camera_to_center_distance:u.cameraToCenterDistance,u_viewport_size:[u.width,u.height]}),_u=(_,i,u=1)=>({u_matrix:_,u_color:i,u_overlay:0,u_overlay_scale:u}),Zs=_=>({u_matrix:_}),ri=(_,i,u,f)=>({u_matrix:_,u_extrude_scale:Mt(i,1,u),u_intensity:f});function Ma(_,i){const u=Math.pow(2,i.canonical.z),f=i.canonical.y;return[new c.Y(0,f/u).toLngLat().lat,new c.Y(0,(f+1)/u).toLngLat().lat]}const Or=(_,i,u,f)=>{const g=_.transform;return{u_matrix:xu(_,i,u,f),u_ratio:1/Mt(i,1,g.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},ii=(_,i,u,f,g)=>c.e(Or(_,i,u,g),{u_image:0,u_image_height:f}),rs=(_,i,u,f,g)=>{const v=_.transform,T=vu(i,v);return{u_matrix:xu(_,i,u,g),u_texsize:i.imageAtlasTexture.size,u_ratio:1/Mt(i,1,v.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[T,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},dl=(_,i,u,f,g,v)=>{const T=_.lineAtlas,I=vu(i,_.transform),C=u.layout.get("line-cap")==="round",M=T.getDash(f.from,C),B=T.getDash(f.to,C),N=M.width*g.fromScale,H=B.width*g.toScale;return c.e(Or(_,i,u,v),{u_patternscale_a:[I/N,-M.height/2],u_patternscale_b:[I/H,-B.height/2],u_sdfgamma:T.width/(256*Math.min(N,H)*_.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:B.y,u_mix:g.t})};function vu(_,i){return 1/Mt(_,1,i.tileZoom)}function xu(_,i,u,f){return _.translatePosMatrix(f?f.posMatrix:i.tileID.posMatrix,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Ti=(_,i,u,f,g)=>{return{u_matrix:_,u_tl_parent:i,u_scale_parent:u,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(T=g.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(v=g.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:Pd(g.paint.get("raster-hue-rotate"))};var v,T};function Pd(_){_*=Math.PI/180;const i=Math.sin(_),u=Math.cos(_);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const Tc=(_,i,u,f,g,v,T,I,C,M,B,N,H,K)=>{const oe=T.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:oe.cameraToCenterDistance,u_pitch:oe.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:oe.width/oe.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:C,u_coord_matrix:M,u_is_text:+N,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:v,u_texsize:H,u_texture:0,u_translation:B,u_pitched_scale:K}},Xs=(_,i,u,f,g,v,T,I,C,M,B,N,H,K,oe)=>{const fe=T.transform;return c.e(Tc(_,i,u,f,g,v,T,I,C,M,B,N,H,oe),{u_gamma_scale:f?Math.cos(fe._pitch)*fe.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:+K})},pl=(_,i,u,f,g,v,T,I,C,M,B,N,H,K)=>c.e(Xs(_,i,u,f,g,v,T,I,C,M,B,!0,N,!0,K),{u_texsize_icon:H,u_texture_icon:1}),Ec=(_,i,u)=>({u_matrix:_,u_opacity:i,u_color:u}),La=(_,i,u,f,g,v)=>c.e(function(T,I,C,M){const B=C.imageManager.getPattern(T.from.toString()),N=C.imageManager.getPattern(T.to.toString()),{width:H,height:K}=C.imageManager.getPixelSize(),oe=Math.pow(2,M.tileID.overscaledZ),fe=M.tileSize*Math.pow(2,C.transform.tileZoom)/oe,ae=fe*(M.tileID.canonical.x+M.tileID.wrap*oe),_e=fe*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[H,K],u_mix:I.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Mt(M,1,C.transform.tileZoom),u_pixel_coord_upper:[ae>>16,_e>>16],u_pixel_coord_lower:[65535&ae,65535&_e]}}(f,v,u,g),{u_matrix:_,u_opacity:i}),is={fillExtrusion:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_lightpos:new c.aL(_,i.u_lightpos),u_lightintensity:new c.aI(_,i.u_lightintensity),u_lightcolor:new c.aL(_,i.u_lightcolor),u_vertical_gradient:new c.aI(_,i.u_vertical_gradient),u_opacity:new c.aI(_,i.u_opacity)}),fillExtrusionPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_lightpos:new c.aL(_,i.u_lightpos),u_lightintensity:new c.aI(_,i.u_lightintensity),u_lightcolor:new c.aL(_,i.u_lightcolor),u_vertical_gradient:new c.aI(_,i.u_vertical_gradient),u_height_factor:new c.aI(_,i.u_height_factor),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade),u_opacity:new c.aI(_,i.u_opacity)}),fill:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix)}),fillPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),fillOutline:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world)}),fillOutlinePattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world),u_image:new c.aH(_,i.u_image),u_texsize:new c.aM(_,i.u_texsize),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),circle:(_,i)=>({u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_scale_with_map:new c.aH(_,i.u_scale_with_map),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_extrude_scale:new c.aM(_,i.u_extrude_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_matrix:new c.aJ(_,i.u_matrix)}),collisionBox:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_pixel_extrude_scale:new c.aM(_,i.u_pixel_extrude_scale)}),collisionCircle:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_inv_matrix:new c.aJ(_,i.u_inv_matrix),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_viewport_size:new c.aM(_,i.u_viewport_size)}),debug:(_,i)=>({u_color:new c.aN(_,i.u_color),u_matrix:new c.aJ(_,i.u_matrix),u_overlay:new c.aH(_,i.u_overlay),u_overlay_scale:new c.aI(_,i.u_overlay_scale)}),clippingMask:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix)}),heatmap:(_,i)=>({u_extrude_scale:new c.aI(_,i.u_extrude_scale),u_intensity:new c.aI(_,i.u_intensity),u_matrix:new c.aJ(_,i.u_matrix)}),heatmapTexture:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_world:new c.aM(_,i.u_world),u_image:new c.aH(_,i.u_image),u_color_ramp:new c.aH(_,i.u_color_ramp),u_opacity:new c.aI(_,i.u_opacity)}),hillshade:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_latrange:new c.aM(_,i.u_latrange),u_light:new c.aM(_,i.u_light),u_shadow:new c.aN(_,i.u_shadow),u_highlight:new c.aN(_,i.u_highlight),u_accent:new c.aN(_,i.u_accent)}),hillshadePrepare:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_image:new c.aH(_,i.u_image),u_dimension:new c.aM(_,i.u_dimension),u_zoom:new c.aI(_,i.u_zoom),u_unpack:new c.aK(_,i.u_unpack)}),line:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels)}),lineGradient:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_image:new c.aH(_,i.u_image),u_image_height:new c.aI(_,i.u_image_height)}),linePattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texsize:new c.aM(_,i.u_texsize),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_image:new c.aH(_,i.u_image),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_scale:new c.aL(_,i.u_scale),u_fade:new c.aI(_,i.u_fade)}),lineSDF:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ratio:new c.aI(_,i.u_ratio),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_units_to_pixels:new c.aM(_,i.u_units_to_pixels),u_patternscale_a:new c.aM(_,i.u_patternscale_a),u_patternscale_b:new c.aM(_,i.u_patternscale_b),u_sdfgamma:new c.aI(_,i.u_sdfgamma),u_image:new c.aH(_,i.u_image),u_tex_y_a:new c.aI(_,i.u_tex_y_a),u_tex_y_b:new c.aI(_,i.u_tex_y_b),u_mix:new c.aI(_,i.u_mix)}),raster:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_tl_parent:new c.aM(_,i.u_tl_parent),u_scale_parent:new c.aI(_,i.u_scale_parent),u_buffer_scale:new c.aI(_,i.u_buffer_scale),u_fade_t:new c.aI(_,i.u_fade_t),u_opacity:new c.aI(_,i.u_opacity),u_image0:new c.aH(_,i.u_image0),u_image1:new c.aH(_,i.u_image1),u_brightness_low:new c.aI(_,i.u_brightness_low),u_brightness_high:new c.aI(_,i.u_brightness_high),u_saturation_factor:new c.aI(_,i.u_saturation_factor),u_contrast_factor:new c.aI(_,i.u_contrast_factor),u_spin_weights:new c.aL(_,i.u_spin_weights)}),symbolIcon:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texture:new c.aH(_,i.u_texture),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),symbolSDF:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texture:new c.aH(_,i.u_texture),u_gamma_scale:new c.aI(_,i.u_gamma_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_is_halo:new c.aH(_,i.u_is_halo),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),symbolTextAndIcon:(_,i)=>({u_is_size_zoom_constant:new c.aH(_,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(_,i.u_is_size_feature_constant),u_size_t:new c.aI(_,i.u_size_t),u_size:new c.aI(_,i.u_size),u_camera_to_center_distance:new c.aI(_,i.u_camera_to_center_distance),u_pitch:new c.aI(_,i.u_pitch),u_rotate_symbol:new c.aH(_,i.u_rotate_symbol),u_aspect_ratio:new c.aI(_,i.u_aspect_ratio),u_fade_change:new c.aI(_,i.u_fade_change),u_matrix:new c.aJ(_,i.u_matrix),u_label_plane_matrix:new c.aJ(_,i.u_label_plane_matrix),u_coord_matrix:new c.aJ(_,i.u_coord_matrix),u_is_text:new c.aH(_,i.u_is_text),u_pitch_with_map:new c.aH(_,i.u_pitch_with_map),u_is_along_line:new c.aH(_,i.u_is_along_line),u_is_variable_anchor:new c.aH(_,i.u_is_variable_anchor),u_texsize:new c.aM(_,i.u_texsize),u_texsize_icon:new c.aM(_,i.u_texsize_icon),u_texture:new c.aH(_,i.u_texture),u_texture_icon:new c.aH(_,i.u_texture_icon),u_gamma_scale:new c.aI(_,i.u_gamma_scale),u_device_pixel_ratio:new c.aI(_,i.u_device_pixel_ratio),u_is_halo:new c.aH(_,i.u_is_halo),u_translation:new c.aM(_,i.u_translation),u_pitched_scale:new c.aI(_,i.u_pitched_scale)}),background:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_opacity:new c.aI(_,i.u_opacity),u_color:new c.aN(_,i.u_color)}),backgroundPattern:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_opacity:new c.aI(_,i.u_opacity),u_image:new c.aH(_,i.u_image),u_pattern_tl_a:new c.aM(_,i.u_pattern_tl_a),u_pattern_br_a:new c.aM(_,i.u_pattern_br_a),u_pattern_tl_b:new c.aM(_,i.u_pattern_tl_b),u_pattern_br_b:new c.aM(_,i.u_pattern_br_b),u_texsize:new c.aM(_,i.u_texsize),u_mix:new c.aI(_,i.u_mix),u_pattern_size_a:new c.aM(_,i.u_pattern_size_a),u_pattern_size_b:new c.aM(_,i.u_pattern_size_b),u_scale_a:new c.aI(_,i.u_scale_a),u_scale_b:new c.aI(_,i.u_scale_b),u_pixel_coord_upper:new c.aM(_,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(_,i.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(_,i.u_tile_units_to_pixels)}),terrain:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texture:new c.aH(_,i.u_texture),u_ele_delta:new c.aI(_,i.u_ele_delta)}),terrainDepth:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_ele_delta:new c.aI(_,i.u_ele_delta)}),terrainCoords:(_,i)=>({u_matrix:new c.aJ(_,i.u_matrix),u_texture:new c.aH(_,i.u_texture),u_terrain_coords_id:new c.aI(_,i.u_terrain_coords_id),u_ele_delta:new c.aI(_,i.u_ele_delta)})};class fl{constructor(i,u,f){this.context=i;const g=i.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ys={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bn{constructor(i,u,f,g){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=i;const v=i.gl;this.buffer=v.createBuffer(),i.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let f=0;f<this.attributes.length;f++){const g=u.attributes[this.attributes[f].name];g!==void 0&&i.enableVertexAttribArray(g)}}setVertexAttribPointers(i,u,f){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],T=u.attributes[v.name];T!==void 0&&i.vertexAttribPointer(T,v.components,i[Ys[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Da=new WeakMap;function Ei(_){var i;if(Da.has(_))return Da.get(_);{const u=(i=_.getParameter(_.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Da.set(_,u),u}}class rn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ml extends rn{getDefault(){return c.aP.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Qs extends rn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class os extends rn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Ic extends rn{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Vi extends rn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Cc extends rn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Js extends rn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class za extends rn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class wu extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class bu extends rn{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Oa extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class gl extends rn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Fa extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class Ac extends rn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Su extends rn{getDefault(){return c.aP.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ea extends rn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class ss extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class Tu extends rn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Eu extends rn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class Iu extends rn{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Cu extends rn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class as extends rn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class kc extends rn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Na extends rn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class As extends rn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Pc extends rn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Au extends rn{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class ku extends rn{getDefault(){return null}set(i){var u;if(i===this.current&&!this.dirty)return;const f=this.gl;Ei(f)?f.bindVertexArray(i):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Pu extends rn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class ta extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class oi extends rn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class ks extends rn{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class vo extends ks{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class ls extends ks{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class w extends ks{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class P{constructor(i,u,f,g,v){this.context=i,this.width=u,this.height=f;const T=i.gl,I=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new vo(i,I),g)this.depthAttachment=v?new w(i,I):new ls(i,I);else if(v)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&i.deleteRenderbuffer(f)}i.deleteFramebuffer(this.framebuffer)}}class F{constructor(i,u,f){this.blendFunction=i,this.blendColor=u,this.mask=f}}F.Replace=[1,0],F.disabled=new F(F.Replace,c.aP.transparent,[!1,!1,!1,!1]),F.unblended=new F(F.Replace,c.aP.transparent,[!0,!0,!0,!0]),F.alphaBlended=new F([1,771],c.aP.transparent,[!0,!0,!0,!0]);class Q{constructor(i){var u,f;if(this.gl=i,this.clearColor=new ml(this),this.clearDepth=new Qs(this),this.clearStencil=new os(this),this.colorMask=new Ic(this),this.depthMask=new Vi(this),this.stencilMask=new Cc(this),this.stencilFunc=new Js(this),this.stencilOp=new za(this),this.stencilTest=new wu(this),this.depthRange=new bu(this),this.depthTest=new Oa(this),this.depthFunc=new gl(this),this.blend=new Fa(this),this.blendFunc=new Ac(this),this.blendColor=new Su(this),this.blendEquation=new ea(this),this.cullFace=new ss(this),this.cullFaceSide=new Tu(this),this.frontFace=new Eu(this),this.program=new Iu(this),this.activeTexture=new Cu(this),this.viewport=new as(this),this.bindFramebuffer=new kc(this),this.bindRenderbuffer=new Na(this),this.bindTexture=new As(this),this.bindVertexBuffer=new Pc(this),this.bindElementBuffer=new Au(this),this.bindVertexArray=new ku(this),this.pixelStoreUnpack=new Pu(this),this.pixelStoreUnpackPremultiplyAlpha=new ta(this),this.pixelStoreUnpackFlipY=new oi(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Ei(i)){this.HALF_FLOAT=i.HALF_FLOAT;const g=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=i.RGBA16F)!==null&&u!==void 0?u:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=i.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const g=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new fl(this,i,u)}createVertexBuffer(i,u,f){return new Bn(this,i,u,f)}createRenderbuffer(i,u,f){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,i,u,f),this.bindRenderbuffer.set(null),v}createFramebuffer(i,u,f,g){return new P(this,i,u,f,g)}clear({color:i,depth:u,stencil:f}){const g=this.gl;let v=0;i&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(v|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(v)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){c.aE(i.blendFunction,F.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Ei(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var u;return Ei(this.gl)?this.gl.deleteVertexArray(i):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class Se{constructor(i,u,f){this.func=i,this.mask=u,this.range=f}}Se.ReadOnly=!1,Se.ReadWrite=!0,Se.disabled=new Se(519,Se.ReadOnly,[0,1]);const Fe=7680;class We{constructor(i,u,f,g,v,T){this.test=i,this.ref=u,this.mask=f,this.fail=g,this.depthFail=v,this.pass=T}}We.disabled=new We({func:519,mask:0},0,0,Fe,Fe,Fe);class Lt{constructor(i,u,f){this.enable=i,this.mode=u,this.frontFace=f}}let ar;function on(_,i,u,f,g){const v=_.context,T=v.gl,I=_.useProgram("collisionBox"),C=[];let M=0,B=0;for(let _e=0;_e<f.length;_e++){const Te=f[_e],he=i.getTile(Te).getBucket(u);if(!he)continue;const Ie=g?he.textCollisionBox:he.iconCollisionBox,Pe=he.collisionCircleArray;if(Pe.length>0){const De=c.F();c.aQ(De,he.placementInvProjMatrix,_.transform.glCoordMatrix),c.aQ(De,De,he.placementViewportMatrix),C.push({circleArray:Pe,circleOffset:B,transform:Te.posMatrix,invTransform:De,coord:Te}),M+=Pe.length/4,B=M}Ie&&I.draw(v,T.LINES,Se.disabled,We.disabled,_.colorModeForRenderPass(),Lt.disabled,{u_matrix:Te.posMatrix,u_pixel_extrude_scale:[1/(N=_.transform).width,1/N.height]},_.style.map.terrain&&_.style.map.terrain.getTerrainData(Te),u.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,null,_.transform.zoom,null,null,Ie.collisionVertexBuffer)}var N;if(!g||!C.length)return;const H=_.useProgram("collisionCircle"),K=new c.aR;K.resize(4*M),K._trim();let oe=0;for(const _e of C)for(let Te=0;Te<_e.circleArray.length/4;Te++){const he=4*Te,Ie=_e.circleArray[he+0],Pe=_e.circleArray[he+1],De=_e.circleArray[he+2],$e=_e.circleArray[he+3];K.emplace(oe++,Ie,Pe,De,$e,0),K.emplace(oe++,Ie,Pe,De,$e,1),K.emplace(oe++,Ie,Pe,De,$e,2),K.emplace(oe++,Ie,Pe,De,$e,3)}(!ar||ar.length<2*M)&&(ar=function(_e){const Te=2*_e,he=new c.aT;he.resize(Te),he._trim();for(let Ie=0;Ie<Te;Ie++){const Pe=6*Ie;he.uint16[Pe+0]=4*Ie+0,he.uint16[Pe+1]=4*Ie+1,he.uint16[Pe+2]=4*Ie+2,he.uint16[Pe+3]=4*Ie+2,he.uint16[Pe+4]=4*Ie+3,he.uint16[Pe+5]=4*Ie+0}return he}(M));const fe=v.createIndexBuffer(ar,!0),ae=v.createVertexBuffer(K,c.aS.members,!0);for(const _e of C){const Te=kd(_e.transform,_e.invTransform,_.transform);H.draw(v,T.TRIANGLES,Se.disabled,We.disabled,_.colorModeForRenderPass(),Lt.disabled,Te,_.style.map.terrain&&_.style.map.terrain.getTerrainData(_e.coord),u.id,ae,fe,c.$.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,_.transform.zoom,null,null,null)}ae.destroy(),fe.destroy()}Lt.disabled=new Lt(!1,1029,2305),Lt.backCCW=new Lt(!0,1029,2305);const wr=c.an(new Float32Array(16));function Fr(_,i,u,f,g,v){const{horizontalAlign:T,verticalAlign:I}=c.au(_);return new c.P((-(T-.5)*i/g+f[0])*v,(-(I-.5)*u/g+f[1])*v)}function Ps(_,i,u,f,g,v){const T=i.tileAnchorPoint.add(new c.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let I=f.mult(v);return u||(I=I.rotate(-g)),Wt(T.add(I),i.labelPlaneMatrix,i.getElevation).point}if(u){const I=ye(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(_),C=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return _.add(f.rotate(C))}return _.add(f)}function si(_,i,u,f,g,v,T,I,C,M,B,N,H,K){const oe=_.text.placedSymbolArray,fe=_.text.dynamicLayoutVertexArray,ae=_.icon.dynamicLayoutVertexArray,_e={};fe.clear();for(let Te=0;Te<oe.length;Te++){const he=oe.get(Te),Ie=he.hidden||!he.crossTileID||_.allowVerticalPlacement&&!he.placedOrientation?null:f[he.crossTileID];if(Ie){const Pe=new c.P(he.anchorX,he.anchorY),De={getElevation:K,width:g.width,height:g.height,labelPlaneMatrix:v,lineVertexArray:null,pitchWithMap:u,projection:B,projectionCache:null,tileAnchorPoint:Pe,translation:N,unwrappedTileID:H},$e=u?Wt(Pe,T,K):ye(Pe.x,Pe.y,De),Ge=ne(g.cameraToCenterDistance,$e.signedDistanceFromCamera);let at=c.ai(_.textSizeData,C,he)*Ge/c.ap;u&&(at*=_.tilePixelRatio/I);const{width:lt,height:Xe,anchor:Ye,textOffset:gt,textBoxScale:Nt}=Ie,tt=Fr(Ye,lt,Xe,gt,Nt,at),it=B.getPitchedTextCorrection(g,Pe.add(new c.P(N[0],N[1])),H),Dt=Ps($e.point,De,i,tt,g.angle,it),Vn=_.allowVerticalPlacement&&he.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Ht=0;Ht<he.numGlyphs;Ht++)c.aj(fe,Dt,Vn);M&&he.associatedIconIndex>=0&&(_e[he.associatedIconIndex]={shiftedAnchor:Dt,angle:Vn})}else bt(he.numGlyphs,fe)}if(M){ae.clear();const Te=_.icon.placedSymbolArray;for(let he=0;he<Te.length;he++){const Ie=Te.get(he);if(Ie.hidden)bt(Ie.numGlyphs,ae);else{const Pe=_e[he];if(Pe)for(let De=0;De<Ie.numGlyphs;De++)c.aj(ae,Pe.shiftedAnchor,Pe.angle);else bt(Ie.numGlyphs,ae)}}_.icon.dynamicLayoutVertexBuffer.updateData(ae)}_.text.dynamicLayoutVertexBuffer.updateData(fe)}function Rs(_,i,u){return u.iconsInText&&i?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Ms(_,i,u,f,g,v,T,I,C,M,B,N){const H=_.context,K=H.gl,oe=_.transform,fe=ni(),ae=I==="map",_e=C==="map",Te=I!=="viewport"&&u.layout.get("symbol-placement")!=="point",he=ae&&!_e&&!Te,Ie=!_e&&Te,Pe=!u.layout.get("symbol-sort-key").isConstant();let De=!1;const $e=_.depthModeForSublayer(0,Se.ReadOnly),Ge=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),at=[],lt=fe.getCircleRadiusCorrection(oe);for(const Xe of f){const Ye=i.getTile(Xe),gt=Ye.getBucket(u);if(!gt)continue;const Nt=g?gt.text:gt.icon;if(!Nt||!Nt.segments.get().length||!Nt.hasVisibleVertices)continue;const tt=Nt.programConfigurations.get(u.id),it=g||gt.sdfIcons,Dt=g?gt.textSizeData:gt.iconSizeData,Vn=_e||oe.pitch!==0,Ht=_.useProgram(Rs(it,g,gt),tt),Yt=c.ag(Dt,oe.zoom),jn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Xe);let li,Oo,Un,Ui,Ii=[0,0],ui=null;if(g)Oo=Ye.glyphAtlasTexture,Un=K.LINEAR,li=Ye.glyphAtlasTexture.size,gt.iconsInText&&(Ii=Ye.imageAtlasTexture.size,ui=Ye.imageAtlasTexture,Ui=Vn||_.options.rotating||_.options.zooming||Dt.kind==="composite"||Dt.kind==="camera"?K.LINEAR:K.NEAREST);else{const Xn=u.layout.get("icon-size").constantOr(0)!==1||gt.iconsNeedLinear;Oo=Ye.imageAtlasTexture,Un=it||_.options.rotating||_.options.zooming||Xn||Vn?K.LINEAR:K.NEAREST,li=Ye.imageAtlasTexture.size}const ci=Mt(Ye,1,_.transform.zoom),Fo=Ie?Xe.posMatrix:wr,Ha=Fi(Fo,_e,ae,_.transform,ci),Zc=Ni(Fo,_e,ae,_.transform,ci),Tl=Ni(Xe.posMatrix,_e,ae,_.transform,ci),Wa=fe.translatePosition(_.transform,Ye,v,T),Xc=Ge&&gt.hasTextData(),Jd=u.layout.get("icon-text-fit")!=="none"&&Xc&&gt.hasIconData();if(Te){const Xn=_.style.map.terrain?(ep,kr)=>_.style.map.terrain.getElevation(Xe,ep,kr):null,Il=u.layout.get("text-rotation-alignment")==="map";U(gt,Xe.posMatrix,_,g,Ha,Tl,_e,M,Il,fe,Xe.toUnwrapped(),oe.width,oe.height,Wa,Xn)}const Zr=Xe.posMatrix,No=g&&Ge||Jd,aa=Te||No?wr:Ha,El=Zc,hi=it&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let di;di=it?gt.iconsInText?pl(Dt.kind,Yt,he,_e,Te,No,_,Zr,aa,El,Wa,li,Ii,lt):Xs(Dt.kind,Yt,he,_e,Te,No,_,Zr,aa,El,Wa,g,li,!0,lt):Tc(Dt.kind,Yt,he,_e,Te,No,_,Zr,aa,El,Wa,g,li,lt);const Nr={program:Ht,buffers:Nt,uniformValues:di,atlasTexture:Oo,atlasTextureIcon:ui,atlasInterpolation:Un,atlasInterpolationIcon:Ui,isSDF:it,hasHalo:hi};if(Pe&&gt.canOverlap){De=!0;const Xn=Nt.segments.get();for(const Il of Xn)at.push({segments:new c.$([Il]),sortKey:Il.sortKey,state:Nr,terrainData:jn})}else at.push({segments:Nt.segments,sortKey:0,state:Nr,terrainData:jn})}De&&at.sort((Xe,Ye)=>Xe.sortKey-Ye.sortKey);for(const Xe of at){const Ye=Xe.state;if(H.activeTexture.set(K.TEXTURE0),Ye.atlasTexture.bind(Ye.atlasInterpolation,K.CLAMP_TO_EDGE),Ye.atlasTextureIcon&&(H.activeTexture.set(K.TEXTURE1),Ye.atlasTextureIcon&&Ye.atlasTextureIcon.bind(Ye.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),Ye.isSDF){const gt=Ye.uniformValues;Ye.hasHalo&&(gt.u_is_halo=1,Rc(Ye.buffers,Xe.segments,u,_,Ye.program,$e,B,N,gt,Xe.terrainData)),gt.u_is_halo=0}Rc(Ye.buffers,Xe.segments,u,_,Ye.program,$e,B,N,Ye.uniformValues,Xe.terrainData)}}function Rc(_,i,u,f,g,v,T,I,C,M){const B=f.context;g.draw(B,B.gl.TRIANGLES,v,T,I,Lt.disabled,C,M,u.id,_.layoutVertexBuffer,_.indexBuffer,i,u.paint,f.transform.zoom,_.programConfigurations.get(u.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function na(_,i,u,f,g){if(!u||!f||!f.imageAtlas)return;const v=f.imageAtlas.patternPositions;let T=v[u.to.toString()],I=v[u.from.toString()];if(!T&&I&&(T=I),!I&&T&&(I=T),!T||!I){const C=g.getPaintProperty(i);T=v[C],I=v[C]}T&&I&&_.setConstantPatternPositions(T,I)}function Ba(_,i,u,f,g,v,T){const I=_.context.gl,C="fill-pattern",M=u.paint.get(C),B=M&&M.constantOr(1),N=u.getCrossfadeParameters();let H,K,oe,fe,ae;T?(K=B&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=I.LINES):(K=B?"fillPattern":"fill",H=I.TRIANGLES);const _e=M.constantOr(null);for(const Te of f){const he=i.getTile(Te);if(B&&!he.patternsLoaded())continue;const Ie=he.getBucket(u);if(!Ie)continue;const Pe=Ie.programConfigurations.get(u.id),De=_.useProgram(K,Pe),$e=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Te);B&&(_.context.activeTexture.set(I.TEXTURE0),he.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Pe.updatePaintBuffers(N)),na(Pe,C,_e,he,u);const Ge=$e?Te:null,at=_.translatePosMatrix(Ge?Ge.posMatrix:Te.posMatrix,he,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(T){fe=Ie.indexBuffer2,ae=Ie.segments2;const lt=[I.drawingBufferWidth,I.drawingBufferHeight];oe=K==="fillOutlinePattern"&&B?Ra(at,_,N,he,lt):Pa(at,lt)}else fe=Ie.indexBuffer,ae=Ie.segments,oe=B?ka(at,_,N,he):ns(at);De.draw(_.context,H,g,_.stencilModeForClipping(Te),v,Lt.disabled,oe,$e,u.id,Ie.layoutVertexBuffer,fe,ae,u.paint,_.transform.zoom,Pe)}}function ji(_,i,u,f,g,v,T){const I=_.context,C=I.gl,M="fill-extrusion-pattern",B=u.paint.get(M),N=B.constantOr(1),H=u.getCrossfadeParameters(),K=u.paint.get("fill-extrusion-opacity"),oe=B.constantOr(null);for(const fe of f){const ae=i.getTile(fe),_e=ae.getBucket(u);if(!_e)continue;const Te=_.style.map.terrain&&_.style.map.terrain.getTerrainData(fe),he=_e.programConfigurations.get(u.id),Ie=_.useProgram(N?"fillExtrusionPattern":"fillExtrusion",he);N&&(_.context.activeTexture.set(C.TEXTURE0),ae.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),he.updatePaintBuffers(H)),na(he,M,oe,ae,u);const Pe=_.translatePosMatrix(fe.posMatrix,ae,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),De=u.paint.get("fill-extrusion-vertical-gradient"),$e=N?Cs(Pe,_,De,K,fe,H,ae):ts(Pe,_,De,K);Ie.draw(I,I.gl.TRIANGLES,g,v,T,Lt.backCCW,$e,Te,u.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,u.paint,_.transform.zoom,he,_.style.map.terrain&&_e.centroidVertexBuffer)}}function Wf(_,i,u,f,g,v,T){const I=_.context,C=I.gl,M=u.fbo;if(!M)return;const B=_.useProgram("hillshade"),N=_.style.map.terrain&&_.style.map.terrain.getTerrainData(i);I.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,M.colorAttachment.get()),B.draw(I,C.TRIANGLES,g,v,T,Lt.disabled,((H,K,oe,fe)=>{const ae=oe.paint.get("hillshade-shadow-color"),_e=oe.paint.get("hillshade-highlight-color"),Te=oe.paint.get("hillshade-accent-color");let he=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(he-=H.transform.angle);const Ie=!H.options.moving;return{u_matrix:fe?fe.posMatrix:H.transform.calculatePosMatrix(K.tileID.toUnwrapped(),Ie),u_image:0,u_latrange:Ma(0,K.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),he],u_shadow:ae,u_highlight:_e,u_accent:Te}})(_,u,f,N?i:null),N,f.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function Gf(_,i,u,f,g,v){const T=_.context,I=T.gl,C=i.dem;if(C&&C.data){const M=C.dim,B=C.stride,N=C.getPixels();if(T.activeTexture.set(I.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||_.getTileTexture(B),i.demTexture){const K=i.demTexture;K.update(N,{premultiply:!1}),K.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else i.demTexture=new de(T,N,I.RGBA,{premultiply:!1}),i.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);T.activeTexture.set(I.TEXTURE0);let H=i.fbo;if(!H){const K=new de(T,{width:M,height:M,data:null},I.RGBA);K.bind(I.LINEAR,I.CLAMP_TO_EDGE),H=i.fbo=T.createFramebuffer(M,M,!0,!1),H.colorAttachment.set(K.texture)}T.bindFramebuffer.set(H.framebuffer),T.viewport.set([0,0,M,M]),_.useProgram("hillshadePrepare").draw(T,I.TRIANGLES,f,g,v,Lt.disabled,((K,oe)=>{const fe=oe.stride,ae=c.F();return c.aO(ae,0,c.W,-c.W,0,0,1),c.H(ae,ae,[0,-c.W,0]),{u_matrix:ae,u_image:1,u_dimension:[fe,fe],u_zoom:K.overscaledZ,u_unpack:oe.getUnpackVector()}})(i.tileID,C),null,u.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Rd(_,i,u,f,g,v){const T=f.paint.get("raster-fade-duration");if(!v&&T>0){const I=L.now(),C=(I-_.timeAdded)/T,M=i?(I-i.timeAdded)/T:-1,B=u.getSource(),N=g.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),H=!i||Math.abs(i.tileID.overscaledZ-N)>Math.abs(_.tileID.overscaledZ-N),K=H&&_.refreshedUponExpiration?1:c.ac(H?C:1-M,0,1);return _.refreshedUponExpiration&&C>=1&&(_.refreshedUponExpiration=!1),i?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}const Va=new c.aP(1,0,0,1),Mc=new c.aP(0,1,0,1),Lc=new c.aP(0,0,1,1),Ru=new c.aP(1,0,1,1),Dc=new c.aP(0,1,1,1);function Md(_,i,u,f){Ls(_,0,i+u/2,_.transform.width,u,f)}function ja(_,i,u,f){Ls(_,i-u/2,0,u,_.transform.height,f)}function Ls(_,i,u,f,g,v){const T=_.context,I=T.gl;I.enable(I.SCISSOR_TEST),I.scissor(i*_.pixelRatio,u*_.pixelRatio,f*_.pixelRatio,g*_.pixelRatio),T.clear({color:v}),I.disable(I.SCISSOR_TEST)}function Kf(_,i,u){const f=_.context,g=f.gl,v=u.posMatrix,T=_.useProgram("debug"),I=Se.disabled,C=We.disabled,M=_.colorModeForRenderPass(),B="$debug",N=_.style.map.terrain&&_.style.map.terrain.getTerrainData(u);f.activeTexture.set(g.TEXTURE0);const H=i.getTileByID(u.key).latestRawTileData,K=Math.floor((H&&H.byteLength||0)/1024),oe=i.getTile(u).tileSize,fe=512/Math.min(oe,512)*(u.overscaledZ/_.transform.zoom)*.5;let ae=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ae+=` => ${u.overscaledZ}`),function(_e,Te){_e.initDebugOverlayCanvas();const he=_e.debugOverlayCanvas,Ie=_e.context.gl,Pe=_e.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,he.width,he.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(Te,5,5),Pe.strokeText(Te,5,5),_e.debugOverlayTexture.update(he),_e.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(_,`${ae} ${K}kB`),T.draw(f,g.TRIANGLES,I,C,F.alphaBlended,Lt.disabled,_u(v,c.aP.transparent,fe),null,B,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),T.draw(f,g.LINE_STRIP,I,C,M,Lt.disabled,_u(v,c.aP.red),N,B,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function zc(_,i,u){const f=_.context,g=f.gl,v=_.colorModeForRenderPass(),T=new Se(g.LEQUAL,Se.ReadWrite,_.depthRangeFor3D),I=_.useProgram("terrain"),C=i.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,_.width,_.height]);for(const M of u){const B=_.renderToTexture.getTexture(M),N=i.getTerrainData(M.tileID);f.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,B.texture);const H={u_matrix:_.transform.calculatePosMatrix(M.tileID.toUnwrapped()),u_texture:0,u_ele_delta:i.getMeshFrameDelta(_.transform.zoom)};I.draw(f,g.TRIANGLES,T,We.disabled,v,Lt.backCCW,H,N,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class hn{constructor(i,u){this.context=new Q(i),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ze.maxUnderzooming+Ze.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gn}resize(i,u,f){if(this.width=Math.floor(i*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const i=this.context,u=new c.aW;u.emplaceBack(0,0),u.emplaceBack(c.W,0),u.emplaceBack(0,c.W),u.emplaceBack(c.W,c.W),this.tileExtentBuffer=i.createVertexBuffer(u,oo.members),this.tileExtentSegments=c.$.simpleSegment(0,0,4,2);const f=new c.aW;f.emplaceBack(0,0),f.emplaceBack(c.W,0),f.emplaceBack(0,c.W),f.emplaceBack(c.W,c.W),this.debugBuffer=i.createVertexBuffer(f,oo.members),this.debugSegments=c.$.simpleSegment(0,0,4,5);const g=new c.Z;g.emplaceBack(0,0,0,0),g.emplaceBack(c.W,0,c.W,0),g.emplaceBack(0,c.W,0,c.W),g.emplaceBack(c.W,c.W,c.W,c.W),this.rasterBoundsBuffer=i.createVertexBuffer(g,en.members),this.rasterBoundsSegments=c.$.simpleSegment(0,0,4,2);const v=new c.aW;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(v,oo.members),this.viewportSegments=c.$.simpleSegment(0,0,4,2);const T=new c.aX;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(T);const I=new c.aY;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(I);const C=this.context.gl;this.stencilClearMode=new We({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.F();c.aO(f,0,this.width,this.height,0,0,1),c.J(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,u.TRIANGLES,Se.disabled,this.stencilClearMode,F.disabled,Lt.disabled,Zs(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,u){if(this.currentStencilSource===i.source||!i.isTileClipped()||!u||!u.length)return;this.currentStencilSource=i.source;const f=this.context,g=f.gl;this.nextStencilID+u.length>256&&this.clearStencil(),f.setColorMode(F.disabled),f.setDepthMode(Se.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of u){const I=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T);v.draw(f,g.TRIANGLES,Se.disabled,new We({func:g.ALWAYS,mask:0},I,255,g.KEEP,g.KEEP,g.REPLACE),F.disabled,Lt.disabled,Zs(T.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new We({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){const u=this.context.gl;return new We({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(i){const u=this.context.gl,f=i.sort((T,I)=>I.overscaledZ-T.overscaledZ),g=f[f.length-1].overscaledZ,v=f[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let I=0;I<v;I++)T[I+g]=new We({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=v,[T,f]}return[{[g]:We.disabled},f]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new F([i.CONSTANT_COLOR,i.ONE],new c.aP(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?F.unblended:F.alphaBlended}depthModeForSublayer(i,u,f){if(!this.opaquePassEnabledForLayer())return Se.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Se(f||this.context.gl.LEQUAL,u,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(L.now()),this.imageManager.beginFrame();const f=this.style._order,g=this.style.sourceCaches,v={},T={},I={};for(const C in g){const M=g[C];M.used&&M.prepare(this.context),v[C]=M.getVisibleCoordinates(),T[C]=v[C].slice().reverse(),I[C]=M.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<f.length;C++)if(this.style._layers[f[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of f){const M=this.style._layers[C];if(!M.hasOffscreenPass()||M.isHidden(this.transform.zoom))continue;const B=T[M.source];(M.type==="custom"||B.length)&&this.renderLayer(this,g[M.source],M,B)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?c.aP.black:c.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[f[this.currentLayer]],M=g[C.source],B=v[C.source];this._renderTileClippingMasks(C,B),this.renderLayer(this,M,C,B)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const C=this.style._layers[f[this.currentLayer]],M=g[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const B=(C.type==="symbol"?I:T)[C.source];this._renderTileClippingMasks(C,v[C.source]),this.renderLayer(this,M,C,B)}if(this.options.showTileBoundaries){const C=function(M,B){let N=null;const H=Object.values(M._layers).flatMap(ae=>ae.source&&!ae.isHidden(B)?[M.sourceCaches[ae.source]]:[]),K=H.filter(ae=>ae.getSource().type==="vector"),oe=H.filter(ae=>ae.getSource().type!=="vector"),fe=ae=>{(!N||N.getSource().maxzoom<ae.getSource().maxzoom)&&(N=ae)};return K.forEach(ae=>fe(ae)),N||oe.forEach(ae=>fe(ae)),N}(this.style,this.transform.zoom);C&&function(M,B,N){for(let H=0;H<N.length;H++)Kf(M,B,N[H])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const M=C.transform.padding;Md(C,C.transform.height-(M.top||0),3,Va),Md(C,M.bottom||0,3,Mc),ja(C,M.left||0,3,Lc),ja(C,C.transform.width-(M.right||0),3,Ru);const B=C.transform.centerPoint;(function(N,H,K,oe){Ls(N,H-1,K-10,2,20,oe),Ls(N,H-10,K-1,20,2,oe)})(C,B.x,C.transform.height-B.y,Dc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=i?!c.aZ(u,f):!c.a_(u,f)),g||(g=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),g&&(c.a$(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,T){const I=v.context,C=I.gl,M=F.unblended,B=new Se(C.LEQUAL,Se.ReadWrite,[0,1]),N=T.getTerrainMesh(),H=T.sourceCache.getRenderableTiles(),K=v.useProgram("terrainDepth");I.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),I.clear({color:c.aP.transparent,depth:1});for(const oe of H){const fe=T.getTerrainData(oe.tileID),ae={u_matrix:v.transform.calculatePosMatrix(oe.tileID.toUnwrapped()),u_ele_delta:T.getMeshFrameDelta(v.transform.zoom)};K.draw(I,C.TRIANGLES,B,We.disabled,M,Lt.backCCW,ae,fe,"terrain",N.vertexBuffer,N.indexBuffer,N.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,T){const I=v.context,C=I.gl,M=F.unblended,B=new Se(C.LEQUAL,Se.ReadWrite,[0,1]),N=T.getTerrainMesh(),H=T.getCoordsTexture(),K=T.sourceCache.getRenderableTiles(),oe=v.useProgram("terrainCoords");I.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),I.clear({color:c.aP.transparent,depth:1}),T.coordsIndex=[];for(const fe of K){const ae=T.getTerrainData(fe.tileID);I.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,H.texture);const _e={u_matrix:v.transform.calculatePosMatrix(fe.tileID.toUnwrapped()),u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(v.transform.zoom)};oe.draw(I,C.TRIANGLES,B,We.disabled,M,Lt.backCCW,_e,ae,"terrain",N.vertexBuffer,N.indexBuffer,N.segments),T.coordsIndex.push(fe.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(i,u,f,g){if(!f.isHidden(this.transform.zoom)&&(f.type==="background"||f.type==="custom"||(g||[]).length))switch(this.id=f.id,f.type){case"symbol":(function(v,T,I,C,M){if(v.renderPass!=="translucent")return;const B=We.disabled,N=v.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(H,K,oe,fe,ae,_e,Te,he,Ie){const Pe=K.transform,De=ni(),$e=ae==="map",Ge=_e==="map";for(const at of H){const lt=fe.getTile(at),Xe=lt.getBucket(oe);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const Ye=c.ag(Xe.textSizeData,Pe.zoom),gt=Mt(lt,1,K.transform.zoom),Nt=Fi(at.posMatrix,Ge,$e,K.transform,gt),tt=oe.layout.get("icon-text-fit")!=="none"&&Xe.hasIconData();if(Ye){const it=Math.pow(2,Pe.zoom-lt.tileID.overscaledZ),Dt=K.style.map.terrain?(Ht,Yt)=>K.style.map.terrain.getElevation(at,Ht,Yt):null,Vn=De.translatePosition(Pe,lt,Te,he);si(Xe,$e,Ge,Ie,Pe,Nt,at.posMatrix,it,Ye,tt,De,Vn,at.toUnwrapped(),Dt)}}}(C,v,I,T,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),M),I.paint.get("icon-opacity").constantOr(1)!==0&&Ms(v,T,I,C,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),B,N),I.paint.get("text-opacity").constantOr(1)!==0&&Ms(v,T,I,C,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),B,N),T.map.showCollisionBoxes&&(on(v,T,I,C,!0),on(v,T,I,C,!1))})(i,u,f,g,this.style.placement.variableOffsets);break;case"circle":(function(v,T,I,C){if(v.renderPass!=="translucent")return;const M=I.paint.get("circle-opacity"),B=I.paint.get("circle-stroke-width"),N=I.paint.get("circle-stroke-opacity"),H=!I.layout.get("circle-sort-key").isConstant();if(M.constantOr(1)===0&&(B.constantOr(1)===0||N.constantOr(1)===0))return;const K=v.context,oe=K.gl,fe=v.depthModeForSublayer(0,Se.ReadOnly),ae=We.disabled,_e=v.colorModeForRenderPass(),Te=[];for(let he=0;he<C.length;he++){const Ie=C[he],Pe=T.getTile(Ie),De=Pe.getBucket(I);if(!De)continue;const $e=De.programConfigurations.get(I.id),Ge=v.useProgram("circle",$e),at=De.layoutVertexBuffer,lt=De.indexBuffer,Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ie),Ye={programConfiguration:$e,program:Ge,layoutVertexBuffer:at,indexBuffer:lt,uniformValues:Ad(v,Ie,Pe,I),terrainData:Xe};if(H){const gt=De.segments.get();for(const Nt of gt)Te.push({segments:new c.$([Nt]),sortKey:Nt.sortKey,state:Ye})}else Te.push({segments:De.segments,sortKey:0,state:Ye})}H&&Te.sort((he,Ie)=>he.sortKey-Ie.sortKey);for(const he of Te){const{programConfiguration:Ie,program:Pe,layoutVertexBuffer:De,indexBuffer:$e,uniformValues:Ge,terrainData:at}=he.state;Pe.draw(K,oe.TRIANGLES,fe,ae,_e,Lt.disabled,Ge,at,I.id,De,$e,he.segments,I.paint,v.transform.zoom,Ie)}})(i,u,f,g);break;case"heatmap":(function(v,T,I,C){if(I.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const M=v.context,B=M.gl,N=We.disabled,H=new F([B.ONE,B.ONE],c.aP.transparent,[!0,!0,!0,!0]);(function(K,oe,fe){const ae=K.gl;K.activeTexture.set(ae.TEXTURE1),K.viewport.set([0,0,oe.width/4,oe.height/4]);let _e=fe.heatmapFbo;if(_e)ae.bindTexture(ae.TEXTURE_2D,_e.colorAttachment.get()),K.bindFramebuffer.set(_e.framebuffer);else{const Te=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Te),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),_e=fe.heatmapFbo=K.createFramebuffer(oe.width/4,oe.height/4,!1,!1),function(he,Ie,Pe,De){var $e,Ge;const at=he.gl,lt=($e=he.HALF_FLOAT)!==null&&$e!==void 0?$e:at.UNSIGNED_BYTE,Xe=(Ge=he.RGBA16F)!==null&&Ge!==void 0?Ge:at.RGBA;at.texImage2D(at.TEXTURE_2D,0,Xe,Ie.width/4,Ie.height/4,0,at.RGBA,lt,null),De.colorAttachment.set(Pe)}(K,oe,Te,_e)}})(M,v,I),M.clear({color:c.aP.transparent});for(let K=0;K<C.length;K++){const oe=C[K];if(T.hasRenderableParent(oe))continue;const fe=T.getTile(oe),ae=fe.getBucket(I);if(!ae)continue;const _e=ae.programConfigurations.get(I.id),Te=v.useProgram("heatmap",_e),{zoom:he}=v.transform;Te.draw(M,B.TRIANGLES,Se.disabled,N,H,Lt.disabled,ri(oe.posMatrix,fe,he,I.paint.get("heatmap-intensity")),null,I.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,I.paint,v.transform.zoom,_e)}M.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(M,B){const N=M.context,H=N.gl,K=B.heatmapFbo;if(!K)return;N.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,K.colorAttachment.get()),N.activeTexture.set(H.TEXTURE1);let oe=B.colorRampTexture;oe||(oe=B.colorRampTexture=new de(N,B.colorRamp,H.RGBA)),oe.bind(H.LINEAR,H.CLAMP_TO_EDGE),M.useProgram("heatmapTexture").draw(N,H.TRIANGLES,Se.disabled,We.disabled,M.colorModeForRenderPass(),Lt.disabled,((fe,ae,_e,Te)=>{const he=c.F();c.aO(he,0,fe.width,fe.height,0,0,1);const Ie=fe.context.gl;return{u_matrix:he,u_world:[Ie.drawingBufferWidth,Ie.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ae.paint.get("heatmap-opacity")}})(M,B),null,B.id,M.viewportBuffer,M.quadTriangleIndexBuffer,M.viewportSegments,B.paint,M.transform.zoom)}(v,I))})(i,u,f,g);break;case"line":(function(v,T,I,C){if(v.renderPass!=="translucent")return;const M=I.paint.get("line-opacity"),B=I.paint.get("line-width");if(M.constantOr(1)===0||B.constantOr(1)===0)return;const N=v.depthModeForSublayer(0,Se.ReadOnly),H=v.colorModeForRenderPass(),K=I.paint.get("line-dasharray"),oe=I.paint.get("line-pattern"),fe=oe.constantOr(1),ae=I.paint.get("line-gradient"),_e=I.getCrossfadeParameters(),Te=fe?"linePattern":K?"lineSDF":ae?"lineGradient":"line",he=v.context,Ie=he.gl;let Pe=!0;for(const De of C){const $e=T.getTile(De);if(fe&&!$e.patternsLoaded())continue;const Ge=$e.getBucket(I);if(!Ge)continue;const at=Ge.programConfigurations.get(I.id),lt=v.context.program.get(),Xe=v.useProgram(Te,at),Ye=Pe||Xe.program!==lt,gt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(De),Nt=oe.constantOr(null);if(Nt&&$e.imageAtlas){const Dt=$e.imageAtlas,Vn=Dt.patternPositions[Nt.to.toString()],Ht=Dt.patternPositions[Nt.from.toString()];Vn&&Ht&&at.setConstantPatternPositions(Vn,Ht)}const tt=gt?De:null,it=fe?rs(v,$e,I,_e,tt):K?dl(v,$e,I,K,_e,tt):ae?ii(v,$e,I,Ge.lineClipsArray.length,tt):Or(v,$e,I,tt);if(fe)he.activeTexture.set(Ie.TEXTURE0),$e.imageAtlasTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),at.updatePaintBuffers(_e);else if(K&&(Ye||v.lineAtlas.dirty))he.activeTexture.set(Ie.TEXTURE0),v.lineAtlas.bind(he);else if(ae){const Dt=Ge.gradients[I.id];let Vn=Dt.texture;if(I.gradientVersion!==Dt.version){let Ht=256;if(I.stepInterpolant){const Yt=T.getSource().maxzoom,jn=De.canonical.z===Yt?Math.ceil(1<<v.transform.maxZoom-De.canonical.z):1;Ht=c.ac(c.aU(Ge.maxLineLength/c.W*1024*jn),256,he.maxTextureSize)}Dt.gradient=c.aV({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Ht,image:Dt.gradient||void 0,clips:Ge.lineClipsArray}),Dt.texture?Dt.texture.update(Dt.gradient):Dt.texture=new de(he,Dt.gradient,Ie.RGBA),Dt.version=I.gradientVersion,Vn=Dt.texture}he.activeTexture.set(Ie.TEXTURE0),Vn.bind(I.stepInterpolant?Ie.NEAREST:Ie.LINEAR,Ie.CLAMP_TO_EDGE)}Xe.draw(he,Ie.TRIANGLES,N,v.stencilModeForClipping(De),H,Lt.disabled,it,gt,I.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,I.paint,v.transform.zoom,at,Ge.layoutVertexBuffer2),Pe=!1}})(i,u,f,g);break;case"fill":(function(v,T,I,C){const M=I.paint.get("fill-color"),B=I.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const N=v.colorModeForRenderPass(),H=I.paint.get("fill-pattern"),K=v.opaquePassEnabledForLayer()&&!H.constantOr(1)&&M.constantOr(c.aP.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===K){const oe=v.depthModeForSublayer(1,v.renderPass==="opaque"?Se.ReadWrite:Se.ReadOnly);Ba(v,T,I,C,oe,N,!1)}if(v.renderPass==="translucent"&&I.paint.get("fill-antialias")){const oe=v.depthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,Se.ReadOnly);Ba(v,T,I,C,oe,N,!0)}})(i,u,f,g);break;case"fill-extrusion":(function(v,T,I,C){const M=I.paint.get("fill-extrusion-opacity");if(M!==0&&v.renderPass==="translucent"){const B=new Se(v.context.gl.LEQUAL,Se.ReadWrite,v.depthRangeFor3D);if(M!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))ji(v,T,I,C,B,We.disabled,F.disabled),ji(v,T,I,C,B,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const N=v.colorModeForRenderPass();ji(v,T,I,C,B,We.disabled,N)}}})(i,u,f,g);break;case"hillshade":(function(v,T,I,C){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const M=v.context,B=v.depthModeForSublayer(0,Se.ReadOnly),N=v.colorModeForRenderPass(),[H,K]=v.renderPass==="translucent"?v.stencilConfigForOverlap(C):[{},C];for(const oe of K){const fe=T.getTile(oe);fe.needsHillshadePrepare!==void 0&&fe.needsHillshadePrepare&&v.renderPass==="offscreen"?Gf(v,fe,I,B,We.disabled,N):v.renderPass==="translucent"&&Wf(v,oe,fe,I,B,H[oe.overscaledZ],N)}M.viewport.set([0,0,v.width,v.height])})(i,u,f,g);break;case"raster":(function(v,T,I,C){if(v.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!C.length)return;const M=v.context,B=M.gl,N=T.getSource(),H=v.useProgram("raster"),K=v.colorModeForRenderPass(),[oe,fe]=N instanceof wi?[{},C]:v.stencilConfigForOverlap(C),ae=fe[fe.length-1].overscaledZ,_e=!v.options.moving;for(const Te of fe){const he=v.depthModeForSublayer(Te.overscaledZ-ae,I.paint.get("raster-opacity")===1?Se.ReadWrite:Se.ReadOnly,B.LESS),Ie=T.getTile(Te);Ie.registerFadeDuration(I.paint.get("raster-fade-duration"));const Pe=T.findLoadedParent(Te,0),De=T.findLoadedSibling(Te),$e=Rd(Ie,Pe||De||null,T,I,v.transform,v.style.map.terrain);let Ge,at;const lt=I.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;M.activeTexture.set(B.TEXTURE0),Ie.texture.bind(lt,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(B.TEXTURE1),Pe?(Pe.texture.bind(lt,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Ge=Math.pow(2,Pe.tileID.overscaledZ-Ie.tileID.overscaledZ),at=[Ie.tileID.canonical.x*Ge%1,Ie.tileID.canonical.y*Ge%1]):Ie.texture.bind(lt,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Te),Ye=Xe?Te:null,gt=Ye?Ye.posMatrix:v.transform.calculatePosMatrix(Te.toUnwrapped(),_e),Nt=Ti(gt,at||[0,0],Ge||1,$e,I);N instanceof wi?H.draw(M,B.TRIANGLES,he,We.disabled,K,Lt.disabled,Nt,Xe,I.id,N.boundsBuffer,v.quadTriangleIndexBuffer,N.boundsSegments):H.draw(M,B.TRIANGLES,he,oe[Te.overscaledZ],K,Lt.disabled,Nt,Xe,I.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(i,u,f,g);break;case"background":(function(v,T,I,C){const M=I.paint.get("background-color"),B=I.paint.get("background-opacity");if(B===0)return;const N=v.context,H=N.gl,K=v.transform,oe=K.tileSize,fe=I.paint.get("background-pattern");if(v.isPatternMissing(fe))return;const ae=!fe&&M.a===1&&B===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==ae)return;const _e=We.disabled,Te=v.depthModeForSublayer(0,ae==="opaque"?Se.ReadWrite:Se.ReadOnly),he=v.colorModeForRenderPass(),Ie=v.useProgram(fe?"backgroundPattern":"background"),Pe=C||K.coveringTiles({tileSize:oe,terrain:v.style.map.terrain});fe&&(N.activeTexture.set(H.TEXTURE0),v.imageManager.bind(v.context));const De=I.getCrossfadeParameters();for(const $e of Pe){const Ge=C?$e.posMatrix:v.transform.calculatePosMatrix($e.toUnwrapped()),at=fe?La(Ge,B,v,fe,{tileID:$e,tileSize:oe},De):Ec(Ge,B,M),lt=v.style.map.terrain&&v.style.map.terrain.getTerrainData($e);Ie.draw(N,H.TRIANGLES,Te,_e,he,Lt.disabled,at,lt,I.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(i,0,f,g);break;case"custom":(function(v,T,I){const C=v.context,M=I.implementation;if(v.renderPass==="offscreen"){const B=M.prerender;B&&(v.setCustomLayerDefaults(),C.setColorMode(v.colorModeForRenderPass()),B.call(M,C.gl,v.transform.customLayerMatrix()),C.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),C.setColorMode(v.colorModeForRenderPass()),C.setStencilMode(We.disabled);const B=M.renderingMode==="3d"?new Se(v.context.gl.LEQUAL,Se.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,Se.ReadOnly);C.setDepthMode(B),M.render(C.gl,v.transform.customLayerMatrix()),C.setDirty(),v.setBaseState(),C.bindFramebuffer.set(null)}})(i,0,f)}}translatePosMatrix(i,u,f,g,v){if(!f[0]&&!f[1])return i;const T=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(T){const M=Math.sin(T),B=Math.cos(T);f=[f[0]*B-f[1]*M,f[0]*M+f[1]*B]}const I=[v?f[0]:Mt(u,f[0],this.transform.zoom),v?f[1]:Mt(u,f[1],this.transform.zoom),0],C=new Float32Array(16);return c.H(C,i,I),C}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),f=this.imageManager.getPattern(i.to.toString());return!u||!f}useProgram(i,u){this.cache=this.cache||{};const f=i+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new hl(this.context,Bi[i],u,is[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new de(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:u}=this.context.gl;return this.width!==i||this.height!==u}}class yl{constructor(i,u){this.points=i,this.planes=u}static fromInvProjectionMatrix(i,u,f){const g=Math.pow(2,f),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const C=1/(I=c.af([],I,i))[3]/u*g;return c.b0(I,I,[C,C,1/I[3],C])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const C=function(H,K){var oe=K[0],fe=K[1],ae=K[2],_e=oe*oe+fe*fe+ae*ae;return _e>0&&(_e=1/Math.sqrt(_e)),H[0]=K[0]*_e,H[1]=K[1]*_e,H[2]=K[2]*_e,H}([],function(H,K,oe){var fe=K[0],ae=K[1],_e=K[2],Te=oe[0],he=oe[1],Ie=oe[2];return H[0]=ae*Ie-_e*he,H[1]=_e*Te-fe*Ie,H[2]=fe*he-ae*Te,H}([],J([],v[I[0]],v[I[1]]),J([],v[I[2]],v[I[1]]))),M=-((B=C)[0]*(N=v[I[1]])[0]+B[1]*N[1]+B[2]*N[2]);var B,N;return C.concat(M)});return new yl(v,T)}}class Oc{constructor(i,u){this.min=i,this.max=u,this.center=function(f,g,v){return f[0]=.5*g[0],f[1]=.5*g[1],f[2]=.5*g[2],f}([],function(f,g,v){return f[0]=g[0]+v[0],f[1]=g[1]+v[1],f[2]=g[2]+v[2],f}([],this.min,this.max))}quadrant(i){const u=[i%2==0,i<2],f=Le(this.min),g=Le(this.max);for(let v=0;v<u.length;v++)f[v]=u[v]?this.min[v]:this.center[v],g[v]=u[v]?this.center[v]:this.max[v];return g[2]=this.max[2],new Oc(f,g)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let g=0;g<i.planes.length;g++){const v=i.planes[g];let T=0;for(let I=0;I<u.length;I++)c.b1(v,u[I])>=0&&T++;if(T===0)return 0;T!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let v=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let I=0;I<i.points.length;I++){const C=i.points[I][g]-this.min[g];v=Math.min(v,C),T=Math.max(T,C)}if(T<0||v>this.max[g]-this.min[g])return 0}return 1}}class Mu{constructor(i=0,u=0,f=0,g=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=f,this.right=g}interpolate(i,u,f){return u.top!=null&&i.top!=null&&(this.top=c.z.number(i.top,u.top,f)),u.bottom!=null&&i.bottom!=null&&(this.bottom=c.z.number(i.bottom,u.bottom,f)),u.left!=null&&i.left!=null&&(this.left=c.z.number(i.left,u.left,f)),u.right!=null&&i.right!=null&&(this.right=c.z.number(i.right,u.right,f)),this}getCenter(i,u){const f=c.ac((this.left+i-this.right)/2,0,i),g=c.ac((this.top+u-this.bottom)/2,0,u);return new c.P(f,g)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Mu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const _l=85.051129;class Ld{constructor(i,u,f,g,v){this.tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Mu,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const i=new Ld(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const u=-c.b2(i,-180,180)*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=function(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}(),function(f,g,v){var T=g[0],I=g[1],C=g[2],M=g[3],B=Math.sin(v),N=Math.cos(v);f[0]=T*N+C*B,f[1]=I*N+M*B,f[2]=T*-B+C*N,f[3]=I*-B+M*N}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const u=c.ac(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const u=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,f){this._unmodified=!1,this._edgeInsets.interpolate(i,u,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const u=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(i){const u=[new c.b3(0,i)];if(this._renderWorldCopies){const f=this.pointCoordinate(new c.P(0,0)),g=this.pointCoordinate(new c.P(this.width,0)),v=this.pointCoordinate(new c.P(this.width,this.height)),T=this.pointCoordinate(new c.P(0,this.height)),I=Math.floor(Math.min(f.x,g.x,v.x,T.x)),C=Math.floor(Math.max(f.x,g.x,v.x,T.x)),M=1;for(let B=I-M;B<=C+M;B++)B!==0&&u.push(new c.b3(B,i))}return u}coveringTiles(i){var u,f;let g=this.coveringZoomLevel(i);const v=g;if(i.minzoom!==void 0&&g<i.minzoom)return[];i.maxzoom!==void 0&&g>i.maxzoom&&(g=i.maxzoom);const T=this.pointCoordinate(this.getCameraPoint()),I=c.Y.fromLngLat(this.center),C=Math.pow(2,g),M=[C*T.x,C*T.y,0],B=[C*I.x,C*I.y,0],N=yl.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,g);let H=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(H=g);const K=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,oe=he=>({aabb:new Oc([he*C,0,0],[(he+1)*C,C,0]),zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),fe=[],ae=[],_e=g,Te=i.reparseOverscaled?v:g;if(this._renderWorldCopies)for(let he=1;he<=3;he++)fe.push(oe(-he)),fe.push(oe(he));for(fe.push(oe(0));fe.length>0;){const he=fe.pop(),Ie=he.x,Pe=he.y;let De=he.fullyVisible;if(!De){const Xe=he.aabb.intersects(N);if(Xe===0)continue;De=Xe===2}const $e=i.terrain?M:B,Ge=he.aabb.distanceX($e),at=he.aabb.distanceY($e),lt=Math.max(Math.abs(Ge),Math.abs(at));if(he.zoom===_e||lt>K+(1<<_e-he.zoom)-2&&he.zoom>=H){const Xe=_e-he.zoom,Ye=M[0]-.5-(Ie<<Xe),gt=M[1]-.5-(Pe<<Xe);ae.push({tileID:new c.Q(he.zoom===_e?Te:he.zoom,he.wrap,he.zoom,Ie,Pe),distanceSq:X([B[0]-.5-Ie,B[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(Ye*Ye+gt*gt)})}else for(let Xe=0;Xe<4;Xe++){const Ye=(Ie<<1)+Xe%2,gt=(Pe<<1)+(Xe>>1),Nt=he.zoom+1;let tt=he.aabb.quadrant(Xe);if(i.terrain){const it=new c.Q(Nt,he.wrap,Nt,Ye,gt),Dt=i.terrain.getMinMaxElevation(it),Vn=(u=Dt.minElevation)!==null&&u!==void 0?u:this.elevation,Ht=(f=Dt.maxElevation)!==null&&f!==void 0?f:this.elevation;tt=new Oc([tt.min[0],tt.min[1],Vn],[tt.max[0],tt.max[1],Ht])}fe.push({aabb:tt,zoom:Nt,x:Ye,y:gt,wrap:he.wrap,fullyVisible:De})}}return ae.sort((he,Ie)=>he.distanceSq-Ie.distanceSq).map(he=>he.tileID)}resize(i,u){this.width=i,this.height=u,this.pixelsToGLUnits=[2/i,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const u=c.ac(i.lat,-85.051129,_l);return new c.P(c.N(i.lng)*this.worldSize,c.O(u)*this.worldSize)}unproject(i){return new c.Y(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const u=this.elevation,f=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,g=this.pointLocation(this.centerPoint,i),v=i.getElevationForLngLatZoom(g,this.tileZoom);if(!(this.elevation-v))return;const T=f+u-v,I=Math.cos(this._pitch)*this.cameraToCenterDistance/T/c.b4(1,g.lat),C=this.scaleZoom(I/this.tileSize);this._elevation=v,this._center=g,this.zoom=C}setLocationAtPoint(i,u){const f=this.pointCoordinate(u),g=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(i),T=new c.Y(v.x-(f.x-g.x),v.y-(f.y-g.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,u){return u?this.coordinatePoint(this.locationCoordinate(i),u.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,u){return this.coordinateLocation(this.pointCoordinate(i,u))}locationCoordinate(i){return c.Y.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,u){if(u){const H=u.pointCoordinate(i);if(H!=null)return H}const f=[i.x,i.y,0,1],g=[i.x,i.y,1,1];c.af(f,f,this.pixelMatrixInverse),c.af(g,g,this.pixelMatrixInverse);const v=f[3],T=g[3],I=f[1]/v,C=g[1]/T,M=f[2]/v,B=g[2]/T,N=M===B?0:(0-M)/(B-M);return new c.Y(c.z.number(f[0]/v,g[0]/T,N)/this.worldSize,c.z.number(I,C,N)/this.worldSize)}coordinatePoint(i,u=0,f=this.pixelMatrix){const g=[i.x*this.worldSize,i.y*this.worldSize,u,1];return c.af(g,g,f),new c.P(g[0]/g[3],g[1]/g[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new En().extend(this.pointLocation(new c.P(0,i))).extend(this.pointLocation(new c.P(this.width,i))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new En([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,_l])}calculatePosMatrix(i,u=!1){const f=i.key,g=u?this._alignedPosMatrixCache:this._posMatrixCache;if(g[f])return g[f];const v=i.canonical,T=this.worldSize/this.zoomScale(v.z),I=v.x+Math.pow(2,v.z)*i.wrap,C=c.an(new Float64Array(16));return c.H(C,C,[I*T,v.y*T,0]),c.J(C,C,[T/c.W,T/c.W,1]),c.K(C,u?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,C),g[f]=new Float32Array(C),g[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,u){u=c.ac(+u,this.minZoom,this.maxZoom);const f={center:new c.M(i.lng,i.lat),zoom:u};let g=this.lngRange;if(!this._renderWorldCopies&&g===null){const he=179.9999999999;g=[-he,he]}const v=this.tileSize*this.zoomScale(f.zoom);let T=0,I=v,C=0,M=v,B=0,N=0;const{x:H,y:K}=this.size;if(this.latRange){const he=this.latRange;T=c.O(he[1])*v,I=c.O(he[0])*v,I-T<K&&(B=K/(I-T))}g&&(C=c.b2(c.N(g[0])*v,0,v),M=c.b2(c.N(g[1])*v,0,v),M<C&&(M+=v),M-C<H&&(N=H/(M-C)));const{x:oe,y:fe}=this.project.call({worldSize:v},i);let ae,_e;const Te=Math.max(N||0,B||0);if(Te){const he=new c.P(N?(M+C)/2:oe,B?(I+T)/2:fe);return f.center=this.unproject.call({worldSize:v},he).wrap(),f.zoom+=this.scaleZoom(Te),f}if(this.latRange){const he=K/2;fe-he<T&&(_e=T+he),fe+he>I&&(_e=I-he)}if(g){const he=(C+M)/2;let Ie=oe;this._renderWorldCopies&&(Ie=c.b2(oe,he-v/2,he+v/2));const Pe=H/2;Ie-Pe<C&&(ae=C+Pe),Ie+Pe>M&&(ae=M-Pe)}if(ae!==void 0||_e!==void 0){const he=new c.P(ae??oe,_e??fe);f.center=this.unproject.call({worldSize:v},he).wrap()}return f}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.center=u,this.zoom=f,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,u=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b4(1,this.center.lat)*this.worldSize;let g=c.an(new Float64Array(16));c.J(g,g,[this.width/2,-this.height/2,1]),c.H(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=c.an(new Float64Array(16)),c.J(g,g,[1,-1,1]),c.H(g,g,[-1,-1,0]),c.J(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),T=Math.min(this.elevation,this.minElevationForCurrentTile),I=v-T*this._pixelPerMeter/Math.cos(this._pitch),C=T<0?I:v,M=Math.PI/2+this._pitch,B=this._fov*(.5+i.y/this.height),N=Math.sin(B)*C/Math.sin(c.ac(Math.PI-M-B,.01,Math.PI-.01)),H=this.getHorizon(),K=2*Math.atan(H/this.cameraToCenterDistance)*(.5+i.y/(2*H)),oe=Math.sin(K)*C/Math.sin(c.ac(Math.PI-M-K,.01,Math.PI-.01)),fe=Math.min(N,oe),ae=1.01*(Math.cos(Math.PI/2-this._pitch)*fe+C),_e=this.height/50;g=new Float64Array(16),c.b5(g,this._fov,this.width/this.height,_e,ae),g[8]=2*-i.x/this.width,g[9]=2*i.y/this.height,c.J(g,g,[1,-1,1]),c.H(g,g,[0,0,-this.cameraToCenterDistance]),c.b6(g,g,this._pitch),c.ad(g,g,this.angle),c.H(g,g,[-u,-f,0]),this.mercatorMatrix=c.J([],g,[this.worldSize,this.worldSize,this.worldSize]),c.J(g,g,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.K(new Float64Array(16),this.labelPlaneMatrix,g),c.H(g,g,[0,0,-this.elevation]),this.modelViewProjectionMatrix=g,this.invModelViewProjectionMatrix=c.as([],g),this.pixelMatrix3D=c.K(new Float64Array(16),this.labelPlaneMatrix,g);const Te=this.width%2/2,he=this.height%2/2,Ie=Math.cos(this.angle),Pe=Math.sin(this.angle),De=u-Math.round(u)+Ie*Te+Pe*he,$e=f-Math.round(f)+Ie*he+Pe*Te,Ge=new Float64Array(g);if(c.H(Ge,Ge,[De>.5?De-1:De,$e>.5?$e-1:$e,0]),this.alignedModelViewProjectionMatrix=Ge,g=c.as(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new c.P(0,0)),u=[i.x*this.worldSize,i.y*this.worldSize,0,1];return c.af(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,i))}getCameraQueryGeometry(i){const u=this.getCameraPoint();if(i.length===1)return[i[0],u];{let f=u.x,g=u.y,v=u.x,T=u.y;for(const I of i)f=Math.min(f,I.x),g=Math.min(g,I.y),v=Math.max(v,I.x),T=Math.max(T,I.y);return[new c.P(f,g),new c.P(v,g),new c.P(v,T),new c.P(f,T),new c.P(f,g)]}}lngLatToCameraDepth(i,u){const f=this.locationCoordinate(i),g=[f.x*this.worldSize,f.y*this.worldSize,u,1];return c.af(g,g,this.modelViewProjectionMatrix),g[2]/g[3]}}function Zf(_,i){let u,f=!1,g=null,v=null;const T=()=>{g=null,f&&(_.apply(v,u),g=setTimeout(T,i),f=!1)};return(...I)=>(f=!0,v=this,u=I,g||T(),g)}class Dd{constructor(i){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,u)}catch{}},this._updateHash=Zf(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,g),T=Math.round(u.lng*v)/v,I=Math.round(u.lat*v)/v,C=this._map.getBearing(),M=this._map.getPitch();let B="";if(B+=i?`/${T}/${I}/${f}`:`${f}/${I}/${T}`,(C||M)&&(B+="/"+Math.round(10*C)/10),M&&(B+=`/${Math.round(M)}`),this._hashName){const N=this._hashName;let H=!1;const K=window.location.hash.slice(1).split("&").map(oe=>{const fe=oe.split("=")[0];return fe===N?(H=!0,`${fe}=${B}`):oe}).filter(oe=>oe);return H||K.push(`${N}=${B}`),`#${K.join("&")}`}return`#${B}`}}const Fc={linearity:.3,easing:c.b7(0,0,.3,1)},zd=c.e({deceleration:2500,maxSpeed:1400},Fc),Nc=c.e({deceleration:20,maxSpeed:1400},Fc),Bc=c.e({deceleration:1e3,maxSpeed:360},Fc),Od=c.e({deceleration:1e3,maxSpeed:90},Fc);class Fd{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:L.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=L.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)u.zoom+=v.zoomDelta||0,u.bearing+=v.bearingDelta||0,u.pitch+=v.pitchDelta||0,v.panDelta&&u.pan._add(v.panDelta),v.around&&(u.around=v.around),v.pinchAround&&(u.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const v=Ua(u.pan.mag(),f,c.e({},zd,i||{}));g.offset=u.pan.mult(v.amount/u.pan.mag()),g.center=this._map.transform.center,Lu(g,v)}if(u.zoom){const v=Ua(u.zoom,f,Nc);g.zoom=this._map.transform.zoom+v.amount,Lu(g,v)}if(u.bearing){const v=Ua(u.bearing,f,Bc);g.bearing=this._map.transform.bearing+c.ac(v.amount,-179,179),Lu(g,v)}if(u.pitch){const v=Ua(u.pitch,f,Od);g.pitch=this._map.transform.pitch+v.amount,Lu(g,v)}if(g.zoom||g.bearing){const v=u.pinchAround===void 0?u.around:u.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),c.e(g,{noMoveStart:!0})}}function Lu(_,i){(!_.duration||_.duration<i.duration)&&(_.duration=i.duration,_.easing=i.easing)}function Ua(_,i,u){const{maxSpeed:f,linearity:g,deceleration:v}=u,T=c.ac(_*g/(i/1e3),-f,f),I=Math.abs(T)/(v*g);return{easing:u.easing,duration:1e3*I,amount:T*(I/2)}}class ai extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,f,g={}){const v=z.mousePos(u.getCanvas(),f),T=u.unproject(v);super(i,c.e({point:v,lngLat:T,originalEvent:f},g)),this._defaultPrevented=!1,this.target=u}}class $a extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,f){const g=i==="touchend"?f.changedTouches:f.touches,v=z.touchPos(u.getCanvasContainer(),g),T=v.map(C=>u.unproject(C)),I=v.reduce((C,M,B,N)=>C.add(M.div(N.length)),new c.P(0,0));super(i,{points:v,point:I,lngLats:T,lngLat:u.unproject(I),originalEvent:f}),this._defaultPrevented=!1}}class Xf extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,f){super(i,{originalEvent:f}),this._defaultPrevented=!1}}class Nd{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Xf(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new ai(i.type,this._map,i))}mouseup(i){this._map.fire(new ai(i.type,this._map,i))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new ai(i.type,this._map,i))}dblclick(i){return this._firePreventable(new ai(i.type,this._map,i))}mouseover(i){this._map.fire(new ai(i.type,this._map,i))}mouseout(i){this._map.fire(new ai(i.type,this._map,i))}touchstart(i){return this._firePreventable(new $a(i.type,this._map,i))}touchmove(i){this._map.fire(new $a(i.type,this._map,i))}touchend(i){this._map.fire(new $a(i.type,this._map,i))}touchcancel(i){this._map.fire(new $a(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class T_{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new ai(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ai("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new ai(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vl{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(c.P.convert(i),this._map.terrain)}}class Du{constructor(i,u){this._map=i,this._tr=new vl(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&i.button===0&&(z.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=z.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const v=Math.min(g.x,f.x),T=Math.max(g.x,f.x),I=Math.min(g.y,f.y),C=Math.max(g.y,f.y);z.setTransform(this._box,`translate(${v}px,${I}px)`),this._box.style.width=T-v+"px",this._box.style.height=C-I+"px"}mouseupWindow(i,u){if(!this._active||i.button!==0)return;const f=this._startPos,g=u;if(this.reset(),z.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:i})),{cameraAnimation:v=>v.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(z.remove(this._box),this._box=null),z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new c.k(i,{originalEvent:u}))}}function zu(_,i){if(_.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${i.length}`);const u={};for(let f=0;f<_.length;f++)u[_[f].identifier]=i[f];return u}class Yf{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const v=new c.P(0,0);for(const T of g)v._add(T);return v.div(g.length)}(u),this.touches=zu(f,u)))}touchmove(i,u,f){if(this.aborted||!this.centroid)return;const g=zu(f,u);for(const v in this.touches){const T=g[v];(!T||T.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(i,u,f){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Vc{constructor(i){this.singleTap=new Yf(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,u,f){this.singleTap.touchstart(i,u,f)}touchmove(i,u,f){this.singleTap.touchmove(i,u,f)}touchend(i,u,f){const g=this.singleTap.touchend(i,u,f);if(g){const v=i.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(g)<30;if(v&&T||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class jc{constructor(i){this._tr=new vl(i),this._zoomIn=new Vc({numTouches:1,numTaps:2}),this._zoomOut=new Vc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,f){this._zoomIn.touchstart(i,u,f),this._zoomOut.touchstart(i,u,f)}touchmove(i,u,f){this._zoomIn.touchmove(i,u,f),this._zoomOut.touchmove(i,u,f)}touchend(i,u,f){const g=this._zoomIn.touchend(i,u,f),v=this._zoomOut.touchend(i,u,f),T=this._tr;return g?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(g)},{originalEvent:i})}):v?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(v)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qa{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const u=this._moveFunction(...i);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(i,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const g=u.length?u[0]:u;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&z.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const E_={0:1,2:2};class Uc{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const u=z.mouseButton(i);this._eventButton=u}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(u,f){const g=E_[f];return u.buttons===void 0||(u.buttons&g)!==g}(i,this._eventButton)}isValidEndEvent(i){return z.mouseButton(i)===this._eventButton}}class Jn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}const Ds=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=i=>{i.preventDefault()}},so=({enable:_,clickTolerance:i,bearingDegreesPerPixelMoved:u=.8})=>{const f=new Uc({checkCorrectEvent:g=>z.mouseButton(g)===0&&g.ctrlKey||z.mouseButton(g)===2});return new qa({clickTolerance:i,move:(g,v)=>({bearingDelta:(v.x-g.x)*u}),moveStateManager:f,enable:_,assignEvents:Ds})},$c=({enable:_,clickTolerance:i,pitchDegreesPerPixelMoved:u=-.5})=>{const f=new Uc({checkCorrectEvent:g=>z.mouseButton(g)===0&&g.ctrlKey||z.mouseButton(g)===2});return new qa({clickTolerance:i,move:(g,v)=>({pitchDelta:(v.y-g.y)*u}),moveStateManager:f,enable:_,assignEvents:Ds})};class Bd{constructor(i,u){this._clickTolerance=i.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(i,u,f){return this._calculateTransform(i,u,f)}touchmove(i,u,f){if(this._active&&!(f.length<this.minTouchs()))return i.preventDefault(),this._calculateTransform(i,u,f)}touchend(i,u,f){this._calculateTransform(i,u,f),this._active&&f.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,f){f.length>0&&(this._active=!0);const g=zu(f,u),v=new c.P(0,0),T=new c.P(0,0);let I=0;for(const M in g){const B=g[M],N=this._touches[M];N&&(v._add(B),T._add(B.sub(N)),I++,g[M]=B)}if(this._touches=g,I<this.minTouchs()||!T.mag())return;const C=T.div(I);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(I),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,f){if(!this._firstTwoTouches)return;i.preventDefault();const[g,v]=this._firstTwoTouches,T=zs(f,u,g),I=zs(f,u,v);if(!T||!I)return;const C=this._aroundCenter?null:T.add(I).div(2);return this._move([T,I],C,i)}touchend(i,u,f){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,T=zs(f,u,g),I=zs(f,u,v);T&&I||(this._active&&z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function zs(_,i,u){for(let f=0;f<_.length;f++)if(_[f].identifier===u)return i[f]}function xl(_,i){return Math.log(_/i)/Math.LN2}class Hc extends qc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(xl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xl(this._distance,f),pinchAround:u}}}function Vd(_,i){return 180*_.angleWith(i)/Math.PI}class jd extends qc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u,f){const g=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vd(this._vector,g),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,f=Vd(i,this._startVector);return Math.abs(f)<u}}function Wc(_){return Math.abs(_.y)>Math.abs(_.x)}class Ud extends qc{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,u,f){super.touchstart(i,u,f),this._currentTouchCount=f.length}_start(i){this._lastPoints=i,Wc(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=i[0].sub(this._lastPoints[0]),v=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,v,f.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(g.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(i,u,f){if(this._valid!==void 0)return this._valid;const g=i.mag()>=2,v=u.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const T=i.y>0==u.y>0;return Wc(i)&&Wc(u)&&T}}const Qf={panStep:100,bearingStep:15,pitchStep:10};class ra{constructor(i){this._tr=new vl(i);const u=Qf;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,f=0,g=0,v=0,T=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?f=-1:(i.preventDefault(),v=-1);break;case 39:i.shiftKey?f=1:(i.preventDefault(),v=1);break;case 38:i.shiftKey?g=1:(i.preventDefault(),T=-1);break;case 40:i.shiftKey?g=-1:(i.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:I=>{const C=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:Jf,zoom:u?Math.round(C.zoom)+u*(i.shiftKey?2:1):C.zoom,bearing:C.bearing+f*this._bearingStep,pitch:C.pitch+g*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:C.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jf(_){return _*(2-_)}const $d=4.000244140625;class qd{constructor(i,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=i,this._tr=new vl(i),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!i[this._map.cooperativeGestures._bypassKey])return;let u=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const f=L.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%$d==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=z.mousePos(this._map.getCanvas(),i),f=this._tr;this._around=u.y>f.transform.height/2-f.transform.getHorizon()?c.M.convert(this._aroundCenter?f.center:f.unproject(u)):c.M.convert(f.center),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>$d?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&C!==0&&(C=1/C);const M=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(M*C))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,f=this._startZoom,g=this._easing;let v,T=!1;if(this._type==="wheel"&&f&&g){const I=Math.min((L.now()-this._lastWheelEventTime)/200,1),C=g(I);v=c.z.number(f,u,C),I<1?this._frameId||(this._frameId=!0):T=!0}else v=u,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:v-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=c.b8;if(this._prevEase){const f=this._prevEase,g=(L.now()-f.start)/f.duration,v=f.easing(g+.01)-f.easing(g),T=.27/Math.sqrt(v*v+1e-4)*.01,I=Math.sqrt(.0729-T*T);u=c.b7(T,I,.25,1)}return this._prevEase={start:L.now(),duration:i,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Hd{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class em{constructor(i){this._tr=new vl(i),this.reset()}reset(){this._active=!1}dblclick(i,u){return i.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tm{constructor(){this._tap=new Vc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,u,f){if(!this._swipePoint)if(this._tapTime){const g=u[0],v=i.timeStamp-this._tapTime<500,T=this._tapPoint.dist(g)<30;v&&T?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(i,u,f)}touchmove(i,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=u[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,i.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(i,u,f)}touchend(i,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(i,u,f);g&&(this._tapTime=i.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wd{constructor(i,u,f){this._el=i,this._mousePan=u,this._touchPan=f}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wl{constructor(i,u,f){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=u,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gd{constructor(i,u,f,g){this._el=i,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class xo{constructor(i,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=z.create("div","maplibregl-cooperative-gesture-screen",i);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=u,this._container.appendChild(g);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=f,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(z.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(i){this._onCooperativeGesture(i.touches.length===1)}wheel(i){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!i[this._bypassKey])}_onCooperativeGesture(i){this._enabled&&i&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ao=_=>_.zoom||_.drag||_.pitch||_.rotate;class nm extends c.k{}function wo(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ou{constructor(i,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,v)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=g.type==="renderFrame"?void 0:g,I={needsRenderFrame:!1},C={},M={},B=g.touches,N=B?this._getMapTouches(B):void 0,H=N?z.touchPos(this._map.getCanvas(),N):z.mousePos(this._map.getCanvas(),g);for(const{handlerName:fe,handler:ae,allowed:_e}of this._handlers){if(!ae.isEnabled())continue;let Te;this._blockedByActive(M,_e,fe)?ae.reset():ae[v||g.type]&&(Te=ae[v||g.type](g,H,N),this.mergeHandlerResult(I,C,Te,fe,T),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()),(Te||ae.isActive())&&(M[fe]=ae)}const K={};for(const fe in this._previousActiveHandlers)M[fe]||(K[fe]=T);this._previousActiveHandlers=M,(Object.keys(K).length||wo(I))&&(this._changes.push([I,C,K]),this._triggerRenderFrame()),(Object.keys(M).length||wo(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=I;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fd(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,v,T]of this._listeners)z.addEventListener(g,v,g===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[i,u,f]of this._listeners)z.removeEventListener(i,u,i===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(i){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new Nd(u,i));const g=u.boxZoom=new Du(u,i);this._add("boxZoom",g),i.interactive&&i.boxZoom&&g.enable();const v=u.cooperativeGestures=new xo(u,i.cooperativeGestures);this._add("cooperativeGestures",v),i.cooperativeGestures&&v.enable();const T=new jc(u),I=new em(u);u.doubleClickZoom=new Hd(I,T),this._add("tapZoom",T),this._add("clickZoom",I),i.interactive&&i.doubleClickZoom&&u.doubleClickZoom.enable();const C=new tm;this._add("tapDragZoom",C);const M=u.touchPitch=new Ud(u);this._add("touchPitch",M),i.interactive&&i.touchPitch&&u.touchPitch.enable(i.touchPitch);const B=so(i),N=$c(i);u.dragRotate=new wl(i,B,N),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]),i.interactive&&i.dragRotate&&u.dragRotate.enable();const H=(({enable:Te,clickTolerance:he})=>{const Ie=new Uc({checkCorrectEvent:Pe=>z.mouseButton(Pe)===0&&!Pe.ctrlKey});return new qa({clickTolerance:he,move:(Pe,De)=>({around:De,panDelta:De.sub(Pe)}),activateOnStart:!0,moveStateManager:Ie,enable:Te,assignEvents:Ds})})(i),K=new Bd(i,u);u.dragPan=new Wd(f,H,K),this._add("mousePan",H),this._add("touchPan",K,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&u.dragPan.enable(i.dragPan);const oe=new jd,fe=new Hc;u.touchZoomRotate=new Gd(f,fe,oe,C),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&u.touchZoomRotate.enable(i.touchZoomRotate);const ae=u.scrollZoom=new qd(u,()=>this._triggerRenderFrame());this._add("scrollZoom",ae,["mousePan"]),i.interactive&&i.scrollZoom&&u.scrollZoom.enable(i.scrollZoom);const _e=u.keyboard=new ra(u);this._add("keyboard",_e),i.interactive&&i.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new T_(u))}_add(i,u,f){this._handlers.push({handlerName:i,handler:u,allowed:f}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ao(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,u,f){for(const g in i)if(g!==f&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(i){const u=[];for(const f of i)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(i,u,f,g,v){if(!f)return;c.e(i,f);const T={handlerName:g,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(u.zoom=T),f.panDelta!==void 0&&(u.drag=T),f.pitchDelta!==void 0&&(u.pitch=T),f.bearingDelta!==void 0&&(u.rotate=T)}_applyChanges(){const i={},u={},f={};for(const[g,v,T]of this._changes)g.panDelta&&(i.panDelta=(i.panDelta||new c.P(0,0))._add(g.panDelta)),g.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(i.around=g.around),g.pinchAround!==void 0&&(i.pinchAround=g.pinchAround),g.noInertia&&(i.noInertia=g.noInertia),c.e(u,v),c.e(f,T);this._updateMapTransform(i,u,f),this._changes=[]}_updateMapTransform(i,u,f){const g=this._map,v=g._getTransformForUpdate(),T=g.terrain;if(!(wo(i)||T&&this._terrainMovement))return this._fireEvents(u,f,!0);let{panDelta:I,zoomDelta:C,bearingDelta:M,pitchDelta:B,around:N,pinchAround:H}=i;H!==void 0&&(N=H),g._stop(!0),N=N||g.transform.centerPoint;const K=v.pointLocation(I?N.sub(I):N);M&&(v.bearing+=M),B&&(v.pitch+=B),C&&(v.zoom+=C),T?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(I)):v.setLocationAtPoint(K,N):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(K,N)):v.setLocationAtPoint(K,N),g._applyUpdatedTransform(v),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,f,!0)}_fireEvents(i,u,f){const g=ao(this._eventsInProgress),v=ao(i),T={};for(const N in i){const{originalEvent:H}=i[N];this._eventsInProgress[N]||(T[`${N}start`]=H),this._eventsInProgress[N]=i[N]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const N in T)this._fireEvent(N,T[N]);v&&this._fireEvent("move",v.originalEvent);for(const N in i){const{originalEvent:H}=i[N];this._fireEvent(N,H)}const I={};let C;for(const N in this._eventsInProgress){const{handlerName:H,originalEvent:K}=this._eventsInProgress[N];this._handlersById[H].isActive()||(delete this._eventsInProgress[N],C=u[H]||K,I[`${N}end`]=C)}for(const N in I)this._fireEvent(N,I[N]);const M=ao(this._eventsInProgress),B=(g||v)&&!M;if(B&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),f&&B){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=K=>K!==0&&-this._bearingSnap<K&&K<this._bearingSnap;!N||!N.essential&&L.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:C})),H(this._map.getBearing())&&this._map.resetNorth()):(H(N.bearing||this._map.getBearing())&&(N.bearing=0),N.freezeElevation=!0,this._map.easeTo(N,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new c.k(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new nm("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class I_ extends c.E{constructor(i,u){super(),this._renderFrameCallback=()=>{const f=Math.min((L.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.M(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}panBy(i,u,f){return i=c.P.convert(i).mult(-1),this.panTo(this.transform.center,c.e({offset:i},u),f)}panTo(i,u,f){return this.easeTo(c.e({center:i},u),f)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,f){return this.easeTo(c.e({zoom:i},u),f)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,f){return this.easeTo(c.e({bearing:i},u),f)}resetNorth(i,u){return this.rotateTo(0,c.e({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}cameraForBounds(i,u){i=En.convert(i);const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,u)}_cameraForBoxAndBearing(i,u,f,g){const v={top:0,bottom:0,right:0,left:0};if(typeof(g=c.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const Xe=g.padding;g.padding={top:Xe,bottom:Xe,right:Xe,left:Xe}}g.padding=c.e(v,g.padding);const T=this.transform,I=T.padding,C=new En(i,u),M=T.project(C.getNorthWest()),B=T.project(C.getNorthEast()),N=T.project(C.getSouthEast()),H=T.project(C.getSouthWest()),K=c.b9(-f),oe=M.rotate(K),fe=B.rotate(K),ae=N.rotate(K),_e=H.rotate(K),Te=new c.P(Math.max(oe.x,fe.x,_e.x,ae.x),Math.max(oe.y,fe.y,_e.y,ae.y)),he=new c.P(Math.min(oe.x,fe.x,_e.x,ae.x),Math.min(oe.y,fe.y,_e.y,ae.y)),Ie=Te.sub(he),Pe=(T.width-(I.left+I.right+g.padding.left+g.padding.right))/Ie.x,De=(T.height-(I.top+I.bottom+g.padding.top+g.padding.bottom))/Ie.y;if(De<0||Pe<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const $e=Math.min(T.scaleZoom(T.scale*Math.min(Pe,De)),g.maxZoom),Ge=c.P.convert(g.offset),at=new c.P((g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2).rotate(c.b9(f)),lt=Ge.add(at).mult(T.scale/T.zoomScale($e));return{center:T.unproject(M.add(N).div(2).sub(lt)),zoom:$e,bearing:f}}fitBounds(i,u,f){return this._fitInternal(this.cameraForBounds(i,u),u,f)}fitScreenCoordinates(i,u,f,g,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(i)),this.transform.pointLocation(c.P.convert(u)),f,g),g,v)}_fitInternal(i,u,f){return i?(delete(u=c.e(i,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(i,u){this.stop();const f=this._getTransformForUpdate();let g=!1,v=!1,T=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(g=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=c.M.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(v=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(T=!0,f.pitch=+i.pitch),i.padding==null||f.isPaddingEqual(i.padding)||(f.padding=i.padding),this._applyUpdatedTransform(f),this.fire(new c.k("movestart",u)).fire(new c.k("move",u)),g&&this.fire(new c.k("zoomstart",u)).fire(new c.k("zoom",u)).fire(new c.k("zoomend",u)),v&&this.fire(new c.k("rotatestart",u)).fire(new c.k("rotate",u)).fire(new c.k("rotateend",u)),T&&this.fire(new c.k("pitchstart",u)).fire(new c.k("pitch",u)).fire(new c.k("pitchend",u)),this.fire(new c.k("moveend",u))}calculateCameraOptionsFromTo(i,u,f,g=0){const v=c.Y.fromLngLat(i,u),T=c.Y.fromLngLat(f,g),I=T.x-v.x,C=T.y-v.y,M=T.z-v.z,B=Math.hypot(I,C,M);if(B===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(I,C),H=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),K=180*Math.atan2(I,-C)/Math.PI;let oe=180*Math.acos(N/B)/Math.PI;return oe=M<0?90-oe:90+oe,{center:T.toLngLat(),zoom:H,pitch:oe,bearing:K}}easeTo(i,u){var f;this._stop(!1,i.easeId),((i=c.e({offset:[0,0],duration:500,easing:c.b8},i)).animate===!1||!i.essential&&L.prefersReducedMotion)&&(i.duration=0);const g=this._getTransformForUpdate(),v=this.getZoom(),T=this.getBearing(),I=this.getPitch(),C=this.getPadding(),M="bearing"in i?this._normalizeBearing(i.bearing,T):T,B="pitch"in i?+i.pitch:I,N="padding"in i?i.padding:g.padding,H=c.P.convert(i.offset);let K=g.centerPoint.add(H);const oe=g.pointLocation(K),{center:fe,zoom:ae}=g.getConstrained(c.M.convert(i.center||oe),(f=i.zoom)!==null&&f!==void 0?f:v);this._normalizeCenter(fe);const _e=g.project(oe),Te=g.project(fe).sub(_e),he=g.zoomScale(ae-v);let Ie,Pe;i.around&&(Ie=c.M.convert(i.around),Pe=g.locationPoint(Ie));const De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ae!==v,this._rotating=this._rotating||T!==M,this._pitching=this._pitching||B!==I,this._padding=!g.isPaddingEqual(N),this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,De),this.terrain&&this._prepareElevation(fe),this._ease($e=>{if(this._zooming&&(g.zoom=c.z.number(v,ae,$e)),this._rotating&&(g.bearing=c.z.number(T,M,$e)),this._pitching&&(g.pitch=c.z.number(I,B,$e)),this._padding&&(g.interpolatePadding(C,N,$e),K=g.centerPoint.add(H)),this.terrain&&!i.freezeElevation&&this._updateElevation($e),Ie)g.setLocationAtPoint(Ie,Pe);else{const Ge=g.zoomScale(g.zoom-v),at=ae>v?Math.min(2,he):Math.max(.5,he),lt=Math.pow(at,1-$e),Xe=g.unproject(_e.add(Te.mult($e*lt)).mult(Ge));g.setLocationAtPoint(g.renderWorldCopies?Xe.wrap():Xe,K)}this._applyUpdatedTransform(g),this._fireMoveEvents(u)},$e=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u,$e)},i),this}_prepareEase(i,u,f={}){this._moving=!0,u||f.moving||this.fire(new c.k("movestart",i)),this._zooming&&!f.zooming&&this.fire(new c.k("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new c.k("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new c.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(f-(u-(f*i+this._elevationStart))/(1-i)),this._elevationTarget=u}this.transform.elevation=c.z.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(i){if(!this.transformCameraUpdate)return;const u=i.clone(),{center:f,zoom:g,pitch:v,bearing:T,elevation:I}=this.transformCameraUpdate(u);f&&(u.center=f),g!==void 0&&(u.zoom=g),v!==void 0&&(u.pitch=v),T!==void 0&&(u.bearing=T),I!==void 0&&(u.elevation=I),this.transform.apply(u)}_fireMoveEvents(i){this.fire(new c.k("move",i)),this._zooming&&this.fire(new c.k("zoom",i)),this._rotating&&this.fire(new c.k("rotate",i)),this._pitching&&this.fire(new c.k("pitch",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new c.k("zoomend",i)),g&&this.fire(new c.k("rotateend",i)),v&&this.fire(new c.k("pitchend",i)),this.fire(new c.k("moveend",i))}flyTo(i,u){var f;if(!i.essential&&L.prefersReducedMotion){const it=c.L(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(it,u)}this.stop(),i=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b8},i);const g=this._getTransformForUpdate(),v=this.getZoom(),T=this.getBearing(),I=this.getPitch(),C=this.getPadding(),M="bearing"in i?this._normalizeBearing(i.bearing,T):T,B="pitch"in i?+i.pitch:I,N="padding"in i?i.padding:g.padding,H=c.P.convert(i.offset);let K=g.centerPoint.add(H);const oe=g.pointLocation(K),{center:fe,zoom:ae}=g.getConstrained(c.M.convert(i.center||oe),(f=i.zoom)!==null&&f!==void 0?f:v);this._normalizeCenter(fe);const _e=g.zoomScale(ae-v),Te=g.project(oe),he=g.project(fe).sub(Te);let Ie=i.curve;const Pe=Math.max(g.width,g.height),De=Pe/_e,$e=he.mag();if("minZoom"in i){const it=c.ac(Math.min(i.minZoom,v,ae),g.minZoom,g.maxZoom),Dt=Pe/g.zoomScale(it-v);Ie=Math.sqrt(Dt/$e*2)}const Ge=Ie*Ie;function at(it){const Dt=(De*De-Pe*Pe+(it?-1:1)*Ge*Ge*$e*$e)/(2*(it?De:Pe)*Ge*$e);return Math.log(Math.sqrt(Dt*Dt+1)-Dt)}function lt(it){return(Math.exp(it)-Math.exp(-it))/2}function Xe(it){return(Math.exp(it)+Math.exp(-it))/2}const Ye=at(!1);let gt=function(it){return Xe(Ye)/Xe(Ye+Ie*it)},Nt=function(it){return Pe*((Xe(Ye)*(lt(Dt=Ye+Ie*it)/Xe(Dt))-lt(Ye))/Ge)/$e;var Dt},tt=(at(!0)-Ye)/Ie;if(Math.abs($e)<1e-6||!isFinite(tt)){if(Math.abs(Pe-De)<1e-6)return this.easeTo(i,u);const it=De<Pe?-1:1;tt=Math.abs(Math.log(De/Pe))/Ie,Nt=()=>0,gt=Dt=>Math.exp(it*Ie*Dt)}return i.duration="duration"in i?+i.duration:1e3*tt/("screenSpeed"in i?+i.screenSpeed/Ie:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=T!==M,this._pitching=B!==I,this._padding=!g.isPaddingEqual(N),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(fe),this._ease(it=>{const Dt=it*tt,Vn=1/gt(Dt);g.zoom=it===1?ae:v+g.scaleZoom(Vn),this._rotating&&(g.bearing=c.z.number(T,M,it)),this._pitching&&(g.pitch=c.z.number(I,B,it)),this._padding&&(g.interpolatePadding(C,N,it),K=g.centerPoint.add(H)),this.terrain&&!i.freezeElevation&&this._updateElevation(it);const Ht=it===1?fe:g.unproject(Te.add(he.mult(Nt(Dt))).mult(Vn));g.setLocationAtPoint(g.renderWorldCopies?Ht.wrap():Ht,K),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,u)}return i||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(i,u,f){f.animate===!1||f.duration===0?(i(1),u()):(this._easeStart=L.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,u){i=c.b2(i,-180,180);const f=Math.abs(i-u);return Math.abs(i-360-u)<f&&(i-=360),Math.abs(i+360-u)<f&&(i+=360),i}_normalizeCenter(i){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const f=i.lng-u.center.lng;i.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(c.M.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}const rm={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class im{constructor(i=rm){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=z.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=z.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=z.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const f=this._map._getUIString(`AttributionControl.${u}`);i.title=f,i.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const v=u[g];if(v.used||v.usedForTerrain){const T=v.getSource();T.attribution&&i.indexOf(T.attribution)<0&&i.push(T.attribution)}}i=i.filter(g=>String(g).trim()),i.sort((g,v)=>g.length-v.length),i=i.filter((g,v)=>{for(let T=v+1;T<i.length;T++)if(i[T].indexOf(g)>=0)return!1;return!0});const f=i.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,i.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Kd{constructor(i={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=z.create("div","maplibregl-ctrl");const u=z.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){z.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Fu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const g of f)if(g.id===i)return void(g.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ia=c.X([{name:"a_pos3d",type:"Int16",components:3}]);class dt extends c.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,u){this.sourceCache.update(i,u),this._renderableTilesKeys=[];const f={};for(const g of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),c.aO(g.posMatrix,0,c.W,0,c.W,0,1),this._tiles[g.key]=new dr(g,this.tileSize));for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(i){for(const u in this._tiles){const f=this._tiles[u];(!i||f.tileID.equals(i)||f.tileID.isChildOf(i)||i.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const u={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID;if(g.canonical.equals(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16),c.aO(v.posMatrix,0,c.W,0,c.W,0,1),u[f]=v}else if(g.canonical.isChildOf(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const T=g.canonical.z-i.canonical.z,I=g.canonical.x-(g.canonical.x>>T<<T),C=g.canonical.y-(g.canonical.y>>T<<T),M=c.W>>T;c.aO(v.posMatrix,0,M,0,M,0,1),c.H(v.posMatrix,v.posMatrix,[-I*M,-C*M,0]),u[f]=v}else if(i.canonical.isChildOf(g.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const T=i.canonical.z-g.canonical.z,I=i.canonical.x-(i.canonical.x>>T<<T),C=i.canonical.y-(i.canonical.y>>T<<T),M=c.W>>T;c.aO(v.posMatrix,0,c.W,0,c.W,0,1),c.H(v.posMatrix,v.posMatrix,[I*M,C*M,0]),c.J(v.posMatrix,v.posMatrix,[1/2**T,1/2**T,0]),u[f]=v}}return u}getSourceTile(i,u){const f=this.sourceCache._source;let g=i.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(g).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!v||!v.dem)&&u)for(;g>=f.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(i.scaledTo(g--).key);return v}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=i)}}class om{constructor(i,u,f){this.painter=i,this.sourceCache=new dt(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,u,f,g=c.W){var v;if(!(u>=0&&u<g&&f>=0&&f<g))return 0;const T=this.getTerrainData(i),I=(v=T.tile)===null||v===void 0?void 0:v.dem;if(!I)return 0;const C=function(oe,fe,ae){var _e=fe[0],Te=fe[1];return oe[0]=ae[0]*_e+ae[4]*Te+ae[12],oe[1]=ae[1]*_e+ae[5]*Te+ae[13],oe}([],[u/g*c.W,f/g*c.W],T.u_terrain_matrix),M=[C[0]*I.dim,C[1]*I.dim],B=Math.floor(M[0]),N=Math.floor(M[1]),H=M[0]-B,K=M[1]-N;return I.get(B,N)*(1-H)*(1-K)+I.get(B+1,N)*H*(1-K)+I.get(B,N+1)*(1-H)*K+I.get(B+1,N+1)*H*K}getElevationForLngLatZoom(i,u){const{tileID:f,mercatorX:g,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(i,u);return this.getElevation(f,g%c.W,v%c.W,c.W)}getElevation(i,u,f,g=c.W){return this.getDEMElevation(i,u,f,g)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const g=this.painter.context,v=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new de(g,v,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new de(g,new c.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const u=this.sourceCache.getSourceTile(i,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new de(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+i.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let v=i.canonical.z-u.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=g?v=i.canonical.z-g:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=i.canonical.x-(i.canonical.x>>v<<v),I=i.canonical.y-(i.canonical.y>>v<<v),C=c.ba(new Float64Array(16),[1/(c.W<<v),1/(c.W<<v),0]);c.H(C,C,[T*c.W,I*c.W,0]),this._demMatrixCache[i.key]={matrix:C,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(i){const u=this.painter,f=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new de(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new de(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,T=0;v<this._coordsTextureSize;v++)for(let I=0;I<this._coordsTextureSize;I++,T+=4)u[T+0]=255&I,u[T+1]=255&v,u[T+2]=I>>8<<4|v>>8,u[T+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new de(i,f,i.gl.RGBA,{premultiply:!1});return g.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,g=f.gl,v=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),T=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(v,I-T-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const C=u[0]+(u[2]>>4<<8),M=u[1]+((15&u[2])<<8),B=this.coordsIndex[255-u[3]],N=B&&this.sourceCache.getTileByID(B);if(!N)return null;const H=this._coordsTextureSize,K=(1<<N.tileID.canonical.z)*H;return new c.Y((N.tileID.canonical.x*H+C)/K+N.tileID.wrap,(N.tileID.canonical.y*H+M)/K,this.getElevation(N.tileID,C,M,H))}depthAtPoint(i){const u=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.painter.context,u=new c.bb,f=new c.aY,g=this.meshSize,v=c.W/g,T=g*g;for(let N=0;N<=g;N++)for(let H=0;H<=g;H++)u.emplaceBack(H*v,N*v,0);for(let N=0;N<T;N+=g+1)for(let H=0;H<g;H++)f.emplaceBack(H+N,g+H+N+1,g+H+N+2),f.emplaceBack(H+N,g+H+N+2,H+N+1);const I=u.length,C=I+2*(g+1);for(const N of[0,1])for(let H=0;H<=g;H++)for(const K of[0,1])u.emplaceBack(H*v,N*c.W,K);for(let N=0;N<2*g;N+=2)f.emplaceBack(C+N,C+N+1,C+N+3),f.emplaceBack(C+N,C+N+3,C+N+2),f.emplaceBack(I+N,I+N+3,I+N+1),f.emplaceBack(I+N,I+N+2,I+N+3);const M=u.length,B=M+2*(g+1);for(const N of[0,1])for(let H=0;H<=g;H++)for(const K of[0,1])u.emplaceBack(N*c.W,H*v,K);for(let N=0;N<2*g;N+=2)f.emplaceBack(M+N,M+N+1,M+N+3),f.emplaceBack(M+N,M+N+3,M+N+2),f.emplaceBack(B+N,B+N+3,B+N+1),f.emplaceBack(B+N,B+N+2,B+N+3);return this._mesh={indexBuffer:i.createIndexBuffer(f),vertexBuffer:i.createVertexBuffer(u,ia.members),segments:c.$.simpleSegment(0,0,u.length,f.length)},this._mesh}getMeshFrameDelta(i){return 2*Math.PI*c.bc/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,u){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(i,u);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(i){const u=this.getTerrainData(i).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(i,u){const f=c.Y.fromLngLat(i.wrap()),g=(1<<u)*c.W,v=f.x*g,T=f.y*g,I=Math.floor(v/c.W),C=Math.floor(T/c.W);return{tileID:new c.Q(u,0,u,I,C),mercatorX:v,mercatorY:T}}}class Nu{constructor(i,u,f){this._context=i,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new de(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:i,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>i.id!==u),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const us={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class sm{constructor(i,u){this.painter=i,this.terrain=u,this.pool=new Nu(i.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(f=>!i._layers[f].isHidden(u)),this._coordsDescendingInv={};for(const f in i.sourceCaches){this._coordsDescendingInv[f]={};const g=i.sourceCaches[f].getVisibleCoordinates();for(const v of g){const T=this.terrain.sourceCache.getTerrainCoords(v);for(const I in T)this._coordsDescendingInv[f][I]||(this._coordsDescendingInv[f][I]=[]),this._coordsDescendingInv[f][I].push(T[I])}}this._coordsDescendingInvStr={};for(const f of i._order){const g=i._layers[f],v=g.source;if(us[g.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const T in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][T]=this._coordsDescendingInv[v][T].map(I=>I.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[g][f.tileID.key];v&&v!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;const u=i.type,f=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(us[u]&&(this._prevType&&us[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(i.id),!g))return!0;if(us[this._prevType]||us[u]&&g){this._prevType=u;const v=this._stacks.length-1,T=this._stacks[v]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(zc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[v]){const M=this.pool.getObjectForId(I.rtt[v].id);if(M.stamp===I.rtt[v].stamp){this.pool.useObject(M);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),I.rtt[v]={id:C.id,stamp:C.stamp},f.context.bindFramebuffer.set(C.fbo.framebuffer),f.context.clear({color:c.aP.transparent,stencil:0}),f.currentStencilSource=void 0;for(let M=0;M<T.length;M++){const B=f.style._layers[T[M]],N=B.source?this._coordsDescendingInv[B.source][I.tileID.key]:[I.tileID];f.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),f._renderTileClippingMasks(B,N),f.renderLayer(f,f.style.sourceCaches[B.source],B,N),B.source&&(I.rttCoords[B.source]=this._coordsDescendingInvStr[B.source][I.tileID.key])}}return zc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),us[u]}return!1}}const st={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Zd=S,C_={hash:!1,interactive:!0,bearingSnap:7,attributionControl:rm,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},am=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},Xd={showCompass:!0,showZoom:!0,visualizePitch:!1};class lm{constructor(i,u,f=!1){this.mousedown=T=>{this.startMouse(c.e({},T,{ctrlKey:!0,preventDefault:()=>T.preventDefault()}),z.mousePos(this.element,T)),z.addEventListener(window,"mousemove",this.mousemove),z.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.moveMouse(T,z.mousePos(this.element,T))},this.mouseup=T=>{this.mouseRotate.dragEnd(T),this.mousePitch&&this.mousePitch.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=z.touchPos(this.element,T.targetTouches)[0],this.startTouch(T,this._startPos),z.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=z.touchPos(this.element,T.targetTouches)[0],this.moveTouch(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const g=i.dragRotate._mouseRotate.getClickTolerance(),v=i.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=so({clickTolerance:g,enable:!0}),this.touchRotate=(({enable:T,clickTolerance:I,bearingDegreesPerPixelMoved:C=.8})=>{const M=new Jn;return new qa({clickTolerance:I,move:(B,N)=>({bearingDelta:(N.x-B.x)*C}),moveStateManager:M,enable:T,assignEvents:am})})({clickTolerance:g,enable:!0}),this.map=i,f&&(this.mousePitch=$c({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:T,clickTolerance:I,pitchDegreesPerPixelMoved:C=-.5})=>{const M=new Jn;return new qa({clickTolerance:I,move:(B,N)=>({pitchDelta:(N.y-B.y)*C}),moveStateManager:M,enable:T,assignEvents:am})})({clickTolerance:v,enable:!0})),z.addEventListener(u,"mousedown",this.mousedown),z.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),z.addEventListener(u,"touchcancel",this.reset)}startMouse(i,u){this.mouseRotate.dragStart(i,u),this.mousePitch&&this.mousePitch.dragStart(i,u),z.disableDrag()}startTouch(i,u){this.touchRotate.dragStart(i,u),this.touchPitch&&this.touchPitch.dragStart(i,u),z.disableDrag()}moveMouse(i,u){const f=this.map,{bearingDelta:g}=this.mouseRotate.dragMove(i,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(i,u)||{};v&&f.setPitch(f.getPitch()+v)}}moveTouch(i,u){const f=this.map,{bearingDelta:g}=this.touchRotate.dragMove(i,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(i,u)||{};v&&f.setPitch(f.getPitch()+v)}}off(){const i=this.element;z.removeEventListener(i,"mousedown",this.mousedown),z.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.removeEventListener(window,"touchend",this.touchend),z.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){z.enableDrag(),z.removeEventListener(window,"mousemove",this.mousemove),z.removeEventListener(window,"mouseup",this.mouseup),z.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),z.removeEventListener(window,"touchend",this.touchend)}}let oa;function um(_,i,u){const f=new c.M(_.lng,_.lat);if(_=new c.M(_.lng,_.lat),i){const g=new c.M(_.lng-360,_.lat),v=new c.M(_.lng+360,_.lat),T=u.locationPoint(_).distSqr(i);u.locationPoint(g).distSqr(i)<T?_=g:u.locationPoint(v).distSqr(i)<T&&(_=v)}for(;Math.abs(_.lng-u.center.lng)>180;){const g=u.locationPoint(_);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;_.lng>u.center.lng?_.lng-=360:_.lng+=360}return _.lng!==f.lng&&u.locationPoint(_).y>u.height/2-u.getHorizon()?_:f}const Yd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sa(_,i,u){const f=_.classList;for(const g in Yd)f.remove(`maplibregl-${u}-anchor-${g}`);f.add(`maplibregl-${u}-anchor-${i}`)}class zn extends c.E{constructor(i){if(super(),this._onKeyPress=u=>{const f=u.code,g=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=u=>{var f;if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?um(this._lngLat,this._flatPos,this._map.transform):(f=this._lngLat)===null||f===void 0?void 0:f.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),u&&u.type!=="moveend"||(this._pos=this._pos.round()),z.setTransform(this._element,`${Yd[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${v}`),L.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i==null?void 0:i.opacity,i==null?void 0:i.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=c.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=z.create("div");const u=z.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const v=z.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const T=z.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const I=z.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const _e of C){const Te=z.createNS("http://www.w3.org/2000/svg","ellipse");Te.setAttributeNS(null,"opacity","0.04"),Te.setAttributeNS(null,"cx","10.5"),Te.setAttributeNS(null,"cy","5.80029008"),Te.setAttributeNS(null,"rx",_e.rx),Te.setAttributeNS(null,"ry",_e.ry),I.appendChild(Te)}const M=z.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const B=z.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(B);const N=z.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const H=z.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(H);const K=z.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");const oe=z.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const fe=z.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");const ae=z.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),oe.appendChild(fe),oe.appendChild(ae),T.appendChild(I),T.appendChild(M),T.appendChild(N),T.appendChild(K),T.appendChild(oe),u.appendChild(T),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=c.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),sa(this._element,this._anchor,"marker"),i&&i.className)for(const u of i.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),z.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=c.M.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const g=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var u,f;if(!(!((u=this._map)===null||u===void 0)&&u.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const g=this._map,v=g.terrain.depthAtPoint(this._pos),T=g.terrain.getElevationForLngLatZoom(this._lngLat,g.transform.tileZoom);if(g.transform.lngLatToCameraDepth(this._lngLat,T)-v<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/g.transform._pixelPerMeter,C=Math.sin(g.getPitch()*Math.PI/180)*I,M=g.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),B=g.transform.lngLatToCameraDepth(this._lngLat,T+C)-M>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=c.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,u){return i===void 0&&u===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Gc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let bl=0,Sl=!1;const cm={maxWidth:100,unit:"metric"};function Qd(_,i,u){const f=u&&u.maxWidth||100,g=_._container.clientHeight/2,v=_.unproject([0,g]),T=_.unproject([f,g]),I=v.distanceTo(T);if(u&&u.unit==="imperial"){const C=3.2808*I;C>5280?Bu(i,f,C/5280,_._getUIString("ScaleControl.Miles")):Bu(i,f,C,_._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Bu(i,f,I/1852,_._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Bu(i,f,I/1e3,_._getUIString("ScaleControl.Kilometers")):Bu(i,f,I,_._getUIString("ScaleControl.Meters"))}function Bu(_,i,u,f){const g=function(v){const T=Math.pow(10,`${Math.floor(v)}`.length-1);let I=v/T;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(C){const M=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*M)/M}(I),T*I}(u);_.style.width=i*(g/u)+"px",_.innerHTML=`${g}&nbsp;${f}`}const cs={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Kc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xt(_){if(_){if(typeof _=="number"){const i=Math.round(Math.abs(_)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,_),"top-left":new c.P(i,i),"top-right":new c.P(-i,i),bottom:new c.P(0,-_),"bottom-left":new c.P(i,-i),"bottom-right":new c.P(-i,-i),left:new c.P(_,0),right:new c.P(-_,0)}}if(_ instanceof c.P||Array.isArray(_)){const i=c.P.convert(_);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:c.P.convert(_.center||[0,0]),top:c.P.convert(_.top||[0,0]),"top-left":c.P.convert(_["top-left"]||[0,0]),"top-right":c.P.convert(_["top-right"]||[0,0]),bottom:c.P.convert(_.bottom||[0,0]),"bottom-left":c.P.convert(_["bottom-left"]||[0,0]),"bottom-right":c.P.convert(_["bottom-right"]||[0,0]),left:c.P.convert(_.left||[0,0]),right:c.P.convert(_.right||[0,0])}}return xt(new c.P(0,0))}const Ct=S;p.AJAXError=c.bf,p.Evented=c.E,p.LngLat=c.M,p.MercatorCoordinate=c.Y,p.Point=c.P,p.addProtocol=c.bg,p.config=c.a,p.removeProtocol=c.bh,p.AttributionControl=im,p.BoxZoomHandler=Du,p.CanvasSource=Qn,p.CooperativeGesturesHandler=xo,p.DoubleClickZoomHandler=Hd,p.DragPanHandler=Wd,p.DragRotateHandler=wl,p.EdgeInsets=Mu,p.FullscreenControl=class extends c.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var i;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=u==null?void 0:u.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){z.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=z.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);z.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},p.GeoJSONSource=Vt,p.GeolocateControl=class extends c.E{constructor(_){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{const u=new c.M(i.coords.longitude,i.coords.latitude),f=i.coords.accuracy,g=this._map.getBearing(),v=c.e({bearing:g},this.options.fitBoundsOptions),T=En.fromLngLat(u,f);this._map.fitBounds(T,v,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const u=new c.M(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Sl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=i=>{if(this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=z.create("button","maplibregl-ctrl-geolocate",this._container),z.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=z.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new zn({element:this._dotElement}),this._circleElement=z.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Gc,_)}onAdd(_){return this._map=_,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return c._(this,arguments,void 0,function*(i=!1){if(oa!==void 0&&!i)return oa;if(window.navigator.permissions===void 0)return oa=!!window.navigator.geolocation,oa;try{oa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{oa=!!window.navigator.geolocation}return oa})}().then(i=>this._setupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,bl=0,Sl=!1}_isOutOfMapMaxBounds(_){const i=this._map.getMaxBounds(),u=_.coords;return i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),i=_.getSouthEast(),u=_.getNorthEast(),f=i.distanceTo(u),g=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":bl--,Sl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),bl++,bl>1?(_={maximumAge:6e5,timeout:0},Sl=!0):(_=this.options.positionOptions,Sl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},p.Hash=Dd,p.ImageSource=wi,p.KeyboardHandler=ra,p.LngLatBounds=En,p.LogoControl=Kd,p.Map=class extends I_{constructor(_){c.bd.mark(c.be.create);const i=Object.assign(Object.assign({},C_),_);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ld(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Fu,this._controls=[],this._mapId=c.a3(),this._contextLost=u=>{u.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:u}))},this._contextRestored=u=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:u}))},this._onMapScroll=u=>{if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},st),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=re.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let u=!1;const f=Zf(g=>{this._trackResize&&!this._removed&&this.resize(g)._update()},50);this._resizeObserver=new ResizeObserver(g=>{u?f(g):u=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ou(this,i),this._hash=i.hash&&new Dd(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,c.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new im(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new Kd,i.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new c.k(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new c.k(`${u.dataType}dataloading`,u))}),this.on("dataabort",u=>{this.fire(new c.k("sourcedataabort",u))})}_getMapId(){return this._mapId}addControl(_,i){if(i===void 0&&(i=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=_.onAdd(this);this._controls.push(_);const f=this._controlPositions[i];return i.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(_);return i>-1&&this._controls.splice(i,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,i,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,i,u,f)}resize(_){var i;const u=this._containerDimensions(),f=u[0],g=u[1],v=this._getClampedPixelRatio(f,g);if(this._resizeCanvas(f,g,v),this.painter.resize(f,g,v),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const C=this._getClampedPixelRatio(f,g);this._resizeCanvas(f,g,C),this.painter.resize(f,g,C)}this.transform.resize(f,g),(i=this._requestedCameraState)===null||i===void 0||i.resize(f,g);const T=!this._moving;return T&&(this.stop(),this.fire(new c.k("movestart",_)).fire(new c.k("move",_))),this.fire(new c.k("resize",_)),T&&this.fire(new c.k("moveend",_)),this}_getClampedPixelRatio(_,i){const{0:u,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),v=_*g,T=i*g;return Math.min(v>u?u/v:1,T>f?f/T:1)*g}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(En.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint(c.M.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(c.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,i,u){if(_==="mouseenter"||_==="mouseover"){let f=!1;return{layer:i,listener:u,delegates:{mousemove:v=>{const T=this.getLayer(i)?this.queryRenderedFeatures(v.point,{layers:[i]}):[];T.length?f||(f=!0,u.call(this,new ai(_,this,v.originalEvent,{features:T}))):f=!1},mouseout:()=>{f=!1}}}}if(_==="mouseleave"||_==="mouseout"){let f=!1;return{layer:i,listener:u,delegates:{mousemove:T=>{(this.getLayer(i)?this.queryRenderedFeatures(T.point,{layers:[i]}):[]).length?f=!0:f&&(f=!1,u.call(this,new ai(_,this,T.originalEvent)))},mouseout:T=>{f&&(f=!1,u.call(this,new ai(_,this,T.originalEvent)))}}}}{const f=g=>{const v=this.getLayer(i)?this.queryRenderedFeatures(g.point,{layers:[i]}):[];v.length&&(g.features=v,u.call(this,g),delete g.features)};return{layer:i,listener:u,delegates:{[_]:f}}}}on(_,i,u){if(u===void 0)return super.on(_,i);const f=this._createDelegatedListener(_,i,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(f);for(const g in f.delegates)this.on(g,f.delegates[g]);return this}once(_,i,u){if(u===void 0)return super.once(_,i);const f=this._createDelegatedListener(_,i,u);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(_,i,u){return u===void 0?super.off(_,i):(this._delegatedListeners&&this._delegatedListeners[_]&&(f=>{const g=this._delegatedListeners[_];for(let v=0;v<g.length;v++){const T=g[v];if(T.layer===i&&T.listener===u){for(const I in T.delegates)this.off(I,T.delegates[I]);return g.splice(v,1),this}}})(),this)}queryRenderedFeatures(_,i){if(!this.style)return[];let u;const f=_ instanceof c.P||Array.isArray(_),g=f?_:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(f?{}:_)||{},g instanceof c.P||typeof g[0]=="number")u=[c.P.convert(g)];else{const v=c.P.convert(g[0]),T=c.P.convert(g[1]);u=[v,new c.P(T.x,v.y),T,new c.P(v.x,T.y),v]}return this.style.queryRenderedFeatures(u,i,this.transform)}querySourceFeatures(_,i){return this.style.querySourceFeatures(_,i)}setStyle(_,i){return(i=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(_,i))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const i=this._locale[_];if(i==null)throw new Error(`Missing UI string '${_}'`);return i}_updateStyle(_,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,i));const u=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new Aa(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,i,u):this.style.loadJSON(_,i,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Aa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,i){if(typeof _=="string"){const u=this._requestManager.transformRequest(_,"Style");c.h(u,new AbortController).then(f=>{this._updateDiff(f.data,i)}).catch(f=>{f&&this.fire(new c.j(f))})}else typeof _=="object"&&this._updateDiff(_,i)}_updateDiff(_,i){try{this.style.setState(_,i)&&this._update(!0)}catch(u){c.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(_,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(_,i){return this._lazyInitEmptyStyle(),this.style.addSource(_,i),this._update(!0)}isSourceLoaded(_){const i=this.style&&this.style.sourceCaches[_];if(i!==void 0)return i.loaded();this.fire(new c.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const i=this.style.sourceCaches[_.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&i.reload();for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===_.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new om(this.painter,i,_),this.painter.renderToTexture=new sm(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==_.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:_})),this}getTerrain(){var _,i;return(i=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const i in _){const u=_[i]._tiles;for(const f in u){const g=u[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,i,u={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:v,stretchY:T,content:I,textFitWidth:C,textFitHeight:M}=u;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||c.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:N,data:H}=i,K=i;return this.style.addImage(_,{data:new c.R({width:B,height:N},new Uint8Array(H)),pixelRatio:f,stretchX:v,stretchY:T,content:I,textFitWidth:C,textFitHeight:M,sdf:g,version:0,userImage:K}),K.onAdd&&K.onAdd(this,_),this}}{const{width:B,height:N,data:H}=L.getImageData(i);this.style.addImage(_,{data:new c.R({width:B,height:N},H),pixelRatio:f,stretchX:v,stretchY:T,content:I,textFitWidth:C,textFitHeight:M,sdf:g,version:0})}}updateImage(_,i){const u=this.style.getImage(_);if(!u)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=i instanceof HTMLImageElement||c.b(i)?L.getImageData(i):i,{width:g,height:v,data:T}=f;if(g===void 0||v===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||v!==u.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(i instanceof HTMLImageElement||c.b(i));return u.data.replace(T,I),this.style.updateImage(_,u),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return re.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,i){return this._lazyInitEmptyStyle(),this.style.addLayer(_,i),this._update(!0)}moveLayer(_,i){return this.style.moveLayer(_,i),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,i,u){return this.style.setLayerZoomRange(_,i,u),this._update(!0)}setFilter(_,i,u={}){return this.style.setFilter(_,i,u),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,i,u,f={}){return this.style.setPaintProperty(_,i,u,f),this._update(!0)}getPaintProperty(_,i){return this.style.getPaintProperty(_,i)}setLayoutProperty(_,i,u,f={}){return this.style.setLayoutProperty(_,i,u,f),this._update(!0)}getLayoutProperty(_,i){return this.style.getLayoutProperty(_,i)}setGlyphs(_,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,i,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,i,u,f=>{f||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,i,u=>{u||this._update(!0)}),this}setLight(_,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(_,i){return this.style.setFeatureState(_,i),this._update()}removeFeatureState(_,i){return this.style.removeFeatureState(_,i),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,i=0;return this._container&&(_=this._container.clientWidth||400,i=this._container.clientHeight||300),[_,i]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const i=this._canvasContainer=z.create("div","maplibregl-canvas-container",_);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=z.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const g=this._controlContainer=z.create("div","maplibregl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{v[T]=z.create("div",`maplibregl-ctrl-${T} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,i,u){this._canvas.width=Math.floor(u*_),this._canvas.height=Math.floor(u*i),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let i=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{i={requestedAttributes:_},f&&(i.statusMessage=f.statusMessage,i.type=f.type)},{once:!0});const u=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!u){const f="Failed to initialize WebGL";throw i?(i.message=f,new Error(JSON.stringify(i))):new Error(f)}this.painter=new hn(u,this.transform),ee.testSupport(u)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,v=L.now();this.style.zoomHistory.update(g,v);const T=new c.a8(g,{now:v,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=T.crossFadingFactor();I===1&&I===this._crossFadingFactor||(u=!0,this._crossFadingFactor=I),this.style.update(T)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bd.mark(c.be.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,c.bd.mark(c.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),re.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i!=null&&i.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),z.remove(this._canvasContainer),z.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bd.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then(_=>{c.bd.frame(_),this._frameRequest=null,this._render(_)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return Zd}getCameraTargetElevation(){return this.transform.elevation}},p.MapMouseEvent=ai,p.MapTouchEvent=$a,p.MapWheelEvent=Xf,p.Marker=zn,p.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const i=this._map.getZoom(),u=i===this._map.getMaxZoom(),f=i===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);i.title=f,i.setAttribute("aria-label",f)},this.options=c.e({},Xd,_),this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),z.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),z.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=z.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lm(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,i){const u=z.create("button",_,this._container);return u.type="button",u.addEventListener("click",i),u}},p.Popup=class extends c.E{constructor(_){super(),this.remove=()=>(this._content&&z.remove(this._content),this._container&&(z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var u;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=z.create("div","maplibregl-popup",this._map.getContainer()),this._tip=z.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?um(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._trackPointer&&!i)return;const f=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let g=this.options.anchor;const v=xt(this.options.offset);if(!g){const I=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=f.y+v.bottom.y<C?["top"]:f.y>this._map.transform.height-C?["bottom"]:[],f.x<I/2?M.push("left"):f.x>this._map.transform.width-I/2&&M.push("right"),g=M.length===0?"bottom":M.join("-")}let T=f.add(v[g]);this.options.subpixelPositioning||(T=T.round()),z.setTransform(this._container,`${Yd[g]} translate(${T.x}px,${T.y}px)`),sa(this._container,g,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(cs),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=c.M.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const i=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=_;f=u.firstChild,f;)i.appendChild(f);return this.setDOMContent(i)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=z.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=z.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Kc);_&&_.focus()}},p.RasterDEMTileSource=Wr,p.RasterTileSource=ro,p.ScaleControl=class{constructor(_){this._onMove=()=>{Qd(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,Qd(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},cm),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},p.ScrollZoomHandler=qd,p.Style=Aa,p.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=z.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=z.create("button","maplibregl-ctrl-terrain",this._container),z.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){z.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},p.TwoFingersTouchPitchHandler=Ud,p.TwoFingersTouchRotateHandler=jd,p.TwoFingersTouchZoomHandler=Hc,p.TwoFingersTouchZoomRotateHandler=Gd,p.VectorTileSource=Oe,p.VideoSource=Do,p.addSourceType=(_,i)=>c._(void 0,void 0,void 0,function*(){if(Gr(_))throw new Error(`A source type called "${_}" already exists.`);((u,f)=>{ti[u]=f})(_,i)}),p.clearPrewarmedResources=function(){const _=fn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(At),fn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},p.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},p.getRTLTextPluginStatus=function(){return Ir().getRTLTextPluginStatus()},p.getVersion=function(){return Ct},p.getWorkerCount=function(){return jt.workerCount},p.getWorkerUrl=function(){return c.a.WORKER_URL},p.importScriptInWorkers=function(_){return Lr().broadcast("IS",_)},p.prewarm=function(){Pn().acquire(At)},p.setMaxParallelImageRequests=function(_){c.a.MAX_PARALLEL_IMAGE_REQUESTS=_},p.setRTLTextPlugin=function(_,i){return Ir().setRTLTextPlugin(_,i)},p.setWorkerCount=function(_){jt.workerCount=_},p.setWorkerUrl=function(_){c.a.WORKER_URL=_}});var d=n;return d})})(hA);var m1=hA.exports;const An=gd(m1);var nw={exports:{}},Fh=typeof Reflect=="object"?Reflect:null,jS=Fh&&typeof Fh.apply=="function"?Fh.apply:function(e,n,o){return Function.prototype.apply.call(e,n,o)},Sg;Fh&&typeof Fh.ownKeys=="function"?Sg=Fh.ownKeys:Object.getOwnPropertySymbols?Sg=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Sg=function(e){return Object.getOwnPropertyNames(e)};function hD(t){console&&console.warn&&console.warn(t)}var pA=Number.isNaN||function(e){return e!==e};function qn(){qn.init.call(this)}nw.exports=qn;nw.exports.once=mD;qn.EventEmitter=qn;qn.prototype._events=void 0;qn.prototype._eventsCount=0;qn.prototype._maxListeners=void 0;var US=10;function t_(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(qn,"defaultMaxListeners",{enumerable:!0,get:function(){return US},set:function(t){if(typeof t!="number"||t<0||pA(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");US=t}});qn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||pA(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function fA(t){return t._maxListeners===void 0?qn.defaultMaxListeners:t._maxListeners}qn.prototype.getMaxListeners=function(){return fA(this)};qn.prototype.emit=function(e){for(var n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);var a=e==="error",d=this._events;if(d!==void 0)a=a&&d.error===void 0;else if(!a)return!1;if(a){var p;if(n.length>0&&(p=n[0]),p instanceof Error)throw p;var c=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw c.context=p,c}var S=d[e];if(S===void 0)return!1;if(typeof S=="function")jS(S,this,n);else for(var A=S.length,D=vA(S,A),o=0;o<A;++o)jS(D[o],this,n);return!0};function mA(t,e,n,o){var a,d,p;if(t_(n),d=t._events,d===void 0?(d=t._events=Object.create(null),t._eventsCount=0):(d.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),d=t._events),p=d[e]),p===void 0)p=d[e]=n,++t._eventsCount;else if(typeof p=="function"?p=d[e]=o?[n,p]:[p,n]:o?p.unshift(n):p.push(n),a=fA(t),a>0&&p.length>a&&!p.warned){p.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=p.length,hD(c)}return t}qn.prototype.addListener=function(e,n){return mA(this,e,n,!1)};qn.prototype.on=qn.prototype.addListener;qn.prototype.prependListener=function(e,n){return mA(this,e,n,!0)};function dD(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gA(t,e,n){var o={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},a=dD.bind(o);return a.listener=n,o.wrapFn=a,a}qn.prototype.once=function(e,n){return t_(n),this.on(e,gA(this,e,n)),this};qn.prototype.prependOnceListener=function(e,n){return t_(n),this.prependListener(e,gA(this,e,n)),this};qn.prototype.removeListener=function(e,n){var o,a,d,p,c;if(t_(n),a=this._events,a===void 0)return this;if(o=a[e],o===void 0)return this;if(o===n||o.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,o.listener||n));else if(typeof o!="function"){for(d=-1,p=o.length-1;p>=0;p--)if(o[p]===n||o[p].listener===n){c=o[p].listener,d=p;break}if(d<0)return this;d===0?o.shift():pD(o,d),o.length===1&&(a[e]=o[0]),a.removeListener!==void 0&&this.emit("removeListener",e,c||n)}return this};qn.prototype.off=qn.prototype.removeListener;qn.prototype.removeAllListeners=function(e){var n,o,a;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[e]),this;if(arguments.length===0){var d=Object.keys(o),p;for(a=0;a<d.length;++a)p=d[a],p!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=o[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(a=n.length-1;a>=0;a--)this.removeListener(e,n[a]);return this};function yA(t,e,n){var o=t._events;if(o===void 0)return[];var a=o[e];return a===void 0?[]:typeof a=="function"?n?[a.listener||a]:[a]:n?fD(a):vA(a,a.length)}qn.prototype.listeners=function(e){return yA(this,e,!0)};qn.prototype.rawListeners=function(e){return yA(this,e,!1)};qn.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):_A.call(t,e)};qn.prototype.listenerCount=_A;function _A(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}qn.prototype.eventNames=function(){return this._eventsCount>0?Sg(this._events):[]};function vA(t,e){for(var n=new Array(e),o=0;o<e;++o)n[o]=t[o];return n}function pD(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function fD(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function mD(t,e){return new Promise(function(n,o){function a(p){t.removeListener(e,d),o(p)}function d(){typeof t.removeListener=="function"&&t.removeListener("error",a),n([].slice.call(arguments))}xA(t,e,d,{once:!0}),e!=="error"&&gD(t,a,{once:!0})})}function gD(t,e,n){typeof t.on=="function"&&xA(t,"error",e,n)}function xA(t,e,n,o){if(typeof t.on=="function")o.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function a(d){o.once&&t.removeEventListener(e,a),n(d)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var yD=nw.exports;const _D=gd(yD);function vD(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class xD{constructor(){this._apiKey="",this._fetch=vD(),this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const Nh=new xD,wD={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"};new Set(Object.values(wD));async function bD(t,e={}){if(Nh.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(t).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Nh.fetch(t,e)}const wA={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(wA);class SD extends Error{constructor(e,n=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${n}`),this.res=e}}const $S={403:"Key is missing, invalid or restricted"};async function TD(t={}){const e=new URL("geolocation/ip.json",wA.maptilerApiURL);e.searchParams.set("key",t.apiKey??Nh.apiKey);const n=e.toString(),o=await bD(n);if(!o.ok)throw new SD(o,o.status in $S?$S[o.status]:"");return await o.json()}const qS={info:TD};function bA(t){const e=/^maptiler:\/\/(.*)/;let n;const o=t.trim();let a;return o.startsWith("http://")||o.startsWith("https://")?a=o:(n=e.exec(o))!==null?a=`https://api.maptiler.com/maps/${n[1]}/style.json`:a=`https://api.maptiler.com/maps/${o}/style.json`,a}class SA{constructor(e,n,o,a,d,p){this.name=e,this.variantType=n,this.id=o,this.referenceStyle=a,this.description=d,this.imageURL=p}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){return this.referenceStyle.getVariant(e)}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return bA(this.getId())}}class TA{constructor(e,n){this.name=e,this.id=n,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const g1=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function ED(t){return new Proxy(t,{get(e,n,o){return e.hasVariant(n)?e.getVariant(n):n.toString().toUpperCase()===n?t.getDefaultVariant():Reflect.get(e,n,o)}})}function ID(){const t={};for(let e=0;e<g1.length;e+=1){const n=g1[e],o=ED(new TA(n.name,n.referenceStyleID));for(let a=0;a<n.variants.length;a+=1){const d=n.variants[a],p=new SA(d.name,d.variantType,d.id,o,d.description,d.imageURL);o.addVariant(p)}t[n.referenceStyleID]=o}return t}const CD=ID();let Jm;const AD=new Uint8Array(16);function kD(){if(!Jm&&(Jm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jm(AD)}const ki=[];for(let t=0;t<256;++t)ki.push((t+256).toString(16).slice(1));function PD(t,e=0){return ki[t[e+0]]+ki[t[e+1]]+ki[t[e+2]]+ki[t[e+3]]+"-"+ki[t[e+4]]+ki[t[e+5]]+"-"+ki[t[e+6]]+ki[t[e+7]]+"-"+ki[t[e+8]]+ki[t[e+9]]+"-"+ki[t[e+10]]+ki[t[e+11]]+ki[t[e+12]]+ki[t[e+13]]+ki[t[e+14]]+ki[t[e+15]]}const RD=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),HS={randomUUID:RD};function MD(t,e,n){if(HS.randomUUID&&!e&&!t)return HS.randomUUID();t=t||{};const o=t.random||(t.rng||kD)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,PD(o)}const EA="3.7.7",LD=EA,wd=typeof Buffer=="function",WS=typeof TextDecoder=="function"?new TextDecoder:void 0,GS=typeof TextEncoder=="function"?new TextEncoder:void 0,DD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fp=Array.prototype.slice.call(DD),eg=(t=>{let e={};return t.forEach((n,o)=>e[n]=o),e})(Fp),zD=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Ri=String.fromCharCode.bind(String),KS=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),IA=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),CA=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),AA=t=>{let e,n,o,a,d="";const p=t.length%3;for(let c=0;c<t.length;){if((n=t.charCodeAt(c++))>255||(o=t.charCodeAt(c++))>255||(a=t.charCodeAt(c++))>255)throw new TypeError("invalid character found");e=n<<16|o<<8|a,d+=Fp[e>>18&63]+Fp[e>>12&63]+Fp[e>>6&63]+Fp[e&63]}return p?d.slice(0,p-3)+"===".substring(p):d},rw=typeof btoa=="function"?t=>btoa(t):wd?t=>Buffer.from(t,"binary").toString("base64"):AA,y1=wd?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let o=0,a=t.length;o<a;o+=4096)n.push(Ri.apply(null,t.subarray(o,o+4096)));return rw(n.join(""))},Tg=(t,e=!1)=>e?IA(y1(t)):y1(t),OD=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?Ri(192|e>>>6)+Ri(128|e&63):Ri(224|e>>>12&15)+Ri(128|e>>>6&63)+Ri(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return Ri(240|e>>>18&7)+Ri(128|e>>>12&63)+Ri(128|e>>>6&63)+Ri(128|e&63)}},FD=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,kA=t=>t.replace(FD,OD),ZS=wd?t=>Buffer.from(t,"utf8").toString("base64"):GS?t=>y1(GS.encode(t)):t=>rw(kA(t)),Bh=(t,e=!1)=>e?IA(ZS(t)):ZS(t),XS=t=>Bh(t,!0),ND=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,BD=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return Ri((n>>>10)+55296)+Ri((n&1023)+56320);case 3:return Ri((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return Ri((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},PA=t=>t.replace(ND,BD),RA=t=>{if(t=t.replace(/\s+/g,""),!zD.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n="",o,a;for(let d=0;d<t.length;)e=eg[t.charAt(d++)]<<18|eg[t.charAt(d++)]<<12|(o=eg[t.charAt(d++)])<<6|(a=eg[t.charAt(d++)]),n+=o===64?Ri(e>>16&255):a===64?Ri(e>>16&255,e>>8&255):Ri(e>>16&255,e>>8&255,e&255);return n},iw=typeof atob=="function"?t=>atob(CA(t)):wd?t=>Buffer.from(t,"base64").toString("binary"):RA,MA=wd?t=>KS(Buffer.from(t,"base64")):t=>KS(iw(t).split("").map(e=>e.charCodeAt(0))),LA=t=>MA(DA(t)),VD=wd?t=>Buffer.from(t,"base64").toString("utf8"):WS?t=>WS.decode(MA(t)):t=>PA(iw(t)),DA=t=>CA(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),_1=t=>VD(DA(t)),jD=t=>{if(typeof t!="string")return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},zA=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),OA=function(){const t=(e,n)=>Object.defineProperty(String.prototype,e,zA(n));t("fromBase64",function(){return _1(this)}),t("toBase64",function(e){return Bh(this,e)}),t("toBase64URI",function(){return Bh(this,!0)}),t("toBase64URL",function(){return Bh(this,!0)}),t("toUint8Array",function(){return LA(this)})},FA=function(){const t=(e,n)=>Object.defineProperty(Uint8Array.prototype,e,zA(n));t("toBase64",function(e){return Tg(this,e)}),t("toBase64URI",function(){return Tg(this,!0)}),t("toBase64URL",function(){return Tg(this,!0)})},UD=()=>{OA(),FA()},$D={version:EA,VERSION:LD,atob:iw,atobPolyfill:RA,btoa:rw,btoaPolyfill:AA,fromBase64:_1,toBase64:Bh,encode:Bh,encodeURI:XS,encodeURL:XS,utob:kA,btou:PA,decode:_1,isValid:jD,fromUint8Array:Tg,toUint8Array:LA,extendString:OA,extendUint8Array:FA,extendBuiltins:UD},_n={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},qD=new Set(Object.values(_n));function YS(t){return qD.has(t)}const HD=new Set(Object.values(_n));function QS(){if(typeof navigator>"u")return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const t=Array.from(new Set(navigator.languages.map(e=>`name:${e.split("-")[0]}`))).filter(e=>HD.has(e));return t.length?t[0]:_n.LOCAL}const Eo={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:_n.STYLE,secondaryLanguage:_n.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Eo);const NA=MD();class WD extends _D{constructor(){super(...arguments),this.primaryLanguage=Eo.primaryLanguage,this.session=!0,this.caching=!0,this._unit="metric",this._apiKey=""}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,Nh.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){Nh.fetch=e}get fetch(){return Nh.fetch}}const To=new WD,v1="localcache_source",x1="localcache",GD="maptiler_sdk",KD=1e3,ZD=100,w1=typeof caches<"u";function XD(t,e){if(w1&&To.caching&&To.session&&t.host===Eo.maptilerApiHost){if(e==="Source"&&t.href.includes("tiles.json"))return t.href.replace("https://",`${v1}://`);if(e==="Tile"||e==="Glyphs")return t.href.replace("https://",`${x1}://`)}return t.href}let H0;async function BA(){return H0||(H0=await caches.open(GD)),H0}let JS=0;async function YD(){const t=await BA(),e=await t.keys(),n=e.slice(0,Math.max(e.length-KD,0));for(const o of n)t.delete(o)}function QD(){m1.addProtocol(v1,async(t,e)=>{if(!t.url)throw new Error("");t.url=t.url.replace(`${v1}://`,"https://");const n=t;n.signal=e.signal;const o=await fetch(t.url,n),a=await o.json();return a.tiles&&a.tiles.length>0&&(a.tiles[0]+=`&last-modified=${o.headers.get("Last-Modified")}`),{data:a,cacheControl:o.headers.get("Cache-Control"),expires:o.headers.get("Expires")}}),m1.addProtocol(x1,async(t,e)=>{if(!t.url)throw new Error("");t.url=t.url.replace(`${x1}://`,"https://");const n=new URL(t.url),o=new URL(n);o.searchParams.delete("mtsid"),o.searchParams.delete("key");const a=o.toString(),d=new URL(n);d.searchParams.delete("last-modified");const p=d.toString(),c=async z=>({data:await z.arrayBuffer(),cacheControl:z.headers.get("Cache-Control"),expires:z.headers.get("Expires")}),S=await BA(),A=await S.match(a);if(A)return c(A);const D=t;D.signal=e.signal;const L=await fetch(p,D);return L.status>=200&&L.status<300&&(S.put(a,L.clone()).catch(()=>{}),++JS>ZD&&(YD(),JS=0)),c(L)})}function JD(){if(typeof window>"u")return;const t=An.getRTLTextPluginStatus();if(t==="unavailable"||t==="requested")try{An.setRTLTextPlugin(Eo.rtlPluginURL,!0)}catch{}}function ez(t,e){for(const n of t)typeof e[n]=="function"&&(e[n]=e[n].bind(e))}function Wl(t,e,n){const o=window.document.createElement(t);return e!==void 0&&(o.className=e),n&&n.appendChild(o),o}function VA(t){t.parentNode&&t.parentNode.removeChild(t)}function eT(t,e){let n=null;try{n=new URL(t)}catch{return{url:t}}return n.host===Eo.maptilerApiHost&&(n.searchParams.has("key")||n.searchParams.append("key",To.apiKey),To.session&&n.searchParams.append("mtsid",NA)),{url:XD(n,e)}}function tT(t){return(e,n)=>{if(t!=null){const o=t(e,n),a=eT((o==null?void 0:o.url)??"",n);return{...o,...a}}return eT(e,n)}}function tz(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function nz(t){const e=tz();if(!e)return;let n=null;if(typeof t=="string"?n=document.getElementById(t):t instanceof HTMLElement&&(n=t),!n)throw new Error("The Map container must be provided.");const o=document.createElement("div");throw o.innerHTML=e,o.classList.add("no-webgl-support-div"),n.appendChild(o),new Error(e)}let rz=class extends An.Marker{addTo(e){return super.addTo(e)}},_7=class extends An.Popup{addTo(e){return super.addTo(e)}},x7=class extends An.Style{constructor(e,n={}){super(e,n)}};class b7 extends An.CanvasSource{onAdd(e){super.onAdd(e)}}class S7 extends An.GeoJSONSource{onAdd(e){super.onAdd(e)}}class T7 extends An.ImageSource{onAdd(e){super.onAdd(e)}}class E7 extends An.RasterTileSource{onAdd(e){super.onAdd(e)}}class I7 extends An.RasterDEMTileSource{onAdd(e){super.onAdd(e)}}class C7 extends An.VectorTileSource{onAdd(e){super.onAdd(e)}}class A7 extends An.VideoSource{onAdd(e){super.onAdd(e)}}class iz extends An.NavigationControl{onAdd(e){return super.onAdd(e)}}class oz extends An.GeolocateControl{onAdd(e){return super.onAdd(e)}}class k7 extends An.AttributionControl{onAdd(e){return super.onAdd(e)}}class sz extends An.LogoControl{onAdd(e){return super.onAdd(e)}}class az extends An.ScaleControl{onAdd(e){return super.onAdd(e)}}class lz extends An.FullscreenControl{onAdd(e){return super.onAdd(e)}}class P7 extends An.TerrainControl{onAdd(e){return super.onAdd(e)}}class R7 extends An.BoxZoomHandler{constructor(e,n){super(e,n)}}class M7 extends An.ScrollZoomHandler{constructor(e,n){super(e,n)}}class L7 extends An.CooperativeGesturesHandler{constructor(e,n){super(e,n)}}class D7 extends An.KeyboardHandler{constructor(e){super(e)}}class z7 extends An.TwoFingersTouchPitchHandler{constructor(e){super(e)}}class O7 extends An.MapWheelEvent{constructor(e,n,o){super(e,n,o)}}class F7 extends An.MapTouchEvent{constructor(e,n,o){super(e,n,o)}}class N7 extends An.MapMouseEvent{constructor(e,n,o,a={}){super(e,n,o,a)}}class nT extends sz{constructor(e={}){super(e),this.logoURL="",this.linkURL="",this.logoURL=e.logoURL??Eo.maptilerLogoURL,this.linkURL=e.linkURL??Eo.maptilerURL}onAdd(e){this._map=e,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const n=window.document.createElement("a");return n.style.backgroundRepeat="no-repeat",n.style.cursor="pointer",n.style.display="block",n.style.height="23px",n.style.margin="0 0 -4px -4px",n.style.overflow="hidden",n.style.width="88px",n.style.backgroundImage=`url(${this.logoURL})`,n.style.backgroundSize="100px 30px",n.style.width="100px",n.style.height="30px",n.target="_blank",n.rel="noopener",n.href=this.linkURL,n.setAttribute("aria-label","MapTiler logo"),n.setAttribute("rel","noopener"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}function rT(t){return t?typeof t=="string"||t instanceof String?!t.startsWith("http")&&t.toLowerCase().includes(".json")?t:bA(t):t instanceof SA?t.getExpandedStyleURL():t instanceof TA?t.getDefaultVariant().getExpandedStyleURL():t:CD[g1[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class uz{constructor(){ez(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=Wl("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Wl("button","maplibregl-ctrl-terrain",this._container),Wl("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){VA(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class cz extends iz{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(this._map.transform.pitch*(Math.PI/180))**.5)}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",e=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})}_createButton(e,n){const o=super._createButton(e,n);return o.clickFunction=n,o}}const iT=An.Marker,oT=An.LngLat,hz=An.LngLatBounds;class dz extends oz{constructor(){super(...arguments),this.lastUpdatedCenter=new oT(0,0),this._updateCamera=e=>{var A,D;const n=new oT(e.coords.longitude,e.coords.latitude),o=e.coords.accuracy,d={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},p=this._map.getZoom();p>(((D=(A=this.options)==null?void 0:A.fitBoundsOptions)==null?void 0:D.maxZoom)??30)&&(d.zoom=p),this._map.fitBounds(hz.fromLngLat(n,o),d,{geolocateSource:!0});let c=!1;const S=()=>{c=!0};this._map.once("click",S),this._map.once("dblclick",S),this._map.once("dragstart",S),this._map.once("mousedown",S),this._map.once("touchstart",S),this._map.once("wheel",S),this._map.once("moveend",()=>{this._map.off("click",S),this._map.off("dblclick",S),this._map.off("dragstart",S),this._map.off("mousedown",S),this._map.off("touchstart",S),this._map.off("wheel",S),!c&&(this.lastUpdatedCenter=this._map.getCenter())})},this._setupUI=e=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=Wl("button","maplibregl-ctrl-geolocate",this._container),Wl("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",e===!1){const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Wl("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new iT({element:this._dotElement}),this._circleElement=Wl("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new iT({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",n=>{const o=n.originalEvent&&n.originalEvent.type==="resize",a=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!n.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!o&&a>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],n=this._map.project(e),o=this._map.unproject([n.x,n.y]),a=this._map.unproject([n.x+20,n.y]),d=o.distanceTo(a)/20,p=Math.ceil(2*this._accuracy/d);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}}var jA=t=>{throw TypeError(t)},ow=(t,e,n)=>e.has(t)||jA("Cannot "+n),pn=(t,e,n)=>(ow(t,e,"read from private field"),n?n.call(t):e.get(t)),Ol=(t,e,n)=>e.has(t)?jA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),fh=(t,e,n,o)=>(ow(t,e,"write to private field"),e.set(t,n),n),qo=(t,e,n)=>(ow(t,e,"access private method"),n),Ho,_a,Zu,UA,ic,ps,Eg,ho,$A,fs,qA;class W0{constructor(e,n){Ol(this,ho),Ol(this,Ho),Ol(this,_a),Ol(this,Zu),Ol(this,UA),Ol(this,ic),Ol(this,ps,!1),Ol(this,Eg),e.style!==void 0&&fh(this,ps,!0),fh(this,Ho,{zoomAdjust:-4,position:"top-right",...n,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...e,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...e.containerStyle??{}}}),e.lockZoom!==void 0&&(pn(this,Ho).minZoom=e.lockZoom,pn(this,Ho).maxZoom=e.lockZoom)}setStyle(e,n){pn(this,ps)||this.map.setStyle(e,n),qo(this,ho,fs).call(this)}addLayer(e,n){return pn(this,ps)||this.map.addLayer(e,n),qo(this,ho,fs).call(this),this.map}moveLayer(e,n){return pn(this,ps)||this.map.moveLayer(e,n),qo(this,ho,fs).call(this),this.map}removeLayer(e){return pn(this,ps)||this.map.removeLayer(e),qo(this,ho,fs).call(this),this}setLayerZoomRange(e,n,o){return pn(this,ps)||this.map.setLayerZoomRange(e,n,o),qo(this,ho,fs).call(this),this}setFilter(e,n,o){return pn(this,ps)||this.map.setFilter(e,n,o),qo(this,ho,fs).call(this),this}setPaintProperty(e,n,o,a){return pn(this,ps)||this.map.setPaintProperty(e,n,o,a),qo(this,ho,fs).call(this),this}setLayoutProperty(e,n,o,a){return pn(this,ps)||this.map.setLayoutProperty(e,n,o,a),qo(this,ho,fs).call(this),this}setGlyphs(e,n){return pn(this,ps)||this.map.setGlyphs(e,n),qo(this,ho,fs).call(this),this}onAdd(e){fh(this,_a,e),fh(this,Zu,Wl("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[n,o]of Object.entries(pn(this,Ho).containerStyle))pn(this,Zu).style.setProperty(n,o);return pn(this,Ho).container=pn(this,Zu),pn(this,Ho).zoom=e.getZoom()+pn(this,Ho).zoomAdjust,this.map=new HA(pn(this,Ho)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{qo(this,ho,$A).call(this,pn(this,Ho).parentRect),fh(this,Eg,qo(this,ho,qA).call(this))}),pn(this,Zu)}onRemove(){var e;(e=pn(this,Eg))==null||e.call(this),VA(pn(this,Zu))}}Ho=new WeakMap;_a=new WeakMap;Zu=new WeakMap;UA=new WeakMap;ic=new WeakMap;ps=new WeakMap;Eg=new WeakMap;ho=new WeakSet;$A=function(t){t===void 0||t.linePaint===void 0&&t.fillPaint===void 0||(fh(this,ic,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:pn(this,ic)}),(t.lineLayout!==void 0||t.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...t.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...t.linePaint}}),t.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...t.fillPaint}}),qo(this,ho,fs).call(this))};fs=function(){if(pn(this,ic)===void 0)return;const{devicePixelRatio:t}=window,e=pn(this,_a).getCanvas(),n=e.width/t,o=e.height/t,a=pn(this,_a).unproject.bind(pn(this,_a)),d=a([0,0]),p=a([n,0]),c=a([0,o]),S=a([n,o]);pn(this,ic).geometry.coordinates=[[c.toArray(),S.toArray(),p.toArray(),d.toArray(),c.toArray()]],this.map.getSource("parentRect").setData(pn(this,ic))};qA=function(){const{pitchAdjust:t}=pn(this,Ho),e=()=>{d("parent")},n=()=>{d("minimap")},o=()=>{pn(this,_a).on("move",e),this.map.on("move",n)},a=()=>{pn(this,_a).off("move",e),this.map.off("move",n)},d=p=>{a();const c=p==="parent"?pn(this,_a):this.map,S=p==="parent"?this.map:pn(this,_a),A=c.getCenter(),D=c.getZoom()+(pn(this,Ho).zoomAdjust??-4)*(p==="parent"?1:-1),L=c.getBearing(),z=c.getPitch();S.jumpTo({center:A,zoom:D,bearing:L,pitch:t?z:0}),qo(this,ho,fs).call(this),o()};return o(),()=>{a()}};const pz={POINT:"POINT",COUNTRY:"COUNTRY"};let HA=class extends An.Map{constructor(e){nz(e.container),e.apiKey&&(To.apiKey=e.apiKey);const n=rT(e.style),o=location.hash;To.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let a={compact:!1};e.customAttribution?a.customAttribution=e.customAttribution:e.attributionControl&&typeof e.attributionControl=="object"&&(a={...a,...e.attributionControl}),super({...e,style:n,maplibreLogo:!1,transformRequest:tT(e.transformRequest),attributionControl:e.forceNoAttributionControl===!0?!1:a}),this.isTerrainEnabled=!1,this.terrainExaggeration=1,this.terrainGrowing=!1,this.terrainFlattening=!1,this.isReady=!1,To.caching&&!w1&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),To.caching&&w1&&QD(),this.primaryLanguage=e.language??To.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===_n.STYLE||this.primaryLanguage===_n.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===_n.STYLE,this.terrainExaggeration=e.terrainExaggeration??this.terrainExaggeration,this.once("styledata",async()=>{if(!e.geolocate||e.center||e.hash&&o)return;try{if(e.geolocate===pz.COUNTRY){await this.fitToIpBounds();return}}catch(L){console.warn(L.message)}let A;try{await this.centerOnIpPoint(e.zoom),A=this.getCameraHash()}catch(L){console.warn(L.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(L=>{A===this.getCameraHash()&&(this.terrain?this.easeTo({center:[L.coords.longitude,L.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[L.coords.longitude,L.coords.latitude],zoom:e.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let A={logo:null};try{const D=Object.keys(this.style.sourceCaches).map(ee=>this.getSource(ee)).filter(ee=>ee&&"url"in ee&&typeof ee.url=="string"&&(ee==null?void 0:ee.url.includes("tiles.json"))),L=new URL(D[0].url);L.searchParams.has("key")||L.searchParams.append("key",To.apiKey),A=await(await fetch(L.href)).json()}catch{}if(e.forceNoAttributionControl!==!0)if("logo"in A&&A.logo){const D=A.logo;this.addControl(new nT({logoURL:D}),e.logoPosition)}else e.maptilerLogo&&this.addControl(new nT,e.logoPosition);if(e.scaleControl){const D=e.scaleControl===!0||e.scaleControl===void 0?"bottom-right":e.scaleControl,L=new az({unit:To.unit});this.addControl(L,D),To.on("unit",z=>{L.setUnit(z)})}if(e.navigationControl!==!1){const D=e.navigationControl===!0||e.navigationControl===void 0?"top-right":e.navigationControl;this.addControl(new cz,D)}if(e.geolocateControl!==!1){const D=e.geolocateControl===!0||e.geolocateControl===void 0?"top-right":e.geolocateControl;this.addControl(new dz({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),D)}if(e.terrainControl){const D=e.terrainControl===!0||e.terrainControl===void 0?"top-right":e.terrainControl;this.addControl(new uz,D)}if(e.fullscreenControl){const D=e.fullscreenControl===!0||e.fullscreenControl===void 0?"top-right":e.fullscreenControl;this.addControl(new lz({}),D)}this.isReady=!0,this.fire("ready",{target:this})});let d=!1,p=!1,c;this.once("ready",()=>{d=!0,p&&this.fire("loadWithTerrain",c)}),this.once("style.load",()=>{const{minimap:A}=e;if(typeof A=="object"){const{zoom:D,center:L,style:z,language:ee,apiKey:pe,maptilerLogo:ue,antialias:me,refreshExpiredTiles:te,maxBounds:G,scrollZoom:re,minZoom:be,maxZoom:Le,boxZoom:Me,locale:J,fadeDuration:X,crossSourceCollisions:Y,clickTolerance:ie,bounds:de,fitBoundsOptions:we,pixelRatio:se,validateStyle:ut}=e;this.minimap=new W0(A,{zoom:D,center:L,style:z,language:ee,apiKey:pe,container:"null",maptilerLogo:ue,antialias:me,refreshExpiredTiles:te,maxBounds:G,scrollZoom:re,minZoom:be,maxZoom:Le,boxZoom:Me,locale:J,fadeDuration:X,crossSourceCollisions:Y,clickTolerance:ie,bounds:de,fitBoundsOptions:we,pixelRatio:se,validateStyle:ut}),this.addControl(this.minimap,A.position??"bottom-left")}else A===!0?(this.minimap=new W0({},e),this.addControl(this.minimap,"bottom-left")):A!==void 0&&A!==!1&&(this.minimap=new W0({},e),this.addControl(this.minimap,A))});const S=A=>{A.terrain&&(p=!0,c={type:"loadWithTerrain",target:this,terrain:A.terrain},this.off("terrain",S),d&&this.fire("loadWithTerrain",c))};this.on("terrain",S),e.terrain&&this.enableTerrain(e.terrainExaggeration??this.terrainExaggeration)}async onLoadAsync(){return new Promise(e=>{if(this.loaded())return e(this);this.once("load",()=>{e(this)})})}async onReadyAsync(){return new Promise(e=>{if(this.isReady)return e(this);this.once("ready",()=>{e(this)})})}async onLoadWithTerrainAsync(){return new Promise(e=>{if(this.isReady&&this.terrain)return e(this);this.once("loadWithTerrain",()=>{e(this)})})}setStyle(e,n){var o;return(o=this.minimap)==null||o.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(rT(e),n)}addLayer(e,n){var o;return(o=this.minimap)==null||o.addLayer(e,n),super.addLayer(e,n)}moveLayer(e,n){var o;return(o=this.minimap)==null||o.moveLayer(e,n),super.moveLayer(e,n)}removeLayer(e){var n;return(n=this.minimap)==null||n.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,n,o){var a;return(a=this.minimap)==null||a.setLayerZoomRange(e,n,o),super.setLayerZoomRange(e,n,o)}setFilter(e,n,o){var a;return(a=this.minimap)==null||a.setFilter(e,n,o),super.setFilter(e,n,o)}setPaintProperty(e,n,o,a){var d;return(d=this.minimap)==null||d.setPaintProperty(e,n,o,a),super.setPaintProperty(e,n,o,a)}setLayoutProperty(e,n,o,a){var d;return(d=this.minimap)==null||d.setLayoutProperty(e,n,o,a),super.setLayoutProperty(e,n,o,a)}setGlyphs(e,n){var o;return(o=this.minimap)==null||o.setGlyphs(e,n),super.setGlyphs(e,n)}getStyleLanguage(){return!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?this.style.stylesheet.metadata["maptiler:language"]:null}setLanguage(e){var n,o;(o=(n=this.minimap)==null?void 0:n.map)==null||o.setLanguage(e),this.onStyleReady(()=>{this.setPrimaryLanguage(e)})}setPrimaryLanguage(e){const n=this.getStyleLanguage();if(!(e===_n.STYLE&&(n===_n.AUTO||n===_n.VISITOR))&&(e!==_n.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===e&&!this.forceLanguageUpdate))return;if(!YS(e)){console.warn(`The language "${e}" is not supported.`);return}if(this.primaryLanguage===_n.STYLE_LOCK){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=e;let o=e;if(e===_n.STYLE){if(!n){console.warn("The style has no default languages.");return}if(!YS(n)){console.warn("The language defined in the style is not valid.");return}o=n}let a=_n.LOCAL,d=`{${a}}`;o===_n.VISITOR?(a=QS(),d=["case",["all",["has",a],["has",_n.LOCAL]],["case",["==",["get",a],["get",_n.LOCAL]],["get",_n.LOCAL],["format",["get",a],{"font-scale":.8},`
`,["get",_n.LOCAL],{"font-scale":1.1}]],["get",_n.LOCAL]]):o===_n.VISITOR_ENGLISH?(a=_n.ENGLISH,d=["case",["all",["has",a],["has",_n.LOCAL]],["case",["==",["get",a],["get",_n.LOCAL]],["get",_n.LOCAL],["format",["get",a],{"font-scale":.8},`
`,["get",_n.LOCAL],{"font-scale":1.1}]],["get",_n.LOCAL]]):o===_n.AUTO?(a=QS(),d=["case",["has",a],["get",a],["get",_n.LOCAL]]):o===_n.LOCAL?(a=_n.LOCAL,d=`{${a}}`):(a=o,d=["case",["has",a],["get",a],["get",_n.LOCAL]]);const{layers:p}=this.getStyle();for(const c of p){if(c.type!=="symbol")continue;const S=c,A=this.getSource(S.source);if(!A||!("url"in A&&typeof A.url=="string")||new URL(A.url).host!==Eo.maptilerApiHost)continue;const{id:L,layout:z}=S;if(!z||!("text-field"in z))continue;const ee=this.getLayoutProperty(L,"text-field");typeof ee=="string"&&(ee.toLowerCase().includes("ref")||ee.toLowerCase().includes("housenumber"))||this.setLayoutProperty(L,"text-field",d)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e,n=1e3){if(!this.terrain)return;const o=performance.now(),a=this.terrain.exaggeration,d=e-a,p=()=>{if(!this.terrain||this.terrainFlattening)return;const c=(performance.now()-o)/n;if(c<.99){const S=1-(1-c)**4,A=a+S*d;this.terrain.exaggeration=A,requestAnimationFrame(p)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(p)}enableTerrain(e=this.terrainExaggeration){if(e<0){console.warn("Terrain exaggeration cannot be negative.");return}const n=async a=>{!this.terrain||a.type!=="data"||a.dataType!=="source"||!("source"in a)||a.sourceId!=="maptiler-terrain"||a.source.type!=="raster-dem"||a.isSourceLoaded&&(this.off("data",n),this.growTerrain(e))},o=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",n),this.addSource(Eo.terrainSourceId,{type:"raster-dem",url:Eo.terrainSourceURL}),this.setTerrain({source:Eo.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(e);return}this.loaded()||this.isTerrainEnabled?o():this.once("load",()=>{this.getTerrain()&&this.getSource(Eo.terrainSourceId)||o()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=1*1e3,n=performance.now(),o=this.terrain.exaggeration,a=()=>{if(!this.terrain||this.terrainGrowing)return;const d=(performance.now()-n)/e;if(d<.99){const p=(1-d)**4,c=o*p;this.terrain.exaggeration=c,requestAnimationFrame(a)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Eo.terrainSourceId)&&this.removeSource(Eo.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(a)}setTerrainExaggeration(e,n=!0){!n&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",()=>{e()})}async fitToIpBounds(){const e=await qS.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(e){const n=await qS.info();this.jumpTo({center:[(n==null?void 0:n.longitude)??0,(n==null?void 0:n.latitude)??0],zoom:e||11})}getCameraHash(){const e=new Float32Array(5),n=this.getCenter();return e[0]=n.lng,e[1]=n.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),$D.fromUint8Array(new Uint8Array(e.buffer))}getSdkConfig(){return To}getMaptilerSessionId(){return NA}setTransformRequest(e){return super.setTransformRequest(tT(e)),this}};function tg(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function fz(t){return`#${tg(t[0])}${tg(t[1])}${tg(t[2])}${t.length===4?tg(t[3]):""}`}class zt extends Array{constructor(e={}){super(),this.min=0,this.max=1,"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new zt({stops:e.map(n=>({value:n[0],color:n[1]}))})}setStops(e,n={clone:!0}){const o=n.clone?this.clone():this;o.length=0;let a=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(let p=0;p<e.length;p+=1)a=Math.min(a,e[p].value),d=Math.max(d,e[p].value),o.push({value:e[p].value,color:e[p].color.slice()});return o.sort((p,c)=>p.value<c.value?-1:1),this.min=a,this.max=d,o}scale(e,n,o={clone:!0}){const a=o.clone,d=this[0].value,c=this.at(-1).value-d,S=n-e,A=[];for(let D=0;D<this.length;D+=1){const ee=(this[D].value-d)/c*S+e;a?A.push({value:ee,color:this[D].color.slice()}):this[D].value=ee}return a?new zt({stops:A}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new zt({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let n=0;n<this.length;n+=1)e.push({value:this[n].value,color:this[n].color});return e}reverse(e={clone:!0}){const n=e.clone?this.clone():this;for(let o=0;o<~~(n.length/2);o+=1){const a=n[o].color;n[o].color=n.at(-(o+1)).color,n.at(-(o+1)).color=a}return n}getBounds(){return{min:this.min,max:this.max}}getColor(e,n={smooth:!0}){if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let o=0;o<this.length-1;o+=1){if(e>this[o+1].value)continue;const a=this[o].color;if(!n.smooth)return a.slice();const d=this[o].value,p=this[o+1].value,c=this[o+1].color,S=(p-e)/(p-d);return a.map((A,D)=>Math.round(A*S+c[D]*(1-S)))}return[0,0,0]}getColorHex(e,n={smooth:!0,withAlpha:!1}){return fz(this.getColor(e,n))}getColorRelative(e,n={smooth:!0}){const o=this.getBounds();return this.getColor(o.min+e*(o.max-o.min),n)}getCanvasStrip(e={horizontal:!0,size:512,smooth:!0}){const n=document.createElement("canvas");n.width=e.horizontal?e.size:1,n.height=e.horizontal?1:e.size;const o=n.getContext("2d");if(!o)throw new Error("Canvs context is missing");const a=o.getImageData(0,0,n.width,n.height),d=a.data,p=e.size,c=this[0].value,D=(this.at(-1).value-c)/p;for(let L=0;L<p;L+=1){const z=this.getColor(c+L*D,{smooth:e.smooth});d[L*4]=z[0],d[L*4+1]=z[1],d[L*4+2]=z[2],d[L*4+3]=z.length>3?z[3]:255}return o.putImageData(a,0,0),n}resample(e,n=15){const o=this.getBounds(),a=this.scale(0,1),d=1/(n-1);let p;if(e==="ease-in-square")p=Array.from({length:n},(A,D)=>{const L=D*d,z=L**2,ee=a.getColor(z);return{value:L,color:ee}});else if(e==="ease-out-square")p=Array.from({length:n},(A,D)=>{const L=D*d,z=1-(1-L)**2,ee=a.getColor(z);return{value:L,color:ee}});else if(e==="ease-out-sqrt")p=Array.from({length:n},(A,D)=>{const L=D*d,z=L**.5,ee=a.getColor(z);return{value:L,color:ee}});else if(e==="ease-in-sqrt")p=Array.from({length:n},(A,D)=>{const L=D*d,z=1-(1-L)**.5,ee=a.getColor(z);return{value:L,color:ee}});else if(e==="ease-out-exp")p=Array.from({length:n},(A,D)=>{const L=D*d,z=1-2**(-10*L),ee=a.getColor(z);return{value:L,color:ee}});else if(e==="ease-in-exp")p=Array.from({length:n},(A,D)=>{const L=D*d,z=2**(10*L-10),ee=a.getColor(z);return{value:L,color:ee}});else throw new Error("Invalid ressampling method.");return new zt({stops:p}).scale(o.min,o.max)}transparentStart(){const e=this.getRawColorStops();e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001;for(const n of e)n.color.length===3&&n.color.push(255);return e[0].color[3]=0,new zt({stops:e})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}new zt({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new zt({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new zt({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new zt({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new zt({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new zt({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new zt({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new zt({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new zt({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new zt({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new zt({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new zt({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new zt({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new zt({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new zt({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new zt({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new zt({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new zt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new zt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new zt({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new zt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new zt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new zt({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new zt({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new zt({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new zt({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new zt({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new zt({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new zt({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new zt({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new zt({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new zt({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new zt({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new zt({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new zt({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new zt({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new zt({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new zt({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new zt({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new zt({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new zt({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new zt({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});JD();function Qp(){return Qp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Qp.apply(this,arguments)}var mz=function(e,n){n===void 0&&(n=!0),Ve.useEffect(function(){if(n){var o=function(d){d.key==="Escape"&&e(d)};return document.addEventListener("keyup",o),function(){n&&document.removeEventListener("keyup",o)}}},[e,n])},gz=function(e,n){n===void 0&&(n=!0),Ve.useEffect(function(){if(n){var o=function(){e()};return window.addEventListener("resize",o),function(){n&&window.removeEventListener("resize",o)}}},[e,n])},yz=function(e,n,o){o===void 0&&(o=!0),Ve.useEffect(function(){if(o){var a=function(p){var c=Array.isArray(e)?e:[e],S=!1;c.forEach(function(A){if(!A.current||A.current.contains(p.target)){S=!0;return}}),p.stopPropagation(),S||n(p)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),function(){o&&(document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a))}}},[e,n,o])},_z=function(e,n){n===void 0&&(n=!0),Ve.useEffect(function(){if(n){var o=function(d){if(d.keyCode===9){var p,c=e==null||(p=e.current)===null||p===void 0?void 0:p.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),S=Array.prototype.slice.call(c);if(S.length===1){d.preventDefault();return}var A=S[0],D=S[S.length-1];d.shiftKey&&document.activeElement===A?(d.preventDefault(),D.focus()):document.activeElement===D&&(d.preventDefault(),A.focus())}};return document.addEventListener("keydown",o),function(){n&&document.removeEventListener("keydown",o)}}},[e,n])},vz=typeof window<"u"?Ve.useLayoutEffect:Ve.useEffect,kp={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},xz=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],wz=function(e,n,o,a,d){var p=d.offsetX,c=d.offsetY,S=a?8:0,A=o.split(" "),D=e.top+e.height/2,L=e.left+e.width/2,z=n.height,ee=n.width,pe=D-z/2,ue=L-ee/2,me="",te="0%",G="0%";switch(A[0]){case"top":pe-=z/2+e.height/2+S,me="rotate(180deg)  translateX(50%)",te="100%",G="50%";break;case"bottom":pe+=z/2+e.height/2+S,me="rotate(0deg) translateY(-100%) translateX(-50%)",G="50%";break;case"left":ue-=ee/2+e.width/2+S,me=" rotate(90deg)  translateY(50%) translateX(-25%)",G="100%",te="50%";break;case"right":ue+=ee/2+e.width/2+S,me="rotate(-90deg)  translateY(-150%) translateX(25%)",te="50%";break}switch(A[1]){case"top":pe=e.top,te=e.height/2+"px";break;case"bottom":pe=e.top-z+e.height,te=z-e.height/2+"px";break;case"left":ue=e.left,G=e.width/2+"px";break;case"right":ue=e.left-ee+e.width,G=ee-e.width/2+"px";break}return pe=A[0]==="top"?pe-c:pe+c,ue=A[0]==="left"?ue-p:ue+p,{top:pe,left:ue,transform:me,arrowLeft:G,arrowTop:te}},bz=function(e){var n={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if(typeof e=="string"){var o=document.querySelector(e);o!==null&&(n=o.getBoundingClientRect())}return n},Sz=function(e,n,o,a,d,p){var c=d.offsetX,S=d.offsetY,A={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},D=0,L=bz(p),z=Array.isArray(o)?o:[o];for((p||Array.isArray(o))&&(z=[].concat(z,xz));D<z.length;){A=wz(e,n,z[D],a,{offsetX:c,offsetY:S});var ee={top:A.top,left:A.left,width:n.width,height:n.height};if(ee.top<=L.top||ee.left<=L.left||ee.top+ee.height>=L.top+L.height||ee.left+ee.width>=L.left+L.width)D++;else break}return A},Tz=0,Ez=function(){var e=document.getElementById("popup-root");return e===null&&(e=document.createElement("div"),e.setAttribute("id","popup-root"),document.body.appendChild(e)),e},Iz=Ve.forwardRef(function(t,e){var n=t.trigger,o=n===void 0?null:n,a=t.onOpen,d=a===void 0?function(){}:a,p=t.onClose,c=p===void 0?function(){}:p,S=t.defaultOpen,A=S===void 0?!1:S,D=t.open,L=D===void 0?void 0:D,z=t.disabled,ee=z===void 0?!1:z,pe=t.nested,ue=pe===void 0?!1:pe,me=t.closeOnDocumentClick,te=me===void 0?!0:me,G=t.repositionOnResize,re=G===void 0?!0:G,be=t.closeOnEscape,Le=be===void 0?!0:be,Me=t.on,J=Me===void 0?["click"]:Me,X=t.contentStyle,Y=X===void 0?{}:X,ie=t.arrowStyle,de=ie===void 0?{}:ie,we=t.overlayStyle,se=we===void 0?{}:we,ut=t.className,un=ut===void 0?"":ut,cn=t.position,tn=cn===void 0?"bottom center":cn,et=t.modal,ht=et===void 0?!1:et,Tt=t.lockScroll,kt=Tt===void 0?!1:Tt,At=t.arrow,jt=At===void 0?!0:At,Hn=t.offsetX,fn=Hn===void 0?0:Hn,kn=t.offsetY,Pn=kn===void 0?0:kn,vr=t.mouseEnterDelay,Lr=vr===void 0?100:vr,Dr=t.mouseLeaveDelay,ei=Dr===void 0?100:Dr,Nn=t.keepTooltipInside,Oi=Nn===void 0?!1:Nn,En=t.children,no=Ve.useState(L||A),Oe=no[0],ro=no[1],Wr=Ve.useRef(null),Vt=Ve.useRef(null),en=Ve.useRef(null),wi=Ve.useRef(null),Do=Ve.useRef("popup-"+ ++Tz),Qn=ht?!0:!o,ti=Ve.useRef(0);vz(function(){return Oe?(wi.current=document.activeElement,Bt(),Ze(),Jo()):bi(),function(){clearTimeout(ti.current)}},[Oe]),Ve.useEffect(function(){typeof L=="boolean"&&(L?Gr():mn())},[L,ee]);var Gr=function(ne){Oe||ee||(ro(!0),setTimeout(function(){return d(ne)},0))},mn=function(ne){var j;!Oe||ee||(ro(!1),Qn&&((j=wi.current)===null||j===void 0||j.focus()),setTimeout(function(){return c(ne)},0))},Kn=function(ne){ne==null||ne.stopPropagation(),Oe?mn(ne):Gr(ne)},Ke=function(ne){clearTimeout(ti.current),ti.current=setTimeout(function(){return Gr(ne)},Lr)},Ir=function(ne){ne==null||ne.preventDefault(),Kn()},dr=function(ne){clearTimeout(ti.current),ti.current=setTimeout(function(){return mn(ne)},ei)},Jo=function(){Qn&&kt&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},bi=function(){Qn&&kt&&(document.getElementsByTagName("body")[0].style.overflow="auto")},Ze=function(){var ne,j=Vt==null||(ne=Vt.current)===null||ne===void 0?void 0:ne.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),U=Array.prototype.slice.call(j)[0];U==null||U.focus()};Ve.useImperativeHandle(e,function(){return{open:function(){Gr()},close:function(){mn()},toggle:function(){Kn()}}});var Bt=function(){if(!(Qn||!Oe)&&!(!(Wr!=null&&Wr.current)||!(Wr!=null&&Wr.current)||!(Vt!=null&&Vt.current))){var ne=Wr.current.getBoundingClientRect(),j=Vt.current.getBoundingClientRect(),U=Sz(ne,j,tn,jt,{offsetX:fn,offsetY:Pn},Oi);if(Vt.current.style.top=U.top+window.scrollY+"px",Vt.current.style.left=U.left+window.scrollX+"px",jt&&en.current){var q,le;en.current.style.transform=U.transform,en.current.style.setProperty("-ms-transform",U.transform),en.current.style.setProperty("-webkit-transform",U.transform),en.current.style.top=((q=de.top)===null||q===void 0?void 0:q.toString())||U.arrowTop,en.current.style.left=((le=de.left)===null||le===void 0?void 0:le.toString())||U.arrowLeft}}};mz(mn,Le),_z(Vt,Oe&&Qn),gz(Bt,re),yz(o?[Vt,Wr]:[Vt],mn,te&&!ue);var Pt=function(){for(var ne={key:"T",ref:Wr,"aria-describedby":Do.current},j=Array.isArray(J)?J:[J],U=0,q=j.length;U<q;U++)switch(j[U]){case"click":ne.onClick=Kn;break;case"right-click":ne.onContextMenu=Ir;break;case"hover":ne.onMouseEnter=Ke,ne.onMouseLeave=dr;break;case"focus":ne.onFocus=Ke,ne.onBlur=dr;break}if(typeof o=="function"){var le=o(Oe);return!!o&&mr.cloneElement(le,ne)}return!!o&&mr.cloneElement(o,ne)},Cr=function(){var ne=Qn?kp.popupContent.modal:kp.popupContent.tooltip,j={className:"popup-content "+(un!==""?un.split(" ").map(function(U){return U+"-content"}).join(" "):""),style:Qp({},ne,Y,{pointerEvents:"auto"}),ref:Vt,onClick:function(q){q.stopPropagation()}};return!ht&&J.indexOf("hover")>=0&&(j.onMouseEnter=Ke,j.onMouseLeave=dr),j},xr=function(){return mr.createElement("div",Object.assign({},Cr(),{key:"C",role:Qn?"dialog":"tooltip",id:Do.current}),jt&&!Qn&&mr.createElement("div",{ref:en,style:kp.popupArrow},mr.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(un!==""?un.split(" ").map(function(ne){return ne+"-arrow"}).join(" "):""),viewBox:"0 0 32 16",style:Qp({position:"absolute"},de)},mr.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),En&&typeof En=="function"?En(mn,Oe):En)},Ot=!(J.indexOf("hover")>=0),Fi=Qn?kp.overlay.modal:kp.overlay.tooltip,Ni=[Ot&&mr.createElement("div",{key:"O","data-testid":"overlay","data-popup":Qn?"modal":"tooltip",className:"popup-overlay "+(un!==""?un.split(" ").map(function(Wt){return Wt+"-overlay"}).join(" "):""),style:Qp({},Fi,se,{pointerEvents:te&&ue||Qn?"auto":"none"}),onClick:te&&ue?mn:void 0,tabIndex:-1},Qn&&xr()),!Qn&&xr()];return mr.createElement(mr.Fragment,null,Pt(),Oe&&oL.createPortal(Ni,Ez()))}),WA={exports:{}},Cz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Az=Cz,kz=Az;function GA(){}function KA(){}KA.resetWarningCache=GA;var Pz=function(){function t(o,a,d,p,c,S){if(S!==kz){var A=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw A.name="Invariant Violation",A}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:KA,resetWarningCache:GA};return n.PropTypes=n,n};WA.exports=Pz();var Rz=WA.exports;const Np=gd(Rz);var ZA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},sT=mr.createContext&&mr.createContext(ZA),Mz=["attr","size","title"];function Lz(t,e){if(t==null)return{};var n=Dz(t,e),o,a;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(a=0;a<d.length;a++)o=d[a],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function Dz(t,e){if(t==null)return{};var n={};for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(e.indexOf(o)>=0)continue;n[o]=t[o]}return n}function hy(){return hy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},hy.apply(this,arguments)}function aT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function dy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aT(Object(n),!0).forEach(function(o){zz(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aT(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function zz(t,e,n){return e=Oz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oz(t){var e=Fz(t,"string");return typeof e=="symbol"?e:e+""}function Fz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XA(t){return t&&t.map((e,n)=>mr.createElement(e.tag,dy({key:n},e.attr),XA(e.child)))}function Lo(t){return e=>mr.createElement(Nz,hy({attr:dy({},t.attr)},e),XA(t.child))}function Nz(t){var e=n=>{var{attr:o,size:a,title:d}=t,p=Lz(t,Mz),c=a||n.size||"1em",S;return n.className&&(S=n.className),t.className&&(S=(S?S+" ":"")+t.className),mr.createElement("svg",hy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,p,{className:S,style:dy(dy({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),d&&mr.createElement("title",null,d),t.children)};return sT!==void 0?mr.createElement(sT.Consumer,null,n=>e(n)):e(ZA)}function Bz(t){return Lo({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M456.69 421.39 362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8 124.95 124.95 0 0 1-124.8-124.8z"},child:[]}]})(t)}function Vz(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},child:[]}]})(t)}function jz(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0 1 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},child:[]}]})(t)}function Uz(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"},child:[]}]})(t)}function YA(t){var e,n,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=YA(t[e]))&&(o&&(o+=" "),o+=n);else for(e in t)t[e]&&(o&&(o+=" "),o+=e);return o}function Bf(){for(var t,e,n=0,o="";n<arguments.length;)(t=arguments[n++])&&(e=YA(t))&&(o&&(o+=" "),o+=e);return o}function QA(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}let $z="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",qz=(t=21)=>{let e="",n=t;for(;n--;)e+=$z[Math.random()*64|0];return e};const Hz={pointerEvents:"none"},sw=({locked:t,style:e})=>t?{...Hz,...e}:e,JA=t=>Ve.useMemo(()=>{if(t){let e="icon";t.type==="img"?e="image":t.type==="svg"&&(e="svg");const n=new RegExp(`\\b${e}\\b`);return{iconType:t.props["data-type"]||e,icon:t.props.className&&!n.test(t.props.className)?Ve.cloneElement(t,{...t.props,className:Bf(t.props.className,e)}):t}}return{}},[t]),Wz=(t,e)=>e?!1:!t||t==="smooth"||t==="pulse",aw=(t,e)=>{const{animation:n,bigger:o,locked:a,plain:d,shape:p,variant:c,iconType:S,hasFocus:A}=t;return{"p-default":!e&&Wz(n,S),"p-bigger":o,"p-locked":a,"p-plain":d,"p-has-focus":A,[`p-${n}`]:n,[`p-${p}`]:p,[`p-${c}`]:c,[`p-${S}`]:S}},lT=t=>typeof t=="boolean",G0=t=>t==null,Gz=t=>t==="indeterminate",lw=t=>{let{checked:e,state:n,setState:o,value:a,defaultValue:d,...p}=t;return o&&((lT(n)||Gz(n))&&!lT(e)&&G0(e)?e=!!n:Array.isArray(n)?e=n.includes(a):G0(e)&&(e=Object.is(n,a)),G0(a)&&(a=d||"")),{checked:e,value:a,state:n,...p}},Kz="pcr_",Zz=()=>Ve.useRef(Kz+qz(8)).current,ek=t=>{const e=Zz(),{locked:n,color:o,variant:a,animation:d,children:p,style:c,id:S=e,className:A,bigger:D,hasFocus:L,...z}=t;return{locked:n,color:o,variant:a,animation:d,children:p,id:S,className:A,bigger:D,style:c,hasFocus:L,htmlProps:z}},tk=t=>{const{shape:e,plain:n,icon:o,indeterminate:a,hasFocus:d,...p}=t;return{shape:e,plain:n,icon:o,indeterminate:a,...ek(p)}},n_=({color:t,icon:e,id:n,children:o,...a})=>Ve.createElement("div",{className:Bf("state",t&&`p-${t}`),...a},e,Ve.createElement("label",{htmlFor:n},o));n_.displayName="State";const Xz=({checked:t,state:e,indeterminate:n})=>{const[o,a]=Ve.useState(!1),d=Ve.useRef(null);return Ve.useEffect(()=>{e!==void 0&&d.current&&a(e==="indeterminate")},[e]),Ve.useEffect(()=>{e!=="indeterminate"&&d.current&&typeof n<"u"&&(d.current.checked=n,a(n))},[n,e]),{ref:d,"aria-checked":o?"mixed":t}},nk=Ve.forwardRef((t,e)=>{const{checked:n,value:o,state:a,...d}=lw(t),{children:p,locked:c,color:S,id:A,className:D,style:L,indeterminate:z,icon:ee,htmlProps:pe}=tk(d),{ref:ue,...me}=Xz({state:a,checked:n,indeterminate:z}),te=sw({locked:c,style:L}),{icon:G,iconType:re}=JA(ee);return Ve.createElement("div",{style:te,className:Bf("pretty",aw({...t,iconType:re}),D)},Ve.createElement("input",{ref:QA([e,ue]),value:o,type:"checkbox",id:A,checked:n,...me,...pe}),Ve.createElement(n_,{id:A,icon:G,color:S},p))});nk.displayName="Checkbox";const Yz=Ve.forwardRef((t,e)=>{const{checked:n,value:o,state:a,...d}=lw(t),{shape:p="round",children:c,locked:S,color:A,id:D,className:L,style:z,icon:ee,htmlProps:pe}=tk(d),ue=sw({locked:S,style:z}),{icon:me,iconType:te}=JA(ee);return Ve.createElement("div",{style:ue,className:Bf("pretty",aw({...t,shape:p,iconType:te}),L)},Ve.createElement("input",{ref:e,value:o,type:"radio",id:D,checked:n,...pe}),Ve.createElement(n_,{id:D,icon:me,color:A},c))});Yz.displayName="Radio";const uT=t=>{t.currentTarget.setAttribute("aria-checked",t.currentTarget.checked+"")},Qz=({setState:t,checked:e})=>{const n=Ve.useRef(null);return Ve.useEffect(()=>{const o=n.current;let a=!1;return!t&&!e&&o&&(o.setAttribute("aria-checked",o.checked+""),o.addEventListener("change",uT),a=!0),()=>{a&&o&&o.removeEventListener("change",uT)}},[t,e]),n},Jz=Ve.forwardRef((t,e)=>{const{checked:n,value:o,state:a,...d}=lw(t),{children:p,locked:c,color:S,id:A,className:D,style:L,htmlProps:z}=ek(d),ee=sw({locked:c,style:L}),pe=Qz({setState:t.setState,checked:n});return Ve.createElement("div",{style:ee,className:Bf("pretty","p-switch",aw(t,!0),D)},Ve.createElement("input",{ref:QA([e,pe]),type:"checkbox",role:"switch",value:o,id:A,"aria-checked":n,checked:n,...z}),Ve.createElement(n_,{id:A,color:S},p))});Jz.displayName="Switch";function eO(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.03 2.59a1.501 1.501 0 0 1 1.94 0l7.5 6.363a1.5 1.5 0 0 1 .53 1.144V19.5a1.5 1.5 0 0 1-1.5 1.5h-5.75a.75.75 0 0 1-.75-.75V14h-2v6.25a.75.75 0 0 1-.75.75H4.5A1.5 1.5 0 0 1 3 19.5v-9.403c0-.44.194-.859.53-1.144ZM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v6.25h5v-9.403Z"},child:[]}]})(t)}function tO(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 1.75V3h5.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H8V1.75C8 .784 8.784 0 9.75 0h4.5C15.216 0 16 .784 16 1.75Zm-6.5 0V3h5V1.75a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25ZM4.997 6.178a.75.75 0 1 0-1.493.144L4.916 20.92a1.75 1.75 0 0 0 1.742 1.58h10.684a1.75 1.75 0 0 0 1.742-1.581l1.413-14.597a.75.75 0 0 0-1.494-.144l-1.412 14.596a.25.25 0 0 1-.249.226H6.658a.25.25 0 0 1-.249-.226L4.997 6.178Z"},child:[]},{tag:"path",attr:{d:"M9.206 7.501a.75.75 0 0 1 .793.705l.5 8.5A.75.75 0 1 1 9 16.794l-.5-8.5a.75.75 0 0 1 .705-.793Zm6.293.793A.75.75 0 1 0 14 8.206l-.5 8.5a.75.75 0 0 0 1.498.088l.5-8.5Z"},child:[]}]})(t)}function rk({typeFilter:t}){const[e,n]=Ve.useState(!1),[o,a]=cA(),[d]=Ve.useState(t);function p(){n(!1),t!=d&&window.location.reload()}function c(A,D){a(L=>{const z=new URLSearchParams(L),ee=z.getAll(A);if(ee.includes(D)){const pe=ee.filter(ue=>ue!==D);z.delete(A),pe.forEach(ue=>z.append(A,ue))}else z.append(A,D);return z})}function S(){a({}),window.location.reload()}return He.jsx(He.Fragment,{children:He.jsxs("div",{className:"absolute flex rounded-full top-3 left-4 bg-navColor text-white shadow-lg duration-200 hover:text-main hover:shadow-main hover:scale-110",children:[He.jsx("button",{type:"button",className:"p-3",onClick:()=>n(A=>!A),children:He.jsx("span",{children:He.jsx(Bz,{size:30})})}),He.jsx(Iz,{open:e,closeOnDocumentClick:!0,onClose:p,children:He.jsxs("div",{className:"modal relative flex flex-col items-center justify-center bg-navColor mx-auto p-4 text-white dark:bg-lightGray dark:text-appColor rounded-lg shadow-xl",children:[He.jsx("div",{className:"absolute flex rounded-full dark:border-[2px] dark:border-[#dbdbdb] top-2 right-3 shadow-sm duration-200 hover:text-main hover:shadow-main hover:scale-110",children:He.jsx("button",{type:"button",className:"p-3  dark:text-appColor ",onClick:S,children:He.jsx("span",{children:He.jsx(tO,{size:30})})})}),He.jsx("div",{className:"absolute flex rounded-full top-2 left-3 bg-navColor dark:bg-lightGray dark:text-appColor dark:border-[2px] dark:border-[#dbdbdb] cursor-pointer text-white shadow-sm duration-200 hover:text-main hover:shadow-main hover:scale-110",children:He.jsx("button",{className:"close p-3",onClick:p,children:He.jsx("span",{children:He.jsx(Uz,{size:30})})})}),He.jsxs("div",{className:"w-full flex flex-col text-lg p-4 mt-7",children:[He.jsxs("h1",{className:"text-center text-2xl mb-4",children:["Filtr ",He.jsx("span",{className:"text-main font-bold",children:"Muala"})," miejsc"]}),["polska","ukrainska","amerykanska","turecka","meksykanska"].map(A=>He.jsxs("div",{className:"flex items-center justify-between border-b border-gray-500",children:[He.jsxs("label",{className:"font-light p-3",children:["Kuchnia"," ",He.jsx("span",{className:"text-main font-bold",children:A})]}),He.jsx(nk,{animation:"jelly",color:"warning",className:"my-4",checked:t.includes(A),onChange:()=>c("category",A)})]},A))]}),He.jsx("button",{className:"mx-auto w-1/2 p-3 rounded-xl border-[2px] border-main duration-300 text-white dark:text-appColor hover:text-main hover:shadow-main hover:scale-105",onClick:()=>window.location.reload(),children:"Zapisz zmiany"})]})})]})})}rk.propTypes={typeFilter:Np.array.isRequired};var cT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=function(t){const e=[];let n=0;for(let o=0;o<t.length;o++){let a=t.charCodeAt(o);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&o+1<t.length&&(t.charCodeAt(o+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++o)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},nO=function(t){const e=[];let n=0,o=0;for(;n<t.length;){const a=t[n++];if(a<128)e[o++]=String.fromCharCode(a);else if(a>191&&a<224){const d=t[n++];e[o++]=String.fromCharCode((a&31)<<6|d&63)}else if(a>239&&a<365){const d=t[n++],p=t[n++],c=t[n++],S=((a&7)<<18|(d&63)<<12|(p&63)<<6|c&63)-65536;e[o++]=String.fromCharCode(55296+(S>>10)),e[o++]=String.fromCharCode(56320+(S&1023))}else{const d=t[n++],p=t[n++];e[o++]=String.fromCharCode((a&15)<<12|(d&63)<<6|p&63)}}return e.join("")},ok={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let a=0;a<t.length;a+=3){const d=t[a],p=a+1<t.length,c=p?t[a+1]:0,S=a+2<t.length,A=S?t[a+2]:0,D=d>>2,L=(d&3)<<4|c>>4;let z=(c&15)<<2|A>>6,ee=A&63;S||(ee=64,p||(z=64)),o.push(n[D],n[L],n[z],n[ee])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ik(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let a=0;a<t.length;){const d=n[t.charAt(a++)],c=a<t.length?n[t.charAt(a)]:0;++a;const A=a<t.length?n[t.charAt(a)]:64;++a;const L=a<t.length?n[t.charAt(a)]:64;if(++a,d==null||c==null||A==null||L==null)throw new rO;const z=d<<2|c>>4;if(o.push(z),A!==64){const ee=c<<4&240|A>>2;if(o.push(ee),L!==64){const pe=A<<6&192|L;o.push(pe)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iO=function(t){const e=ik(t);return ok.encodeByteArray(e,!0)},py=function(t){return iO(t).replace(/\./g,"")},oO=function(t){try{return ok.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=()=>sO().__FIREBASE_DEFAULTS__,lO=()=>{if(typeof process>"u"||typeof cT>"u")return;const t=cT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&oO(t[1]);return e&&JSON.parse(e)},uw=()=>{try{return aO()||lO()||uO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cO=t=>{var e,n;return(n=(e=uw())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},sk=t=>{const e=cO(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),o]:[e.substring(0,n),o]},ak=()=>{var t;return(t=uw())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,o)=>{n?this.reject(n):this.resolve(o),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,o))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},o=e||"demo-project",a=t.iat||0,d=t.sub||t.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const p=Object.assign({iss:`https://securetoken.google.com/${o}`,aud:o,iat:a,exp:a+3600,auth_time:a,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}}},t);return[py(JSON.stringify(n)),py(JSON.stringify(p)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pO(){var t;const e=(t=uw())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fO(){return!pO()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mO(){try{return typeof indexedDB=="object"}catch{return!1}}function gO(){return new Promise((t,e)=>{try{let n=!0;const o="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(o);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(o),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var d;e(((d=a.error)===null||d===void 0?void 0:d.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO="FirebaseError";class bc extends Error{constructor(e,n,o){super(n),this.code=e,this.customData=o,this.name=yO,Object.setPrototypeOf(this,bc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,uk.prototype.create)}}class uk{constructor(e,n,o){this.service=e,this.serviceName=n,this.errors=o}create(e,...n){const o=n[0]||{},a=`${this.service}/${e}`,d=this.errors[e],p=d?_O(d,o):"Error",c=`${this.serviceName}: ${p} (${a}).`;return new bc(a,c,o)}}function _O(t,e){return t.replace(vO,(n,o)=>{const a=e[o];return a!=null?String(a):`<${o}?>`})}const vO=/\{\$([^}]+)}/g;function b1(t,e){if(t===e)return!0;const n=Object.keys(t),o=Object.keys(e);for(const a of n){if(!o.includes(a))return!1;const d=t[a],p=e[a];if(hT(d)&&hT(p)){if(!b1(d,p))return!1}else if(d!==p)return!1}for(const a of o)if(!n.includes(a))return!1;return!0}function hT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(t){return t&&t._delegate?t._delegate:t}class Jh{constructor(e,n,o){this.name=e,this.instanceFactory=n,this.type=o,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const o=new hO;if(this.instancesDeferred.set(n,o),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&o.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const o=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(o)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:o})}catch(d){if(a)return null;throw d}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bO(e))try{this.getOrInitializeService({instanceIdentifier:Xu})}catch{}for(const[n,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const d=this.getOrInitializeService({instanceIdentifier:a});o.resolve(d)}catch{}}}}clearInstance(e=Xu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xu){return this.instances.has(e)}getOptions(e=Xu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(`${this.name}(${o}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:o,options:n});for(const[d,p]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(d);o===c&&p.resolve(a)}return a}onInit(e,n){var o;const a=this.normalizeInstanceIdentifier(n),d=(o=this.onInitCallbacks.get(a))!==null&&o!==void 0?o:new Set;d.add(e),this.onInitCallbacks.set(a,d);const p=this.instances.get(a);return p&&e(p,a),()=>{d.delete(e)}}invokeOnInitCallbacks(e,n){const o=this.onInitCallbacks.get(n);if(o)for(const a of o)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let o=this.instances.get(e);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:wO(e),options:n}),this.instances.set(e,o),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(o,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,o)}catch{}return o||null}normalizeInstanceIdentifier(e=Xu){return this.component?this.component.multipleInstances?e:Xu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wO(t){return t===Xu?void 0:t}function bO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new xO(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(vn||(vn={}));const TO={debug:vn.DEBUG,verbose:vn.VERBOSE,info:vn.INFO,warn:vn.WARN,error:vn.ERROR,silent:vn.SILENT},EO=vn.INFO,IO={[vn.DEBUG]:"log",[vn.VERBOSE]:"log",[vn.INFO]:"info",[vn.WARN]:"warn",[vn.ERROR]:"error"},CO=(t,e,...n)=>{if(e<t.logLevel)return;const o=new Date().toISOString(),a=IO[e];if(a)console[a](`[${o}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hk{constructor(e){this.name=e,this._logLevel=EO,this._logHandler=CO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vn.DEBUG,...e),this._logHandler(this,vn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vn.VERBOSE,...e),this._logHandler(this,vn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vn.INFO,...e),this._logHandler(this,vn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vn.WARN,...e),this._logHandler(this,vn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vn.ERROR,...e),this._logHandler(this,vn.ERROR,...e)}}const AO=(t,e)=>e.some(n=>t instanceof n);let dT,pT;function kO(){return dT||(dT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PO(){return pT||(pT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dk=new WeakMap,S1=new WeakMap,pk=new WeakMap,K0=new WeakMap,cw=new WeakMap;function RO(t){const e=new Promise((n,o)=>{const a=()=>{t.removeEventListener("success",d),t.removeEventListener("error",p)},d=()=>{n(iu(t.result)),a()},p=()=>{o(t.error),a()};t.addEventListener("success",d),t.addEventListener("error",p)});return e.then(n=>{n instanceof IDBCursor&&dk.set(n,t)}).catch(()=>{}),cw.set(e,t),e}function MO(t){if(S1.has(t))return;const e=new Promise((n,o)=>{const a=()=>{t.removeEventListener("complete",d),t.removeEventListener("error",p),t.removeEventListener("abort",p)},d=()=>{n(),a()},p=()=>{o(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",d),t.addEventListener("error",p),t.addEventListener("abort",p)});S1.set(t,e)}let T1={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return S1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||pk.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return iu(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LO(t){T1=t(T1)}function DO(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const o=t.call(Z0(this),e,...n);return pk.set(o,e.sort?e.sort():[e]),iu(o)}:PO().includes(t)?function(...e){return t.apply(Z0(this),e),iu(dk.get(this))}:function(...e){return iu(t.apply(Z0(this),e))}}function zO(t){return typeof t=="function"?DO(t):(t instanceof IDBTransaction&&MO(t),AO(t,kO())?new Proxy(t,T1):t)}function iu(t){if(t instanceof IDBRequest)return RO(t);if(K0.has(t))return K0.get(t);const e=zO(t);return e!==t&&(K0.set(t,e),cw.set(e,t)),e}const Z0=t=>cw.get(t);function OO(t,e,{blocked:n,upgrade:o,blocking:a,terminated:d}={}){const p=indexedDB.open(t,e),c=iu(p);return o&&p.addEventListener("upgradeneeded",S=>{o(iu(p.result),S.oldVersion,S.newVersion,iu(p.transaction),S)}),n&&p.addEventListener("blocked",S=>n(S.oldVersion,S.newVersion,S)),c.then(S=>{d&&S.addEventListener("close",()=>d()),a&&S.addEventListener("versionchange",A=>a(A.oldVersion,A.newVersion,A))}).catch(()=>{}),c}const FO=["get","getKey","getAll","getAllKeys","count"],NO=["put","add","delete","clear"],X0=new Map;function fT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(X0.get(e))return X0.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,a=NO.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(a||FO.includes(n)))return;const d=async function(p,...c){const S=this.transaction(p,a?"readwrite":"readonly");let A=S.store;return o&&(A=A.index(c.shift())),(await Promise.all([A[n](...c),a&&S.done]))[0]};return X0.set(e,d),d}LO(t=>({...t,get:(e,n,o)=>fT(e,n)||t.get(e,n,o),has:(e,n)=>!!fT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VO(n)){const o=n.getImmediate();return`${o.library}/${o.version}`}else return null}).filter(n=>n).join(" ")}}function VO(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const E1="@firebase/app",mT="0.10.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc=new hk("@firebase/app"),jO="@firebase/app-compat",UO="@firebase/analytics-compat",$O="@firebase/analytics",qO="@firebase/app-check-compat",HO="@firebase/app-check",WO="@firebase/auth",GO="@firebase/auth-compat",KO="@firebase/database",ZO="@firebase/database-compat",XO="@firebase/functions",YO="@firebase/functions-compat",QO="@firebase/installations",JO="@firebase/installations-compat",e6="@firebase/messaging",t6="@firebase/messaging-compat",n6="@firebase/performance",r6="@firebase/performance-compat",i6="@firebase/remote-config",o6="@firebase/remote-config-compat",s6="@firebase/storage",a6="@firebase/storage-compat",l6="@firebase/firestore",u6="@firebase/vertexai-preview",c6="@firebase/firestore-compat",h6="firebase",d6="10.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1="[DEFAULT]",p6={[E1]:"fire-core",[jO]:"fire-core-compat",[$O]:"fire-analytics",[UO]:"fire-analytics-compat",[HO]:"fire-app-check",[qO]:"fire-app-check-compat",[WO]:"fire-auth",[GO]:"fire-auth-compat",[KO]:"fire-rtdb",[ZO]:"fire-rtdb-compat",[XO]:"fire-fn",[YO]:"fire-fn-compat",[QO]:"fire-iid",[JO]:"fire-iid-compat",[e6]:"fire-fcm",[t6]:"fire-fcm-compat",[n6]:"fire-perf",[r6]:"fire-perf-compat",[i6]:"fire-rc",[o6]:"fire-rc-compat",[s6]:"fire-gcs",[a6]:"fire-gcs-compat",[l6]:"fire-fst",[c6]:"fire-fst-compat",[u6]:"fire-vertex","fire-js":"fire-js",[h6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy=new Map,f6=new Map,C1=new Map;function gT(t,e){try{t.container.addComponent(e)}catch(n){mc.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Tf(t){const e=t.name;if(C1.has(e))return mc.debug(`There were multiple attempts to register component ${e}.`),!1;C1.set(e,t);for(const n of fy.values())gT(n,t);for(const n of f6.values())gT(n,t);return!0}function fk(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ou=new uk("app","Firebase",m6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,n,o){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=o,this.container.addComponent(new Jh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ou.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=d6;function gk(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const o=Object.assign({name:I1,automaticDataCollectionEnabled:!1},e),a=o.name;if(typeof a!="string"||!a)throw ou.create("bad-app-name",{appName:String(a)});if(n||(n=ak()),!n)throw ou.create("no-options");const d=fy.get(a);if(d){if(b1(n,d.options)&&b1(o,d.config))return d;throw ou.create("duplicate-app",{appName:a})}const p=new SO(a);for(const S of C1.values())p.addComponent(S);const c=new g6(n,o,p);return fy.set(a,c),c}function yk(t=I1){const e=fy.get(t);if(!e&&t===I1&&ak())return gk();if(!e)throw ou.create("no-app",{appName:t});return e}function su(t,e,n){var o;let a=(o=p6[t])!==null&&o!==void 0?o:t;n&&(a+=`-${n}`);const d=a.match(/\s|\//),p=e.match(/\s|\//);if(d||p){const c=[`Unable to register library "${a}" with version "${e}":`];d&&c.push(`library name "${a}" contains illegal characters (whitespace or "/")`),d&&p&&c.push("and"),p&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mc.warn(c.join(" "));return}Tf(new Jh(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6="firebase-heartbeat-database",_6=1,Ef="firebase-heartbeat-store";let Y0=null;function _k(){return Y0||(Y0=OO(y6,_6,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ef)}catch(n){console.warn(n)}}}}).catch(t=>{throw ou.create("idb-open",{originalErrorMessage:t.message})})),Y0}async function v6(t){try{const n=(await _k()).transaction(Ef),o=await n.objectStore(Ef).get(vk(t));return await n.done,o}catch(e){if(e instanceof bc)mc.warn(e.message);else{const n=ou.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mc.warn(n.message)}}}async function yT(t,e){try{const o=(await _k()).transaction(Ef,"readwrite");await o.objectStore(Ef).put(e,vk(t)),await o.done}catch(n){if(n instanceof bc)mc.warn(n.message);else{const o=ou.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});mc.warn(o.message)}}}function vk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6=1024,w6=30*24*60*60*1e3;class b6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new T6(n),this._heartbeatsCachePromise=this._storage.read().then(o=>(this._heartbeatsCache=o,o))}async triggerHeartbeat(){var e,n;const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=_T();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(p=>p.date===d)))return this._heartbeatsCache.heartbeats.push({date:d,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(p=>{const c=new Date(p.date).valueOf();return Date.now()-c<=w6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=_T(),{heartbeatsToSend:o,unsentEntries:a}=S6(this._heartbeatsCache.heartbeats),d=py(JSON.stringify({version:2,heartbeats:o}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}}function _T(){return new Date().toISOString().substring(0,10)}function S6(t,e=x6){const n=[];let o=t.slice();for(const a of t){const d=n.find(p=>p.agent===a.agent);if(d){if(d.dates.push(a.date),vT(n)>e){d.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),vT(n)>e){n.pop();break}o=o.slice(1)}return{heartbeatsToSend:n,unsentEntries:o}}class T6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mO()?gO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await v6(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return yT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return yT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function vT(t){return py(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E6(t){Tf(new Jh("platform-logger",e=>new BO(e),"PRIVATE")),Tf(new Jh("heartbeat",e=>new b6(e),"PRIVATE")),su(E1,mT,t),su(E1,mT,"esm2017"),su("fire-js","")}E6("");var xT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var oc,xk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(J,X){function Y(){}Y.prototype=X.prototype,J.D=X.prototype,J.prototype=new Y,J.prototype.constructor=J,J.C=function(ie,de,we){for(var se=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)se[ut-2]=arguments[ut];return X.prototype[de].apply(ie,se)}}function n(){this.blockSize=-1}function o(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(o,n),o.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(J,X,Y){Y||(Y=0);var ie=Array(16);if(typeof X=="string")for(var de=0;16>de;++de)ie[de]=X.charCodeAt(Y++)|X.charCodeAt(Y++)<<8|X.charCodeAt(Y++)<<16|X.charCodeAt(Y++)<<24;else for(de=0;16>de;++de)ie[de]=X[Y++]|X[Y++]<<8|X[Y++]<<16|X[Y++]<<24;X=J.g[0],Y=J.g[1],de=J.g[2];var we=J.g[3],se=X+(we^Y&(de^we))+ie[0]+3614090360&4294967295;X=Y+(se<<7&4294967295|se>>>25),se=we+(de^X&(Y^de))+ie[1]+3905402710&4294967295,we=X+(se<<12&4294967295|se>>>20),se=de+(Y^we&(X^Y))+ie[2]+606105819&4294967295,de=we+(se<<17&4294967295|se>>>15),se=Y+(X^de&(we^X))+ie[3]+3250441966&4294967295,Y=de+(se<<22&4294967295|se>>>10),se=X+(we^Y&(de^we))+ie[4]+4118548399&4294967295,X=Y+(se<<7&4294967295|se>>>25),se=we+(de^X&(Y^de))+ie[5]+1200080426&4294967295,we=X+(se<<12&4294967295|se>>>20),se=de+(Y^we&(X^Y))+ie[6]+2821735955&4294967295,de=we+(se<<17&4294967295|se>>>15),se=Y+(X^de&(we^X))+ie[7]+4249261313&4294967295,Y=de+(se<<22&4294967295|se>>>10),se=X+(we^Y&(de^we))+ie[8]+1770035416&4294967295,X=Y+(se<<7&4294967295|se>>>25),se=we+(de^X&(Y^de))+ie[9]+2336552879&4294967295,we=X+(se<<12&4294967295|se>>>20),se=de+(Y^we&(X^Y))+ie[10]+4294925233&4294967295,de=we+(se<<17&4294967295|se>>>15),se=Y+(X^de&(we^X))+ie[11]+2304563134&4294967295,Y=de+(se<<22&4294967295|se>>>10),se=X+(we^Y&(de^we))+ie[12]+1804603682&4294967295,X=Y+(se<<7&4294967295|se>>>25),se=we+(de^X&(Y^de))+ie[13]+4254626195&4294967295,we=X+(se<<12&4294967295|se>>>20),se=de+(Y^we&(X^Y))+ie[14]+2792965006&4294967295,de=we+(se<<17&4294967295|se>>>15),se=Y+(X^de&(we^X))+ie[15]+1236535329&4294967295,Y=de+(se<<22&4294967295|se>>>10),se=X+(de^we&(Y^de))+ie[1]+4129170786&4294967295,X=Y+(se<<5&4294967295|se>>>27),se=we+(Y^de&(X^Y))+ie[6]+3225465664&4294967295,we=X+(se<<9&4294967295|se>>>23),se=de+(X^Y&(we^X))+ie[11]+643717713&4294967295,de=we+(se<<14&4294967295|se>>>18),se=Y+(we^X&(de^we))+ie[0]+3921069994&4294967295,Y=de+(se<<20&4294967295|se>>>12),se=X+(de^we&(Y^de))+ie[5]+3593408605&4294967295,X=Y+(se<<5&4294967295|se>>>27),se=we+(Y^de&(X^Y))+ie[10]+38016083&4294967295,we=X+(se<<9&4294967295|se>>>23),se=de+(X^Y&(we^X))+ie[15]+3634488961&4294967295,de=we+(se<<14&4294967295|se>>>18),se=Y+(we^X&(de^we))+ie[4]+3889429448&4294967295,Y=de+(se<<20&4294967295|se>>>12),se=X+(de^we&(Y^de))+ie[9]+568446438&4294967295,X=Y+(se<<5&4294967295|se>>>27),se=we+(Y^de&(X^Y))+ie[14]+3275163606&4294967295,we=X+(se<<9&4294967295|se>>>23),se=de+(X^Y&(we^X))+ie[3]+4107603335&4294967295,de=we+(se<<14&4294967295|se>>>18),se=Y+(we^X&(de^we))+ie[8]+1163531501&4294967295,Y=de+(se<<20&4294967295|se>>>12),se=X+(de^we&(Y^de))+ie[13]+2850285829&4294967295,X=Y+(se<<5&4294967295|se>>>27),se=we+(Y^de&(X^Y))+ie[2]+4243563512&4294967295,we=X+(se<<9&4294967295|se>>>23),se=de+(X^Y&(we^X))+ie[7]+1735328473&4294967295,de=we+(se<<14&4294967295|se>>>18),se=Y+(we^X&(de^we))+ie[12]+2368359562&4294967295,Y=de+(se<<20&4294967295|se>>>12),se=X+(Y^de^we)+ie[5]+4294588738&4294967295,X=Y+(se<<4&4294967295|se>>>28),se=we+(X^Y^de)+ie[8]+2272392833&4294967295,we=X+(se<<11&4294967295|se>>>21),se=de+(we^X^Y)+ie[11]+1839030562&4294967295,de=we+(se<<16&4294967295|se>>>16),se=Y+(de^we^X)+ie[14]+4259657740&4294967295,Y=de+(se<<23&4294967295|se>>>9),se=X+(Y^de^we)+ie[1]+2763975236&4294967295,X=Y+(se<<4&4294967295|se>>>28),se=we+(X^Y^de)+ie[4]+1272893353&4294967295,we=X+(se<<11&4294967295|se>>>21),se=de+(we^X^Y)+ie[7]+4139469664&4294967295,de=we+(se<<16&4294967295|se>>>16),se=Y+(de^we^X)+ie[10]+3200236656&4294967295,Y=de+(se<<23&4294967295|se>>>9),se=X+(Y^de^we)+ie[13]+681279174&4294967295,X=Y+(se<<4&4294967295|se>>>28),se=we+(X^Y^de)+ie[0]+3936430074&4294967295,we=X+(se<<11&4294967295|se>>>21),se=de+(we^X^Y)+ie[3]+3572445317&4294967295,de=we+(se<<16&4294967295|se>>>16),se=Y+(de^we^X)+ie[6]+76029189&4294967295,Y=de+(se<<23&4294967295|se>>>9),se=X+(Y^de^we)+ie[9]+3654602809&4294967295,X=Y+(se<<4&4294967295|se>>>28),se=we+(X^Y^de)+ie[12]+3873151461&4294967295,we=X+(se<<11&4294967295|se>>>21),se=de+(we^X^Y)+ie[15]+530742520&4294967295,de=we+(se<<16&4294967295|se>>>16),se=Y+(de^we^X)+ie[2]+3299628645&4294967295,Y=de+(se<<23&4294967295|se>>>9),se=X+(de^(Y|~we))+ie[0]+4096336452&4294967295,X=Y+(se<<6&4294967295|se>>>26),se=we+(Y^(X|~de))+ie[7]+1126891415&4294967295,we=X+(se<<10&4294967295|se>>>22),se=de+(X^(we|~Y))+ie[14]+2878612391&4294967295,de=we+(se<<15&4294967295|se>>>17),se=Y+(we^(de|~X))+ie[5]+4237533241&4294967295,Y=de+(se<<21&4294967295|se>>>11),se=X+(de^(Y|~we))+ie[12]+1700485571&4294967295,X=Y+(se<<6&4294967295|se>>>26),se=we+(Y^(X|~de))+ie[3]+2399980690&4294967295,we=X+(se<<10&4294967295|se>>>22),se=de+(X^(we|~Y))+ie[10]+4293915773&4294967295,de=we+(se<<15&4294967295|se>>>17),se=Y+(we^(de|~X))+ie[1]+2240044497&4294967295,Y=de+(se<<21&4294967295|se>>>11),se=X+(de^(Y|~we))+ie[8]+1873313359&4294967295,X=Y+(se<<6&4294967295|se>>>26),se=we+(Y^(X|~de))+ie[15]+4264355552&4294967295,we=X+(se<<10&4294967295|se>>>22),se=de+(X^(we|~Y))+ie[6]+2734768916&4294967295,de=we+(se<<15&4294967295|se>>>17),se=Y+(we^(de|~X))+ie[13]+1309151649&4294967295,Y=de+(se<<21&4294967295|se>>>11),se=X+(de^(Y|~we))+ie[4]+4149444226&4294967295,X=Y+(se<<6&4294967295|se>>>26),se=we+(Y^(X|~de))+ie[11]+3174756917&4294967295,we=X+(se<<10&4294967295|se>>>22),se=de+(X^(we|~Y))+ie[2]+718787259&4294967295,de=we+(se<<15&4294967295|se>>>17),se=Y+(we^(de|~X))+ie[9]+3951481745&4294967295,J.g[0]=J.g[0]+X&4294967295,J.g[1]=J.g[1]+(de+(se<<21&4294967295|se>>>11))&4294967295,J.g[2]=J.g[2]+de&4294967295,J.g[3]=J.g[3]+we&4294967295}o.prototype.u=function(J,X){X===void 0&&(X=J.length);for(var Y=X-this.blockSize,ie=this.B,de=this.h,we=0;we<X;){if(de==0)for(;we<=Y;)a(this,J,we),we+=this.blockSize;if(typeof J=="string"){for(;we<X;)if(ie[de++]=J.charCodeAt(we++),de==this.blockSize){a(this,ie),de=0;break}}else for(;we<X;)if(ie[de++]=J[we++],de==this.blockSize){a(this,ie),de=0;break}}this.h=de,this.o+=X},o.prototype.v=function(){var J=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);J[0]=128;for(var X=1;X<J.length-8;++X)J[X]=0;var Y=8*this.o;for(X=J.length-8;X<J.length;++X)J[X]=Y&255,Y/=256;for(this.u(J),J=Array(16),X=Y=0;4>X;++X)for(var ie=0;32>ie;ie+=8)J[Y++]=this.g[X]>>>ie&255;return J};function d(J,X){var Y=c;return Object.prototype.hasOwnProperty.call(Y,J)?Y[J]:Y[J]=X(J)}function p(J,X){this.h=X;for(var Y=[],ie=!0,de=J.length-1;0<=de;de--){var we=J[de]|0;ie&&we==X||(Y[de]=we,ie=!1)}this.g=Y}var c={};function S(J){return-128<=J&&128>J?d(J,function(X){return new p([X|0],0>X?-1:0)}):new p([J|0],0>J?-1:0)}function A(J){if(isNaN(J)||!isFinite(J))return L;if(0>J)return me(A(-J));for(var X=[],Y=1,ie=0;J>=Y;ie++)X[ie]=J/Y|0,Y*=4294967296;return new p(X,0)}function D(J,X){if(J.length==0)throw Error("number format error: empty string");if(X=X||10,2>X||36<X)throw Error("radix out of range: "+X);if(J.charAt(0)=="-")return me(D(J.substring(1),X));if(0<=J.indexOf("-"))throw Error('number format error: interior "-" character');for(var Y=A(Math.pow(X,8)),ie=L,de=0;de<J.length;de+=8){var we=Math.min(8,J.length-de),se=parseInt(J.substring(de,de+we),X);8>we?(we=A(Math.pow(X,we)),ie=ie.j(we).add(A(se))):(ie=ie.j(Y),ie=ie.add(A(se)))}return ie}var L=S(0),z=S(1),ee=S(16777216);t=p.prototype,t.m=function(){if(ue(this))return-me(this).m();for(var J=0,X=1,Y=0;Y<this.g.length;Y++){var ie=this.i(Y);J+=(0<=ie?ie:4294967296+ie)*X,X*=4294967296}return J},t.toString=function(J){if(J=J||10,2>J||36<J)throw Error("radix out of range: "+J);if(pe(this))return"0";if(ue(this))return"-"+me(this).toString(J);for(var X=A(Math.pow(J,6)),Y=this,ie="";;){var de=be(Y,X).g;Y=te(Y,de.j(X));var we=((0<Y.g.length?Y.g[0]:Y.h)>>>0).toString(J);if(Y=de,pe(Y))return we+ie;for(;6>we.length;)we="0"+we;ie=we+ie}},t.i=function(J){return 0>J?0:J<this.g.length?this.g[J]:this.h};function pe(J){if(J.h!=0)return!1;for(var X=0;X<J.g.length;X++)if(J.g[X]!=0)return!1;return!0}function ue(J){return J.h==-1}t.l=function(J){return J=te(this,J),ue(J)?-1:pe(J)?0:1};function me(J){for(var X=J.g.length,Y=[],ie=0;ie<X;ie++)Y[ie]=~J.g[ie];return new p(Y,~J.h).add(z)}t.abs=function(){return ue(this)?me(this):this},t.add=function(J){for(var X=Math.max(this.g.length,J.g.length),Y=[],ie=0,de=0;de<=X;de++){var we=ie+(this.i(de)&65535)+(J.i(de)&65535),se=(we>>>16)+(this.i(de)>>>16)+(J.i(de)>>>16);ie=se>>>16,we&=65535,se&=65535,Y[de]=se<<16|we}return new p(Y,Y[Y.length-1]&-2147483648?-1:0)};function te(J,X){return J.add(me(X))}t.j=function(J){if(pe(this)||pe(J))return L;if(ue(this))return ue(J)?me(this).j(me(J)):me(me(this).j(J));if(ue(J))return me(this.j(me(J)));if(0>this.l(ee)&&0>J.l(ee))return A(this.m()*J.m());for(var X=this.g.length+J.g.length,Y=[],ie=0;ie<2*X;ie++)Y[ie]=0;for(ie=0;ie<this.g.length;ie++)for(var de=0;de<J.g.length;de++){var we=this.i(ie)>>>16,se=this.i(ie)&65535,ut=J.i(de)>>>16,un=J.i(de)&65535;Y[2*ie+2*de]+=se*un,G(Y,2*ie+2*de),Y[2*ie+2*de+1]+=we*un,G(Y,2*ie+2*de+1),Y[2*ie+2*de+1]+=se*ut,G(Y,2*ie+2*de+1),Y[2*ie+2*de+2]+=we*ut,G(Y,2*ie+2*de+2)}for(ie=0;ie<X;ie++)Y[ie]=Y[2*ie+1]<<16|Y[2*ie];for(ie=X;ie<2*X;ie++)Y[ie]=0;return new p(Y,0)};function G(J,X){for(;(J[X]&65535)!=J[X];)J[X+1]+=J[X]>>>16,J[X]&=65535,X++}function re(J,X){this.g=J,this.h=X}function be(J,X){if(pe(X))throw Error("division by zero");if(pe(J))return new re(L,L);if(ue(J))return X=be(me(J),X),new re(me(X.g),me(X.h));if(ue(X))return X=be(J,me(X)),new re(me(X.g),X.h);if(30<J.g.length){if(ue(J)||ue(X))throw Error("slowDivide_ only works with positive integers.");for(var Y=z,ie=X;0>=ie.l(J);)Y=Le(Y),ie=Le(ie);var de=Me(Y,1),we=Me(ie,1);for(ie=Me(ie,2),Y=Me(Y,2);!pe(ie);){var se=we.add(ie);0>=se.l(J)&&(de=de.add(Y),we=se),ie=Me(ie,1),Y=Me(Y,1)}return X=te(J,de.j(X)),new re(de,X)}for(de=L;0<=J.l(X);){for(Y=Math.max(1,Math.floor(J.m()/X.m())),ie=Math.ceil(Math.log(Y)/Math.LN2),ie=48>=ie?1:Math.pow(2,ie-48),we=A(Y),se=we.j(X);ue(se)||0<se.l(J);)Y-=ie,we=A(Y),se=we.j(X);pe(we)&&(we=z),de=de.add(we),J=te(J,se)}return new re(de,J)}t.A=function(J){return be(this,J).h},t.and=function(J){for(var X=Math.max(this.g.length,J.g.length),Y=[],ie=0;ie<X;ie++)Y[ie]=this.i(ie)&J.i(ie);return new p(Y,this.h&J.h)},t.or=function(J){for(var X=Math.max(this.g.length,J.g.length),Y=[],ie=0;ie<X;ie++)Y[ie]=this.i(ie)|J.i(ie);return new p(Y,this.h|J.h)},t.xor=function(J){for(var X=Math.max(this.g.length,J.g.length),Y=[],ie=0;ie<X;ie++)Y[ie]=this.i(ie)^J.i(ie);return new p(Y,this.h^J.h)};function Le(J){for(var X=J.g.length+1,Y=[],ie=0;ie<X;ie++)Y[ie]=J.i(ie)<<1|J.i(ie-1)>>>31;return new p(Y,J.h)}function Me(J,X){var Y=X>>5;X%=32;for(var ie=J.g.length-Y,de=[],we=0;we<ie;we++)de[we]=0<X?J.i(we+Y)>>>X|J.i(we+Y+1)<<32-X:J.i(we+Y);return new p(de,J.h)}o.prototype.digest=o.prototype.v,o.prototype.reset=o.prototype.s,o.prototype.update=o.prototype.u,xk=o,p.prototype.add=p.prototype.add,p.prototype.multiply=p.prototype.j,p.prototype.modulo=p.prototype.A,p.prototype.compare=p.prototype.l,p.prototype.toNumber=p.prototype.m,p.prototype.toString=p.prototype.toString,p.prototype.getBits=p.prototype.i,p.fromNumber=A,p.fromString=D,oc=p}).apply(typeof xT<"u"?xT:typeof self<"u"?self:typeof window<"u"?window:{});var ng=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wk,bk,Bp,Sk,Ig,A1,Tk,Ek,Ik;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,P,F){return w==Array.prototype||w==Object.prototype||(w[P]=F.value),w};function n(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof ng=="object"&&ng];for(var P=0;P<w.length;++P){var F=w[P];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var o=n(this);function a(w,P){if(P)e:{var F=o;w=w.split(".");for(var Q=0;Q<w.length-1;Q++){var Se=w[Q];if(!(Se in F))break e;F=F[Se]}w=w[w.length-1],Q=F[w],P=P(Q),P!=Q&&P!=null&&e(F,w,{configurable:!0,writable:!0,value:P})}}function d(w,P){w instanceof String&&(w+="");var F=0,Q=!1,Se={next:function(){if(!Q&&F<w.length){var Fe=F++;return{value:P(Fe,w[Fe]),done:!1}}return Q=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}a("Array.prototype.values",function(w){return w||function(){return d(this,function(P,F){return F})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var p=p||{},c=this||self;function S(w){var P=typeof w;return P=P!="object"?P:w?Array.isArray(w)?"array":P:"null",P=="array"||P=="object"&&typeof w.length=="number"}function A(w){var P=typeof w;return P=="object"&&w!=null||P=="function"}function D(w,P,F){return w.call.apply(w.bind,arguments)}function L(w,P,F){if(!w)throw Error();if(2<arguments.length){var Q=Array.prototype.slice.call(arguments,2);return function(){var Se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Se,Q),w.apply(P,Se)}}return function(){return w.apply(P,arguments)}}function z(w,P,F){return z=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?D:L,z.apply(null,arguments)}function ee(w,P){var F=Array.prototype.slice.call(arguments,1);return function(){var Q=F.slice();return Q.push.apply(Q,arguments),w.apply(this,Q)}}function pe(w,P){function F(){}F.prototype=P.prototype,w.aa=P.prototype,w.prototype=new F,w.prototype.constructor=w,w.Qb=function(Q,Se,Fe){for(var We=Array(arguments.length-2),Lt=2;Lt<arguments.length;Lt++)We[Lt-2]=arguments[Lt];return P.prototype[Se].apply(Q,We)}}function ue(w){const P=w.length;if(0<P){const F=Array(P);for(let Q=0;Q<P;Q++)F[Q]=w[Q];return F}return[]}function me(w,P){for(let F=1;F<arguments.length;F++){const Q=arguments[F];if(S(Q)){const Se=w.length||0,Fe=Q.length||0;w.length=Se+Fe;for(let We=0;We<Fe;We++)w[Se+We]=Q[We]}else w.push(Q)}}class te{constructor(P,F){this.i=P,this.j=F,this.h=0,this.g=null}get(){let P;return 0<this.h?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function G(w){return/^[\s\xa0]*$/.test(w)}function re(){var w=c.navigator;return w&&(w=w.userAgent)?w:""}function be(w){return be[" "](w),w}be[" "]=function(){};var Le=re().indexOf("Gecko")!=-1&&!(re().toLowerCase().indexOf("webkit")!=-1&&re().indexOf("Edge")==-1)&&!(re().indexOf("Trident")!=-1||re().indexOf("MSIE")!=-1)&&re().indexOf("Edge")==-1;function Me(w,P,F){for(const Q in w)P.call(F,w[Q],Q,w)}function J(w,P){for(const F in w)P.call(void 0,w[F],F,w)}function X(w){const P={};for(const F in w)P[F]=w[F];return P}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(w,P){let F,Q;for(let Se=1;Se<arguments.length;Se++){Q=arguments[Se];for(F in Q)w[F]=Q[F];for(let Fe=0;Fe<Y.length;Fe++)F=Y[Fe],Object.prototype.hasOwnProperty.call(Q,F)&&(w[F]=Q[F])}}function de(w){var P=1;w=w.split(":");const F=[];for(;0<P&&w.length;)F.push(w.shift()),P--;return w.length&&F.push(w.join(":")),F}function we(w){c.setTimeout(()=>{throw w},0)}function se(){var w=ht;let P=null;return w.g&&(P=w.g,w.g=w.g.next,w.g||(w.h=null),P.next=null),P}class ut{constructor(){this.h=this.g=null}add(P,F){const Q=un.get();Q.set(P,F),this.h?this.h.next=Q:this.g=Q,this.h=Q}}var un=new te(()=>new cn,w=>w.reset());class cn{constructor(){this.next=this.g=this.h=null}set(P,F){this.h=P,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let tn,et=!1,ht=new ut,Tt=()=>{const w=c.Promise.resolve(void 0);tn=()=>{w.then(kt)}};var kt=()=>{for(var w;w=se();){try{w.h.call(w.g)}catch(F){we(F)}var P=un;P.j(w),100>P.h&&(P.h++,w.next=P.g,P.g=w)}et=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function jt(w,P){this.type=w,this.g=this.target=P,this.defaultPrevented=!1}jt.prototype.h=function(){this.defaultPrevented=!0};var Hn=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var w=!1,P=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const F=()=>{};c.addEventListener("test",F,P),c.removeEventListener("test",F,P)}catch{}return w}();function fn(w,P){if(jt.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var F=this.type=w.type,Q=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=P,P=w.relatedTarget){if(Le){e:{try{be(P.nodeName);var Se=!0;break e}catch{}Se=!1}Se||(P=null)}}else F=="mouseover"?P=w.fromElement:F=="mouseout"&&(P=w.toElement);this.relatedTarget=P,Q?(this.clientX=Q.clientX!==void 0?Q.clientX:Q.pageX,this.clientY=Q.clientY!==void 0?Q.clientY:Q.pageY,this.screenX=Q.screenX||0,this.screenY=Q.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:kn[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&fn.aa.h.call(this)}}pe(fn,jt);var kn={2:"touch",3:"pen",4:"mouse"};fn.prototype.h=function(){fn.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var Pn="closure_listenable_"+(1e6*Math.random()|0),vr=0;function Lr(w,P,F,Q,Se){this.listener=w,this.proxy=null,this.src=P,this.type=F,this.capture=!!Q,this.ha=Se,this.key=++vr,this.da=this.fa=!1}function Dr(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function ei(w){this.src=w,this.g={},this.h=0}ei.prototype.add=function(w,P,F,Q,Se){var Fe=w.toString();w=this.g[Fe],w||(w=this.g[Fe]=[],this.h++);var We=Oi(w,P,Q,Se);return-1<We?(P=w[We],F||(P.fa=!1)):(P=new Lr(P,this.src,Fe,!!Q,Se),P.fa=F,w.push(P)),P};function Nn(w,P){var F=P.type;if(F in w.g){var Q=w.g[F],Se=Array.prototype.indexOf.call(Q,P,void 0),Fe;(Fe=0<=Se)&&Array.prototype.splice.call(Q,Se,1),Fe&&(Dr(P),w.g[F].length==0&&(delete w.g[F],w.h--))}}function Oi(w,P,F,Q){for(var Se=0;Se<w.length;++Se){var Fe=w[Se];if(!Fe.da&&Fe.listener==P&&Fe.capture==!!F&&Fe.ha==Q)return Se}return-1}var En="closure_lm_"+(1e6*Math.random()|0),no={};function Oe(w,P,F,Q,Se){if(Array.isArray(P)){for(var Fe=0;Fe<P.length;Fe++)Oe(w,P[Fe],F,Q,Se);return null}return F=Gr(F),w&&w[Pn]?w.K(P,F,A(Q)?!!Q.capture:!!Q,Se):ro(w,P,F,!1,Q,Se)}function ro(w,P,F,Q,Se,Fe){if(!P)throw Error("Invalid event type");var We=A(Se)?!!Se.capture:!!Se,Lt=Qn(w);if(Lt||(w[En]=Lt=new ei(w)),F=Lt.add(P,F,Q,We,Fe),F.proxy)return F;if(Q=Wr(),F.proxy=Q,Q.src=w,Q.listener=F,w.addEventListener)Hn||(Se=We),Se===void 0&&(Se=!1),w.addEventListener(P.toString(),Q,Se);else if(w.attachEvent)w.attachEvent(wi(P.toString()),Q);else if(w.addListener&&w.removeListener)w.addListener(Q);else throw Error("addEventListener and attachEvent are unavailable.");return F}function Wr(){function w(F){return P.call(w.src,w.listener,F)}const P=Do;return w}function Vt(w,P,F,Q,Se){if(Array.isArray(P))for(var Fe=0;Fe<P.length;Fe++)Vt(w,P[Fe],F,Q,Se);else Q=A(Q)?!!Q.capture:!!Q,F=Gr(F),w&&w[Pn]?(w=w.i,P=String(P).toString(),P in w.g&&(Fe=w.g[P],F=Oi(Fe,F,Q,Se),-1<F&&(Dr(Fe[F]),Array.prototype.splice.call(Fe,F,1),Fe.length==0&&(delete w.g[P],w.h--)))):w&&(w=Qn(w))&&(P=w.g[P.toString()],w=-1,P&&(w=Oi(P,F,Q,Se)),(F=-1<w?P[w]:null)&&en(F))}function en(w){if(typeof w!="number"&&w&&!w.da){var P=w.src;if(P&&P[Pn])Nn(P.i,w);else{var F=w.type,Q=w.proxy;P.removeEventListener?P.removeEventListener(F,Q,w.capture):P.detachEvent?P.detachEvent(wi(F),Q):P.addListener&&P.removeListener&&P.removeListener(Q),(F=Qn(P))?(Nn(F,w),F.h==0&&(F.src=null,P[En]=null)):Dr(w)}}}function wi(w){return w in no?no[w]:no[w]="on"+w}function Do(w,P){if(w.da)w=!0;else{P=new fn(P,this);var F=w.listener,Q=w.ha||w.src;w.fa&&en(w),w=F.call(Q,P)}return w}function Qn(w){return w=w[En],w instanceof ei?w:null}var ti="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gr(w){return typeof w=="function"?w:(w[ti]||(w[ti]=function(P){return w.handleEvent(P)}),w[ti])}function mn(){At.call(this),this.i=new ei(this),this.M=this,this.F=null}pe(mn,At),mn.prototype[Pn]=!0,mn.prototype.removeEventListener=function(w,P,F,Q){Vt(this,w,P,F,Q)};function Kn(w,P){var F,Q=w.F;if(Q)for(F=[];Q;Q=Q.F)F.push(Q);if(w=w.M,Q=P.type||P,typeof P=="string")P=new jt(P,w);else if(P instanceof jt)P.target=P.target||w;else{var Se=P;P=new jt(Q,w),ie(P,Se)}if(Se=!0,F)for(var Fe=F.length-1;0<=Fe;Fe--){var We=P.g=F[Fe];Se=Ke(We,Q,!0,P)&&Se}if(We=P.g=w,Se=Ke(We,Q,!0,P)&&Se,Se=Ke(We,Q,!1,P)&&Se,F)for(Fe=0;Fe<F.length;Fe++)We=P.g=F[Fe],Se=Ke(We,Q,!1,P)&&Se}mn.prototype.N=function(){if(mn.aa.N.call(this),this.i){var w=this.i,P;for(P in w.g){for(var F=w.g[P],Q=0;Q<F.length;Q++)Dr(F[Q]);delete w.g[P],w.h--}}this.F=null},mn.prototype.K=function(w,P,F,Q){return this.i.add(String(w),P,!1,F,Q)},mn.prototype.L=function(w,P,F,Q){return this.i.add(String(w),P,!0,F,Q)};function Ke(w,P,F,Q){if(P=w.i.g[String(P)],!P)return!0;P=P.concat();for(var Se=!0,Fe=0;Fe<P.length;++Fe){var We=P[Fe];if(We&&!We.da&&We.capture==F){var Lt=We.listener,ar=We.ha||We.src;We.fa&&Nn(w.i,We),Se=Lt.call(ar,Q)!==!1&&Se}}return Se&&!Q.defaultPrevented}function Ir(w,P,F){if(typeof w=="function")F&&(w=z(w,F));else if(w&&typeof w.handleEvent=="function")w=z(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(P)?-1:c.setTimeout(w,P||0)}function dr(w){w.g=Ir(()=>{w.g=null,w.i&&(w.i=!1,dr(w))},w.l);const P=w.h;w.h=null,w.m.apply(null,P)}class Jo extends At{constructor(P,F){super(),this.m=P,this.l=F,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:dr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bi(w){At.call(this),this.h=w,this.g={}}pe(bi,At);var Ze=[];function Bt(w){Me(w.g,function(P,F){this.g.hasOwnProperty(F)&&en(P)},w),w.g={}}bi.prototype.N=function(){bi.aa.N.call(this),Bt(this)},bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pt=c.JSON.stringify,Cr=c.JSON.parse,xr=class{stringify(w){return c.JSON.stringify(w,void 0)}parse(w){return c.JSON.parse(w,void 0)}};function Ot(){}Ot.prototype.h=null;function Fi(w){return w.h||(w.h=w.i())}function Ni(){}var Wt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ne(){jt.call(this,"d")}pe(ne,jt);function j(){jt.call(this,"c")}pe(j,jt);var U={},q=null;function le(){return q=q||new mn}U.La="serverreachability";function ve(w){jt.call(this,U.La,w)}pe(ve,jt);function Ee(w){const P=le();Kn(P,new ve(P))}U.STAT_EVENT="statevent";function Ae(w,P){jt.call(this,U.STAT_EVENT,w),this.stat=P}pe(Ae,jt);function ye(w){const P=le();Kn(P,new Ae(P,w))}U.Ma="timingevent";function Re(w,P){jt.call(this,U.Ma,w),this.size=P}pe(Re,jt);function Ue(w,P){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){w()},P)}function Ne(){this.g=!0}Ne.prototype.xa=function(){this.g=!1};function Be(w,P,F,Q,Se,Fe){w.info(function(){if(w.g)if(Fe)for(var We="",Lt=Fe.split("&"),ar=0;ar<Lt.length;ar++){var on=Lt[ar].split("=");if(1<on.length){var wr=on[0];on=on[1];var Fr=wr.split("_");We=2<=Fr.length&&Fr[1]=="type"?We+(wr+"="+on+"&"):We+(wr+"=redacted&")}}else We=null;else We=Fe;return"XMLHTTP REQ ("+Q+") [attempt "+Se+"]: "+P+`
`+F+`
`+We})}function bt(w,P,F,Q,Se,Fe,We){w.info(function(){return"XMLHTTP RESP ("+Q+") [ attempt "+Se+"]: "+P+`
`+F+`
`+Fe+" "+We})}function yt(w,P,F,Q){w.info(function(){return"XMLHTTP TEXT ("+P+"): "+Mt(w,F)+(Q?" "+Q:"")})}function Gt(w,P){w.info(function(){return"TIMEOUT: "+P})}Ne.prototype.info=function(){};function Mt(w,P){if(!w.g)return P;if(!P)return null;try{var F=JSON.parse(P);if(F){for(w=0;w<F.length;w++)if(Array.isArray(F[w])){var Q=F[w];if(!(2>Q.length)){var Se=Q[1];if(Array.isArray(Se)&&!(1>Se.length)){var Fe=Se[0];if(Fe!="noop"&&Fe!="stop"&&Fe!="close")for(var We=1;We<Se.length;We++)Se[We]=""}}}}return Pt(F)}catch{return P}}var Kt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sn;function Wn(){}pe(Wn,Ot),Wn.prototype.g=function(){return new XMLHttpRequest},Wn.prototype.i=function(){return{}},Sn=new Wn;function Rt(w,P,F,Q){this.j=w,this.i=P,this.l=F,this.R=Q||1,this.U=new bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Dn}function Dn(){this.i=null,this.g="",this.h=!1}var ir={},zr={};function Kr(w,P,F){w.L=1,w.v=ts(Zt(P)),w.m=F,w.P=!0,or(w,null)}function or(w,P){w.F=Date.now(),nn(w),w.A=Zt(w.v);var F=w.A,Q=w.R;Array.isArray(Q)||(Q=[String(Q)]),ii(F.i,"t",Q),w.C=0,F=w.j.J,w.h=new Dn,w.g=ku(w.j,F?P:null,!w.m),0<w.O&&(w.M=new Jo(z(w.Y,w,w.g),w.O)),P=w.U,F=w.g,Q=w.ca;var Se="readystatechange";Array.isArray(Se)||(Se&&(Ze[0]=Se.toString()),Se=Ze);for(var Fe=0;Fe<Se.length;Fe++){var We=Oe(F,Se[Fe],Q||P.handleEvent,!1,P.h||P);if(!We)break;P.g[We.key]=We}P=w.H?X(w.H):{},w.m?(w.u||(w.u="POST"),P["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,P)):(w.u="GET",w.g.ea(w.A,w.u,null,P)),Ee(),Be(w.i,w.u,w.A,w.l,w.R,w.m)}Rt.prototype.ca=function(w){w=w.target;const P=this.M;P&&Vi(w)==3?P.j():this.Y(w)},Rt.prototype.Y=function(w){try{if(w==this.g)e:{const Fr=Vi(this.g);var P=this.g.Ba();const Ps=this.g.Z();if(!(3>Fr)&&(Fr!=3||this.g&&(this.h.h||this.g.oa()||Cc(this.g)))){this.J||Fr!=4||P==7||(P==8||0>=Ps?Ee(3):Ee(2)),Ca(this);var F=this.g.Z();this.X=F;t:if(bs(this)){var Q=Cc(this.g);w="";var Se=Q.length,Fe=Vi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sr(this),Ar(this);var We="";break t}this.h.i=new c.TextDecoder}for(P=0;P<Se;P++)this.h.h=!0,w+=this.h.i.decode(Q[P],{stream:!(Fe&&P==Se-1)});Q.length=0,this.h.g+=w,this.C=0,We=this.h.g}else We=this.g.oa();if(this.o=F==200,bt(this.i,this.u,this.A,this.l,this.R,Fr,F),this.o){if(this.T&&!this.K){t:{if(this.g){var Lt,ar=this.g;if((Lt=ar.g?ar.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(Lt)){var on=Lt;break t}}on=null}if(F=on)yt(this.i,this.l,F,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ss(this,F);else{this.o=!1,this.s=3,ye(12),sr(this),Ar(this);break e}}if(this.P){F=!0;let si;for(;!this.J&&this.C<We.length;)if(si=Cd(this,We),si==zr){Fr==4&&(this.s=4,ye(14),F=!1),yt(this.i,this.l,null,"[Incomplete Response]");break}else if(si==ir){this.s=4,ye(15),yt(this.i,this.l,We,"[Invalid Chunk]"),F=!1;break}else yt(this.i,this.l,si,null),Ss(this,si);if(bs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fr!=4||We.length!=0||this.h.h||(this.s=1,ye(16),F=!1),this.o=this.o&&F,!F)yt(this.i,this.l,We,"[Invalid Chunked Response]"),sr(this),Ar(this);else if(0<We.length&&!this.W){this.W=!0;var wr=this.j;wr.g==this&&wr.ba&&!wr.M&&(wr.j.info("Great, no buffering proxy detected. Bytes received: "+We.length),Iu(wr),wr.M=!0,ye(11))}}else yt(this.i,this.l,We,null),Ss(this,We);Fr==4&&sr(this),this.o&&!this.J&&(Fr==4?kc(this.j,this):(this.o=!1,nn(this)))}else Js(this.g),F==400&&0<We.indexOf("Unknown SID")?(this.s=3,ye(12)):(this.s=0,ye(13)),sr(this),Ar(this)}}}catch{}finally{}};function bs(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Cd(w,P){var F=w.C,Q=P.indexOf(`
`,F);return Q==-1?zr:(F=Number(P.substring(F,Q)),isNaN(F)?ir:(Q+=1,Q+F>P.length?zr:(P=P.slice(Q,Q+F),w.C=Q+F,P)))}Rt.prototype.cancel=function(){this.J=!0,sr(this)};function nn(w){w.S=Date.now()+w.I,cl(w,w.I)}function cl(w,P){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Ue(z(w.ba,w),P)}function Ca(w){w.B&&(c.clearTimeout(w.B),w.B=null)}Rt.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(Gt(this.i,this.A),this.L!=2&&(Ee(),ye(17)),sr(this),this.s=2,Ar(this)):cl(this,this.S-w)};function Ar(w){w.j.G==0||w.J||kc(w.j,w)}function sr(w){Ca(w);var P=w.M;P&&typeof P.ma=="function"&&P.ma(),w.M=null,Bt(w.U),w.g&&(P=w.g,w.g=null,P.abort(),P.ma())}function Ss(w,P){try{var F=w.j;if(F.G!=0&&(F.g==w||Zn(F.h,w))){if(!w.K&&Zn(F.h,w)&&F.G==3){try{var Q=F.Da.g.parse(P)}catch{Q=null}if(Array.isArray(Q)&&Q.length==3){var Se=Q;if(Se[0]==0){e:if(!F.u){if(F.g)if(F.g.F+3e3<w.F)as(F),Oa(F);else break e;Eu(F),ye(18)}}else F.za=Se[1],0<F.za-F.T&&37500>Se[2]&&F.F&&F.v==0&&!F.C&&(F.C=Ue(z(F.Za,F),6e3));if(1>=_o(F.h)&&F.ca){try{F.ca()}catch{}F.ca=void 0}}else As(F,11)}else if((w.K||F.g==w)&&as(F),!G(P))for(Se=F.Da.g.parse(P),P=0;P<Se.length;P++){let on=Se[P];if(F.T=on[0],on=on[1],F.G==2)if(on[0]=="c"){F.K=on[1],F.ia=on[2];const wr=on[3];wr!=null&&(F.la=wr,F.j.info("VER="+F.la));const Fr=on[4];Fr!=null&&(F.Aa=Fr,F.j.info("SVER="+F.Aa));const Ps=on[5];Ps!=null&&typeof Ps=="number"&&0<Ps&&(Q=1.5*Ps,F.L=Q,F.j.info("backChannelRequestTimeoutMs_="+Q)),Q=F;const si=w.g;if(si){const Rs=si.g?si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rs){var Fe=Q.h;Fe.g||Rs.indexOf("spdy")==-1&&Rs.indexOf("quic")==-1&&Rs.indexOf("h2")==-1||(Fe.j=Fe.l,Fe.g=new Set,Fe.h&&(Ts(Fe,Fe.h),Fe.h=null))}if(Q.D){const Ms=si.g?si.g.getResponseHeader("X-HTTP-Session-Id"):null;Ms&&(Q.ya=Ms,Tn(Q.I,Q.D,Ms))}}F.G=3,F.l&&F.l.ua(),F.ba&&(F.R=Date.now()-w.F,F.j.info("Handshake RTT: "+F.R+"ms")),Q=F;var We=w;if(Q.qa=Au(Q,Q.J?Q.ia:null,Q.W),We.K){es(Q.h,We);var Lt=We,ar=Q.L;ar&&(Lt.I=ar),Lt.B&&(Ca(Lt),nn(Lt)),Q.g=We}else Tu(Q);0<F.i.length&&Fa(F)}else on[0]!="stop"&&on[0]!="close"||As(F,7);else F.G==3&&(on[0]=="stop"||on[0]=="close"?on[0]=="stop"?As(F,7):bu(F):on[0]!="noop"&&F.l&&F.l.ta(on),F.v=0)}}Ee(4)}catch{}}var ni=class{constructor(w,P){this.g=w,this.map=P}};function Si(w){this.l=w||10,c.PerformanceNavigationTiming?(w=c.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function gu(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function _o(w){return w.h?1:w.g?w.g.size:0}function Zn(w,P){return w.h?w.h==P:w.g?w.g.has(P):!1}function Ts(w,P){w.g?w.g.add(P):w.h=P}function es(w,P){w.h&&w.h==P?w.h=null:w.g&&w.g.has(P)&&w.g.delete(P)}Si.prototype.cancel=function(){if(this.i=Gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Gn(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let P=w.i;for(const F of w.g.values())P=P.concat(F.D);return P}return ue(w.i)}function Es(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(S(w)){for(var P=[],F=w.length,Q=0;Q<F;Q++)P.push(w[Q]);return P}P=[],F=0;for(Q in w)P[F++]=w[Q];return P}function io(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(S(w)||typeof w=="string"){var P=[];w=w.length;for(var F=0;F<w;F++)P.push(F);return P}P=[],F=0;for(const Q in w)P[F++]=Q;return P}}}function Aa(w,P){if(w.forEach&&typeof w.forEach=="function")w.forEach(P,void 0);else if(S(w)||typeof w=="string")Array.prototype.forEach.call(w,P,void 0);else for(var F=io(w),Q=Es(w),Se=Q.length,Fe=0;Fe<Se;Fe++)P.call(void 0,Q[Fe],F&&F[Fe],w)}var oo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yu(w,P){if(w){w=w.split("&");for(var F=0;F<w.length;F++){var Q=w[F].indexOf("="),Se=null;if(0<=Q){var Fe=w[F].substring(0,Q);Se=w[F].substring(Q+1)}else Fe=w[F];P(Fe,Se?decodeURIComponent(Se.replace(/\+/g," ")):"")}}}function Bi(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof Bi){this.h=w.h,Is(this,w.j),this.o=w.o,this.g=w.g,zo(this,w.s),this.l=w.l;var P=w.i,F=new Zs;F.i=P.i,P.g&&(F.g=new Map(P.g),F.h=P.h),hl(this,F),this.m=w.m}else w&&(P=String(w).match(oo))?(this.h=!1,Is(this,P[1]||"",!0),this.o=Cs(P[2]||""),this.g=Cs(P[3]||"",!0),zo(this,P[4]),this.l=Cs(P[5]||"",!0),hl(this,P[6]||"",!0),this.m=Cs(P[7]||"")):(this.h=!1,this.i=new Zs(null,this.h))}Bi.prototype.toString=function(){var w=[],P=this.j;P&&w.push(ns(P,Pa,!0),":");var F=this.g;return(F||P=="file")&&(w.push("//"),(P=this.o)&&w.push(ns(P,Pa,!0),"@"),w.push(encodeURIComponent(String(F)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.s,F!=null&&w.push(":",String(F))),(F=this.l)&&(this.g&&F.charAt(0)!="/"&&w.push("/"),w.push(ns(F,F.charAt(0)=="/"?Ad:Ra,!0))),(F=this.i.toString())&&w.push("?",F),(F=this.m)&&w.push("#",ns(F,_u)),w.join("")};function Zt(w){return new Bi(w)}function Is(w,P,F){w.j=F?Cs(P,!0):P,w.j&&(w.j=w.j.replace(/:$/,""))}function zo(w,P){if(P){if(P=Number(P),isNaN(P)||0>P)throw Error("Bad port number "+P);w.s=P}else w.s=null}function hl(w,P,F){P instanceof Zs?(w.i=P,dl(w.i,w.h)):(F||(P=ns(P,kd)),w.i=new Zs(P,w.h))}function Tn(w,P,F){w.i.set(P,F)}function ts(w){return Tn(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Cs(w,P){return w?P?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function ns(w,P,F){return typeof w=="string"?(w=encodeURI(w).replace(P,ka),F&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function ka(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var Pa=/[#\/\?@]/g,Ra=/[#\?:]/g,Ad=/[#\?]/g,kd=/[#\?@]/g,_u=/#/g;function Zs(w,P){this.h=this.g=null,this.i=w||null,this.j=!!P}function ri(w){w.g||(w.g=new Map,w.h=0,w.i&&yu(w.i,function(P,F){w.add(decodeURIComponent(P.replace(/\+/g," ")),F)}))}t=Zs.prototype,t.add=function(w,P){ri(this),this.i=null,w=rs(this,w);var F=this.g.get(w);return F||this.g.set(w,F=[]),F.push(P),this.h+=1,this};function Ma(w,P){ri(w),P=rs(w,P),w.g.has(P)&&(w.i=null,w.h-=w.g.get(P).length,w.g.delete(P))}function Or(w,P){return ri(w),P=rs(w,P),w.g.has(P)}t.forEach=function(w,P){ri(this),this.g.forEach(function(F,Q){F.forEach(function(Se){w.call(P,Se,Q,this)},this)},this)},t.na=function(){ri(this);const w=Array.from(this.g.values()),P=Array.from(this.g.keys()),F=[];for(let Q=0;Q<P.length;Q++){const Se=w[Q];for(let Fe=0;Fe<Se.length;Fe++)F.push(P[Q])}return F},t.V=function(w){ri(this);let P=[];if(typeof w=="string")Or(this,w)&&(P=P.concat(this.g.get(rs(this,w))));else{w=Array.from(this.g.values());for(let F=0;F<w.length;F++)P=P.concat(w[F])}return P},t.set=function(w,P){return ri(this),this.i=null,w=rs(this,w),Or(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[P]),this.h+=1,this},t.get=function(w,P){return w?(w=this.V(w),0<w.length?String(w[0]):P):P};function ii(w,P,F){Ma(w,P),0<F.length&&(w.i=null,w.g.set(rs(w,P),ue(F)),w.h+=F.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],P=Array.from(this.g.keys());for(var F=0;F<P.length;F++){var Q=P[F];const Fe=encodeURIComponent(String(Q)),We=this.V(Q);for(Q=0;Q<We.length;Q++){var Se=Fe;We[Q]!==""&&(Se+="="+encodeURIComponent(String(We[Q]))),w.push(Se)}}return this.i=w.join("&")};function rs(w,P){return P=String(P),w.j&&(P=P.toLowerCase()),P}function dl(w,P){P&&!w.j&&(ri(w),w.i=null,w.g.forEach(function(F,Q){var Se=Q.toLowerCase();Q!=Se&&(Ma(this,Q),ii(this,Se,F))},w)),w.j=P}function vu(w,P){const F=new Ne;if(c.Image){const Q=new Image;Q.onload=ee(Ti,F,"TestLoadImage: loaded",!0,P,Q),Q.onerror=ee(Ti,F,"TestLoadImage: error",!1,P,Q),Q.onabort=ee(Ti,F,"TestLoadImage: abort",!1,P,Q),Q.ontimeout=ee(Ti,F,"TestLoadImage: timeout",!1,P,Q),c.setTimeout(function(){Q.ontimeout&&Q.ontimeout()},1e4),Q.src=w}else P(!1)}function xu(w,P){const F=new Ne,Q=new AbortController,Se=setTimeout(()=>{Q.abort(),Ti(F,"TestPingServer: timeout",!1,P)},1e4);fetch(w,{signal:Q.signal}).then(Fe=>{clearTimeout(Se),Fe.ok?Ti(F,"TestPingServer: ok",!0,P):Ti(F,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(Se),Ti(F,"TestPingServer: error",!1,P)})}function Ti(w,P,F,Q,Se){try{Se&&(Se.onload=null,Se.onerror=null,Se.onabort=null,Se.ontimeout=null),Q(F)}catch{}}function Pd(){this.g=new xr}function Tc(w,P,F){const Q=F||"";try{Aa(w,function(Se,Fe){let We=Se;A(Se)&&(We=Pt(Se)),P.push(Q+Fe+"="+encodeURIComponent(We))})}catch(Se){throw P.push(Q+"type="+encodeURIComponent("_badmap")),Se}}function Xs(w){this.l=w.Ub||null,this.j=w.eb||!1}pe(Xs,Ot),Xs.prototype.g=function(){return new pl(this.l,this.j)},Xs.prototype.i=function(w){return function(){return w}}({});function pl(w,P){mn.call(this),this.D=w,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}pe(pl,mn),t=pl.prototype,t.open=function(w,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=P,this.readyState=1,is(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const P={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(P.body=w),(this.D||c).fetch(new Request(this.A,P)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,La(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,is(this)),this.g&&(this.readyState=3,is(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ec(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ec(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var P=w.value?w.value:new Uint8Array(0);(P=this.v.decode(P,{stream:!w.done}))&&(this.response=this.responseText+=P)}w.done?La(this):is(this),this.readyState==3&&Ec(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,La(this))},t.Qa=function(w){this.g&&(this.response=w,La(this))},t.ga=function(){this.g&&La(this)};function La(w){w.readyState=4,w.l=null,w.j=null,w.v=null,is(w)}t.setRequestHeader=function(w,P){this.u.append(w,P)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],P=this.h.entries();for(var F=P.next();!F.done;)F=F.value,w.push(F[0]+": "+F[1]),F=P.next();return w.join(`\r
`)};function is(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(pl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function fl(w){let P="";return Me(w,function(F,Q){P+=Q,P+=":",P+=F,P+=`\r
`}),P}function Ys(w,P,F){e:{for(Q in F){var Q=!1;break e}Q=!0}Q||(F=fl(F),typeof w=="string"?F!=null&&encodeURIComponent(String(F)):Tn(w,P,F))}function Bn(w){mn.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}pe(Bn,mn);var Da=/^https?$/i,Ei=["POST","PUT"];t=Bn.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,P,F,Q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);P=P?P.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sn.g(),this.v=this.o?Fi(this.o):Fi(Sn),this.g.onreadystatechange=z(this.Ea,this);try{this.B=!0,this.g.open(P,String(w),!0),this.B=!1}catch(Fe){rn(this,Fe);return}if(w=F||"",F=new Map(this.headers),Q)if(Object.getPrototypeOf(Q)===Object.prototype)for(var Se in Q)F.set(Se,Q[Se]);else if(typeof Q.keys=="function"&&typeof Q.get=="function")for(const Fe of Q.keys())F.set(Fe,Q.get(Fe));else throw Error("Unknown input type for opt_headers: "+String(Q));Q=Array.from(F.keys()).find(Fe=>Fe.toLowerCase()=="content-type"),Se=c.FormData&&w instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Ei,P,void 0))||Q||Se||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Fe,We]of F)this.g.setRequestHeader(Fe,We);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ic(this),this.u=!0,this.g.send(w),this.u=!1}catch(Fe){rn(this,Fe)}};function rn(w,P){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=P,w.m=5,ml(w),os(w)}function ml(w){w.A||(w.A=!0,Kn(w,"complete"),Kn(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,Kn(this,"complete"),Kn(this,"abort"),os(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),os(this,!0)),Bn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Qs(this):this.bb())},t.bb=function(){Qs(this)};function Qs(w){if(w.h&&typeof p<"u"&&(!w.v[1]||Vi(w)!=4||w.Z()!=2)){if(w.u&&Vi(w)==4)Ir(w.Ea,0,w);else if(Kn(w,"readystatechange"),Vi(w)==4){w.h=!1;try{const We=w.Z();e:switch(We){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var F;if(!(F=P)){var Q;if(Q=We===0){var Se=String(w.D).match(oo)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),Q=!Da.test(Se?Se.toLowerCase():"")}F=Q}if(F)Kn(w,"complete"),Kn(w,"success");else{w.m=6;try{var Fe=2<Vi(w)?w.g.statusText:""}catch{Fe=""}w.l=Fe+" ["+w.Z()+"]",ml(w)}}finally{os(w)}}}}function os(w,P){if(w.g){Ic(w);const F=w.g,Q=w.v[0]?()=>{}:null;w.g=null,w.v=null,P||Kn(w,"ready");try{F.onreadystatechange=Q}catch{}}}function Ic(w){w.I&&(c.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function Vi(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<Vi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(w){if(this.g){var P=this.g.responseText;return w&&P.indexOf(w)==0&&(P=P.substring(w.length)),Cr(P)}};function Cc(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Js(w){const P={};w=(w.g&&2<=Vi(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let Q=0;Q<w.length;Q++){if(G(w[Q]))continue;var F=de(w[Q]);const Se=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const Fe=P[Se]||[];P[Se]=Fe,Fe.push(F)}J(P,function(Q){return Q.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function za(w,P,F){return F&&F.internalChannelParams&&F.internalChannelParams[w]||P}function wu(w){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=za("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=za("baseRetryDelayMs",5e3,w),this.cb=za("retryDelaySeedMs",1e4,w),this.Wa=za("forwardChannelMaxRetries",2,w),this.wa=za("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Si(w&&w.concurrentRequestLimit),this.Da=new Pd,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=wu.prototype,t.la=8,t.G=1,t.connect=function(w,P,F,Q){ye(0),this.W=w,this.H=P||{},F&&Q!==void 0&&(this.H.OSID=F,this.H.OAID=Q),this.F=this.X,this.I=Au(this,null,this.W),Fa(this)};function bu(w){if(gl(w),w.G==3){var P=w.U++,F=Zt(w.I);if(Tn(F,"SID",w.K),Tn(F,"RID",P),Tn(F,"TYPE","terminate"),ea(w,F),P=new Rt(w,w.j,P),P.L=2,P.v=ts(Zt(F)),F=!1,c.navigator&&c.navigator.sendBeacon)try{F=c.navigator.sendBeacon(P.v.toString(),"")}catch{}!F&&c.Image&&(new Image().src=P.v,F=!0),F||(P.g=ku(P.j,null),P.g.ea(P.v)),P.F=Date.now(),nn(P)}Pc(w)}function Oa(w){w.g&&(Iu(w),w.g.cancel(),w.g=null)}function gl(w){Oa(w),w.u&&(c.clearTimeout(w.u),w.u=null),as(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&c.clearTimeout(w.s),w.s=null)}function Fa(w){if(!gu(w.h)&&!w.s){w.s=!0;var P=w.Ga;tn||Tt(),et||(tn(),et=!0),ht.add(P,w),w.B=0}}function Ac(w,P){return _o(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=P.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Ue(z(w.Ga,w,P),Na(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const Se=new Rt(this,this.j,w);let Fe=this.o;if(this.S&&(Fe?(Fe=X(Fe),ie(Fe,this.S)):Fe=this.S),this.m!==null||this.O||(Se.H=Fe,Fe=null),this.P)e:{for(var P=0,F=0;F<this.i.length;F++){t:{var Q=this.i[F];if("__data__"in Q.map&&(Q=Q.map.__data__,typeof Q=="string")){Q=Q.length;break t}Q=void 0}if(Q===void 0)break;if(P+=Q,4096<P){P=F;break e}if(P===4096||F===this.i.length-1){P=F+1;break e}}P=1e3}else P=1e3;P=ss(this,Se,P),F=Zt(this.I),Tn(F,"RID",w),Tn(F,"CVER",22),this.D&&Tn(F,"X-HTTP-Session-Id",this.D),ea(this,F),Fe&&(this.O?P="headers="+encodeURIComponent(String(fl(Fe)))+"&"+P:this.m&&Ys(F,this.m,Fe)),Ts(this.h,Se),this.Ua&&Tn(F,"TYPE","init"),this.P?(Tn(F,"$req",P),Tn(F,"SID","null"),Se.T=!0,Kr(Se,F,null)):Kr(Se,F,P),this.G=2}}else this.G==3&&(w?Su(this,w):this.i.length==0||gu(this.h)||Su(this))};function Su(w,P){var F;P?F=P.l:F=w.U++;const Q=Zt(w.I);Tn(Q,"SID",w.K),Tn(Q,"RID",F),Tn(Q,"AID",w.T),ea(w,Q),w.m&&w.o&&Ys(Q,w.m,w.o),F=new Rt(w,w.j,F,w.B+1),w.m===null&&(F.H=w.o),P&&(w.i=P.D.concat(w.i)),P=ss(w,F,1e3),F.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),Ts(w.h,F),Kr(F,Q,P)}function ea(w,P){w.H&&Me(w.H,function(F,Q){Tn(P,Q,F)}),w.l&&Aa({},function(F,Q){Tn(P,Q,F)})}function ss(w,P,F){F=Math.min(w.i.length,F);var Q=w.l?z(w.l.Na,w.l,w):null;e:{var Se=w.i;let Fe=-1;for(;;){const We=["count="+F];Fe==-1?0<F?(Fe=Se[0].g,We.push("ofs="+Fe)):Fe=0:We.push("ofs="+Fe);let Lt=!0;for(let ar=0;ar<F;ar++){let on=Se[ar].g;const wr=Se[ar].map;if(on-=Fe,0>on)Fe=Math.max(0,Se[ar].g-100),Lt=!1;else try{Tc(wr,We,"req"+on+"_")}catch{Q&&Q(wr)}}if(Lt){Q=We.join("&");break e}}}return w=w.i.splice(0,F),P.D=w,Q}function Tu(w){if(!w.g&&!w.u){w.Y=1;var P=w.Fa;tn||Tt(),et||(tn(),et=!0),ht.add(P,w),w.v=0}}function Eu(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Ue(z(w.Fa,w),Na(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,Cu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Ue(z(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ye(10),Oa(this),Cu(this))};function Iu(w){w.A!=null&&(c.clearTimeout(w.A),w.A=null)}function Cu(w){w.g=new Rt(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var P=Zt(w.qa);Tn(P,"RID","rpc"),Tn(P,"SID",w.K),Tn(P,"AID",w.T),Tn(P,"CI",w.F?"0":"1"),!w.F&&w.ja&&Tn(P,"TO",w.ja),Tn(P,"TYPE","xmlhttp"),ea(w,P),w.m&&w.o&&Ys(P,w.m,w.o),w.L&&(w.g.I=w.L);var F=w.g;w=w.ia,F.L=1,F.v=ts(Zt(P)),F.m=null,F.P=!0,or(F,w)}t.Za=function(){this.C!=null&&(this.C=null,Oa(this),Eu(this),ye(19))};function as(w){w.C!=null&&(c.clearTimeout(w.C),w.C=null)}function kc(w,P){var F=null;if(w.g==P){as(w),Iu(w),w.g=null;var Q=2}else if(Zn(w.h,P))F=P.D,es(w.h,P),Q=1;else return;if(w.G!=0){if(P.o)if(Q==1){F=P.m?P.m.length:0,P=Date.now()-P.F;var Se=w.B;Q=le(),Kn(Q,new Re(Q,F)),Fa(w)}else Tu(w);else if(Se=P.s,Se==3||Se==0&&0<P.X||!(Q==1&&Ac(w,P)||Q==2&&Eu(w)))switch(F&&0<F.length&&(P=w.h,P.i=P.i.concat(F)),Se){case 1:As(w,5);break;case 4:As(w,10);break;case 3:As(w,6);break;default:As(w,2)}}}function Na(w,P){let F=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(F*=2),F*P}function As(w,P){if(w.j.info("Error code "+P),P==2){var F=z(w.fb,w),Q=w.Xa;const Se=!Q;Q=new Bi(Q||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Is(Q,"https"),ts(Q),Se?vu(Q.toString(),F):xu(Q.toString(),F)}else ye(2);w.G=0,w.l&&w.l.sa(P),Pc(w),gl(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),ye(2)):(this.j.info("Failed to ping google.com"),ye(1))};function Pc(w){if(w.G=0,w.ka=[],w.l){const P=Gn(w.h);(P.length!=0||w.i.length!=0)&&(me(w.ka,P),me(w.ka,w.i),w.h.i.length=0,ue(w.i),w.i.length=0),w.l.ra()}}function Au(w,P,F){var Q=F instanceof Bi?Zt(F):new Bi(F);if(Q.g!="")P&&(Q.g=P+"."+Q.g),zo(Q,Q.s);else{var Se=c.location;Q=Se.protocol,P=P?P+"."+Se.hostname:Se.hostname,Se=+Se.port;var Fe=new Bi(null);Q&&Is(Fe,Q),P&&(Fe.g=P),Se&&zo(Fe,Se),F&&(Fe.l=F),Q=Fe}return F=w.D,P=w.ya,F&&P&&Tn(Q,F,P),Tn(Q,"VER",w.la),ea(w,Q),Q}function ku(w,P,F){if(P&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return P=w.Ca&&!w.pa?new Bn(new Xs({eb:F})):new Bn(w.pa),P.Ha(w.J),P}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pu(){}t=Pu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ta(){}ta.prototype.g=function(w,P){return new oi(w,P)};function oi(w,P){mn.call(this),this.g=new wu(P),this.l=w,this.h=P&&P.messageUrlParams||null,w=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(w?w["X-WebChannel-Content-Type"]=P.messageContentType:w={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.va&&(w?w["X-WebChannel-Client-Profile"]=P.va:w={"X-WebChannel-Client-Profile":P.va}),this.g.S=w,(w=P&&P.Sb)&&!G(w)&&(this.g.m=w),this.v=P&&P.supportsCrossDomainXhr||!1,this.u=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!G(P)&&(this.g.D=P,w=this.h,w!==null&&P in w&&(w=this.h,P in w&&delete w[P])),this.j=new ls(this)}pe(oi,mn),oi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},oi.prototype.close=function(){bu(this.g)},oi.prototype.o=function(w){var P=this.g;if(typeof w=="string"){var F={};F.__data__=w,w=F}else this.u&&(F={},F.__data__=Pt(w),w=F);P.i.push(new ni(P.Ya++,w)),P.G==3&&Fa(P)},oi.prototype.N=function(){this.g.l=null,delete this.j,bu(this.g),delete this.g,oi.aa.N.call(this)};function ks(w){ne.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var P=w.__sm__;if(P){e:{for(const F in P){w=F;break e}w=void 0}(this.i=w)&&(w=this.i,P=P!==null&&w in P?P[w]:void 0),this.data=P}else this.data=w}pe(ks,ne);function vo(){j.call(this),this.status=1}pe(vo,j);function ls(w){this.g=w}pe(ls,Pu),ls.prototype.ua=function(){Kn(this.g,"a")},ls.prototype.ta=function(w){Kn(this.g,new ks(w))},ls.prototype.sa=function(w){Kn(this.g,new vo)},ls.prototype.ra=function(){Kn(this.g,"b")},ta.prototype.createWebChannel=ta.prototype.g,oi.prototype.send=oi.prototype.o,oi.prototype.open=oi.prototype.m,oi.prototype.close=oi.prototype.close,Ik=function(){return new ta},Ek=function(){return le()},Tk=U,A1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kt.NO_ERROR=0,Kt.TIMEOUT=8,Kt.HTTP_ERROR=6,Ig=Kt,gn.COMPLETE="complete",Sk=gn,Ni.EventType=Wt,Wt.OPEN="a",Wt.CLOSE="b",Wt.ERROR="c",Wt.MESSAGE="d",mn.prototype.listen=mn.prototype.K,Bp=Ni,bk=Xs,Bn.prototype.listenOnce=Bn.prototype.L,Bn.prototype.getLastError=Bn.prototype.Ka,Bn.prototype.getLastErrorCode=Bn.prototype.Ba,Bn.prototype.getStatus=Bn.prototype.Z,Bn.prototype.getResponseJson=Bn.prototype.Oa,Bn.prototype.getResponseText=Bn.prototype.oa,Bn.prototype.send=Bn.prototype.ea,Bn.prototype.setWithCredentials=Bn.prototype.Ha,wk=Bn}).apply(typeof ng<"u"?ng:typeof self<"u"?self:typeof window<"u"?window:{});const wT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yi.UNAUTHENTICATED=new Yi(null),Yi.GOOGLE_CREDENTIALS=new Yi("google-credentials-uid"),Yi.FIRST_PARTY=new Yi("first-party-uid"),Yi.MOCK_USER=new Yi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bd="10.12.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=new hk("@firebase/firestore");function Pp(){return gc.logLevel}function It(t,...e){if(gc.logLevel<=vn.DEBUG){const n=e.map(hw);gc.debug(`Firestore (${bd}): ${t}`,...n)}}function al(t,...e){if(gc.logLevel<=vn.ERROR){const n=e.map(hw);gc.error(`Firestore (${bd}): ${t}`,...n)}}function ed(t,...e){if(gc.logLevel<=vn.WARN){const n=e.map(hw);gc.warn(`Firestore (${bd}): ${t}`,...n)}}function hw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t="Unexpected state"){const e=`FIRESTORE (${bd}) INTERNAL ASSERTION FAILED: `+t;throw al(e),new Error(e)}function Hr(t,e){t||Qt()}function bn(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $t extends bc{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Yi.UNAUTHENTICATED))}shutdown(){}}class C6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class A6{constructor(e){this.t=e,this.currentUser=Yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let o=this.i;const a=S=>this.i!==o?(o=this.i,n(S)):Promise.resolve();let d=new sc;this.o=()=>{this.i++,this.currentUser=this.u(),d.resolve(),d=new sc,e.enqueueRetryable(()=>a(this.currentUser))};const p=()=>{const S=d;e.enqueueRetryable(async()=>{await S.promise,await a(this.currentUser)})},c=S=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=S,this.auth.addAuthTokenListener(this.o),p()};this.t.onInit(S=>c(S)),setTimeout(()=>{if(!this.auth){const S=this.t.getImmediate({optional:!0});S?c(S):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),d.resolve(),d=new sc)}},0),p()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(o=>this.i!==e?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(Hr(typeof o.accessToken=="string"),new Ck(o.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Hr(e===null||typeof e=="string"),new Yi(e)}}class k6{constructor(e,n,o){this.l=e,this.h=n,this.P=o,this.type="FirstParty",this.user=Yi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class P6{constructor(e,n,o){this.l=e,this.h=n,this.P=o}getToken(){return Promise.resolve(new k6(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class R6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const o=d=>{d.error!=null&&It("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${d.error.message}`);const p=d.token!==this.R;return this.R=d.token,It("FirebaseAppCheckTokenProvider",`Received ${p?"new":"existing"} token.`),p?n(d.token):Promise.resolve()};this.o=d=>{e.enqueueRetryable(()=>o(d))};const a=d=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=d,this.appCheck.addTokenListener(this.o)};this.A.onInit(d=>a(d)),setTimeout(()=>{if(!this.appCheck){const d=this.A.getImmediate({optional:!0});d?a(d):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Hr(typeof n.token=="string"),this.R=n.token,new R6(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let o=0;o<t;o++)n[o]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let o="";for(;o.length<20;){const a=L6(40);for(let d=0;d<a.length;++d)o.length<20&&a[d]<n&&(o+=e.charAt(a[d]%e.length))}return o}}function Ln(t,e){return t<e?-1:t>e?1:0}function td(t,e,n){return t.length===e.length&&t.every((o,a)=>n(o,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $t(mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $t(mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $t(mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $t(mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Mo.fromMillis(Date.now())}static fromDate(e){return Mo.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),o=Math.floor(1e6*(e-1e3*n));return new Mo(n,o)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ln(this.nanoseconds,e.nanoseconds):Ln(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Xt(e)}static min(){return new Xt(new Mo(0,0))}static max(){return new Xt(new Mo(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,n,o){n===void 0?n=0:n>e.length&&Qt(),o===void 0?o=e.length-n:o>e.length-n&&Qt(),this.segments=e,this.offset=n,this.len=o}get length(){return this.len}isEqual(e){return If.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof If?e.forEach(o=>{n.push(o)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,o=this.limit();n<o;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const o=Math.min(e.length,n.length);for(let a=0;a<o;a++){const d=e.get(a),p=n.get(a);if(d<p)return-1;if(d>p)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Tr extends If{construct(e,n,o){return new Tr(e,n,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const o of e){if(o.indexOf("//")>=0)throw new $t(mt.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);n.push(...o.split("/").filter(a=>a.length>0))}return new Tr(n)}static emptyPath(){return new Tr([])}}const z6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fo extends If{construct(e,n,o){return new fo(e,n,o)}static isValidIdentifier(e){return z6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fo.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new fo(["__name__"])}static fromServerFormat(e){const n=[];let o="",a=0;const d=()=>{if(o.length===0)throw new $t(mt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(o),o=""};let p=!1;for(;a<e.length;){const c=e[a];if(c==="\\"){if(a+1===e.length)throw new $t(mt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const S=e[a+1];if(S!=="\\"&&S!=="."&&S!=="`")throw new $t(mt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);o+=S,a+=2}else c==="`"?(p=!p,a++):c!=="."||p?(o+=c,a++):(d(),a++)}if(d(),p)throw new $t(mt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fo(n)}static emptyPath(){return new fo([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.path=e}static fromPath(e){return new qt(Tr.fromString(e))}static fromName(e){return new qt(Tr.fromString(e).popFirst(5))}static empty(){return new qt(Tr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Tr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Tr.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qt(new Tr(e.slice()))}}function O6(t,e){const n=t.toTimestamp().seconds,o=t.toTimestamp().nanoseconds+1,a=Xt.fromTimestamp(o===1e9?new Mo(n+1,0):new Mo(n,o));return new uu(a,qt.empty(),e)}function F6(t){return new uu(t.readTime,t.key,-1)}class uu{constructor(e,n,o){this.readTime=e,this.documentKey=n,this.largestBatchId=o}static min(){return new uu(Xt.min(),qt.empty(),-1)}static max(){return new uu(Xt.max(),qt.empty(),-1)}}function N6(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=qt.comparator(t.documentKey,e.documentKey),n!==0?n:Ln(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dw(t){if(t.code!==mt.FAILED_PRECONDITION||t.message!==B6)throw t;It("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Qt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Qe((o,a)=>{this.nextCallback=d=>{this.wrapSuccess(e,d).next(o,a)},this.catchCallback=d=>{this.wrapFailure(n,d).next(o,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Qe?n:Qe.resolve(n)}catch(n){return Qe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Qe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Qe.reject(n)}static resolve(e){return new Qe((n,o)=>{n(e)})}static reject(e){return new Qe((n,o)=>{o(e)})}static waitFor(e){return new Qe((n,o)=>{let a=0,d=0,p=!1;e.forEach(c=>{++a,c.next(()=>{++d,p&&d===a&&n()},S=>o(S))}),p=!0,d===a&&n()})}static or(e){let n=Qe.resolve(!1);for(const o of e)n=n.next(a=>a?Qe.resolve(a):o());return n}static forEach(e,n){const o=[];return e.forEach((a,d)=>{o.push(n.call(this,a,d))}),this.waitFor(o)}static mapArray(e,n){return new Qe((o,a)=>{const d=e.length,p=new Array(d);let c=0;for(let S=0;S<d;S++){const A=S;n(e[A]).next(D=>{p[A]=D,++c,c===d&&o(p)},D=>a(D))}})}static doWhile(e,n){return new Qe((o,a)=>{const d=()=>{e()===!0?n().next(()=>{d()},a):o()};d()})}}function j6(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Vf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=o=>this.ie(o),this.se=o=>n.writeSequenceNumber(o))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}pw.oe=-1;function r_(t){return t==null}function k1(t){return t===0&&1/t==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function i_(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function U6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,n){this.comparator=e,this.root=n||Mi.EMPTY}insert(e,n){return new Mr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Mi.BLACK,null,null))}remove(e){return new Mr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mi.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return n.value;o<0?n=n.left:o>0&&(n=n.right)}return null}indexOf(e){let n=0,o=this.root;for(;!o.isEmpty();){const a=this.comparator(e,o.key);if(a===0)return n+o.left.size;a<0?o=o.left:(n+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,o)=>(e(n,o),!1))}toString(){const e=[];return this.inorderTraversal((n,o)=>(e.push(`${n}:${o}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rg(this.root,e,this.comparator,!1)}getReverseIterator(){return new rg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rg(this.root,e,this.comparator,!0)}}class rg{constructor(e,n,o,a){this.isReverse=a,this.nodeStack=[];let d=1;for(;!e.isEmpty();)if(d=n?o(e.key,n):1,n&&a&&(d*=-1),d<0)e=this.isReverse?e.left:e.right;else{if(d===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mi{constructor(e,n,o,a,d){this.key=e,this.value=n,this.color=o??Mi.RED,this.left=a??Mi.EMPTY,this.right=d??Mi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,o,a,d){return new Mi(e??this.key,n??this.value,o??this.color,a??this.left,d??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,o){let a=this;const d=o(e,a.key);return a=d<0?a.copy(null,null,null,a.left.insert(e,n,o),null):d===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,o)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Mi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let o,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return Mi.EMPTY;o=a.right.min(),a=a.copy(o.key,o.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Qt();const e=this.left.check();if(e!==this.right.check())throw Qt();return e+(this.isRed()?0:1)}}Mi.EMPTY=null,Mi.RED=!0,Mi.BLACK=!1;Mi.EMPTY=new class{constructor(){this.size=0}get key(){throw Qt()}get value(){throw Qt()}get color(){throw Qt()}get left(){throw Qt()}get right(){throw Qt()}copy(e,n,o,a,d){return this}insert(e,n,o){return new Mi(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.comparator=e,this.data=new Mr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,o)=>(e(n),!1))}forEachInRange(e,n){const o=this.data.getIteratorFrom(e[0]);for(;o.hasNext();){const a=o.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let o;for(o=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();o.hasNext();)if(!e(o.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ST(this.data.getIterator())}getIteratorFrom(e){return new ST(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(o=>{n=n.add(o)}),n}isEqual(e){if(!(e instanceof Di)||this.size!==e.size)return!1;const n=this.data.getIterator(),o=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,d=o.getNext().key;if(this.comparator(a,d)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Di(this.comparator);return n.data=e,n}}class ST{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e){this.fields=e,e.sort(fo.comparator)}static empty(){return new Gl([])}unionWith(e){let n=new Di(fo.comparator);for(const o of this.fields)n=n.add(o);for(const o of e)n=n.add(o);return new Gl(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return td(this.fields,e.fields,(n,o)=>n.isEqual(o))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(a){try{return atob(a)}catch(d){throw typeof DOMException<"u"&&d instanceof DOMException?new Ak("Invalid base64 string: "+d):d}}(e);return new to(n)}static fromUint8Array(e){const n=function(a){let d="";for(let p=0;p<a.length;++p)d+=String.fromCharCode(a[p]);return d}(e);return new to(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const o=new Uint8Array(n.length);for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return o}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ln(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}to.EMPTY_BYTE_STRING=new to("");const $6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cu(t){if(Hr(!!t),typeof t=="string"){let e=0;const n=$6.exec(t);if(Hr(!!n),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const o=new Date(t);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:Ur(t.seconds),nanos:Ur(t.nanos)}}function Ur(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function yc(t){return typeof t=="string"?to.fromBase64String(t):to.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function mw(t){const e=t.mapValue.fields.__previous_value__;return fw(e)?mw(e):e}function Cf(t){const e=cu(t.mapValue.fields.__local_write_time__.timestampValue);return new Mo(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e,n,o,a,d,p,c,S,A){this.databaseId=e,this.appId=n,this.persistenceKey=o,this.host=a,this.ssl=d,this.forceLongPolling=p,this.autoDetectLongPolling=c,this.longPollingOptions=S,this.useFetchStreams=A}}class Af{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Af("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Af&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _c(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fw(t)?4:H6(t)?9007199254740991:10:Qt()}function ba(t,e){if(t===e)return!0;const n=_c(t);if(n!==_c(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cf(t).isEqual(Cf(e));case 3:return function(a,d){if(typeof a.timestampValue=="string"&&typeof d.timestampValue=="string"&&a.timestampValue.length===d.timestampValue.length)return a.timestampValue===d.timestampValue;const p=cu(a.timestampValue),c=cu(d.timestampValue);return p.seconds===c.seconds&&p.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,d){return yc(a.bytesValue).isEqual(yc(d.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,d){return Ur(a.geoPointValue.latitude)===Ur(d.geoPointValue.latitude)&&Ur(a.geoPointValue.longitude)===Ur(d.geoPointValue.longitude)}(t,e);case 2:return function(a,d){if("integerValue"in a&&"integerValue"in d)return Ur(a.integerValue)===Ur(d.integerValue);if("doubleValue"in a&&"doubleValue"in d){const p=Ur(a.doubleValue),c=Ur(d.doubleValue);return p===c?k1(p)===k1(c):isNaN(p)&&isNaN(c)}return!1}(t,e);case 9:return td(t.arrayValue.values||[],e.arrayValue.values||[],ba);case 10:return function(a,d){const p=a.mapValue.fields||{},c=d.mapValue.fields||{};if(bT(p)!==bT(c))return!1;for(const S in p)if(p.hasOwnProperty(S)&&(c[S]===void 0||!ba(p[S],c[S])))return!1;return!0}(t,e);default:return Qt()}}function kf(t,e){return(t.values||[]).find(n=>ba(n,e))!==void 0}function nd(t,e){if(t===e)return 0;const n=_c(t),o=_c(e);if(n!==o)return Ln(n,o);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ln(t.booleanValue,e.booleanValue);case 2:return function(d,p){const c=Ur(d.integerValue||d.doubleValue),S=Ur(p.integerValue||p.doubleValue);return c<S?-1:c>S?1:c===S?0:isNaN(c)?isNaN(S)?0:-1:1}(t,e);case 3:return TT(t.timestampValue,e.timestampValue);case 4:return TT(Cf(t),Cf(e));case 5:return Ln(t.stringValue,e.stringValue);case 6:return function(d,p){const c=yc(d),S=yc(p);return c.compareTo(S)}(t.bytesValue,e.bytesValue);case 7:return function(d,p){const c=d.split("/"),S=p.split("/");for(let A=0;A<c.length&&A<S.length;A++){const D=Ln(c[A],S[A]);if(D!==0)return D}return Ln(c.length,S.length)}(t.referenceValue,e.referenceValue);case 8:return function(d,p){const c=Ln(Ur(d.latitude),Ur(p.latitude));return c!==0?c:Ln(Ur(d.longitude),Ur(p.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(d,p){const c=d.values||[],S=p.values||[];for(let A=0;A<c.length&&A<S.length;++A){const D=nd(c[A],S[A]);if(D)return D}return Ln(c.length,S.length)}(t.arrayValue,e.arrayValue);case 10:return function(d,p){if(d===ig.mapValue&&p===ig.mapValue)return 0;if(d===ig.mapValue)return 1;if(p===ig.mapValue)return-1;const c=d.fields||{},S=Object.keys(c),A=p.fields||{},D=Object.keys(A);S.sort(),D.sort();for(let L=0;L<S.length&&L<D.length;++L){const z=Ln(S[L],D[L]);if(z!==0)return z;const ee=nd(c[S[L]],A[D[L]]);if(ee!==0)return ee}return Ln(S.length,D.length)}(t.mapValue,e.mapValue);default:throw Qt()}}function TT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ln(t,e);const n=cu(t),o=cu(e),a=Ln(n.seconds,o.seconds);return a!==0?a:Ln(n.nanos,o.nanos)}function rd(t){return P1(t)}function P1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const o=cu(n);return`time(${o.seconds},${o.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return yc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return qt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let o="[",a=!0;for(const d of n.values||[])a?a=!1:o+=",",o+=P1(d);return o+"]"}(t.arrayValue):"mapValue"in t?function(n){const o=Object.keys(n.fields||{}).sort();let a="{",d=!0;for(const p of o)d?d=!1:a+=",",a+=`${p}:${P1(n.fields[p])}`;return a+"}"}(t.mapValue):Qt()}function R1(t){return!!t&&"integerValue"in t}function gw(t){return!!t&&"arrayValue"in t}function ET(t){return!!t&&"nullValue"in t}function IT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Q0(t){return!!t&&"mapValue"in t}function Jp(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return i_(t.mapValue.fields,(n,o)=>e.mapValue.fields[n]=Jp(o)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Jp(t.arrayValue.values[n]);return e}return Object.assign({},t)}function H6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this.value=e}static empty(){return new ya({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let o=0;o<e.length-1;++o)if(n=(n.mapValue.fields||{})[e.get(o)],!Q0(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jp(n)}setAll(e){let n=fo.emptyPath(),o={},a=[];e.forEach((p,c)=>{if(!n.isImmediateParentOf(c)){const S=this.getFieldsMap(n);this.applyChanges(S,o,a),o={},a=[],n=c.popLast()}p?o[c.lastSegment()]=Jp(p):a.push(c.lastSegment())});const d=this.getFieldsMap(n);this.applyChanges(d,o,a)}delete(e){const n=this.field(e.popLast());Q0(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ba(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let o=0;o<e.length;++o){let a=n.mapValue.fields[e.get(o)];Q0(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(o)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,o){i_(n,(a,d)=>e[a]=d);for(const a of o)delete e[a]}clone(){return new ya(Jp(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n,o,a,d,p,c){this.key=e,this.documentType=n,this.version=o,this.readTime=a,this.createTime=d,this.data=p,this.documentState=c}static newInvalidDocument(e){return new Ji(e,0,Xt.min(),Xt.min(),Xt.min(),ya.empty(),0)}static newFoundDocument(e,n,o,a){return new Ji(e,1,n,Xt.min(),o,a,0)}static newNoDocument(e,n){return new Ji(e,2,n,Xt.min(),Xt.min(),ya.empty(),0)}static newUnknownDocument(e,n){return new Ji(e,3,n,Xt.min(),Xt.min(),ya.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Xt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ya.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ya.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ji&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ji(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,n){this.position=e,this.inclusive=n}}function CT(t,e,n){let o=0;for(let a=0;a<t.position.length;a++){const d=e[a],p=t.position[a];if(d.field.isKeyField()?o=qt.comparator(qt.fromName(p.referenceValue),n.key):o=nd(p,n.data.field(d.field)),d.dir==="desc"&&(o*=-1),o!==0)break}return o}function AT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ba(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e,n="asc"){this.field=e,this.dir=n}}function W6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{}class Qr extends kk{constructor(e,n,o){super(),this.field=e,this.op=n,this.value=o}static create(e,n,o){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,o):new K6(e,n,o):n==="array-contains"?new Y6(e,o):n==="in"?new Q6(e,o):n==="not-in"?new J6(e,o):n==="array-contains-any"?new eF(e,o):new Qr(e,n,o)}static createKeyFieldInFilter(e,n,o){return n==="in"?new Z6(e,o):new X6(e,o)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(nd(n,this.value)):n!==null&&_c(this.value)===_c(n)&&this.matchesComparison(nd(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sa extends kk{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Sa(e,n)}matches(e){return Pk(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Pk(t){return t.op==="and"}function Rk(t){return G6(t)&&Pk(t)}function G6(t){for(const e of t.filters)if(e instanceof Sa)return!1;return!0}function M1(t){if(t instanceof Qr)return t.field.canonicalString()+t.op.toString()+rd(t.value);if(Rk(t))return t.filters.map(e=>M1(e)).join(",");{const e=t.filters.map(n=>M1(n)).join(",");return`${t.op}(${e})`}}function Mk(t,e){return t instanceof Qr?function(o,a){return a instanceof Qr&&o.op===a.op&&o.field.isEqual(a.field)&&ba(o.value,a.value)}(t,e):t instanceof Sa?function(o,a){return a instanceof Sa&&o.op===a.op&&o.filters.length===a.filters.length?o.filters.reduce((d,p,c)=>d&&Mk(p,a.filters[c]),!0):!1}(t,e):void Qt()}function Lk(t){return t instanceof Qr?function(n){return`${n.field.canonicalString()} ${n.op} ${rd(n.value)}`}(t):t instanceof Sa?function(n){return n.op.toString()+" {"+n.getFilters().map(Lk).join(" ,")+"}"}(t):"Filter"}class K6 extends Qr{constructor(e,n,o){super(e,n,o),this.key=qt.fromName(o.referenceValue)}matches(e){const n=qt.comparator(e.key,this.key);return this.matchesComparison(n)}}class Z6 extends Qr{constructor(e,n){super(e,"in",n),this.keys=Dk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class X6 extends Qr{constructor(e,n){super(e,"not-in",n),this.keys=Dk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Dk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(o=>qt.fromName(o.referenceValue))}class Y6 extends Qr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gw(n)&&kf(n.arrayValue,this.value)}}class Q6 extends Qr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&kf(this.value.arrayValue,n)}}class J6 extends Qr{constructor(e,n){super(e,"not-in",n)}matches(e){if(kf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!kf(this.value.arrayValue,n)}}class eF extends Qr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gw(n)||!n.arrayValue.values)&&n.arrayValue.values.some(o=>kf(this.value.arrayValue,o))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,n=null,o=[],a=[],d=null,p=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=o,this.filters=a,this.limit=d,this.startAt=p,this.endAt=c,this.ue=null}}function kT(t,e=null,n=[],o=[],a=null,d=null,p=null){return new tF(t,e,n,o,a,d,p)}function yw(t){const e=bn(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(o=>M1(o)).join(","),n+="|ob:",n+=e.orderBy.map(o=>function(d){return d.field.canonicalString()+d.dir}(o)).join(","),r_(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(o=>rd(o)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(o=>rd(o)).join(",")),e.ue=n}return e.ue}function _w(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!W6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Mk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!AT(t.startAt,e.startAt)&&AT(t.endAt,e.endAt)}function L1(t){return qt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e,n=null,o=[],a=[],d=null,p="F",c=null,S=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=o,this.filters=a,this.limit=d,this.limitType=p,this.startAt=c,this.endAt=S,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function nF(t,e,n,o,a,d,p,c){return new o_(t,e,n,o,a,d,p,c)}function zk(t){return new o_(t)}function PT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rF(t){return t.collectionGroup!==null}function ef(t){const e=bn(t);if(e.ce===null){e.ce=[];const n=new Set;for(const d of e.explicitOrderBy)e.ce.push(d),n.add(d.field.canonicalString());const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(p){let c=new Di(fo.comparator);return p.filters.forEach(S=>{S.getFlattenedFilters().forEach(A=>{A.isInequality()&&(c=c.add(A.field))})}),c})(e).forEach(d=>{n.has(d.canonicalString())||d.isKeyField()||e.ce.push(new gy(d,o))}),n.has(fo.keyField().canonicalString())||e.ce.push(new gy(fo.keyField(),o))}return e.ce}function wa(t){const e=bn(t);return e.le||(e.le=iF(e,ef(t))),e.le}function iF(t,e){if(t.limitType==="F")return kT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const d=a.dir==="desc"?"asc":"desc";return new gy(a.field,d)});const n=t.endAt?new my(t.endAt.position,t.endAt.inclusive):null,o=t.startAt?new my(t.startAt.position,t.startAt.inclusive):null;return kT(t.path,t.collectionGroup,e,t.filters,t.limit,n,o)}}function D1(t,e,n){return new o_(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function s_(t,e){return _w(wa(t),wa(e))&&t.limitType===e.limitType}function Ok(t){return`${yw(wa(t))}|lt:${t.limitType}`}function mh(t){return`Query(target=${function(n){let o=n.path.canonicalString();return n.collectionGroup!==null&&(o+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(o+=`, filters: [${n.filters.map(a=>Lk(a)).join(", ")}]`),r_(n.limit)||(o+=", limit: "+n.limit),n.orderBy.length>0&&(o+=`, orderBy: [${n.orderBy.map(a=>function(p){return`${p.field.canonicalString()} (${p.dir})`}(a)).join(", ")}]`),n.startAt&&(o+=", startAt: ",o+=n.startAt.inclusive?"b:":"a:",o+=n.startAt.position.map(a=>rd(a)).join(",")),n.endAt&&(o+=", endAt: ",o+=n.endAt.inclusive?"a:":"b:",o+=n.endAt.position.map(a=>rd(a)).join(",")),`Target(${o})`}(wa(t))}; limitType=${t.limitType})`}function a_(t,e){return e.isFoundDocument()&&function(o,a){const d=a.key.path;return o.collectionGroup!==null?a.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(d):qt.isDocumentKey(o.path)?o.path.isEqual(d):o.path.isImmediateParentOf(d)}(t,e)&&function(o,a){for(const d of ef(o))if(!d.field.isKeyField()&&a.data.field(d.field)===null)return!1;return!0}(t,e)&&function(o,a){for(const d of o.filters)if(!d.matches(a))return!1;return!0}(t,e)&&function(o,a){return!(o.startAt&&!function(p,c,S){const A=CT(p,c,S);return p.inclusive?A<=0:A<0}(o.startAt,ef(o),a)||o.endAt&&!function(p,c,S){const A=CT(p,c,S);return p.inclusive?A>=0:A>0}(o.endAt,ef(o),a))}(t,e)}function oF(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Fk(t){return(e,n)=>{let o=!1;for(const a of ef(t)){const d=sF(a,e,n);if(d!==0)return d;o=o||a.field.isKeyField()}return 0}}function sF(t,e,n){const o=t.field.isKeyField()?qt.comparator(e.key,n.key):function(d,p,c){const S=p.data.field(d),A=c.data.field(d);return S!==null&&A!==null?nd(S,A):Qt()}(t.field,e,n);switch(t.dir){case"asc":return o;case"desc":return-1*o;default:return Qt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o!==void 0){for(const[a,d]of o)if(this.equalsFn(a,e))return d}}has(e){return this.get(e)!==void 0}set(e,n){const o=this.mapKeyFn(e),a=this.inner[o];if(a===void 0)return this.inner[o]=[[e,n]],void this.innerSize++;for(let d=0;d<a.length;d++)if(this.equalsFn(a[d][0],e))return void(a[d]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return!1;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return o.length===1?delete this.inner[n]:o.splice(a,1),this.innerSize--,!0;return!1}forEach(e){i_(this.inner,(n,o)=>{for(const[a,d]of o)e(a,d)})}isEmpty(){return U6(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF=new Mr(qt.comparator);function hu(){return aF}const Nk=new Mr(qt.comparator);function Vp(...t){let e=Nk;for(const n of t)e=e.insert(n.key,n);return e}function lF(t){let e=Nk;return t.forEach((n,o)=>e=e.insert(n,o.overlayedDocument)),e}function ec(){return tf()}function Bk(){return tf()}function tf(){return new Sd(t=>t.toString(),(t,e)=>t.isEqual(e))}const uF=new Di(qt.comparator);function xn(...t){let e=uF;for(const n of t)e=e.add(n);return e}const cF=new Di(Ln);function hF(){return cF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:k1(e)?"-0":e}}function pF(t){return{integerValue:""+t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(){this._=void 0}}function fF(t,e,n){return t instanceof z1?function(a,d){const p={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return d&&fw(d)&&(d=mw(d)),d&&(p.fields.__previous_value__=d),{mapValue:p}}(n,e):t instanceof yy?Vk(t,e):t instanceof _y?jk(t,e):function(a,d){const p=gF(a,d),c=RT(p)+RT(a.Pe);return R1(p)&&R1(a.Pe)?pF(c):dF(a.serializer,c)}(t,e)}function mF(t,e,n){return t instanceof yy?Vk(t,e):t instanceof _y?jk(t,e):n}function gF(t,e){return t instanceof O1?function(o){return R1(o)||function(d){return!!d&&"doubleValue"in d}(o)}(e)?e:{integerValue:0}:null}class z1 extends l_{}class yy extends l_{constructor(e){super(),this.elements=e}}function Vk(t,e){const n=Uk(e);for(const o of t.elements)n.some(a=>ba(a,o))||n.push(o);return{arrayValue:{values:n}}}class _y extends l_{constructor(e){super(),this.elements=e}}function jk(t,e){let n=Uk(e);for(const o of t.elements)n=n.filter(a=>!ba(a,o));return{arrayValue:{values:n}}}class O1 extends l_{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function RT(t){return Ur(t.integerValue||t.doubleValue)}function Uk(t){return gw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yF(t,e){return t.field.isEqual(e.field)&&function(o,a){return o instanceof yy&&a instanceof yy||o instanceof _y&&a instanceof _y?td(o.elements,a.elements,ba):o instanceof O1&&a instanceof O1?ba(o.Pe,a.Pe):o instanceof z1&&a instanceof z1}(t.transform,e.transform)}class ac{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ac}static exists(e){return new ac(void 0,e)}static updateTime(e){return new ac(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vw{}function $k(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vF(t.key,ac.none()):new xw(t.key,t.data,ac.none());{const n=t.data,o=ya.empty();let a=new Di(fo.comparator);for(let d of e.fields)if(!a.has(d)){let p=n.field(d);p===null&&d.length>1&&(d=d.popLast(),p=n.field(d)),p===null?o.delete(d):o.set(d,p),a=a.add(d)}return new u_(t.key,o,new Gl(a.toArray()),ac.none())}}function _F(t,e,n){t instanceof xw?function(a,d,p){const c=a.value.clone(),S=LT(a.fieldTransforms,d,p.transformResults);c.setAll(S),d.convertToFoundDocument(p.version,c).setHasCommittedMutations()}(t,e,n):t instanceof u_?function(a,d,p){if(!Cg(a.precondition,d))return void d.convertToUnknownDocument(p.version);const c=LT(a.fieldTransforms,d,p.transformResults),S=d.data;S.setAll(qk(a)),S.setAll(c),d.convertToFoundDocument(p.version,S).setHasCommittedMutations()}(t,e,n):function(a,d,p){d.convertToNoDocument(p.version).setHasCommittedMutations()}(0,e,n)}function nf(t,e,n,o){return t instanceof xw?function(d,p,c,S){if(!Cg(d.precondition,p))return c;const A=d.value.clone(),D=DT(d.fieldTransforms,S,p);return A.setAll(D),p.convertToFoundDocument(p.version,A).setHasLocalMutations(),null}(t,e,n,o):t instanceof u_?function(d,p,c,S){if(!Cg(d.precondition,p))return c;const A=DT(d.fieldTransforms,S,p),D=p.data;return D.setAll(qk(d)),D.setAll(A),p.convertToFoundDocument(p.version,D).setHasLocalMutations(),c===null?null:c.unionWith(d.fieldMask.fields).unionWith(d.fieldTransforms.map(L=>L.field))}(t,e,n,o):function(d,p,c){return Cg(d.precondition,p)?(p.convertToNoDocument(p.version).setHasLocalMutations(),null):c}(t,e,n)}function MT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(o,a){return o===void 0&&a===void 0||!(!o||!a)&&td(o,a,(d,p)=>yF(d,p))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class xw extends vw{constructor(e,n,o,a=[]){super(),this.key=e,this.value=n,this.precondition=o,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class u_ extends vw{constructor(e,n,o,a,d=[]){super(),this.key=e,this.data=n,this.fieldMask=o,this.precondition=a,this.fieldTransforms=d,this.type=1}getFieldMask(){return this.fieldMask}}function qk(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const o=t.data.field(n);e.set(n,o)}}),e}function LT(t,e,n){const o=new Map;Hr(t.length===n.length);for(let a=0;a<n.length;a++){const d=t[a],p=d.transform,c=e.data.field(d.field);o.set(d.field,mF(p,c,n[a]))}return o}function DT(t,e,n){const o=new Map;for(const a of t){const d=a.transform,p=n.data.field(a.field);o.set(a.field,fF(d,p,e))}return o}class vF extends vw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e,n,o,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=o,this.mutations=a}applyToRemoteDocument(e,n){const o=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const d=this.mutations[a];d.key.isEqual(e.key)&&_F(d,e,o[a])}}applyToLocalView(e,n){for(const o of this.baseMutations)o.key.isEqual(e.key)&&(n=nf(o,e,n,this.localWriteTime));for(const o of this.mutations)o.key.isEqual(e.key)&&(n=nf(o,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const o=Bk();return this.mutations.forEach(a=>{const d=e.get(a.key),p=d.overlayedDocument;let c=this.applyToLocalView(p,d.mutatedFields);c=n.has(a.key)?null:c;const S=$k(p,c);S!==null&&o.set(a.key,S),p.isValidDocument()||p.convertToNoDocument(Xt.min())}),o}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),xn())}isEqual(e){return this.batchId===e.batchId&&td(this.mutations,e.mutations,(n,o)=>MT(n,o))&&td(this.baseMutations,e.baseMutations,(n,o)=>MT(n,o))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jr,yn;function Hk(t){if(t===void 0)return al("GRPC error has no .code"),mt.UNKNOWN;switch(t){case jr.OK:return mt.OK;case jr.CANCELLED:return mt.CANCELLED;case jr.UNKNOWN:return mt.UNKNOWN;case jr.DEADLINE_EXCEEDED:return mt.DEADLINE_EXCEEDED;case jr.RESOURCE_EXHAUSTED:return mt.RESOURCE_EXHAUSTED;case jr.INTERNAL:return mt.INTERNAL;case jr.UNAVAILABLE:return mt.UNAVAILABLE;case jr.UNAUTHENTICATED:return mt.UNAUTHENTICATED;case jr.INVALID_ARGUMENT:return mt.INVALID_ARGUMENT;case jr.NOT_FOUND:return mt.NOT_FOUND;case jr.ALREADY_EXISTS:return mt.ALREADY_EXISTS;case jr.PERMISSION_DENIED:return mt.PERMISSION_DENIED;case jr.FAILED_PRECONDITION:return mt.FAILED_PRECONDITION;case jr.ABORTED:return mt.ABORTED;case jr.OUT_OF_RANGE:return mt.OUT_OF_RANGE;case jr.UNIMPLEMENTED:return mt.UNIMPLEMENTED;case jr.DATA_LOSS:return mt.DATA_LOSS;default:return Qt()}}(yn=jr||(jr={}))[yn.OK=0]="OK",yn[yn.CANCELLED=1]="CANCELLED",yn[yn.UNKNOWN=2]="UNKNOWN",yn[yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yn[yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yn[yn.NOT_FOUND=5]="NOT_FOUND",yn[yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",yn[yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",yn[yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",yn[yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yn[yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yn[yn.ABORTED=10]="ABORTED",yn[yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",yn[yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",yn[yn.INTERNAL=13]="INTERNAL",yn[yn.UNAVAILABLE=14]="UNAVAILABLE",yn[yn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TF=new oc([4294967295,4294967295],0);function zT(t){const e=SF().encode(t),n=new xk;return n.update(e),new Uint8Array(n.digest())}function OT(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),o=e.getUint32(4,!0),a=e.getUint32(8,!0),d=e.getUint32(12,!0);return[new oc([n,o],0),new oc([a,d],0)]}class ww{constructor(e,n,o){if(this.bitmap=e,this.padding=n,this.hashCount=o,n<0||n>=8)throw new jp(`Invalid padding: ${n}`);if(o<0)throw new jp(`Invalid hash count: ${o}`);if(e.length>0&&this.hashCount===0)throw new jp(`Invalid hash count: ${o}`);if(e.length===0&&n!==0)throw new jp(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=oc.fromNumber(this.Ie)}Ee(e,n,o){let a=e.add(n.multiply(oc.fromNumber(o)));return a.compare(TF)===1&&(a=new oc([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=zT(e),[o,a]=OT(n);for(let d=0;d<this.hashCount;d++){const p=this.Ee(o,a,d);if(!this.de(p))return!1}return!0}static create(e,n,o){const a=e%8==0?0:8-e%8,d=new Uint8Array(Math.ceil(e/8)),p=new ww(d,a,n);return o.forEach(c=>p.insert(c)),p}insert(e){if(this.Ie===0)return;const n=zT(e),[o,a]=OT(n);for(let d=0;d<this.hashCount;d++){const p=this.Ee(o,a,d);this.Ae(p)}}Ae(e){const n=Math.floor(e/8),o=e%8;this.bitmap[n]|=1<<o}}class jp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,n,o,a,d){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=o,this.documentUpdates=a,this.resolvedLimboDocuments=d}static createSynthesizedRemoteEventForCurrentChange(e,n,o){const a=new Map;return a.set(e,jf.createSynthesizedTargetChangeForCurrentChange(e,n,o)),new c_(Xt.min(),a,new Mr(Ln),hu(),xn())}}class jf{constructor(e,n,o,a,d){this.resumeToken=e,this.current=n,this.addedDocuments=o,this.modifiedDocuments=a,this.removedDocuments=d}static createSynthesizedTargetChangeForCurrentChange(e,n,o){return new jf(o,n,xn(),xn(),xn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,n,o,a){this.Re=e,this.removedTargetIds=n,this.key=o,this.Ve=a}}class Wk{constructor(e,n){this.targetId=e,this.me=n}}class Gk{constructor(e,n,o=to.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=o,this.cause=a}}class FT{constructor(){this.fe=0,this.ge=BT(),this.pe=to.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=xn(),n=xn(),o=xn();return this.ge.forEach((a,d)=>{switch(d){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:o=o.add(a);break;default:Qt()}}),new jf(this.pe,this.ye,e,n,o)}ve(){this.we=!1,this.ge=BT()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Hr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class EF{constructor(e){this.Le=e,this.Be=new Map,this.ke=hu(),this.qe=NT(),this.Qe=new Mr(Ln)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const o=this.Ge(n);switch(e.state){case 0:this.ze(n)&&o.De(e.resumeToken);break;case 1:o.Oe(),o.Se||o.ve(),o.De(e.resumeToken);break;case 2:o.Oe(),o.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(o.Ne(),o.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),o.De(e.resumeToken));break;default:Qt()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((o,a)=>{this.ze(a)&&n(a)})}He(e){const n=e.targetId,o=e.me.count,a=this.Je(n);if(a){const d=a.target;if(L1(d))if(o===0){const p=new qt(d.path);this.Ue(n,p,Ji.newNoDocument(p,Xt.min()))}else Hr(o===1);else{const p=this.Ye(n);if(p!==o){const c=this.Ze(e),S=c?this.Xe(c,e,p):1;if(S!==0){this.je(n);const A=S===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,A)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:o="",padding:a=0},hashCount:d=0}=n;let p,c;try{p=yc(o).toUint8Array()}catch(S){if(S instanceof Ak)return ed("Decoding the base64 bloom filter in existence filter failed ("+S.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw S}try{c=new ww(p,a,d)}catch(S){return ed(S instanceof jp?"BloomFilter error: ":"Applying bloom filter failed: ",S),null}return c.Ie===0?null:c}Xe(e,n,o){return n.me.count===o-this.nt(e,n.targetId)?0:2}nt(e,n){const o=this.Le.getRemoteKeysForTarget(n);let a=0;return o.forEach(d=>{const p=this.Le.tt(),c=`projects/${p.projectId}/databases/${p.database}/documents/${d.path.canonicalString()}`;e.mightContain(c)||(this.Ue(n,d,null),a++)}),a}rt(e){const n=new Map;this.Be.forEach((d,p)=>{const c=this.Je(p);if(c){if(d.current&&L1(c.target)){const S=new qt(c.target.path);this.ke.get(S)!==null||this.it(p,S)||this.Ue(p,S,Ji.newNoDocument(S,e))}d.be&&(n.set(p,d.Ce()),d.ve())}});let o=xn();this.qe.forEach((d,p)=>{let c=!0;p.forEachWhile(S=>{const A=this.Je(S);return!A||A.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(o=o.add(d))}),this.ke.forEach((d,p)=>p.setReadTime(e));const a=new c_(e,n,this.Qe,this.ke,o);return this.ke=hu(),this.qe=NT(),this.Qe=new Mr(Ln),a}$e(e,n){if(!this.ze(e))return;const o=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,o),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,o){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,n)?a.Fe(n,1):a.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),o&&(this.ke=this.ke.insert(n,o))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new FT,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Di(Ln),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||It("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new FT),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function NT(){return new Mr(qt.comparator)}function BT(){return new Mr(qt.comparator)}const IF={asc:"ASCENDING",desc:"DESCENDING"},CF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AF={and:"AND",or:"OR"};class kF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function F1(t,e){return t.useProto3Json||r_(e)?e:{value:e}}function PF(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function RF(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Vh(t){return Hr(!!t),Xt.fromTimestamp(function(n){const o=cu(n);return new Mo(o.seconds,o.nanos)}(t))}function MF(t,e){return N1(t,e).canonicalString()}function N1(t,e){const n=function(a){return new Tr(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Kk(t){const e=Tr.fromString(t);return Hr(Jk(e)),e}function J0(t,e){const n=Kk(e);if(n.get(1)!==t.databaseId.projectId)throw new $t(mt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $t(mt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new qt(Xk(n))}function Zk(t,e){return MF(t.databaseId,e)}function LF(t){const e=Kk(t);return e.length===4?Tr.emptyPath():Xk(e)}function VT(t){return new Tr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Xk(t){return Hr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function DF(t,e){let n;if("targetChange"in e){e.targetChange;const o=function(A){return A==="NO_CHANGE"?0:A==="ADD"?1:A==="REMOVE"?2:A==="CURRENT"?3:A==="RESET"?4:Qt()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],d=function(A,D){return A.useProto3Json?(Hr(D===void 0||typeof D=="string"),to.fromBase64String(D||"")):(Hr(D===void 0||D instanceof Buffer||D instanceof Uint8Array),to.fromUint8Array(D||new Uint8Array))}(t,e.targetChange.resumeToken),p=e.targetChange.cause,c=p&&function(A){const D=A.code===void 0?mt.UNKNOWN:Hk(A.code);return new $t(D,A.message||"")}(p);n=new Gk(o,a,d,c||null)}else if("documentChange"in e){e.documentChange;const o=e.documentChange;o.document,o.document.name,o.document.updateTime;const a=J0(t,o.document.name),d=Vh(o.document.updateTime),p=o.document.createTime?Vh(o.document.createTime):Xt.min(),c=new ya({mapValue:{fields:o.document.fields}}),S=Ji.newFoundDocument(a,d,p,c),A=o.targetIds||[],D=o.removedTargetIds||[];n=new Ag(A,D,S.key,S)}else if("documentDelete"in e){e.documentDelete;const o=e.documentDelete;o.document;const a=J0(t,o.document),d=o.readTime?Vh(o.readTime):Xt.min(),p=Ji.newNoDocument(a,d),c=o.removedTargetIds||[];n=new Ag([],c,p.key,p)}else if("documentRemove"in e){e.documentRemove;const o=e.documentRemove;o.document;const a=J0(t,o.document),d=o.removedTargetIds||[];n=new Ag([],d,a,null)}else{if(!("filter"in e))return Qt();{e.filter;const o=e.filter;o.targetId;const{count:a=0,unchangedNames:d}=o,p=new bF(a,d),c=o.targetId;n=new Wk(c,p)}}return n}function zF(t,e){return{documents:[Zk(t,e.path)]}}function OF(t,e){const n={structuredQuery:{}},o=e.path;let a;e.collectionGroup!==null?(a=o,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=o.popLast(),n.structuredQuery.from=[{collectionId:o.lastSegment()}]),n.parent=Zk(t,a);const d=function(A){if(A.length!==0)return Qk(Sa.create(A,"and"))}(e.filters);d&&(n.structuredQuery.where=d);const p=function(A){if(A.length!==0)return A.map(D=>function(z){return{field:gh(z.field),direction:BF(z.dir)}}(D))}(e.orderBy);p&&(n.structuredQuery.orderBy=p);const c=F1(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(A){return{before:A.inclusive,values:A.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(A){return{before:!A.inclusive,values:A.position}}(e.endAt)),{_t:n,parent:a}}function FF(t){let e=LF(t.parent);const n=t.structuredQuery,o=n.from?n.from.length:0;let a=null;if(o>0){Hr(o===1);const D=n.from[0];D.allDescendants?a=D.collectionId:e=e.child(D.collectionId)}let d=[];n.where&&(d=function(L){const z=Yk(L);return z instanceof Sa&&Rk(z)?z.getFilters():[z]}(n.where));let p=[];n.orderBy&&(p=function(L){return L.map(z=>function(pe){return new gy(yh(pe.field),function(me){switch(me){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(pe.direction))}(z))}(n.orderBy));let c=null;n.limit&&(c=function(L){let z;return z=typeof L=="object"?L.value:L,r_(z)?null:z}(n.limit));let S=null;n.startAt&&(S=function(L){const z=!!L.before,ee=L.values||[];return new my(ee,z)}(n.startAt));let A=null;return n.endAt&&(A=function(L){const z=!L.before,ee=L.values||[];return new my(ee,z)}(n.endAt)),nF(e,a,p,d,c,"F",S,A)}function NF(t,e){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qt()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Yk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const o=yh(n.unaryFilter.field);return Qr.create(o,"==",{doubleValue:NaN});case"IS_NULL":const a=yh(n.unaryFilter.field);return Qr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=yh(n.unaryFilter.field);return Qr.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const p=yh(n.unaryFilter.field);return Qr.create(p,"!=",{nullValue:"NULL_VALUE"});default:return Qt()}}(t):t.fieldFilter!==void 0?function(n){return Qr.create(yh(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Qt()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Sa.create(n.compositeFilter.filters.map(o=>Yk(o)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Qt()}}(n.compositeFilter.op))}(t):Qt()}function BF(t){return IF[t]}function VF(t){return CF[t]}function jF(t){return AF[t]}function gh(t){return{fieldPath:t.canonicalString()}}function yh(t){return fo.fromServerFormat(t.fieldPath)}function Qk(t){return t instanceof Qr?function(n){if(n.op==="=="){if(IT(n.value))return{unaryFilter:{field:gh(n.field),op:"IS_NAN"}};if(ET(n.value))return{unaryFilter:{field:gh(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(IT(n.value))return{unaryFilter:{field:gh(n.field),op:"IS_NOT_NAN"}};if(ET(n.value))return{unaryFilter:{field:gh(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gh(n.field),op:VF(n.op),value:n.value}}}(t):t instanceof Sa?function(n){const o=n.getFilters().map(a=>Qk(a));return o.length===1?o[0]:{compositeFilter:{op:jF(n.op),filters:o}}}(t):Qt()}function Jk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,n,o,a,d=Xt.min(),p=Xt.min(),c=to.EMPTY_BYTE_STRING,S=null){this.target=e,this.targetId=n,this.purpose=o,this.sequenceNumber=a,this.snapshotVersion=d,this.lastLimboFreeSnapshotVersion=p,this.resumeToken=c,this.expectedCount=S}withSequenceNumber(e){return new Kl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Kl(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e){this.ct=e}}function $F(t){const e=FF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?D1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(){this._n=new HF}addToCollectionParentIndex(e,n){return this._n.add(n),Qe.resolve()}getCollectionParents(e,n){return Qe.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return Qe.resolve()}deleteFieldIndex(e,n){return Qe.resolve()}deleteAllFieldIndexes(e){return Qe.resolve()}createTargetIndexes(e,n){return Qe.resolve()}getDocumentsMatchingTarget(e,n){return Qe.resolve(null)}getIndexType(e,n){return Qe.resolve(0)}getFieldIndexes(e,n){return Qe.resolve([])}getNextCollectionGroupToUpdate(e){return Qe.resolve(null)}getMinOffset(e,n){return Qe.resolve(uu.min())}getMinOffsetFromCollectionGroup(e,n){return Qe.resolve(uu.min())}updateCollectionGroup(e,n,o){return Qe.resolve()}updateIndexEntries(e,n){return Qe.resolve()}}class HF{constructor(){this.index={}}add(e){const n=e.lastSegment(),o=e.popLast(),a=this.index[n]||new Di(Tr.comparator),d=!a.has(o);return this.index[n]=a.add(o),d}has(e){const n=e.lastSegment(),o=e.popLast(),a=this.index[n];return a&&a.has(o)}getEntries(e){return(this.index[e]||new Di(Tr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new id(0)}static Ln(){return new id(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(){this.changes=new Sd(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ji.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const o=this.changes.get(n);return o!==void 0?Qe.resolve(o):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,n,o,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=o,this.indexManager=a}getDocument(e,n){let o=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(o=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(o!==null&&nf(o.mutation,a,Gl.empty(),Mo.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(o=>this.getLocalViewOfDocuments(e,o,xn()).next(()=>o))}getLocalViewOfDocuments(e,n,o=xn()){const a=ec();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,o).next(d=>{let p=Vp();return d.forEach((c,S)=>{p=p.insert(c,S.overlayedDocument)}),p}))}getOverlayedDocuments(e,n){const o=ec();return this.populateOverlays(e,o,n).next(()=>this.computeViews(e,n,o,xn()))}populateOverlays(e,n,o){const a=[];return o.forEach(d=>{n.has(d)||a.push(d)}),this.documentOverlayCache.getOverlays(e,a).next(d=>{d.forEach((p,c)=>{n.set(p,c)})})}computeViews(e,n,o,a){let d=hu();const p=tf(),c=function(){return tf()}();return n.forEach((S,A)=>{const D=o.get(A.key);a.has(A.key)&&(D===void 0||D.mutation instanceof u_)?d=d.insert(A.key,A):D!==void 0?(p.set(A.key,D.mutation.getFieldMask()),nf(D.mutation,A,D.mutation.getFieldMask(),Mo.now())):p.set(A.key,Gl.empty())}),this.recalculateAndSaveOverlays(e,d).next(S=>(S.forEach((A,D)=>p.set(A,D)),n.forEach((A,D)=>{var L;return c.set(A,new GF(D,(L=p.get(A))!==null&&L!==void 0?L:null))}),c))}recalculateAndSaveOverlays(e,n){const o=tf();let a=new Mr((p,c)=>p-c),d=xn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(p=>{for(const c of p)c.keys().forEach(S=>{const A=n.get(S);if(A===null)return;let D=o.get(S)||Gl.empty();D=c.applyToLocalView(A,D),o.set(S,D);const L=(a.get(c.batchId)||xn()).add(S);a=a.insert(c.batchId,L)})}).next(()=>{const p=[],c=a.getReverseIterator();for(;c.hasNext();){const S=c.getNext(),A=S.key,D=S.value,L=Bk();D.forEach(z=>{if(!d.has(z)){const ee=$k(n.get(z),o.get(z));ee!==null&&L.set(z,ee),d=d.add(z)}}),p.push(this.documentOverlayCache.saveOverlays(e,A,L))}return Qe.waitFor(p)}).next(()=>o)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(o=>this.recalculateAndSaveOverlays(e,o))}getDocumentsMatchingQuery(e,n,o,a){return function(p){return qt.isDocumentKey(p.path)&&p.collectionGroup===null&&p.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rF(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,o,a):this.getDocumentsMatchingCollectionQuery(e,n,o,a)}getNextDocuments(e,n,o,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,o,a).next(d=>{const p=a-d.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,o.largestBatchId,a-d.size):Qe.resolve(ec());let c=-1,S=d;return p.next(A=>Qe.forEach(A,(D,L)=>(c<L.largestBatchId&&(c=L.largestBatchId),d.get(D)?Qe.resolve():this.remoteDocumentCache.getEntry(e,D).next(z=>{S=S.insert(D,z)}))).next(()=>this.populateOverlays(e,A,d)).next(()=>this.computeViews(e,S,A,xn())).next(D=>({batchId:c,changes:lF(D)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new qt(n)).next(o=>{let a=Vp();return o.isFoundDocument()&&(a=a.insert(o.key,o)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,o,a){const d=n.collectionGroup;let p=Vp();return this.indexManager.getCollectionParents(e,d).next(c=>Qe.forEach(c,S=>{const A=function(L,z){return new o_(z,null,L.explicitOrderBy.slice(),L.filters.slice(),L.limit,L.limitType,L.startAt,L.endAt)}(n,S.child(d));return this.getDocumentsMatchingCollectionQuery(e,A,o,a).next(D=>{D.forEach((L,z)=>{p=p.insert(L,z)})})}).next(()=>p))}getDocumentsMatchingCollectionQuery(e,n,o,a){let d;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,o.largestBatchId).next(p=>(d=p,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,o,d,a))).next(p=>{d.forEach((S,A)=>{const D=A.getKey();p.get(D)===null&&(p=p.insert(D,Ji.newInvalidDocument(D)))});let c=Vp();return p.forEach((S,A)=>{const D=d.get(S);D!==void 0&&nf(D.mutation,A,Gl.empty(),Mo.now()),a_(n,A)&&(c=c.insert(S,A))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return Qe.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(a){return{id:a.id,version:a.version,createTime:Vh(a.createTime)}}(n)),Qe.resolve()}getNamedQuery(e,n){return Qe.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(a){return{name:a.name,query:$F(a.bundledQuery),readTime:Vh(a.readTime)}}(n)),Qe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(){this.overlays=new Mr(qt.comparator),this.hr=new Map}getOverlay(e,n){return Qe.resolve(this.overlays.get(n))}getOverlays(e,n){const o=ec();return Qe.forEach(n,a=>this.getOverlay(e,a).next(d=>{d!==null&&o.set(a,d)})).next(()=>o)}saveOverlays(e,n,o){return o.forEach((a,d)=>{this.ht(e,n,d)}),Qe.resolve()}removeOverlaysForBatchId(e,n,o){const a=this.hr.get(o);return a!==void 0&&(a.forEach(d=>this.overlays=this.overlays.remove(d)),this.hr.delete(o)),Qe.resolve()}getOverlaysForCollection(e,n,o){const a=ec(),d=n.length+1,p=new qt(n.child("")),c=this.overlays.getIteratorFrom(p);for(;c.hasNext();){const S=c.getNext().value,A=S.getKey();if(!n.isPrefixOf(A.path))break;A.path.length===d&&S.largestBatchId>o&&a.set(S.getKey(),S)}return Qe.resolve(a)}getOverlaysForCollectionGroup(e,n,o,a){let d=new Mr((A,D)=>A-D);const p=this.overlays.getIterator();for(;p.hasNext();){const A=p.getNext().value;if(A.getKey().getCollectionGroup()===n&&A.largestBatchId>o){let D=d.get(A.largestBatchId);D===null&&(D=ec(),d=d.insert(A.largestBatchId,D)),D.set(A.getKey(),A)}}const c=ec(),S=d.getIterator();for(;S.hasNext()&&(S.getNext().value.forEach((A,D)=>c.set(A,D)),!(c.size()>=a)););return Qe.resolve(c)}ht(e,n,o){const a=this.overlays.get(o.key);if(a!==null){const p=this.hr.get(a.largestBatchId).delete(o.key);this.hr.set(a.largestBatchId,p)}this.overlays=this.overlays.insert(o.key,new wF(n,o));let d=this.hr.get(n);d===void 0&&(d=xn(),this.hr.set(n,d)),this.hr.set(n,d.add(o.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(){this.Pr=new Di(yi.Ir),this.Tr=new Di(yi.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const o=new yi(e,n);this.Pr=this.Pr.add(o),this.Tr=this.Tr.add(o)}dr(e,n){e.forEach(o=>this.addReference(o,n))}removeReference(e,n){this.Ar(new yi(e,n))}Rr(e,n){e.forEach(o=>this.removeReference(o,n))}Vr(e){const n=new qt(new Tr([])),o=new yi(n,e),a=new yi(n,e+1),d=[];return this.Tr.forEachInRange([o,a],p=>{this.Ar(p),d.push(p.key)}),d}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new qt(new Tr([])),o=new yi(n,e),a=new yi(n,e+1);let d=xn();return this.Tr.forEachInRange([o,a],p=>{d=d.add(p.key)}),d}containsKey(e){const n=new yi(e,0),o=this.Pr.firstAfterOrEqual(n);return o!==null&&e.isEqual(o.key)}}class yi{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return qt.comparator(e.key,n.key)||Ln(e.pr,n.pr)}static Er(e,n){return Ln(e.pr,n.pr)||qt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Di(yi.Ir)}checkEmpty(e){return Qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,o,a){const d=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const p=new xF(d,n,o,a);this.mutationQueue.push(p);for(const c of a)this.wr=this.wr.add(new yi(c.key,d)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Qe.resolve(p)}lookupMutationBatch(e,n){return Qe.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const o=n+1,a=this.br(o),d=a<0?0:a;return Qe.resolve(this.mutationQueue.length>d?this.mutationQueue[d]:null)}getHighestUnacknowledgedBatchId(){return Qe.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return Qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const o=new yi(n,0),a=new yi(n,Number.POSITIVE_INFINITY),d=[];return this.wr.forEachInRange([o,a],p=>{const c=this.Sr(p.pr);d.push(c)}),Qe.resolve(d)}getAllMutationBatchesAffectingDocumentKeys(e,n){let o=new Di(Ln);return n.forEach(a=>{const d=new yi(a,0),p=new yi(a,Number.POSITIVE_INFINITY);this.wr.forEachInRange([d,p],c=>{o=o.add(c.pr)})}),Qe.resolve(this.Dr(o))}getAllMutationBatchesAffectingQuery(e,n){const o=n.path,a=o.length+1;let d=o;qt.isDocumentKey(d)||(d=d.child(""));const p=new yi(new qt(d),0);let c=new Di(Ln);return this.wr.forEachWhile(S=>{const A=S.key.path;return!!o.isPrefixOf(A)&&(A.length===a&&(c=c.add(S.pr)),!0)},p),Qe.resolve(this.Dr(c))}Dr(e){const n=[];return e.forEach(o=>{const a=this.Sr(o);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){Hr(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let o=this.wr;return Qe.forEach(n.mutations,a=>{const d=new yi(a.key,n.batchId);return o=o.delete(d),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.wr=o})}Mn(e){}containsKey(e,n){const o=new yi(n,0),a=this.wr.firstAfterOrEqual(o);return Qe.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Qe.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e){this.vr=e,this.docs=function(){return new Mr(qt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const o=n.key,a=this.docs.get(o),d=a?a.size:0,p=this.vr(n);return this.docs=this.docs.insert(o,{document:n.mutableCopy(),size:p}),this.size+=p-d,this.indexManager.addToCollectionParentIndex(e,o.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const o=this.docs.get(n);return Qe.resolve(o?o.document.mutableCopy():Ji.newInvalidDocument(n))}getEntries(e,n){let o=hu();return n.forEach(a=>{const d=this.docs.get(a);o=o.insert(a,d?d.document.mutableCopy():Ji.newInvalidDocument(a))}),Qe.resolve(o)}getDocumentsMatchingQuery(e,n,o,a){let d=hu();const p=n.path,c=new qt(p.child("")),S=this.docs.getIteratorFrom(c);for(;S.hasNext();){const{key:A,value:{document:D}}=S.getNext();if(!p.isPrefixOf(A.path))break;A.path.length>p.length+1||N6(F6(D),o)<=0||(a.has(D.key)||a_(n,D))&&(d=d.insert(D.key,D.mutableCopy()))}return Qe.resolve(d)}getAllFromCollectionGroup(e,n,o,a){Qt()}Fr(e,n){return Qe.forEach(this.docs,o=>n(o))}newChangeBuffer(e){return new JF(this)}getSize(e){return Qe.resolve(this.size)}}class JF extends WF{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((o,a)=>{a.isValidDocument()?n.push(this.ar.addEntry(e,a)):this.ar.removeEntry(o)}),Qe.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e){this.persistence=e,this.Mr=new Sd(n=>yw(n),_w),this.lastRemoteSnapshotVersion=Xt.min(),this.highestTargetId=0,this.Or=0,this.Nr=new bw,this.targetCount=0,this.Lr=id.Nn()}forEachTarget(e,n){return this.Mr.forEach((o,a)=>n(a)),Qe.resolve()}getLastRemoteSnapshotVersion(e){return Qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Qe.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),Qe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,o){return o&&(this.lastRemoteSnapshotVersion=o),n>this.Or&&(this.Or=n),Qe.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Lr=new id(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,Qe.resolve()}updateTargetData(e,n){return this.qn(n),Qe.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,Qe.resolve()}removeTargets(e,n,o){let a=0;const d=[];return this.Mr.forEach((p,c)=>{c.sequenceNumber<=n&&o.get(c.targetId)===null&&(this.Mr.delete(p),d.push(this.removeMatchingKeysForTargetId(e,c.targetId)),a++)}),Qe.waitFor(d).next(()=>a)}getTargetCount(e){return Qe.resolve(this.targetCount)}getTargetData(e,n){const o=this.Mr.get(n)||null;return Qe.resolve(o)}addMatchingKeys(e,n,o){return this.Nr.dr(n,o),Qe.resolve()}removeMatchingKeys(e,n,o){this.Nr.Rr(n,o);const a=this.persistence.referenceDelegate,d=[];return a&&n.forEach(p=>{d.push(a.markPotentiallyOrphaned(e,p))}),Qe.waitFor(d)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),Qe.resolve()}getMatchingKeysForTargetId(e,n){const o=this.Nr.gr(n);return Qe.resolve(o)}containsKey(e,n){return Qe.resolve(this.Nr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,n){this.Br={},this.overlays={},this.kr=new pw(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new eN(this),this.indexManager=new qF,this.remoteDocumentCache=function(a){return new QF(a)}(o=>this.referenceDelegate.Kr(o)),this.serializer=new UF(n),this.$r=new ZF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new XF,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let o=this.Br[e.toKey()];return o||(o=new YF(n,this.referenceDelegate),this.Br[e.toKey()]=o),o}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,o){It("MemoryPersistence","Starting transaction:",e);const a=new nN(this.kr.next());return this.referenceDelegate.Ur(),o(a).next(d=>this.referenceDelegate.Wr(a).next(()=>d)).toPromise().then(d=>(a.raiseOnCommittedEvent(),d))}Gr(e,n){return Qe.or(Object.values(this.Br).map(o=>()=>o.containsKey(e,n)))}}class nN extends V6{constructor(e){super(),this.currentSequenceNumber=e}}class Sw{constructor(e){this.persistence=e,this.zr=new bw,this.jr=null}static Hr(e){return new Sw(e)}get Jr(){if(this.jr)return this.jr;throw Qt()}addReference(e,n,o){return this.zr.addReference(o,n),this.Jr.delete(o.toString()),Qe.resolve()}removeReference(e,n,o){return this.zr.removeReference(o,n),this.Jr.add(o.toString()),Qe.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),Qe.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(a=>this.Jr.add(a.toString()));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(d=>this.Jr.add(d.toString()))}).next(()=>o.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qe.forEach(this.Jr,o=>{const a=qt.fromPath(o);return this.Yr(e,a).next(d=>{d||n.removeEntry(a,Xt.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(o=>{o?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return Qe.or([()=>Qe.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e,n,o,a){this.targetId=e,this.fromCache=n,this.qi=o,this.Qi=a}static Ki(e,n){let o=xn(),a=xn();for(const d of n.docChanges)switch(d.type){case 0:o=o.add(d.doc.key);break;case 1:a=a.add(d.doc.key)}return new Tw(e,n.fromCache,o,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return fO()?8:j6(dO())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,o,a){const d={result:null};return this.ji(e,n).next(p=>{d.result=p}).next(()=>{if(!d.result)return this.Hi(e,n,a,o).next(p=>{d.result=p})}).next(()=>{if(d.result)return;const p=new rN;return this.Ji(e,n,p).next(c=>{if(d.result=c,this.Ui)return this.Yi(e,n,p,c.size)})}).next(()=>d.result)}Yi(e,n,o,a){return o.documentReadCount<this.Wi?(Pp()<=vn.DEBUG&&It("QueryEngine","SDK will not create cache indexes for query:",mh(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Qe.resolve()):(Pp()<=vn.DEBUG&&It("QueryEngine","Query:",mh(n),"scans",o.documentReadCount,"local documents and returns",a,"documents as results."),o.documentReadCount>this.Gi*a?(Pp()<=vn.DEBUG&&It("QueryEngine","The SDK decides to create cache indexes for query:",mh(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wa(n))):Qe.resolve())}ji(e,n){if(PT(n))return Qe.resolve(null);let o=wa(n);return this.indexManager.getIndexType(e,o).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=D1(n,null,"F"),o=wa(n)),this.indexManager.getDocumentsMatchingTarget(e,o).next(d=>{const p=xn(...d);return this.zi.getDocuments(e,p).next(c=>this.indexManager.getMinOffset(e,o).next(S=>{const A=this.Zi(n,c);return this.Xi(n,A,p,S.readTime)?this.ji(e,D1(n,null,"F")):this.es(e,A,n,S)}))})))}Hi(e,n,o,a){return PT(n)||a.isEqual(Xt.min())?Qe.resolve(null):this.zi.getDocuments(e,o).next(d=>{const p=this.Zi(n,d);return this.Xi(n,p,o,a)?Qe.resolve(null):(Pp()<=vn.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),mh(n)),this.es(e,p,n,O6(a,-1)).next(c=>c))})}Zi(e,n){let o=new Di(Fk(e));return n.forEach((a,d)=>{a_(e,d)&&(o=o.add(d))}),o}Xi(e,n,o,a){if(e.limit===null)return!1;if(o.size!==n.size)return!0;const d=e.limitType==="F"?n.last():n.first();return!!d&&(d.hasPendingWrites||d.version.compareTo(a)>0)}Ji(e,n,o){return Pp()<=vn.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",mh(n)),this.zi.getDocumentsMatchingQuery(e,n,uu.min(),o)}es(e,n,o,a){return this.zi.getDocumentsMatchingQuery(e,o,a).next(d=>(n.forEach(p=>{d=d.insert(p.key,p)}),d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,n,o,a){this.persistence=e,this.ts=n,this.serializer=a,this.ns=new Mr(Ln),this.rs=new Sd(d=>yw(d),_w),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(o)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KF(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}}function sN(t,e,n,o){return new oN(t,e,n,o)}async function eP(t,e){const n=bn(t);return await n.persistence.runTransaction("Handle user change","readonly",o=>{let a;return n.mutationQueue.getAllMutationBatches(o).next(d=>(a=d,n._s(e),n.mutationQueue.getAllMutationBatches(o))).next(d=>{const p=[],c=[];let S=xn();for(const A of a){p.push(A.batchId);for(const D of A.mutations)S=S.add(D.key)}for(const A of d){c.push(A.batchId);for(const D of A.mutations)S=S.add(D.key)}return n.localDocuments.getDocuments(o,S).next(A=>({us:A,removedBatchIds:p,addedBatchIds:c}))})})}function tP(t){const e=bn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function aN(t,e){const n=bn(t),o=e.snapshotVersion;let a=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",d=>{const p=n.os.newChangeBuffer({trackRemovals:!0});a=n.ns;const c=[];e.targetChanges.forEach((D,L)=>{const z=a.get(L);if(!z)return;c.push(n.Qr.removeMatchingKeys(d,D.removedDocuments,L).next(()=>n.Qr.addMatchingKeys(d,D.addedDocuments,L)));let ee=z.withSequenceNumber(d.currentSequenceNumber);e.targetMismatches.get(L)!==null?ee=ee.withResumeToken(to.EMPTY_BYTE_STRING,Xt.min()).withLastLimboFreeSnapshotVersion(Xt.min()):D.resumeToken.approximateByteSize()>0&&(ee=ee.withResumeToken(D.resumeToken,o)),a=a.insert(L,ee),function(ue,me,te){return ue.resumeToken.approximateByteSize()===0||me.snapshotVersion.toMicroseconds()-ue.snapshotVersion.toMicroseconds()>=3e8?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0}(z,ee,D)&&c.push(n.Qr.updateTargetData(d,ee))});let S=hu(),A=xn();if(e.documentUpdates.forEach(D=>{e.resolvedLimboDocuments.has(D)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(d,D))}),c.push(lN(d,p,e.documentUpdates).next(D=>{S=D.cs,A=D.ls})),!o.isEqual(Xt.min())){const D=n.Qr.getLastRemoteSnapshotVersion(d).next(L=>n.Qr.setTargetsMetadata(d,d.currentSequenceNumber,o));c.push(D)}return Qe.waitFor(c).next(()=>p.apply(d)).next(()=>n.localDocuments.getLocalViewOfDocuments(d,S,A)).next(()=>S)}).then(d=>(n.ns=a,d))}function lN(t,e,n){let o=xn(),a=xn();return n.forEach(d=>o=o.add(d)),e.getEntries(t,o).next(d=>{let p=hu();return n.forEach((c,S)=>{const A=d.get(c);S.isFoundDocument()!==A.isFoundDocument()&&(a=a.add(c)),S.isNoDocument()&&S.version.isEqual(Xt.min())?(e.removeEntry(c,S.readTime),p=p.insert(c,S)):!A.isValidDocument()||S.version.compareTo(A.version)>0||S.version.compareTo(A.version)===0&&A.hasPendingWrites?(e.addEntry(S),p=p.insert(c,S)):It("LocalStore","Ignoring outdated watch update for ",c,". Current version:",A.version," Watch version:",S.version)}),{cs:p,ls:a}})}function uN(t,e){const n=bn(t);return n.persistence.runTransaction("Allocate target","readwrite",o=>{let a;return n.Qr.getTargetData(o,e).next(d=>d?(a=d,Qe.resolve(a)):n.Qr.allocateTargetId(o).next(p=>(a=new Kl(e,p,"TargetPurposeListen",o.currentSequenceNumber),n.Qr.addTargetData(o,a).next(()=>a))))}).then(o=>{const a=n.ns.get(o.targetId);return(a===null||o.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.ns=n.ns.insert(o.targetId,o),n.rs.set(e,o.targetId)),o})}async function B1(t,e,n){const o=bn(t),a=o.ns.get(e),d=n?"readwrite":"readwrite-primary";try{n||await o.persistence.runTransaction("Release target",d,p=>o.persistence.referenceDelegate.removeTarget(p,a))}catch(p){if(!Vf(p))throw p;It("LocalStore",`Failed to update sequence numbers for target ${e}: ${p}`)}o.ns=o.ns.remove(e),o.rs.delete(a.target)}function jT(t,e,n){const o=bn(t);let a=Xt.min(),d=xn();return o.persistence.runTransaction("Execute query","readwrite",p=>function(S,A,D){const L=bn(S),z=L.rs.get(D);return z!==void 0?Qe.resolve(L.ns.get(z)):L.Qr.getTargetData(A,D)}(o,p,wa(e)).next(c=>{if(c)return a=c.lastLimboFreeSnapshotVersion,o.Qr.getMatchingKeysForTargetId(p,c.targetId).next(S=>{d=S})}).next(()=>o.ts.getDocumentsMatchingQuery(p,e,n?a:Xt.min(),n?d:xn())).next(c=>(cN(o,oF(e),c),{documents:c,hs:d})))}function cN(t,e,n){let o=t.ss.get(e)||Xt.min();n.forEach((a,d)=>{d.readTime.compareTo(o)>0&&(o=d.readTime)}),t.ss.set(e,o)}class UT{constructor(){this.activeTargetIds=hF()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hN{constructor(){this.no=new UT,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,o){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,o){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new UT,Promise.resolve()}handleUserChange(e,n,o){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{io(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){It("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){It("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let og=null;function ev(){return og===null?og=function(){return 268435456+Math.round(2147483648*Math.random())}():og++,"0x"+og.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="WebChannelConnection";class mN extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const o=n.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.wo=o+"://"+n.host,this.So=`projects/${a}/databases/${d}`,this.bo=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${d}`}get Do(){return!1}Co(n,o,a,d,p){const c=ev(),S=this.vo(n,o.toUriEncodedString());It("RestConnection",`Sending RPC '${n}' ${c}:`,S,a);const A={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(A,d,p),this.Mo(n,S,A,a).then(D=>(It("RestConnection",`Received RPC '${n}' ${c}: `,D),D),D=>{throw ed("RestConnection",`RPC '${n}' ${c} failed with error: `,D,"url: ",S,"request:",a),D})}xo(n,o,a,d,p,c){return this.Co(n,o,a,d,p)}Fo(n,o,a){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+bd}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),o&&o.headers.forEach((d,p)=>n[p]=d),a&&a.headers.forEach((d,p)=>n[p]=d)}vo(n,o){const a=pN[n];return`${this.wo}/v1/${o}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,n,o,a){const d=ev();return new Promise((p,c)=>{const S=new wk;S.setWithCredentials(!0),S.listenOnce(Sk.COMPLETE,()=>{try{switch(S.getLastErrorCode()){case Ig.NO_ERROR:const D=S.getResponseJson();It(Xi,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(D)),p(D);break;case Ig.TIMEOUT:It(Xi,`RPC '${e}' ${d} timed out`),c(new $t(mt.DEADLINE_EXCEEDED,"Request time out"));break;case Ig.HTTP_ERROR:const L=S.getStatus();if(It(Xi,`RPC '${e}' ${d} failed with status:`,L,"response text:",S.getResponseText()),L>0){let z=S.getResponseJson();Array.isArray(z)&&(z=z[0]);const ee=z==null?void 0:z.error;if(ee&&ee.status&&ee.message){const pe=function(me){const te=me.toLowerCase().replace(/_/g,"-");return Object.values(mt).indexOf(te)>=0?te:mt.UNKNOWN}(ee.status);c(new $t(pe,ee.message))}else c(new $t(mt.UNKNOWN,"Server responded with status "+S.getStatus()))}else c(new $t(mt.UNAVAILABLE,"Connection failed."));break;default:Qt()}}finally{It(Xi,`RPC '${e}' ${d} completed.`)}});const A=JSON.stringify(a);It(Xi,`RPC '${e}' ${d} sending request:`,a),S.send(n,"POST",A,o,15)})}Oo(e,n,o){const a=ev(),d=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],p=Ik(),c=Ek(),S={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},A=this.longPollingOptions.timeoutSeconds;A!==void 0&&(S.longPollingTimeout=Math.round(1e3*A)),this.useFetchStreams&&(S.xmlHttpFactory=new bk({})),this.Fo(S.initMessageHeaders,n,o),S.encodeInitMessageHeaders=!0;const D=d.join("");It(Xi,`Creating RPC '${e}' stream ${a}: ${D}`,S);const L=p.createWebChannel(D,S);let z=!1,ee=!1;const pe=new fN({lo:me=>{ee?It(Xi,`Not sending because RPC '${e}' stream ${a} is closed:`,me):(z||(It(Xi,`Opening RPC '${e}' stream ${a} transport.`),L.open(),z=!0),It(Xi,`RPC '${e}' stream ${a} sending:`,me),L.send(me))},ho:()=>L.close()}),ue=(me,te,G)=>{me.listen(te,re=>{try{G(re)}catch(be){setTimeout(()=>{throw be},0)}})};return ue(L,Bp.EventType.OPEN,()=>{ee||(It(Xi,`RPC '${e}' stream ${a} transport opened.`),pe.mo())}),ue(L,Bp.EventType.CLOSE,()=>{ee||(ee=!0,It(Xi,`RPC '${e}' stream ${a} transport closed`),pe.po())}),ue(L,Bp.EventType.ERROR,me=>{ee||(ee=!0,ed(Xi,`RPC '${e}' stream ${a} transport errored:`,me),pe.po(new $t(mt.UNAVAILABLE,"The operation could not be completed")))}),ue(L,Bp.EventType.MESSAGE,me=>{var te;if(!ee){const G=me.data[0];Hr(!!G);const re=G,be=re.error||((te=re[0])===null||te===void 0?void 0:te.error);if(be){It(Xi,`RPC '${e}' stream ${a} received error:`,be);const Le=be.status;let Me=function(Y){const ie=jr[Y];if(ie!==void 0)return Hk(ie)}(Le),J=be.message;Me===void 0&&(Me=mt.INTERNAL,J="Unknown error status: "+Le+" with message "+be.message),ee=!0,pe.po(new $t(Me,J)),L.close()}else It(Xi,`RPC '${e}' stream ${a} received:`,G),pe.yo(G)}}),ue(c,Tk.STAT_EVENT,me=>{me.stat===A1.PROXY?It(Xi,`RPC '${e}' stream ${a} detected buffering proxy`):me.stat===A1.NOPROXY&&It(Xi,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{pe.fo()},0),pe}}function tv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){return new kF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n,o=1e3,a=1.5,d=6e4){this.oi=e,this.timerId=n,this.No=o,this.Lo=a,this.Bo=d,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const n=Math.floor(this.ko+this.Uo()),o=Math.max(0,Date.now()-this.Qo),a=Math.max(0,n-o);a>0&&It("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.ko} ms, delay with jitter: ${n} ms, last attempt: ${o} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,a,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,n,o,a,d,p,c,S){this.oi=e,this.Go=o,this.zo=a,this.connection=d,this.authCredentialsProvider=p,this.appCheckCredentialsProvider=c,this.listener=S,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new rP(e,n)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,n){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():n&&n.code===mt.RESOURCE_EXHAUSTED?(al(n.toString()),al("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):n&&n.code===mt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(n)}__(){}auth(){this.state=1;const e=this.a_(this.jo),n=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([o,a])=>{this.jo===n&&this.u_(o,a)},o=>{e(()=>{const a=new $t(mt.UNKNOWN,"Fetching auth token failed: "+o.message);return this.c_(a)})})}u_(e,n){const o=this.a_(this.jo);this.stream=this.l_(e,n),this.stream.Po(()=>{o(()=>this.listener.Po())}),this.stream.To(()=>{o(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(a=>{o(()=>this.c_(a))}),this.stream.onMessage(a=>{o(()=>this.onMessage(a))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(e){return It("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return n=>{this.oi.enqueueAndForget(()=>this.jo===e?n():(It("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yN extends gN{constructor(e,n,o,a,d,p){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,o,a,p),this.serializer=d}l_(e,n){return this.connection.Oo("Listen",e,n)}onMessage(e){this.Yo.reset();const n=DF(this.serializer,e),o=function(d){if(!("targetChange"in d))return Xt.min();const p=d.targetChange;return p.targetIds&&p.targetIds.length?Xt.min():p.readTime?Vh(p.readTime):Xt.min()}(e);return this.listener.h_(n,o)}P_(e){const n={};n.database=VT(this.serializer),n.addTarget=function(d,p){let c;const S=p.target;if(c=L1(S)?{documents:zF(d,S)}:{query:OF(d,S)._t},c.targetId=p.targetId,p.resumeToken.approximateByteSize()>0){c.resumeToken=RF(d,p.resumeToken);const A=F1(d,p.expectedCount);A!==null&&(c.expectedCount=A)}else if(p.snapshotVersion.compareTo(Xt.min())>0){c.readTime=PF(d,p.snapshotVersion.toTimestamp());const A=F1(d,p.expectedCount);A!==null&&(c.expectedCount=A)}return c}(this.serializer,e);const o=NF(this.serializer,e);o&&(n.labels=o),this.i_(n)}I_(e){const n={};n.database=VT(this.serializer),n.removeTarget=e,this.i_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N extends class{}{constructor(e,n,o,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=o,this.serializer=a,this.m_=!1}f_(){if(this.m_)throw new $t(mt.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,n,o,a){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,p])=>this.connection.Co(e,N1(n,o),a,d,p)).catch(d=>{throw d.name==="FirebaseError"?(d.code===mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new $t(mt.UNKNOWN,d.toString())})}xo(e,n,o,a,d){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([p,c])=>this.connection.xo(e,N1(n,o),a,p,c,d)).catch(p=>{throw p.name==="FirebaseError"?(p.code===mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),p):new $t(mt.UNKNOWN,p.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class vN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(al(n),this.y_=!1):It("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,n,o,a,d){this.localStore=e,this.datastore=n,this.asyncQueue=o,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=d,this.O_.io(p=>{o.enqueueAndForget(async()=>{$f(this)&&(It("RemoteStore","Restarting streams for network reachability change."),await async function(S){const A=bn(S);A.M_.add(4),await Uf(A),A.N_.set("Unknown"),A.M_.delete(4),await h_(A)}(this))})}),this.N_=new vN(o,a)}}async function h_(t){if($f(t))for(const e of t.x_)await e(!0)}async function Uf(t){for(const e of t.x_)await e(!1)}function iP(t,e){const n=bn(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),Aw(n)?Cw(n):Td(n).Xo()&&Iw(n,e))}function Ew(t,e){const n=bn(t),o=Td(n);n.F_.delete(e),o.Xo()&&oP(n,e),n.F_.size===0&&(o.Xo()?o.n_():$f(n)&&n.N_.set("Unknown"))}function Iw(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Td(t).P_(e)}function oP(t,e){t.L_.xe(e),Td(t).I_(e)}function Cw(t){t.L_=new EF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Td(t).start(),t.N_.w_()}function Aw(t){return $f(t)&&!Td(t).Zo()&&t.F_.size>0}function $f(t){return bn(t).M_.size===0}function sP(t){t.L_=void 0}async function wN(t){t.N_.set("Online")}async function bN(t){t.F_.forEach((e,n)=>{Iw(t,e)})}async function SN(t,e){sP(t),Aw(t)?(t.N_.D_(e),Cw(t)):t.N_.set("Unknown")}async function TN(t,e,n){if(t.N_.set("Online"),e instanceof Gk&&e.state===2&&e.cause)try{await async function(a,d){const p=d.cause;for(const c of d.targetIds)a.F_.has(c)&&(await a.remoteSyncer.rejectListen(c,p),a.F_.delete(c),a.L_.removeTarget(c))}(t,e)}catch(o){It("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),o),await qT(t,o)}else if(e instanceof Ag?t.L_.Ke(e):e instanceof Wk?t.L_.He(e):t.L_.We(e),!n.isEqual(Xt.min()))try{const o=await tP(t.localStore);n.compareTo(o)>=0&&await function(d,p){const c=d.L_.rt(p);return c.targetChanges.forEach((S,A)=>{if(S.resumeToken.approximateByteSize()>0){const D=d.F_.get(A);D&&d.F_.set(A,D.withResumeToken(S.resumeToken,p))}}),c.targetMismatches.forEach((S,A)=>{const D=d.F_.get(S);if(!D)return;d.F_.set(S,D.withResumeToken(to.EMPTY_BYTE_STRING,D.snapshotVersion)),oP(d,S);const L=new Kl(D.target,S,A,D.sequenceNumber);Iw(d,L)}),d.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(o){It("RemoteStore","Failed to raise snapshot:",o),await qT(t,o)}}async function qT(t,e,n){if(!Vf(e))throw e;t.M_.add(1),await Uf(t),t.N_.set("Offline"),n||(n=()=>tP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{It("RemoteStore","Retrying IndexedDB access"),await n(),t.M_.delete(1),await h_(t)})}async function HT(t,e){const n=bn(t);n.asyncQueue.verifyOperationInProgress(),It("RemoteStore","RemoteStore received new credentials");const o=$f(n);n.M_.add(3),await Uf(n),o&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),await h_(n)}async function EN(t,e){const n=bn(t);e?(n.M_.delete(2),await h_(n)):e||(n.M_.add(2),await Uf(n),n.N_.set("Unknown"))}function Td(t){return t.B_||(t.B_=function(n,o,a){const d=bn(n);return d.f_(),new yN(o,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,a)}(t.datastore,t.asyncQueue,{Po:wN.bind(null,t),To:bN.bind(null,t),Ao:SN.bind(null,t),h_:TN.bind(null,t)}),t.x_.push(async e=>{e?(t.B_.t_(),Aw(t)?Cw(t):t.N_.set("Unknown")):(await t.B_.stop(),sP(t))})),t.B_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,n,o,a,d){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=o,this.op=a,this.removalCallback=d,this.deferred=new sc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(p=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,o,a,d){const p=Date.now()+o,c=new kw(e,n,p,a,d);return c.start(o),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $t(mt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function aP(t,e){if(al("AsyncQueue",`${e}: ${t}`),Vf(t))return new $t(mt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e){this.comparator=e?(n,o)=>e(n,o)||qt.comparator(n.key,o.key):(n,o)=>qt.comparator(n.key,o.key),this.keyedMap=Vp(),this.sortedSet=new Mr(this.comparator)}static emptySet(e){return new jh(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,o)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof jh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),o=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,d=o.getNext().key;if(!a.isEqual(d))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const o=new jh;return o.comparator=this.comparator,o.keyedMap=e,o.sortedSet=n,o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(){this.q_=new Mr(qt.comparator)}track(e){const n=e.doc.key,o=this.q_.get(n);o?e.type!==0&&o.type===3?this.q_=this.q_.insert(n,e):e.type===3&&o.type!==1?this.q_=this.q_.insert(n,{type:o.type,doc:e.doc}):e.type===2&&o.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&o.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&o.type===0?this.q_=this.q_.remove(n):e.type===1&&o.type===2?this.q_=this.q_.insert(n,{type:1,doc:o.doc}):e.type===0&&o.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):Qt():this.q_=this.q_.insert(n,e)}Q_(){const e=[];return this.q_.inorderTraversal((n,o)=>{e.push(o)}),e}}class od{constructor(e,n,o,a,d,p,c,S,A){this.query=e,this.docs=n,this.oldDocs=o,this.docChanges=a,this.mutatedKeys=d,this.fromCache=p,this.syncStateChanged=c,this.excludesMetadataChanges=S,this.hasCachedResults=A}static fromInitialDocuments(e,n,o,a,d){const p=[];return n.forEach(c=>{p.push({type:0,doc:c})}),new od(e,n,jh.emptySet(n),p,o,a,!0,!1,d)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&s_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,o=e.docChanges;if(n.length!==o.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==o[a].type||!n[a].doc.isEqual(o[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class CN{constructor(){this.queries=new Sd(e=>Ok(e),s_),this.onlineState="Unknown",this.z_=new Set}}async function AN(t,e){const n=bn(t);let o=3;const a=e.query;let d=n.queries.get(a);d?!d.W_()&&e.G_()&&(o=2):(d=new IN,o=e.G_()?0:1);try{switch(o){case 0:d.K_=await n.onListen(a,!0);break;case 1:d.K_=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(p){const c=aP(p,`Initialization of query '${mh(e.query)}' failed`);return void e.onError(c)}n.queries.set(a,d),d.U_.push(e),e.j_(n.onlineState),d.K_&&e.H_(d.K_)&&Pw(n)}async function kN(t,e){const n=bn(t),o=e.query;let a=3;const d=n.queries.get(o);if(d){const p=d.U_.indexOf(e);p>=0&&(d.U_.splice(p,1),d.U_.length===0?a=e.G_()?0:1:!d.W_()&&e.G_()&&(a=2))}switch(a){case 0:return n.queries.delete(o),n.onUnlisten(o,!0);case 1:return n.queries.delete(o),n.onUnlisten(o,!1);case 2:return n.onLastRemoteStoreUnlisten(o);default:return}}function PN(t,e){const n=bn(t);let o=!1;for(const a of e){const d=a.query,p=n.queries.get(d);if(p){for(const c of p.U_)c.H_(a)&&(o=!0);p.K_=a}}o&&Pw(n)}function RN(t,e,n){const o=bn(t),a=o.queries.get(e);if(a)for(const d of a.U_)d.onError(n);o.queries.delete(e)}function Pw(t){t.z_.forEach(e=>{e.next()})}var V1,GT;(GT=V1||(V1={})).J_="default",GT.Cache="cache";class MN{constructor(e,n,o){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=o||{}}H_(e){if(!this.options.includeMetadataChanges){const o=[];for(const a of e.docChanges)a.type!==3&&o.push(a);e=new od(e.query,e.docs,e.oldDocs,o,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;const o=n!=="Offline";return(!this.options.ra||!o)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=od.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==V1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e){this.key=e}}class uP{constructor(e){this.key=e}}class LN{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=xn(),this.mutatedKeys=xn(),this.Ia=Fk(e),this.Ta=new jh(this.Ia)}get Ea(){return this.la}da(e,n){const o=n?n.Aa:new WT,a=n?n.Ta:this.Ta;let d=n?n.mutatedKeys:this.mutatedKeys,p=a,c=!1;const S=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,A=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((D,L)=>{const z=a.get(D),ee=a_(this.query,L)?L:null,pe=!!z&&this.mutatedKeys.has(z.key),ue=!!ee&&(ee.hasLocalMutations||this.mutatedKeys.has(ee.key)&&ee.hasCommittedMutations);let me=!1;z&&ee?z.data.isEqual(ee.data)?pe!==ue&&(o.track({type:3,doc:ee}),me=!0):this.Ra(z,ee)||(o.track({type:2,doc:ee}),me=!0,(S&&this.Ia(ee,S)>0||A&&this.Ia(ee,A)<0)&&(c=!0)):!z&&ee?(o.track({type:0,doc:ee}),me=!0):z&&!ee&&(o.track({type:1,doc:z}),me=!0,(S||A)&&(c=!0)),me&&(ee?(p=p.add(ee),d=ue?d.add(D):d.delete(D)):(p=p.delete(D),d=d.delete(D)))}),this.query.limit!==null)for(;p.size>this.query.limit;){const D=this.query.limitType==="F"?p.last():p.first();p=p.delete(D.key),d=d.delete(D.key),o.track({type:1,doc:D})}return{Ta:p,Aa:o,Xi:c,mutatedKeys:d}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,o,a){const d=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const p=e.Aa.Q_();p.sort((D,L)=>function(ee,pe){const ue=me=>{switch(me){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qt()}};return ue(ee)-ue(pe)}(D.type,L.type)||this.Ia(D.doc,L.doc)),this.Va(o),a=a!=null&&a;const c=n&&!a?this.ma():[],S=this.Pa.size===0&&this.current&&!a?1:0,A=S!==this.ha;return this.ha=S,p.length!==0||A?{snapshot:new od(this.query,e.Ta,d,p,e.mutatedKeys,S===0,A,!1,!!o&&o.resumeToken.approximateByteSize()>0),fa:c}:{fa:c}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new WT,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=xn(),this.Ta.forEach(o=>{this.ga(o.key)&&(this.Pa=this.Pa.add(o.key))});const n=[];return e.forEach(o=>{this.Pa.has(o)||n.push(new uP(o))}),this.Pa.forEach(o=>{e.has(o)||n.push(new lP(o))}),n}pa(e){this.la=e.hs,this.Pa=xn();const n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return od.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class DN{constructor(e,n,o){this.query=e,this.targetId=n,this.view=o}}class zN{constructor(e){this.key=e,this.wa=!1}}class ON{constructor(e,n,o,a,d,p){this.localStore=e,this.remoteStore=n,this.eventManager=o,this.sharedClientState=a,this.currentUser=d,this.maxConcurrentLimboResolutions=p,this.Sa={},this.ba=new Sd(c=>Ok(c),s_),this.Da=new Map,this.Ca=new Set,this.va=new Mr(qt.comparator),this.Fa=new Map,this.Ma=new bw,this.xa={},this.Oa=new Map,this.Na=id.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function FN(t,e,n=!0){const o=fP(t);let a;const d=o.ba.get(e);return d?(o.sharedClientState.addLocalQueryTarget(d.targetId),a=d.view.ya()):a=await cP(o,e,n,!0),a}async function NN(t,e){const n=fP(t);await cP(n,e,!0,!1)}async function cP(t,e,n,o){const a=await uN(t.localStore,wa(e)),d=a.targetId,p=n?t.sharedClientState.addLocalQueryTarget(d):"not-current";let c;return o&&(c=await BN(t,e,d,p==="current",a.resumeToken)),t.isPrimaryClient&&n&&iP(t.remoteStore,a),c}async function BN(t,e,n,o,a){t.Ba=(L,z,ee)=>async function(ue,me,te,G){let re=me.view.da(te);re.Xi&&(re=await jT(ue.localStore,me.query,!1).then(({documents:J})=>me.view.da(J,re)));const be=G&&G.targetChanges.get(me.targetId),Le=G&&G.targetMismatches.get(me.targetId)!=null,Me=me.view.applyChanges(re,ue.isPrimaryClient,be,Le);return ZT(ue,me.targetId,Me.fa),Me.snapshot}(t,L,z,ee);const d=await jT(t.localStore,e,!0),p=new LN(e,d.hs),c=p.da(d.documents),S=jf.createSynthesizedTargetChangeForCurrentChange(n,o&&t.onlineState!=="Offline",a),A=p.applyChanges(c,t.isPrimaryClient,S);ZT(t,n,A.fa);const D=new DN(e,n,p);return t.ba.set(e,D),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),A.snapshot}async function VN(t,e,n){const o=bn(t),a=o.ba.get(e),d=o.Da.get(a.targetId);if(d.length>1)return o.Da.set(a.targetId,d.filter(p=>!s_(p,e))),void o.ba.delete(e);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(a.targetId),o.sharedClientState.isActiveQueryTarget(a.targetId)||await B1(o.localStore,a.targetId,!1).then(()=>{o.sharedClientState.clearQueryState(a.targetId),n&&Ew(o.remoteStore,a.targetId),j1(o,a.targetId)}).catch(dw)):(j1(o,a.targetId),await B1(o.localStore,a.targetId,!0))}async function jN(t,e){const n=bn(t),o=n.ba.get(e),a=n.Da.get(o.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(o.targetId),Ew(n.remoteStore,o.targetId))}async function hP(t,e){const n=bn(t);try{const o=await aN(n.localStore,e);e.targetChanges.forEach((a,d)=>{const p=n.Fa.get(d);p&&(Hr(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?p.wa=!0:a.modifiedDocuments.size>0?Hr(p.wa):a.removedDocuments.size>0&&(Hr(p.wa),p.wa=!1))}),await pP(n,o,e)}catch(o){await dw(o)}}function KT(t,e,n){const o=bn(t);if(o.isPrimaryClient&&n===0||!o.isPrimaryClient&&n===1){const a=[];o.ba.forEach((d,p)=>{const c=p.view.j_(e);c.snapshot&&a.push(c.snapshot)}),function(p,c){const S=bn(p);S.onlineState=c;let A=!1;S.queries.forEach((D,L)=>{for(const z of L.U_)z.j_(c)&&(A=!0)}),A&&Pw(S)}(o.eventManager,e),a.length&&o.Sa.h_(a),o.onlineState=e,o.isPrimaryClient&&o.sharedClientState.setOnlineState(e)}}async function UN(t,e,n){const o=bn(t);o.sharedClientState.updateQueryState(e,"rejected",n);const a=o.Fa.get(e),d=a&&a.key;if(d){let p=new Mr(qt.comparator);p=p.insert(d,Ji.newNoDocument(d,Xt.min()));const c=xn().add(d),S=new c_(Xt.min(),new Map,new Mr(Ln),p,c);await hP(o,S),o.va=o.va.remove(d),o.Fa.delete(e),Rw(o)}else await B1(o.localStore,e,!1).then(()=>j1(o,e,n)).catch(dw)}function j1(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const o of t.Da.get(e))t.ba.delete(o),n&&t.Sa.ka(o,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Vr(e).forEach(o=>{t.Ma.containsKey(o)||dP(t,o)})}function dP(t,e){t.Ca.delete(e.path.canonicalString());const n=t.va.get(e);n!==null&&(Ew(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),Rw(t))}function ZT(t,e,n){for(const o of n)o instanceof lP?(t.Ma.addReference(o.key,e),$N(t,o)):o instanceof uP?(It("SyncEngine","Document no longer in limbo: "+o.key),t.Ma.removeReference(o.key,e),t.Ma.containsKey(o.key)||dP(t,o.key)):Qt()}function $N(t,e){const n=e.key,o=n.path.canonicalString();t.va.get(n)||t.Ca.has(o)||(It("SyncEngine","New document in limbo: "+n),t.Ca.add(o),Rw(t))}function Rw(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){const e=t.Ca.values().next().value;t.Ca.delete(e);const n=new qt(Tr.fromString(e)),o=t.Na.next();t.Fa.set(o,new zN(n)),t.va=t.va.insert(n,o),iP(t.remoteStore,new Kl(wa(zk(n.path)),o,"TargetPurposeLimboResolution",pw.oe))}}async function pP(t,e,n){const o=bn(t),a=[],d=[],p=[];o.ba.isEmpty()||(o.ba.forEach((c,S)=>{p.push(o.Ba(S,e,n).then(A=>{var D;if((A||n)&&o.isPrimaryClient){const L=A?!A.fromCache:(D=n==null?void 0:n.targetChanges.get(S.targetId))===null||D===void 0?void 0:D.current;o.sharedClientState.updateQueryState(S.targetId,L?"current":"not-current")}if(A){a.push(A);const L=Tw.Ki(S.targetId,A);d.push(L)}}))}),await Promise.all(p),o.Sa.h_(a),await async function(S,A){const D=bn(S);try{await D.persistence.runTransaction("notifyLocalViewChanges","readwrite",L=>Qe.forEach(A,z=>Qe.forEach(z.qi,ee=>D.persistence.referenceDelegate.addReference(L,z.targetId,ee)).next(()=>Qe.forEach(z.Qi,ee=>D.persistence.referenceDelegate.removeReference(L,z.targetId,ee)))))}catch(L){if(!Vf(L))throw L;It("LocalStore","Failed to update sequence numbers: "+L)}for(const L of A){const z=L.targetId;if(!L.fromCache){const ee=D.ns.get(z),pe=ee.snapshotVersion,ue=ee.withLastLimboFreeSnapshotVersion(pe);D.ns=D.ns.insert(z,ue)}}}(o.localStore,d))}async function qN(t,e){const n=bn(t);if(!n.currentUser.isEqual(e)){It("SyncEngine","User change. New user:",e.toKey());const o=await eP(n.localStore,e);n.currentUser=e,function(d,p){d.Oa.forEach(c=>{c.forEach(S=>{S.reject(new $t(mt.CANCELLED,p))})}),d.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,o.removedBatchIds,o.addedBatchIds),await pP(n,o.us)}}function HN(t,e){const n=bn(t),o=n.Fa.get(e);if(o&&o.wa)return xn().add(o.key);{let a=xn();const d=n.Da.get(e);if(!d)return a;for(const p of d){const c=n.ba.get(p);a=a.unionWith(c.view.Ea)}return a}}function fP(t){const e=bn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=hP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UN.bind(null,e),e.Sa.h_=PN.bind(null,e.eventManager),e.Sa.ka=RN.bind(null,e.eventManager),e}class XT{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=nP(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return sN(this.persistence,new iN,e.initialUser,this.serializer)}createPersistence(e){return new tN(Sw.Hr,this.serializer)}createSharedClientState(e){return new hN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class WN{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>KT(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=qN.bind(null,this.syncEngine),await EN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new CN}()}createDatastore(e){const n=nP(e.databaseInfo.databaseId),o=function(d){return new mN(d)}(e.databaseInfo);return function(d,p,c,S){return new _N(d,p,c,S)}(e.authCredentials,e.appCheckCredentials,o,n)}createRemoteStore(e){return function(o,a,d,p,c){return new xN(o,a,d,p,c)}(this.localStore,this.datastore,e.asyncQueue,n=>KT(this.syncEngine,n,0),function(){return $T.D()?new $T:new dN}())}createSyncEngine(e,n){return function(a,d,p,c,S,A,D){const L=new ON(a,d,p,c,S,A);return D&&(L.La=!0),L}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e;await async function(o){const a=bn(o);It("RemoteStore","RemoteStore shutting down."),a.M_.add(5),await Uf(a),a.O_.shutdown(),a.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):al("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,n,o,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=o,this.databaseInfo=a,this.user=Yi.UNAUTHENTICATED,this.clientId=D6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(o,async d=>{It("FirestoreClient","Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(o,d=>(It("FirestoreClient","Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $t(mt.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const o=aP(n,"Failed to shutdown persistence");e.reject(o)}}),e.promise}}async function nv(t,e){t.asyncQueue.verifyOperationInProgress(),It("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let o=n.initialUser;t.setCredentialChangeListener(async a=>{o.isEqual(a)||(await eP(e.localStore,a),o=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function YT(t,e){t.asyncQueue.verifyOperationInProgress();const n=await XN(t);It("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(o=>HT(e.remoteStore,o)),t.setAppCheckTokenChangeListener((o,a)=>HT(e.remoteStore,a)),t._onlineComponents=e}function ZN(t){return t.name==="FirebaseError"?t.code===mt.FAILED_PRECONDITION||t.code===mt.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function XN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){It("FirestoreClient","Using user provided OfflineComponentProvider");try{await nv(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!ZN(n))throw n;ed("Error using user provided cache. Falling back to memory cache: "+n),await nv(t,new XT)}}else It("FirestoreClient","Using default OfflineComponentProvider"),await nv(t,new XT);return t._offlineComponents}async function YN(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(It("FirestoreClient","Using user provided OnlineComponentProvider"),await YT(t,t._uninitializedComponentsProvider._online)):(It("FirestoreClient","Using default OnlineComponentProvider"),await YT(t,new WN))),t._onlineComponents}async function QN(t){const e=await YN(t),n=e.eventManager;return n.onListen=FN.bind(null,e.syncEngine),n.onUnlisten=VN.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=NN.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jN.bind(null,e.syncEngine),n}function JN(t,e,n={}){const o=new sc;return t.asyncQueue.enqueueAndForget(async()=>function(d,p,c,S,A){const D=new GN({next:z=>{p.enqueueAndForget(()=>kN(d,L)),z.fromCache&&S.source==="server"?A.reject(new $t(mt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):A.resolve(z)},error:z=>A.reject(z)}),L=new MN(c,D,{includeMetadataChanges:!0,ra:!0});return AN(d,L)}(await QN(t),t.asyncQueue,e,n,o)),o.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT=new Map;function eB(t,e,n,o){if(e===!0&&o===!0)throw new $t(mt.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function JT(t){if(qt.isDocumentKey(t))throw new $t(mt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tB(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(o){return o.constructor?o.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Qt()}function U1(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $t(mt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tB(t);throw new $t(mt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e){var n,o;if(e.host===void 0){if(e.ssl!==void 0)throw new $t(mt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $t(mt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mP((o=e.experimentalLongPollingOptions)!==null&&o!==void 0?o:{}),function(d){if(d.timeoutSeconds!==void 0){if(isNaN(d.timeoutSeconds))throw new $t(mt.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (must not be NaN)`);if(d.timeoutSeconds<5)throw new $t(mt.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (minimum allowed value is 5)`);if(d.timeoutSeconds>30)throw new $t(mt.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(o,a){return o.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Mw{constructor(e,n,o,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=o,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eE({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $t(mt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new $t(mt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eE(e),e.credentials!==void 0&&(this._authCredentials=function(o){if(!o)return new I6;switch(o.type){case"firstParty":return new P6(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new $t(mt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const o=QT.get(n);o&&(It("ComponentProvider","Removing Datastore"),QT.delete(n),o.terminate())}(this),Promise.resolve()}}function nB(t,e,n,o={}){var a;const d=(t=U1(t,Mw))._getSettings(),p=`${e}:${n}`;if(d.host!=="firestore.googleapis.com"&&d.host!==p&&ed("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},d),{host:p,ssl:!1})),o.mockUserToken){let c,S;if(typeof o.mockUserToken=="string")c=o.mockUserToken,S=Yi.MOCK_USER;else{c=lk(o.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const A=o.mockUserToken.sub||o.mockUserToken.user_id;if(!A)throw new $t(mt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new Yi(A)}t._authCredentials=new C6(new Ck(c,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e,n,o){this.converter=n,this._query=o,this.type="query",this.firestore=e}withConverter(e){return new d_(this.firestore,e,this._query)}}class Ed{constructor(e,n,o){this.converter=n,this._key=o,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Uh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ed(this.firestore,e,this._key)}}class Uh extends d_{constructor(e,n,o){super(e,n,zk(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ed(this.firestore,null,new qt(e))}withConverter(e){return new Uh(this.firestore,e,this._path)}}function rB(t,e,...n){if(t=ck(t),t instanceof Mw){const o=Tr.fromString(e,...n);return JT(o),new Uh(t,null,o)}{if(!(t instanceof Ed||t instanceof Uh))throw new $t(mt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=t._path.child(Tr.fromString(e,...n));return JT(o),new Uh(t.firestore,null,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new rP(this,"async_queue_retry"),this.hu=()=>{const n=tv();n&&It("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Yo.Wo()};const e=tv();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const n=tv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const n=new sc;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Vf(e))throw e;It("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const n=this.iu.then(()=>(this.uu=!0,e().catch(o=>{this.au=o,this.uu=!1;const a=function(p){let c=p.message||"";return p.stack&&(c=p.stack.includes(p.message)?p.stack:p.message+`
`+p.stack),c}(o);throw al("INTERNAL UNHANDLED ERROR: ",a),o}).then(o=>(this.uu=!1,o))));return this.iu=n,n}enqueueAfterDelay(e,n,o){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);const a=kw.createAndSchedule(this,e,n,o,d=>this.Eu(d));return this._u.push(a),a}Pu(){this.au&&Qt()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,o)=>n.targetTimeMs-o.targetTimeMs);for(const n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const n=this._u.indexOf(e);this._u.splice(n,1)}}class gP extends Mw{constructor(e,n,o,a){super(e,n,o,a),this.type="firestore",this._queue=function(){return new iB}(),this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||yP(this),this._firestoreClient.terminate()}}function oB(t,e){const n=typeof t=="object"?t:yk(),o=typeof t=="string"?t:"(default)",a=fk(n,"firestore").getImmediate({identifier:o});if(!a._initialized){const d=sk("firestore");d&&nB(a,...d)}return a}function sB(t){return t._firestoreClient||yP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function yP(t){var e,n,o;const a=t._freezeSettings(),d=function(c,S,A,D){return new q6(c,S,A,D.host,D.ssl,D.experimentalForceLongPolling,D.experimentalAutoDetectLongPolling,mP(D.experimentalLongPollingOptions),D.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._firestoreClient=new KN(t._authCredentials,t._appCheckCredentials,t._queue,d),!((n=a.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((o=a.localCache)===null||o===void 0)&&o._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.localCache.kind,_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vy(to.fromBase64String(e))}catch(n){throw new $t(mt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vy(to.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $t(mt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $t(mt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $t(mt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ln(this._lat,e._lat)||Ln(this._long,e._long)}}const lB=new RegExp("[~\\*/\\[\\]]");function uB(t,e,n){if(e.search(lB)>=0)throw tE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new _P(...e.split("."))._internalPath}catch{throw tE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function tE(t,e,n,o,a){let d=`Function ${e}() called with invalid data`;d+=". ";let p="";return new $t(mt.INVALID_ARGUMENT,d+t+p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,n,o,a,d){this._firestore=e,this._userDataWriter=n,this._key=o,this._document=a,this._converter=d}get id(){return this._key.path.lastSegment()}get ref(){return new Ed(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xP("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class cB extends vP{data(){return super.data()}}function xP(t,e){return typeof e=="string"?uB(t,e):e instanceof _P?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $t(mt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dB{convertValue(e,n="none"){switch(_c(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ur(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(yc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Qt()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const o={};return i_(e,(a,d)=>{o[a]=this.convertValue(d,n)}),o}convertGeoPoint(e){return new aB(Ur(e.latitude),Ur(e.longitude))}convertArray(e,n){return(e.values||[]).map(o=>this.convertValue(o,n))}convertServerTimestamp(e,n){switch(n){case"previous":const o=mw(e);return o==null?null:this.convertValue(o,n);case"estimate":return this.convertTimestamp(Cf(e));default:return null}}convertTimestamp(e){const n=cu(e);return new Mo(n.seconds,n.nanos)}convertDocumentKey(e,n){const o=Tr.fromString(e);Hr(Jk(o));const a=new Af(o.get(1),o.get(3)),d=new qt(o.popFirst(5));return a.isEqual(n)||al(`Document ${d} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pB extends vP{constructor(e,n,o,a,d,p){super(e,n,o,a,p),this._firestore=e,this._firestoreImpl=e,this.metadata=d}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new kg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const o=this._document.data.field(xP("DocumentSnapshot.get",e));if(o!==null)return this._userDataWriter.convertValue(o,n.serverTimestamps)}}}class kg extends pB{data(e={}){return super.data(e)}}class fB{constructor(e,n,o,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new sg(a.hasPendingWrites,a.fromCache),this.query=o}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(o=>{e.call(n,new kg(this._firestore,this._userDataWriter,o.key,o,new sg(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $t(mt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,d){if(a._snapshot.oldDocs.isEmpty()){let p=0;return a._snapshot.docChanges.map(c=>{const S=new kg(a._firestore,a._userDataWriter,c.doc.key,c.doc,new sg(a._snapshot.mutatedKeys.has(c.doc.key),a._snapshot.fromCache),a.query.converter);return c.doc,{type:"added",doc:S,oldIndex:-1,newIndex:p++}})}{let p=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(c=>d||c.type!==3).map(c=>{const S=new kg(a._firestore,a._userDataWriter,c.doc.key,c.doc,new sg(a._snapshot.mutatedKeys.has(c.doc.key),a._snapshot.fromCache),a.query.converter);let A=-1,D=-1;return c.type!==0&&(A=p.indexOf(c.doc.key),p=p.delete(c.doc.key)),c.type!==1&&(p=p.add(c.doc),D=p.indexOf(c.doc.key)),{type:mB(c.type),doc:S,oldIndex:A,newIndex:D}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function mB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qt()}}class gB extends dB{constructor(e){super(),this.firestore=e}convertBytes(e){return new vy(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ed(this.firestore,null,n)}}function yB(t){t=U1(t,d_);const e=U1(t.firestore,gP),n=sB(e),o=new gB(e);return hB(t._query),JN(n,t._query).then(a=>new fB(e,o,t,a))}(function(e,n=!0){(function(a){bd=a})(mk),Tf(new Jh("firestore",(o,{instanceIdentifier:a,options:d})=>{const p=o.getProvider("app").getImmediate(),c=new gP(new A6(o.getProvider("auth-internal")),new M6(o.getProvider("app-check-internal")),function(A,D){if(!Object.prototype.hasOwnProperty.apply(A.options,["projectId"]))throw new $t(mt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Af(A.options.projectId,D)}(p,a),p);return d=Object.assign({useFetchStreams:n},d),c._setSettings(d),c},"PUBLIC").setMultipleInstances(!0)),su(wT,"4.6.4",e),su(wT,"4.6.4","esm2017")})();var _B="firebase",vB="10.12.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */su(_B,vB,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP="firebasestorage.googleapis.com",xB="storageBucket",wB=2*60*1e3,bB=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia extends bc{constructor(e,n,o=0){super(rv(e),`Firebase Storage: ${n} (${rv(e)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ia.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ta;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ta||(Ta={}));function rv(t){return"storage/"+t}function SB(){const t="An unknown error occurred, please check the error payload for server response.";return new Ia(Ta.UNKNOWN,t)}function TB(){return new Ia(Ta.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EB(){return new Ia(Ta.CANCELED,"User canceled the upload/download.")}function IB(t){return new Ia(Ta.INVALID_URL,"Invalid URL '"+t+"'.")}function CB(t){return new Ia(Ta.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function nE(t){return new Ia(Ta.INVALID_ARGUMENT,t)}function bP(){return new Ia(Ta.APP_DELETED,"The Firebase app was deleted.")}function AB(t){return new Ia(Ta.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let o;try{o=qs.makeFromUrl(e,n)}catch{return new qs(e,"")}if(o.path==="")return o;throw CB(e)}static makeFromUrl(e,n){let o=null;const a="([A-Za-z0-9.\\-_]+)";function d(be){be.path.charAt(be.path.length-1)==="/"&&(be.path_=be.path_.slice(0,-1))}const p="(/(.*))?$",c=new RegExp("^gs://"+a+p,"i"),S={bucket:1,path:3};function A(be){be.path_=decodeURIComponent(be.path)}const D="v[A-Za-z0-9_]+",L=n.replace(/[.]/g,"\\."),z="(/([^?#]*).*)?$",ee=new RegExp(`^https?://${L}/${D}/b/${a}/o${z}`,"i"),pe={bucket:1,path:3},ue=n===wP?"(?:storage.googleapis.com|storage.cloud.google.com)":n,me="([^?#]*)",te=new RegExp(`^https?://${ue}/${a}/${me}`,"i"),re=[{regex:c,indices:S,postModify:d},{regex:ee,indices:pe,postModify:A},{regex:te,indices:{bucket:1,path:2},postModify:A}];for(let be=0;be<re.length;be++){const Le=re[be],Me=Le.regex.exec(e);if(Me){const J=Me[Le.indices.bucket];let X=Me[Le.indices.path];X||(X=""),o=new qs(J,X),Le.postModify(o);break}}if(o==null)throw IB(e);return o}}class kB{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t,e,n){let o=1,a=null,d=null,p=!1,c=0;function S(){return c===2}let A=!1;function D(...me){A||(A=!0,e.apply(null,me))}function L(me){a=setTimeout(()=>{a=null,t(ee,S())},me)}function z(){d&&clearTimeout(d)}function ee(me,...te){if(A){z();return}if(me){z(),D.call(null,me,...te);return}if(S()||p){z(),D.call(null,me,...te);return}o<64&&(o*=2);let re;c===1?(c=2,re=0):re=(o+Math.random())*1e3,L(re)}let pe=!1;function ue(me){pe||(pe=!0,z(),!A&&(a!==null?(me||(c=2),clearTimeout(a),L(0)):me||(c=1)))}return L(0),d=setTimeout(()=>{p=!0,ue(!0)},n),ue}function RB(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MB(t){return t!==void 0}function rE(t,e,n,o){if(o<e)throw nE(`Invalid value for '${t}'. Expected ${e} or greater.`);if(o>n)throw nE(`Invalid value for '${t}'. Expected ${n} or less.`)}function LB(t){const e=encodeURIComponent;let n="?";for(const o in t)if(t.hasOwnProperty(o)){const a=e(o)+"="+e(t[o]);n=n+a+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xy;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(xy||(xy={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(t,e){const n=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,d=e.indexOf(t)!==-1;return n||a||d}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e,n,o,a,d,p,c,S,A,D,L,z=!0){this.url_=e,this.method_=n,this.headers_=o,this.body_=a,this.successCodes_=d,this.additionalRetryCodes_=p,this.callback_=c,this.errorCallback_=S,this.timeout_=A,this.progressCallback_=D,this.connectionFactory_=L,this.retry=z,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ee,pe)=>{this.resolve_=ee,this.reject_=pe,this.start_()})}start_(){const e=(o,a)=>{if(a){o(!1,new ag(!1,null,!0));return}const d=this.connectionFactory_();this.pendingConnection_=d;const p=c=>{const S=c.loaded,A=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(S,A)};this.progressCallback_!==null&&d.addUploadProgressListener(p),d.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&d.removeUploadProgressListener(p),this.pendingConnection_=null;const c=d.getErrorCode()===xy.NO_ERROR,S=d.getStatus();if(!c||DB(S,this.additionalRetryCodes_)&&this.retry){const D=d.getErrorCode()===xy.ABORT;o(!1,new ag(!1,null,D));return}const A=this.successCodes_.indexOf(S)!==-1;o(!0,new ag(A,d))})},n=(o,a)=>{const d=this.resolve_,p=this.reject_,c=a.connection;if(a.wasSuccessCode)try{const S=this.callback_(c,c.getResponse());MB(S)?d(S):d()}catch(S){p(S)}else if(c!==null){const S=SB();S.serverResponse=c.getErrorText(),this.errorCallback_?p(this.errorCallback_(c,S)):p(S)}else if(a.canceled){const S=this.appDelete_?bP():EB();p(S)}else{const S=TB();p(S)}};this.canceled_?n(!1,new ag(!1,null,!0)):this.backoffId_=PB(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ag{constructor(e,n,o){this.wasSuccessCode=e,this.connection=n,this.canceled=!!o}}function OB(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function FB(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function NB(t,e){e&&(t["X-Firebase-GMPID"]=e)}function BB(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function VB(t,e,n,o,a,d,p=!0){const c=LB(t.urlParams),S=t.url+c,A=Object.assign({},t.headers);return NB(A,e),OB(A,n),FB(A,d),BB(A,o),new zB(S,t.method,A,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,p)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function UB(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n){this._service=e,n instanceof qs?this._location=n:this._location=qs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new wy(e,n)}get root(){const e=new qs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return UB(this._location.path)}get storage(){return this._service}get parent(){const e=jB(this._location.path);if(e===null)return null;const n=new qs(this._location.bucket,e);return new wy(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw AB(e)}}function iE(t,e){const n=e==null?void 0:e[xB];return n==null?null:qs.makeFromBucketSpec(n,t)}function $B(t,e,n,o={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:a}=o;a&&(t._overrideAuthToken=typeof a=="string"?a:lk(a,t.app.options.projectId))}class qB{constructor(e,n,o,a,d){this.app=e,this._authProvider=n,this._appCheckProvider=o,this._url=a,this._firebaseVersion=d,this._bucket=null,this._host=wP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wB,this._maxUploadRetryTime=bB,this._requests=new Set,a!=null?this._bucket=qs.makeFromBucketSpec(a,this._host):this._bucket=iE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qs.makeFromBucketSpec(this._url,e):this._bucket=iE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){rE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){rE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wy(this,e)}_makeRequest(e,n,o,a,d=!0){if(this._deleted)return new kB(bP());{const p=VB(e,this._appId,o,a,n,this._firebaseVersion,d);return this._requests.add(p),p.getPromise().then(()=>this._requests.delete(p),()=>this._requests.delete(p)),p}}async makeRequestWithTokens(e,n){const[o,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,o,a).getPromise()}}const oE="@firebase/storage",sE="0.12.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP="storage";function HB(t=yk(),e){t=ck(t);const o=fk(t,SP).getImmediate({identifier:e}),a=sk("storage");return a&&WB(o,...a),o}function WB(t,e,n,o={}){$B(t,e,n,o)}function GB(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new qB(n,o,a,e,mk)}function KB(){Tf(new Jh(SP,GB,"PUBLIC").setMultipleInstances(!0)),su(oE,sE,""),su(oE,sE,"esm2017")}KB();const ZB={apiKey:"AIzaSyAC46RxFCp_x1BFIYyMeqMfGWa3ao3UGh0",authDomain:"mualaapp-32feb.firebaseapp.com",projectId:"mualaapp-32feb",storageBucket:"mualaapp-32feb.appspot.com",messagingSenderId:"631272198666",appId:"1:631272198666:web:f2e293897d390dc8a385f3"},TP=gk(ZB);HB(TP);const XB=oB(TP),YB=rB(XB,"kolekcja");async function EP(){return(await yB(YB)).docs.map(n=>({...n.data()}))}var Ao=function(){return Ao=Object.assign||function(e){for(var n,o=1,a=arguments.length;o<a;o++){n=arguments[o];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(e[d]=n[d])}return e},Ao.apply(this,arguments)};function Pf(t,e,n){if(n||arguments.length===2)for(var o=0,a=e.length,d;o<a;o++)(d||!(o in e))&&(d||(d=Array.prototype.slice.call(e,0,o)),d[o]=e[o]);return t.concat(d||Array.prototype.slice.call(e))}var nr="-ms-",rf="-moz-",Mn="-webkit-",IP="comm",p_="rule",Lw="decl",QB="@import",CP="@keyframes",JB="@layer",AP=Math.abs,Dw=String.fromCharCode,$1=Object.assign;function e8(t,e){return vi(t,0)^45?(((e<<2^vi(t,0))<<2^vi(t,1))<<2^vi(t,2))<<2^vi(t,3):0}function kP(t){return t.trim()}function Qa(t,e){return(t=e.exec(t))?t[0]:t}function Jt(t,e,n){return t.replace(e,n)}function Pg(t,e,n){return t.indexOf(e,n)}function vi(t,e){return t.charCodeAt(e)|0}function sd(t,e,n){return t.slice(e,n)}function ma(t){return t.length}function PP(t){return t.length}function Up(t,e){return e.push(t),t}function t8(t,e){return t.map(e).join("")}function aE(t,e){return t.filter(function(n){return!Qa(n,e)})}var f_=1,ad=1,RP=0,ws=0,$r=0,Id="";function m_(t,e,n,o,a,d,p,c){return{value:t,root:e,parent:n,type:o,props:a,children:d,line:f_,column:ad,length:p,return:"",siblings:c}}function Fl(t,e){return $1(m_("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function ph(t){for(;t.root;)t=Fl(t.root,{children:[t]});Up(t,t.siblings)}function n8(){return $r}function r8(){return $r=ws>0?vi(Id,--ws):0,ad--,$r===10&&(ad=1,f_--),$r}function Gs(){return $r=ws<RP?vi(Id,ws++):0,ad++,$r===10&&(ad=1,f_++),$r}function lc(){return vi(Id,ws)}function Rg(){return ws}function g_(t,e){return sd(Id,t,e)}function q1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function i8(t){return f_=ad=1,RP=ma(Id=t),ws=0,[]}function o8(t){return Id="",t}function iv(t){return kP(g_(ws-1,H1(t===91?t+2:t===40?t+1:t)))}function s8(t){for(;($r=lc())&&$r<33;)Gs();return q1(t)>2||q1($r)>3?"":" "}function a8(t,e){for(;--e&&Gs()&&!($r<48||$r>102||$r>57&&$r<65||$r>70&&$r<97););return g_(t,Rg()+(e<6&&lc()==32&&Gs()==32))}function H1(t){for(;Gs();)switch($r){case t:return ws;case 34:case 39:t!==34&&t!==39&&H1($r);break;case 40:t===41&&H1(t);break;case 92:Gs();break}return ws}function l8(t,e){for(;Gs()&&t+$r!==57;)if(t+$r===84&&lc()===47)break;return"/*"+g_(e,ws-1)+"*"+Dw(t===47?t:Gs())}function u8(t){for(;!q1(lc());)Gs();return g_(t,ws)}function c8(t){return o8(Mg("",null,null,null,[""],t=i8(t),0,[0],t))}function Mg(t,e,n,o,a,d,p,c,S){for(var A=0,D=0,L=p,z=0,ee=0,pe=0,ue=1,me=1,te=1,G=0,re="",be=a,Le=d,Me=o,J=re;me;)switch(pe=G,G=Gs()){case 40:if(pe!=108&&vi(J,L-1)==58){Pg(J+=Jt(iv(G),"&","&\f"),"&\f",AP(A?c[A-1]:0))!=-1&&(te=-1);break}case 34:case 39:case 91:J+=iv(G);break;case 9:case 10:case 13:case 32:J+=s8(pe);break;case 92:J+=a8(Rg()-1,7);continue;case 47:switch(lc()){case 42:case 47:Up(h8(l8(Gs(),Rg()),e,n,S),S);break;default:J+="/"}break;case 123*ue:c[A++]=ma(J)*te;case 125*ue:case 59:case 0:switch(G){case 0:case 125:me=0;case 59+D:te==-1&&(J=Jt(J,/\f/g,"")),ee>0&&ma(J)-L&&Up(ee>32?uE(J+";",o,n,L-1,S):uE(Jt(J," ","")+";",o,n,L-2,S),S);break;case 59:J+=";";default:if(Up(Me=lE(J,e,n,A,D,a,c,re,be=[],Le=[],L,d),d),G===123)if(D===0)Mg(J,e,Me,Me,be,d,L,c,Le);else switch(z===99&&vi(J,3)===110?100:z){case 100:case 108:case 109:case 115:Mg(t,Me,Me,o&&Up(lE(t,Me,Me,0,0,a,c,re,a,be=[],L,Le),Le),a,Le,L,c,o?be:Le);break;default:Mg(J,Me,Me,Me,[""],Le,0,c,Le)}}A=D=ee=0,ue=te=1,re=J="",L=p;break;case 58:L=1+ma(J),ee=pe;default:if(ue<1){if(G==123)--ue;else if(G==125&&ue++==0&&r8()==125)continue}switch(J+=Dw(G),G*ue){case 38:te=D>0?1:(J+="\f",-1);break;case 44:c[A++]=(ma(J)-1)*te,te=1;break;case 64:lc()===45&&(J+=iv(Gs())),z=lc(),D=L=ma(re=J+=u8(Rg())),G++;break;case 45:pe===45&&ma(J)==2&&(ue=0)}}return d}function lE(t,e,n,o,a,d,p,c,S,A,D,L){for(var z=a-1,ee=a===0?d:[""],pe=PP(ee),ue=0,me=0,te=0;ue<o;++ue)for(var G=0,re=sd(t,z+1,z=AP(me=p[ue])),be=t;G<pe;++G)(be=kP(me>0?ee[G]+" "+re:Jt(re,/&\f/g,ee[G])))&&(S[te++]=be);return m_(t,e,n,a===0?p_:c,S,A,D,L)}function h8(t,e,n,o){return m_(t,e,n,IP,Dw(n8()),sd(t,2,-2),0,o)}function uE(t,e,n,o,a){return m_(t,e,n,Lw,sd(t,0,o),sd(t,o+1,-1),o,a)}function MP(t,e,n){switch(e8(t,e)){case 5103:return Mn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Mn+t+t;case 4789:return rf+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Mn+t+rf+t+nr+t+t;case 5936:switch(vi(t,e+11)){case 114:return Mn+t+nr+Jt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Mn+t+nr+Jt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Mn+t+nr+Jt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return Mn+t+nr+t+t;case 6165:return Mn+t+nr+"flex-"+t+t;case 5187:return Mn+t+Jt(t,/(\w+).+(:[^]+)/,Mn+"box-$1$2"+nr+"flex-$1$2")+t;case 5443:return Mn+t+nr+"flex-item-"+Jt(t,/flex-|-self/g,"")+(Qa(t,/flex-|baseline/)?"":nr+"grid-row-"+Jt(t,/flex-|-self/g,""))+t;case 4675:return Mn+t+nr+"flex-line-pack"+Jt(t,/align-content|flex-|-self/g,"")+t;case 5548:return Mn+t+nr+Jt(t,"shrink","negative")+t;case 5292:return Mn+t+nr+Jt(t,"basis","preferred-size")+t;case 6060:return Mn+"box-"+Jt(t,"-grow","")+Mn+t+nr+Jt(t,"grow","positive")+t;case 4554:return Mn+Jt(t,/([^-])(transform)/g,"$1"+Mn+"$2")+t;case 6187:return Jt(Jt(Jt(t,/(zoom-|grab)/,Mn+"$1"),/(image-set)/,Mn+"$1"),t,"")+t;case 5495:case 3959:return Jt(t,/(image-set\([^]*)/,Mn+"$1$`$1");case 4968:return Jt(Jt(t,/(.+:)(flex-)?(.*)/,Mn+"box-pack:$3"+nr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Mn+t+t;case 4200:if(!Qa(t,/flex-|baseline/))return nr+"grid-column-align"+sd(t,e)+t;break;case 2592:case 3360:return nr+Jt(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(o,a){return e=a,Qa(o.props,/grid-\w+-end/)})?~Pg(t+(n=n[e].value),"span",0)?t:nr+Jt(t,"-start","")+t+nr+"grid-row-span:"+(~Pg(n,"span",0)?Qa(n,/\d+/):+Qa(n,/\d+/)-+Qa(t,/\d+/))+";":nr+Jt(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(o){return Qa(o.props,/grid-\w+-start/)})?t:nr+Jt(Jt(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return Jt(t,/(.+)-inline(.+)/,Mn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ma(t)-1-e>6)switch(vi(t,e+1)){case 109:if(vi(t,e+4)!==45)break;case 102:return Jt(t,/(.+:)(.+)-([^]+)/,"$1"+Mn+"$2-$3$1"+rf+(vi(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Pg(t,"stretch",0)?MP(Jt(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return Jt(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(o,a,d,p,c,S,A){return nr+a+":"+d+A+(p?nr+a+"-span:"+(c?S:+S-+d)+A:"")+t});case 4949:if(vi(t,e+6)===121)return Jt(t,":",":"+Mn)+t;break;case 6444:switch(vi(t,vi(t,14)===45?18:11)){case 120:return Jt(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Mn+(vi(t,14)===45?"inline-":"")+"box$3$1"+Mn+"$2$3$1"+nr+"$2box$3")+t;case 100:return Jt(t,":",":"+nr)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Jt(t,"scroll-","scroll-snap-")+t}return t}function by(t,e){for(var n="",o=0;o<t.length;o++)n+=e(t[o],o,t,e)||"";return n}function d8(t,e,n,o){switch(t.type){case JB:if(t.children.length)break;case QB:case Lw:return t.return=t.return||t.value;case IP:return"";case CP:return t.return=t.value+"{"+by(t.children,o)+"}";case p_:if(!ma(t.value=t.props.join(",")))return""}return ma(n=by(t.children,o))?t.return=t.value+"{"+n+"}":""}function p8(t){var e=PP(t);return function(n,o,a,d){for(var p="",c=0;c<e;c++)p+=t[c](n,o,a,d)||"";return p}}function f8(t){return function(e){e.root||(e=e.return)&&t(e)}}function m8(t,e,n,o){if(t.length>-1&&!t.return)switch(t.type){case Lw:t.return=MP(t.value,t.length,n);return;case CP:return by([Fl(t,{value:Jt(t.value,"@","@"+Mn)})],o);case p_:if(t.length)return t8(n=t.props,function(a){switch(Qa(a,o=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":ph(Fl(t,{props:[Jt(a,/:(read-\w+)/,":"+rf+"$1")]})),ph(Fl(t,{props:[a]})),$1(t,{props:aE(n,o)});break;case"::placeholder":ph(Fl(t,{props:[Jt(a,/:(plac\w+)/,":"+Mn+"input-$1")]})),ph(Fl(t,{props:[Jt(a,/:(plac\w+)/,":"+rf+"$1")]})),ph(Fl(t,{props:[Jt(a,/:(plac\w+)/,nr+"input-$1")]})),ph(Fl(t,{props:[a]})),$1(t,{props:aE(n,o)});break}return""})}}var g8={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Wo={},ld=typeof process<"u"&&Wo!==void 0&&(Wo.REACT_APP_SC_ATTR||Wo.SC_ATTR)||"data-styled",LP="active",DP="data-styled-version",y_="6.1.12",zw=`/*!sc*/
`,Sy=typeof window<"u"&&"HTMLElement"in window,y8=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Wo!==void 0&&Wo.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Wo.REACT_APP_SC_DISABLE_SPEEDY!==""?Wo.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Wo.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Wo!==void 0&&Wo.SC_DISABLE_SPEEDY!==void 0&&Wo.SC_DISABLE_SPEEDY!==""&&Wo.SC_DISABLE_SPEEDY!=="false"&&Wo.SC_DISABLE_SPEEDY),__=Object.freeze([]),ud=Object.freeze({});function _8(t,e,n){return n===void 0&&(n=ud),t.theme!==n.theme&&t.theme||e||n.theme}var zP=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),v8=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,x8=/(^-|-$)/g;function cE(t){return t.replace(v8,"-").replace(x8,"")}var w8=/(a)(d)/gi,lg=52,hE=function(t){return String.fromCharCode(t+(t>25?39:97))};function W1(t){var e,n="";for(e=Math.abs(t);e>lg;e=e/lg|0)n=hE(e%lg)+n;return(hE(e%lg)+n).replace(w8,"$1-$2")}var ov,OP=5381,Ph=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},FP=function(t){return Ph(OP,t)};function NP(t){return W1(FP(t)>>>0)}function b8(t){return t.displayName||t.name||"Component"}function sv(t){return typeof t=="string"&&!0}var BP=typeof Symbol=="function"&&Symbol.for,VP=BP?Symbol.for("react.memo"):60115,S8=BP?Symbol.for("react.forward_ref"):60112,T8={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},E8={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},jP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},I8=((ov={})[S8]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ov[VP]=jP,ov);function dE(t){return("type"in(e=t)&&e.type.$$typeof)===VP?jP:"$$typeof"in t?I8[t.$$typeof]:T8;var e}var C8=Object.defineProperty,A8=Object.getOwnPropertyNames,pE=Object.getOwnPropertySymbols,k8=Object.getOwnPropertyDescriptor,P8=Object.getPrototypeOf,fE=Object.prototype;function UP(t,e,n){if(typeof e!="string"){if(fE){var o=P8(e);o&&o!==fE&&UP(t,o,n)}var a=A8(e);pE&&(a=a.concat(pE(e)));for(var d=dE(t),p=dE(e),c=0;c<a.length;++c){var S=a[c];if(!(S in E8||n&&n[S]||p&&S in p||d&&S in d)){var A=k8(e,S);try{C8(t,S,A)}catch{}}}}return t}function cd(t){return typeof t=="function"}function Ow(t){return typeof t=="object"&&"styledComponentId"in t}function tc(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function G1(t,e){if(t.length===0)return"";for(var n=t[0],o=1;o<t.length;o++)n+=t[o];return n}function Rf(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function K1(t,e,n){if(n===void 0&&(n=!1),!n&&!Rf(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var o=0;o<e.length;o++)t[o]=K1(t[o],e[o]);else if(Rf(e))for(var o in e)t[o]=K1(t[o],e[o]);return t}function Fw(t,e){Object.defineProperty(t,"toString",{value:e})}function qf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var R8=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,o=0;o<e;o++)n+=this.groupSizes[o];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var o=this.groupSizes,a=o.length,d=a;e>=d;)if((d<<=1)<0)throw qf(16,"".concat(e));this.groupSizes=new Uint32Array(d),this.groupSizes.set(o),this.length=d;for(var p=a;p<d;p++)this.groupSizes[p]=0}for(var c=this.indexOfGroup(e+1),S=(p=0,n.length);p<S;p++)this.tag.insertRule(c,n[p])&&(this.groupSizes[e]++,c++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],o=this.indexOfGroup(e),a=o+n;this.groupSizes[e]=0;for(var d=o;d<a;d++)this.tag.deleteRule(o)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var o=this.groupSizes[e],a=this.indexOfGroup(e),d=a+o,p=a;p<d;p++)n+="".concat(this.tag.getRule(p)).concat(zw);return n},t}(),Lg=new Map,Ty=new Map,Dg=1,ug=function(t){if(Lg.has(t))return Lg.get(t);for(;Ty.has(Dg);)Dg++;var e=Dg++;return Lg.set(t,e),Ty.set(e,t),e},M8=function(t,e){Dg=e+1,Lg.set(t,e),Ty.set(e,t)},L8="style[".concat(ld,"][").concat(DP,'="').concat(y_,'"]'),D8=new RegExp("^".concat(ld,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),z8=function(t,e,n){for(var o,a=n.split(","),d=0,p=a.length;d<p;d++)(o=a[d])&&t.registerName(e,o)},O8=function(t,e){for(var n,o=((n=e.textContent)!==null&&n!==void 0?n:"").split(zw),a=[],d=0,p=o.length;d<p;d++){var c=o[d].trim();if(c){var S=c.match(D8);if(S){var A=0|parseInt(S[1],10),D=S[2];A!==0&&(M8(D,A),z8(t,D,S[3]),t.getTag().insertRules(A,a)),a.length=0}else a.push(c)}}},mE=function(t){for(var e=document.querySelectorAll(L8),n=0,o=e.length;n<o;n++){var a=e[n];a&&a.getAttribute(ld)!==LP&&(O8(t,a),a.parentNode&&a.parentNode.removeChild(a))}};function F8(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var $P=function(t){var e=document.head,n=t||e,o=document.createElement("style"),a=function(c){var S=Array.from(c.querySelectorAll("style[".concat(ld,"]")));return S[S.length-1]}(n),d=a!==void 0?a.nextSibling:null;o.setAttribute(ld,LP),o.setAttribute(DP,y_);var p=F8();return p&&o.setAttribute("nonce",p),n.insertBefore(o,d),o},N8=function(){function t(e){this.element=$P(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var o=document.styleSheets,a=0,d=o.length;a<d;a++){var p=o[a];if(p.ownerNode===n)return p}throw qf(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),B8=function(){function t(e){this.element=$P(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var o=document.createTextNode(n);return this.element.insertBefore(o,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),V8=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),gE=Sy,j8={isServer:!Sy,useCSSOMInjection:!y8},qP=function(){function t(e,n,o){e===void 0&&(e=ud),n===void 0&&(n={});var a=this;this.options=Ao(Ao({},j8),e),this.gs=n,this.names=new Map(o),this.server=!!e.isServer,!this.server&&Sy&&gE&&(gE=!1,mE(this)),Fw(this,function(){return function(d){for(var p=d.getTag(),c=p.length,S="",A=function(L){var z=function(te){return Ty.get(te)}(L);if(z===void 0)return"continue";var ee=d.names.get(z),pe=p.getGroup(L);if(ee===void 0||!ee.size||pe.length===0)return"continue";var ue="".concat(ld,".g").concat(L,'[id="').concat(z,'"]'),me="";ee!==void 0&&ee.forEach(function(te){te.length>0&&(me+="".concat(te,","))}),S+="".concat(pe).concat(ue,'{content:"').concat(me,'"}').concat(zw)},D=0;D<c;D++)A(D);return S}(a)})}return t.registerId=function(e){return ug(e)},t.prototype.rehydrate=function(){!this.server&&Sy&&mE(this)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(Ao(Ao({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var o=n.useCSSOMInjection,a=n.target;return n.isServer?new V8(a):o?new N8(a):new B8(a)}(this.options),new R8(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(ug(e),this.names.has(e))this.names.get(e).add(n);else{var o=new Set;o.add(n),this.names.set(e,o)}},t.prototype.insertRules=function(e,n,o){this.registerName(e,n),this.getTag().insertRules(ug(e),o)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(ug(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),U8=/&/g,$8=/^\s*\/\/.*$/gm;function HP(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(o){return"".concat(e," ").concat(o)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=HP(n.children,e)),n})}function q8(t){var e,n,o,a=ud,d=a.options,p=d===void 0?ud:d,c=a.plugins,S=c===void 0?__:c,A=function(z,ee,pe){return pe.startsWith(n)&&pe.endsWith(n)&&pe.replaceAll(n,"").length>0?".".concat(e):z},D=S.slice();D.push(function(z){z.type===p_&&z.value.includes("&")&&(z.props[0]=z.props[0].replace(U8,n).replace(o,A))}),p.prefix&&D.push(m8),D.push(d8);var L=function(z,ee,pe,ue){ee===void 0&&(ee=""),pe===void 0&&(pe=""),ue===void 0&&(ue="&"),e=ue,n=ee,o=new RegExp("\\".concat(n,"\\b"),"g");var me=z.replace($8,""),te=c8(pe||ee?"".concat(pe," ").concat(ee," { ").concat(me," }"):me);p.namespace&&(te=HP(te,p.namespace));var G=[];return by(te,p8(D.concat(f8(function(re){return G.push(re)})))),G};return L.hash=S.length?S.reduce(function(z,ee){return ee.name||qf(15),Ph(z,ee.name)},OP).toString():"",L}var H8=new qP,Z1=q8(),WP=mr.createContext({shouldForwardProp:void 0,styleSheet:H8,stylis:Z1});WP.Consumer;mr.createContext(void 0);function yE(){return Ve.useContext(WP)}var GP=function(){function t(e,n){var o=this;this.inject=function(a,d){d===void 0&&(d=Z1);var p=o.name+d.hash;a.hasNameForId(o.id,p)||a.insertRules(o.id,p,d(o.rules,p,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,Fw(this,function(){throw qf(12,String(o.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Z1),this.name+e.hash},t}(),W8=function(t){return t>="A"&&t<="Z"};function _E(t){for(var e="",n=0;n<t.length;n++){var o=t[n];if(n===1&&o==="-"&&t[0]==="-")return t;W8(o)?e+="-"+o.toLowerCase():e+=o}return e.startsWith("ms-")?"-"+e:e}var KP=function(t){return t==null||t===!1||t===""},ZP=function(t){var e,n,o=[];for(var a in t){var d=t[a];t.hasOwnProperty(a)&&!KP(d)&&(Array.isArray(d)&&d.isCss||cd(d)?o.push("".concat(_E(a),":"),d,";"):Rf(d)?o.push.apply(o,Pf(Pf(["".concat(a," {")],ZP(d),!1),["}"],!1)):o.push("".concat(_E(a),": ").concat((e=a,(n=d)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in g8||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return o};function uc(t,e,n,o){if(KP(t))return[];if(Ow(t))return[".".concat(t.styledComponentId)];if(cd(t)){if(!cd(d=t)||d.prototype&&d.prototype.isReactComponent||!e)return[t];var a=t(e);return uc(a,e,n,o)}var d;return t instanceof GP?n?(t.inject(n,o),[t.getName(o)]):[t]:Rf(t)?ZP(t):Array.isArray(t)?Array.prototype.concat.apply(__,t.map(function(p){return uc(p,e,n,o)})):[t.toString()]}function G8(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(cd(n)&&!Ow(n))return!1}return!0}var K8=FP(y_),Z8=function(){function t(e,n,o){this.rules=e,this.staticRulesId="",this.isStatic=(o===void 0||o.isStatic)&&G8(e),this.componentId=n,this.baseHash=Ph(K8,n),this.baseStyle=o,qP.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,o){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))a=tc(a,this.staticRulesId);else{var d=G1(uc(this.rules,e,n,o)),p=W1(Ph(this.baseHash,d)>>>0);if(!n.hasNameForId(this.componentId,p)){var c=o(d,".".concat(p),void 0,this.componentId);n.insertRules(this.componentId,p,c)}a=tc(a,p),this.staticRulesId=p}else{for(var S=Ph(this.baseHash,o.hash),A="",D=0;D<this.rules.length;D++){var L=this.rules[D];if(typeof L=="string")A+=L;else if(L){var z=G1(uc(L,e,n,o));S=Ph(S,z+D),A+=z}}if(A){var ee=W1(S>>>0);n.hasNameForId(this.componentId,ee)||n.insertRules(this.componentId,ee,o(A,".".concat(ee),void 0,this.componentId)),a=tc(a,ee)}}return a},t}(),XP=mr.createContext(void 0);XP.Consumer;var av={};function X8(t,e,n){var o=Ow(t),a=t,d=!sv(t),p=e.attrs,c=p===void 0?__:p,S=e.componentId,A=S===void 0?function(be,Le){var Me=typeof be!="string"?"sc":cE(be);av[Me]=(av[Me]||0)+1;var J="".concat(Me,"-").concat(NP(y_+Me+av[Me]));return Le?"".concat(Le,"-").concat(J):J}(e.displayName,e.parentComponentId):S,D=e.displayName,L=D===void 0?function(be){return sv(be)?"styled.".concat(be):"Styled(".concat(b8(be),")")}(t):D,z=e.displayName&&e.componentId?"".concat(cE(e.displayName),"-").concat(e.componentId):e.componentId||A,ee=o&&a.attrs?a.attrs.concat(c).filter(Boolean):c,pe=e.shouldForwardProp;if(o&&a.shouldForwardProp){var ue=a.shouldForwardProp;if(e.shouldForwardProp){var me=e.shouldForwardProp;pe=function(be,Le){return ue(be,Le)&&me(be,Le)}}else pe=ue}var te=new Z8(n,z,o?a.componentStyle:void 0);function G(be,Le){return function(Me,J,X){var Y=Me.attrs,ie=Me.componentStyle,de=Me.defaultProps,we=Me.foldedComponentIds,se=Me.styledComponentId,ut=Me.target,un=mr.useContext(XP),cn=yE(),tn=Me.shouldForwardProp||cn.shouldForwardProp,et=_8(J,un,de)||ud,ht=function(fn,kn,Pn){for(var vr,Lr=Ao(Ao({},kn),{className:void 0,theme:Pn}),Dr=0;Dr<fn.length;Dr+=1){var ei=cd(vr=fn[Dr])?vr(Lr):vr;for(var Nn in ei)Lr[Nn]=Nn==="className"?tc(Lr[Nn],ei[Nn]):Nn==="style"?Ao(Ao({},Lr[Nn]),ei[Nn]):ei[Nn]}return kn.className&&(Lr.className=tc(Lr.className,kn.className)),Lr}(Y,J,et),Tt=ht.as||ut,kt={};for(var At in ht)ht[At]===void 0||At[0]==="$"||At==="as"||At==="theme"&&ht.theme===et||(At==="forwardedAs"?kt.as=ht.forwardedAs:tn&&!tn(At,Tt)||(kt[At]=ht[At]));var jt=function(fn,kn){var Pn=yE(),vr=fn.generateAndInjectStyles(kn,Pn.styleSheet,Pn.stylis);return vr}(ie,ht),Hn=tc(we,se);return jt&&(Hn+=" "+jt),ht.className&&(Hn+=" "+ht.className),kt[sv(Tt)&&!zP.has(Tt)?"class":"className"]=Hn,kt.ref=X,Ve.createElement(Tt,kt)}(re,be,Le)}G.displayName=L;var re=mr.forwardRef(G);return re.attrs=ee,re.componentStyle=te,re.displayName=L,re.shouldForwardProp=pe,re.foldedComponentIds=o?tc(a.foldedComponentIds,a.styledComponentId):"",re.styledComponentId=z,re.target=o?a.target:t,Object.defineProperty(re,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(be){this._foldedDefaultProps=o?function(Le){for(var Me=[],J=1;J<arguments.length;J++)Me[J-1]=arguments[J];for(var X=0,Y=Me;X<Y.length;X++)K1(Le,Y[X],!0);return Le}({},a.defaultProps,be):be}}),Fw(re,function(){return".".concat(re.styledComponentId)}),d&&UP(re,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),re}function vE(t,e){for(var n=[t[0]],o=0,a=e.length;o<a;o+=1)n.push(e[o],t[o+1]);return n}var xE=function(t){return Object.assign(t,{isCss:!0})};function YP(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(cd(t)||Rf(t))return xE(uc(vE(__,Pf([t],e,!0))));var o=t;return e.length===0&&o.length===1&&typeof o[0]=="string"?uc(o):xE(uc(vE(o,e)))}function X1(t,e,n){if(n===void 0&&(n=ud),!e)throw qf(1,e);var o=function(a){for(var d=[],p=1;p<arguments.length;p++)d[p-1]=arguments[p];return t(e,n,YP.apply(void 0,Pf([a],d,!1)))};return o.attrs=function(a){return X1(t,e,Ao(Ao({},n),{attrs:Array.prototype.concat(n.attrs,a).filter(Boolean)}))},o.withConfig=function(a){return X1(t,e,Ao(Ao({},n),a))},o}var QP=function(t){return X1(X8,t)},Sc=QP;zP.forEach(function(t){Sc[t]=QP(t)});function Nw(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=G1(YP.apply(void 0,Pf([t],e,!1))),a=NP(o);return new GP(a,o)}const Y8="#4fa94d";Sc.div`
  display: ${t=>t.$visible?"flex":"none"};
`;const Q8="http://www.w3.org/2000/svg",Vs=242.776657104492,J8=1.6,e9=Nw`
12.5% {
  stroke-dasharray: ${Vs*.14}px, ${Vs}px;
  stroke-dashoffset: -${Vs*.11}px;
}
43.75% {
  stroke-dasharray: ${Vs*.35}px, ${Vs}px;
  stroke-dashoffset: -${Vs*.35}px;
}
100% {
  stroke-dasharray: ${Vs*.01}px, ${Vs}px;
  stroke-dashoffset: -${Vs*.99}px;
}
`,t9=Sc.path`
  stroke-dasharray: ${Vs*.01}px, ${Vs};
  stroke-dashoffset: 0;
  animation: ${e9} ${J8}s linear infinite;
`,JP=({color:t=Y8,width:e="200"})=>He.jsxs("svg",{xmlns:Q8,width:`${e}`,height:`${Number(e)*.5}`,viewBox:`0 0 ${e} 100`,"data-testid":"infinity-spin",children:[He.jsx(t9,{"data-testid":"infinity-spin-path-1",stroke:t,fill:"none",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M93.9,46.4c9.3,9.5,13.8,17.9,23.5,17.9s17.5-7.8,17.5-17.5s-7.8-17.6-17.5-17.5c-9.7,0.1-13.3,7.2-22.1,17.1 c-8.9,8.8-15.7,17.9-25.4,17.9s-17.5-7.8-17.5-17.5s7.8-17.5,17.5-17.5S86.2,38.6,93.9,46.4z"}),He.jsx("path",{"data-testid":"infinity-spin-path-2",opacity:"0.07",fill:"none",stroke:t,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M93.9,46.4c9.3,9.5,13.8,17.9,23.5,17.9s17.5-7.8,17.5-17.5s-7.8-17.6-17.5-17.5c-9.7,0.1-13.3,7.2-22.1,17.1 c-8.9,8.8-15.7,17.9-25.4,17.9s-17.5-7.8-17.5-17.5s7.8-17.5,17.5-17.5S86.2,38.6,93.9,46.4z"})]}),n9=Nw`
to {
   transform: rotate(360deg);
 }
`;Sc.svg`
  animation: ${n9} 0.75s steps(12, end) infinite;
  animation-duration: 0.75s;
`;Sc.polyline`
  stroke-width: ${t=>t.width}px;
  stroke-linecap: round;

  &:nth-child(12n + 0) {
    stroke-opacity: 0.08;
  }

  &:nth-child(12n + 1) {
    stroke-opacity: 0.17;
  }

  &:nth-child(12n + 2) {
    stroke-opacity: 0.25;
  }

  &:nth-child(12n + 3) {
    stroke-opacity: 0.33;
  }

  &:nth-child(12n + 4) {
    stroke-opacity: 0.42;
  }

  &:nth-child(12n + 5) {
    stroke-opacity: 0.5;
  }

  &:nth-child(12n + 6) {
    stroke-opacity: 0.58;
  }

  &:nth-child(12n + 7) {
    stroke-opacity: 0.66;
  }

  &:nth-child(12n + 8) {
    stroke-opacity: 0.75;
  }

  &:nth-child(12n + 9) {
    stroke-opacity: 0.83;
  }

  &:nth-child(12n + 11) {
    stroke-opacity: 0.92;
  }
`;const r9=Nw`
to {
   stroke-dashoffset: 136;
 }
`;Sc.polygon`
  stroke-dasharray: 17;
  animation: ${r9} 2.5s cubic-bezier(0.35, 0.04, 0.63, 0.95) infinite;
`;Sc.svg`
  transform-origin: 50% 65%;
`;function i9(){To.apiKey="i10L3MwNCIbub5Dvmg3m";const[t,e]=Ve.useState([]),[n,o]=Ve.useState(!0);Ve.useEffect(()=>{(async()=>{o(!0);try{const ue=await EP();e(ue)}catch(ue){console.error("Error fetching locations:",ue)}finally{o(!1)}})()},[]);const a=Ve.useRef(null),d=Ve.useRef(null),p={lng:19.1451,lat:51.9194},c=5.5,S=tw(),A=Ea(),D=(A==null?void 0:A.search)||"/",[L]=cA(),z=L.getAll("category"),ee=z.length?t.filter(pe=>z.includes(pe.category)):t;return Ve.useEffect(()=>{!d.current&&a.current&&(d.current=new HA({container:a.current,style:"https://api.maptiler.com/maps/streets-v2/style.json?key=i10L3MwNCIbub5Dvmg3m",center:[p.lng,p.lat],zoom:c}),d.current.on("load",()=>{const pe={type:"FeatureCollection",features:ee.map(ue=>({type:"Feature",properties:{id:ue.id},geometry:{type:"Point",coordinates:[ue.longitude,ue.latitude]}}))};d.current.addSource("displayedLocation",{type:"geojson",data:pe,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),d.current.addLayer({id:"clusters",type:"circle",source:"displayedLocation",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#F18C18",100,"#F18C18",750,"#F18C18"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]}}),d.current.addLayer({id:"cluster-count",type:"symbol",source:"displayedLocation",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),d.current.addLayer({id:"unclustered-point",type:"circle",source:"displayedLocation",filter:["!",["has","point_count"]],paint:{"circle-color":"#F18C18","circle-radius":12,"circle-stroke-width":1,"circle-stroke-color":"#fff"}}),ee.forEach(ue=>{const me=document.createElement("div");me.className="marker",me.style.backgroundImage=`url(${ue.mainImage})`,me.style.width="50px",me.style.height="50px",me.style.backgroundSize="cover",me.style.backgroundPosition="center",me.addEventListener("click",()=>{S(`/${ue.id}`,{state:{link:D}})});const te=new rz({element:me}).setLngLat([ue.longitude,ue.latitude]).addTo(d.current);d.current.on("zoom",()=>{d.current.getZoom()>9?te.getElement().style.display="block":te.getElement().style.display="none"})}),d.current.on("click","clusters",ue=>{const me=d.current.queryRenderedFeatures(ue.point,{layers:["clusters"]}),te=me[0].properties.cluster_id;d.current.getSource("displayedLocation").getClusterExpansionZoom(te,(G,re)=>{G||d.current.easeTo({center:me[0].geometry.coordinates,zoom:re})})}),d.current.on("click","unclustered-point",ue=>{const{id:me}=ue.features[0].properties;S(`/${me}`,{state:{link:D}})}),d.current.on("mouseenter","clusters",()=>{d.current.getCanvas().style.cursor="pointer"}),d.current.on("mouseleave","clusters",()=>{d.current.getCanvas().style.cursor=""})}))},[ee,S,D,p,c]),He.jsx("div",{className:"map-wrap relative transition duration-300",children:n?He.jsx("div",{className:"absolute text-6xl top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 font-bold bg-gradient-to-tr from-yellow-500 via-yellow-400 to-amber-500 bg-clip-text text-transparent",children:He.jsx(JP,{visible:!0,width:"200",color:"#F18C18",ariaLabel:"infinity-spin-loading"})}):He.jsxs(He.Fragment,{children:[He.jsx("div",{ref:a,className:"map"}),He.jsx(rk,{typeFilter:z})]})})}function o9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"View_List"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M18.436,20.937H5.562a2.5,2.5,0,0,1-2.5-2.5V5.563a2.5,2.5,0,0,1,2.5-2.5H18.436a2.5,2.5,0,0,1,2.5,2.5V18.437A2.5,2.5,0,0,1,18.436,20.937ZM5.562,4.063a1.5,1.5,0,0,0-1.5,1.5V18.437a1.5,1.5,0,0,0,1.5,1.5H18.436a1.5,1.5,0,0,0,1.5-1.5V5.563a1.5,1.5,0,0,0-1.5-1.5Z"},child:[]},{tag:"path",attr:{d:"M6.544,8.283h0a.519.519,0,0,1-.353-.147.5.5,0,0,1,0-.707.512.512,0,0,1,.353-.146H7.55a.516.516,0,0,1,.353.146.5.5,0,0,1,.147.354.5.5,0,0,1-.5.5Z"},child:[]},{tag:"path",attr:{d:"M6.544,12.5h0a.523.523,0,0,1-.353-.146.5.5,0,0,1,0-.708.516.516,0,0,1,.353-.146H7.55a.521.521,0,0,1,.353.146.5.5,0,0,1,0,.708.516.516,0,0,1-.353.146Z"},child:[]},{tag:"path",attr:{d:"M6.544,16.72h0a.519.519,0,0,1-.353-.147.5.5,0,0,1,0-.707.516.516,0,0,1,.353-.146H7.55a.516.516,0,0,1,.353.146.5.5,0,0,1,.147.354.5.5,0,0,1-.5.5Z"},child:[]},{tag:"path",attr:{d:"M10.554,8.281h0a.5.5,0,0,1,0-1h6.9a.5.5,0,0,1,0,1Z"},child:[]},{tag:"path",attr:{d:"M10.554,12.5h0a.5.5,0,0,1,0-1h6.9a.5.5,0,0,1,0,1Z"},child:[]},{tag:"path",attr:{d:"M10.554,16.718h0a.5.5,0,0,1,0-1h6.9a.5.5,0,0,1,0,1Z"},child:[]}]}]}]})(t)}function s9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"},child:[]},{tag:"path",attr:{d:"M9 16v-8l3 5l3 -5v8"},child:[]}]})(t)}function a9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19.5 7a9 9 0 0 0 -7.5 -4a8.991 8.991 0 0 0 -7.484 4"},child:[]},{tag:"path",attr:{d:"M11.5 3a16.989 16.989 0 0 0 -1.826 4"},child:[]},{tag:"path",attr:{d:"M12.5 3a16.989 16.989 0 0 1 1.828 4"},child:[]},{tag:"path",attr:{d:"M19.5 17a9 9 0 0 1 -7.5 4a8.991 8.991 0 0 1 -7.484 -4"},child:[]},{tag:"path",attr:{d:"M11.5 21a16.989 16.989 0 0 1 -1.826 -4"},child:[]},{tag:"path",attr:{d:"M12.5 21a16.989 16.989 0 0 0 1.828 -4"},child:[]},{tag:"path",attr:{d:"M2 10l1 4l1.5 -4l1.5 4l1 -4"},child:[]},{tag:"path",attr:{d:"M17 10l1 4l1.5 -4l1.5 4l1 -4"},child:[]},{tag:"path",attr:{d:"M9.5 10l1 4l1.5 -4l1.5 4l1 -4"},child:[]}]})(t)}function l9(){const t={fontWeight:"bold",color:"#F18C18"},e=Ea(),n=(e==null?void 0:e.search)||"/";return He.jsx("footer",{className:"fixed bottom-2 w-screen flex items-center justify-center",children:He.jsxs("nav",{className:"flex items-center justify-center bg-gradient-to-r px-6 p-2 bg-navColor text-fontColor no-underline rounded-[15rem] mt-3 gap-5",children:[He.jsxs(BS,{className:"flex items-center w-12 flex-col hover:text-main",style:({isActive:o})=>o?t:null,to:"/",children:[He.jsx("span",{children:He.jsx(eO,{size:30,className:"transition-colors duration-200"})}),"Home"]}),He.jsx(s9,{color:"F18C18",size:60}),He.jsxs(BS,{className:"flex items-center w-12 flex-col hover:text-main",style:({isActive:o})=>o?t:null,to:"list",state:{link:n},children:[He.jsx("span",{children:He.jsx(o9,{size:30,className:"transition-colors duration-200"})}),"List"]})]})})}function u9(){const[t,e]=Ve.useState(()=>{const o=localStorage.getItem("isDarkMode");return o?JSON.parse(o):!0});Ve.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("isDarkMode",JSON.stringify(t))},[t]);const n=()=>{e(o=>!o)};return He.jsx("div",{className:"absolute z-10 flex rounded-full top-[4.5rem] left-4 bg-navColor text-white shadow-lg duration-200 hover:text-main hover:shadow-main hover:scale-110",children:He.jsx("button",{type:"button",className:"p-3",onClick:n,children:He.jsx("span",{children:t?He.jsx(jz,{size:30}):He.jsx(Vz,{size:30})})})})}function c9(){return He.jsxs("main",{className:"relative bg-appColor dark:bg-lightGray",children:[He.jsx(u9,{}),He.jsx(KL,{}),He.jsx(l9,{})]})}function e5(t){return Lo({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"},child:[]}]})(t)}function h9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(t)}function d9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(t)}function p9(t){return Lo({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h320c26.5 0 48-21.5 48-48v-48h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20zm-68 304H48V48h320v416zM208 256c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm-89.6 128h179.2c12.4 0 22.4-8.6 22.4-19.2v-19.2c0-31.8-30.1-57.6-67.2-57.6-10.8 0-18.7 8-44.8 8-26.9 0-33.4-8-44.8-8-37.1 0-67.2 25.8-67.2 57.6v19.2c0 10.6 10 19.2 22.4 19.2z"},child:[]}]})(t)}var t5={},n5={},v_={},r5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0};t.default=e})(r5);var f9="Expected a function",wE=NaN,m9="[object Symbol]",g9=/^\s+|\s+$/g,y9=/^[-+]0x[0-9a-f]+$/i,_9=/^0b[01]+$/i,v9=/^0o[0-7]+$/i,x9=parseInt,w9=typeof Rp=="object"&&Rp&&Rp.Object===Object&&Rp,b9=typeof self=="object"&&self&&self.Object===Object&&self,S9=w9||b9||Function("return this")(),T9=Object.prototype,E9=T9.toString,I9=Math.max,C9=Math.min,lv=function(){return S9.Date.now()};function A9(t,e,n){var o,a,d,p,c,S,A=0,D=!1,L=!1,z=!0;if(typeof t!="function")throw new TypeError(f9);e=bE(e)||0,Y1(n)&&(D=!!n.leading,L="maxWait"in n,d=L?I9(bE(n.maxWait)||0,e):d,z="trailing"in n?!!n.trailing:z);function ee(Me){var J=o,X=a;return o=a=void 0,A=Me,p=t.apply(X,J),p}function pe(Me){return A=Me,c=setTimeout(te,e),D?ee(Me):p}function ue(Me){var J=Me-S,X=Me-A,Y=e-J;return L?C9(Y,d-X):Y}function me(Me){var J=Me-S,X=Me-A;return S===void 0||J>=e||J<0||L&&X>=d}function te(){var Me=lv();if(me(Me))return G(Me);c=setTimeout(te,ue(Me))}function G(Me){return c=void 0,z&&o?ee(Me):(o=a=void 0,p)}function re(){c!==void 0&&clearTimeout(c),A=0,o=S=a=c=void 0}function be(){return c===void 0?p:G(lv())}function Le(){var Me=lv(),J=me(Me);if(o=arguments,a=this,S=Me,J){if(c===void 0)return pe(S);if(L)return c=setTimeout(te,e),ee(S)}return c===void 0&&(c=setTimeout(te,e)),p}return Le.cancel=re,Le.flush=be,Le}function Y1(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function k9(t){return!!t&&typeof t=="object"}function P9(t){return typeof t=="symbol"||k9(t)&&E9.call(t)==m9}function bE(t){if(typeof t=="number")return t;if(P9(t))return wE;if(Y1(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Y1(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(g9,"");var n=_9.test(t);return n||v9.test(t)?x9(t.slice(2),n?2:8):y9.test(t)?wE:+t}var R9=A9,i5={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var d="",p=0;p<arguments.length;p++){var c=arguments[p];c&&(d=a(d,o(c)))}return d}function o(d){if(typeof d=="string"||typeof d=="number")return d;if(typeof d!="object")return"";if(Array.isArray(d))return n.apply(null,d);if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]"))return d.toString();var p="";for(var c in d)e.call(d,c)&&d[c]&&(p=a(p,c));return p}function a(d,p){return p?d?d+" "+p:d+p:d}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(i5);var x_=i5.exports,pt={},Bw={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=n(Ve);function n(a){return a&&a.__esModule?a:{default:a}}var o={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(d){return e.default.createElement("ul",{style:{display:"block"}},d)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(d){return e.default.createElement("button",null,d+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0,asNavFor:null};t.default=o})(Bw);Object.defineProperty(pt,"__esModule",{value:!0});pt.checkSpecKeys=pt.checkNavigable=pt.changeSlide=pt.canUseDOM=pt.canGoNext=void 0;pt.clamp=s5;pt.extractObject=void 0;pt.filterSettings=W9;pt.validSettings=pt.swipeStart=pt.swipeMove=pt.swipeEnd=pt.slidesOnRight=pt.slidesOnLeft=pt.slideHandler=pt.siblingDirection=pt.safePreventDefault=pt.lazyStartIndex=pt.lazySlidesOnRight=pt.lazySlidesOnLeft=pt.lazyEndIndex=pt.keyHandler=pt.initializedState=pt.getWidth=pt.getTrackLeft=pt.getTrackCSS=pt.getTrackAnimateCSS=pt.getTotalSlides=pt.getSwipeDirection=pt.getSlideCount=pt.getRequiredLazySlides=pt.getPreClones=pt.getPostClones=pt.getOnDemandLazySlides=pt.getNavigableIndexes=pt.getHeight=void 0;var M9=o5(Ve),L9=o5(Bw);function o5(t){return t&&t.__esModule?t:{default:t}}function Mf(t){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(t)}function SE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function cr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SE(Object(n),!0).forEach(function(o){D9(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SE(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function D9(t,e,n){return e=z9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z9(t){var e=O9(t,"string");return Mf(e)=="symbol"?e:String(e)}function O9(t,e){if(Mf(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(Mf(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s5(t,e,n){return Math.max(e,Math.min(t,n))}var $h=pt.safePreventDefault=function(e){var n=["onTouchStart","onTouchMove","onWheel"];n.includes(e._reactName)||e.preventDefault()},a5=pt.getOnDemandLazySlides=function(e){for(var n=[],o=l5(e),a=u5(e),d=o;d<a;d++)e.lazyLoadedList.indexOf(d)<0&&n.push(d);return n};pt.getRequiredLazySlides=function(e){for(var n=[],o=l5(e),a=u5(e),d=o;d<a;d++)n.push(d);return n};var l5=pt.lazyStartIndex=function(e){return e.currentSlide-F9(e)},u5=pt.lazyEndIndex=function(e){return e.currentSlide+N9(e)},F9=pt.lazySlidesOnLeft=function(e){return e.centerMode?Math.floor(e.slidesToShow/2)+(parseInt(e.centerPadding)>0?1:0):0},N9=pt.lazySlidesOnRight=function(e){return e.centerMode?Math.floor((e.slidesToShow-1)/2)+1+(parseInt(e.centerPadding)>0?1:0):e.slidesToShow},Q1=pt.getWidth=function(e){return e&&e.offsetWidth||0},c5=pt.getHeight=function(e){return e&&e.offsetHeight||0},h5=pt.getSwipeDirection=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o,a,d,p;return o=e.startX-e.curX,a=e.startY-e.curY,d=Math.atan2(a,o),p=Math.round(d*180/Math.PI),p<0&&(p=360-Math.abs(p)),p<=45&&p>=0||p<=360&&p>=315?"left":p>=135&&p<=225?"right":n===!0?p>=35&&p<=135?"up":"down":"vertical"},d5=pt.canGoNext=function(e){var n=!0;return e.infinite||(e.centerMode&&e.currentSlide>=e.slideCount-1||e.slideCount<=e.slidesToShow||e.currentSlide>=e.slideCount-e.slidesToShow)&&(n=!1),n};pt.extractObject=function(e,n){var o={};return n.forEach(function(a){return o[a]=e[a]}),o};pt.initializedState=function(e){var n=M9.default.Children.count(e.children),o=e.listRef,a=Math.ceil(Q1(o)),d=e.trackRef&&e.trackRef.node,p=Math.ceil(Q1(d)),c;if(e.vertical)c=a;else{var S=e.centerMode&&parseInt(e.centerPadding)*2;typeof e.centerPadding=="string"&&e.centerPadding.slice(-1)==="%"&&(S*=a/100),c=Math.ceil((a-S)/e.slidesToShow)}var A=o&&c5(o.querySelector('[data-index="0"]')),D=A*e.slidesToShow,L=e.currentSlide===void 0?e.initialSlide:e.currentSlide;e.rtl&&e.currentSlide===void 0&&(L=n-1-e.initialSlide);var z=e.lazyLoadedList||[],ee=a5(cr(cr({},e),{},{currentSlide:L,lazyLoadedList:z}));z=z.concat(ee);var pe={slideCount:n,slideWidth:c,listWidth:a,trackWidth:p,currentSlide:L,slideHeight:A,listHeight:D,lazyLoadedList:z};return e.autoplaying===null&&e.autoplay&&(pe.autoplaying="playing"),pe};pt.slideHandler=function(e){var n=e.waitForAnimate,o=e.animating,a=e.fade,d=e.infinite,p=e.index,c=e.slideCount,S=e.lazyLoad,A=e.currentSlide,D=e.centerMode,L=e.slidesToScroll,z=e.slidesToShow,ee=e.useCSS,pe=e.lazyLoadedList;if(n&&o)return{};var ue=p,me,te,G,re={},be={},Le=d?p:s5(p,0,c-1);if(a){if(!d&&(p<0||p>=c))return{};p<0?ue=p+c:p>=c&&(ue=p-c),S&&pe.indexOf(ue)<0&&(pe=pe.concat(ue)),re={animating:!0,currentSlide:ue,lazyLoadedList:pe,targetSlide:ue},be={animating:!1,targetSlide:ue}}else me=ue,ue<0?(me=ue+c,d?c%L!==0&&(me=c-c%L):me=0):!d5(e)&&ue>A?ue=me=A:D&&ue>=c?(ue=d?c:c-1,me=d?0:c-1):ue>=c&&(me=ue-c,d?c%L!==0&&(me=0):me=c-z),!d&&ue+z>=c&&(me=c-z),te=Iy(cr(cr({},e),{},{slideIndex:ue})),G=Iy(cr(cr({},e),{},{slideIndex:me})),d||(te===G&&(ue=me),te=G),S&&(pe=pe.concat(a5(cr(cr({},e),{},{currentSlide:ue})))),ee?(re={animating:!0,currentSlide:me,trackStyle:p5(cr(cr({},e),{},{left:te})),lazyLoadedList:pe,targetSlide:Le},be={animating:!1,currentSlide:me,trackStyle:Ey(cr(cr({},e),{},{left:G})),swipeLeft:null,targetSlide:Le}):re={currentSlide:me,trackStyle:Ey(cr(cr({},e),{},{left:G})),lazyLoadedList:pe,targetSlide:Le};return{state:re,nextState:be}};pt.changeSlide=function(e,n){var o,a,d,p,c,S=e.slidesToScroll,A=e.slidesToShow,D=e.slideCount,L=e.currentSlide,z=e.targetSlide,ee=e.lazyLoad,pe=e.infinite;if(p=D%S!==0,o=p?0:(D-L)%S,n.message==="previous")d=o===0?S:A-o,c=L-d,ee&&!pe&&(a=L-d,c=a===-1?D-1:a),pe||(c=z-S);else if(n.message==="next")d=o===0?S:o,c=L+d,ee&&!pe&&(c=(L+S)%D+o),pe||(c=z+S);else if(n.message==="dots")c=n.index*n.slidesToScroll;else if(n.message==="children"){if(c=n.index,pe){var ue=U9(cr(cr({},e),{},{targetSlide:c}));c>n.currentSlide&&ue==="left"?c=c-D:c<n.currentSlide&&ue==="right"&&(c=c+D)}}else n.message==="index"&&(c=Number(n.index));return c};pt.keyHandler=function(e,n,o){return e.target.tagName.match("TEXTAREA|INPUT|SELECT")||!n?"":e.keyCode===37?o?"next":"previous":e.keyCode===39?o?"previous":"next":""};pt.swipeStart=function(e,n,o){return e.target.tagName==="IMG"&&$h(e),!n||!o&&e.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:e.touches?e.touches[0].pageX:e.clientX,startY:e.touches?e.touches[0].pageY:e.clientY,curX:e.touches?e.touches[0].pageX:e.clientX,curY:e.touches?e.touches[0].pageY:e.clientY}}};pt.swipeMove=function(e,n){var o=n.scrolling,a=n.animating,d=n.vertical,p=n.swipeToSlide,c=n.verticalSwiping,S=n.rtl,A=n.currentSlide,D=n.edgeFriction,L=n.edgeDragged,z=n.onEdge,ee=n.swiped,pe=n.swiping,ue=n.slideCount,me=n.slidesToScroll,te=n.infinite,G=n.touchObject,re=n.swipeEvent,be=n.listHeight,Le=n.listWidth;if(!o){if(a)return $h(e);d&&p&&c&&$h(e);var Me,J={},X=Iy(n);G.curX=e.touches?e.touches[0].pageX:e.clientX,G.curY=e.touches?e.touches[0].pageY:e.clientY,G.swipeLength=Math.round(Math.sqrt(Math.pow(G.curX-G.startX,2)));var Y=Math.round(Math.sqrt(Math.pow(G.curY-G.startY,2)));if(!c&&!pe&&Y>10)return{scrolling:!0};c&&(G.swipeLength=Y);var ie=(S?-1:1)*(G.curX>G.startX?1:-1);c&&(ie=G.curY>G.startY?1:-1);var de=Math.ceil(ue/me),we=h5(n.touchObject,c),se=G.swipeLength;return te||(A===0&&(we==="right"||we==="down")||A+1>=de&&(we==="left"||we==="up")||!d5(n)&&(we==="left"||we==="up"))&&(se=G.swipeLength*D,L===!1&&z&&(z(we),J.edgeDragged=!0)),!ee&&re&&(re(we),J.swiped=!0),d?Me=X+se*(be/Le)*ie:S?Me=X-se*ie:Me=X+se*ie,c&&(Me=X+se*ie),J=cr(cr({},J),{},{touchObject:G,swipeLeft:Me,trackStyle:Ey(cr(cr({},n),{},{left:Me}))}),Math.abs(G.curX-G.startX)<Math.abs(G.curY-G.startY)*.8||G.swipeLength>10&&(J.swiping=!0,$h(e)),J}};pt.swipeEnd=function(e,n){var o=n.dragging,a=n.swipe,d=n.touchObject,p=n.listWidth,c=n.touchThreshold,S=n.verticalSwiping,A=n.listHeight,D=n.swipeToSlide,L=n.scrolling,z=n.onSwipe,ee=n.targetSlide,pe=n.currentSlide,ue=n.infinite;if(!o)return a&&$h(e),{};var me=S?A/c:p/c,te=h5(d,S),G={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(L||!d.swipeLength)return G;if(d.swipeLength>me){$h(e),z&&z(te);var re,be,Le=ue?pe:ee;switch(te){case"left":case"up":be=Le+EE(n),re=D?TE(n,be):be,G.currentDirection=0;break;case"right":case"down":be=Le-EE(n),re=D?TE(n,be):be,G.currentDirection=1;break;default:re=Le}G.triggerSlideHandler=re}else{var Me=Iy(n);G.trackStyle=p5(cr(cr({},n),{},{left:Me}))}return G};var B9=pt.getNavigableIndexes=function(e){for(var n=e.infinite?e.slideCount*2:e.slideCount,o=e.infinite?e.slidesToShow*-1:0,a=e.infinite?e.slidesToShow*-1:0,d=[];o<n;)d.push(o),o=a+e.slidesToScroll,a+=Math.min(e.slidesToScroll,e.slidesToShow);return d},TE=pt.checkNavigable=function(e,n){var o=B9(e),a=0;if(n>o[o.length-1])n=o[o.length-1];else for(var d in o){if(n<o[d]){n=a;break}a=o[d]}return n},EE=pt.getSlideCount=function(e){var n=e.centerMode?e.slideWidth*Math.floor(e.slidesToShow/2):0;if(e.swipeToSlide){var o,a=e.listRef,d=a.querySelectorAll&&a.querySelectorAll(".slick-slide")||[];if(Array.from(d).every(function(S){if(e.vertical){if(S.offsetTop+c5(S)/2>e.swipeLeft*-1)return o=S,!1}else if(S.offsetLeft-n+Q1(S)/2>e.swipeLeft*-1)return o=S,!1;return!0}),!o)return 0;var p=e.rtl===!0?e.slideCount-e.currentSlide:e.currentSlide,c=Math.abs(o.dataset.index-p)||1;return c}else return e.slidesToScroll},Vw=pt.checkSpecKeys=function(e,n){return n.reduce(function(o,a){return o&&e.hasOwnProperty(a)},!0)?null:console.error("Keys Missing:",e)},Ey=pt.getTrackCSS=function(e){Vw(e,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var n,o,a=e.slideCount+2*e.slidesToShow;e.vertical?o=a*e.slideHeight:n=j9(e)*e.slideWidth;var d={opacity:1,transition:"",WebkitTransition:""};if(e.useTransform){var p=e.vertical?"translate3d(0px, "+e.left+"px, 0px)":"translate3d("+e.left+"px, 0px, 0px)",c=e.vertical?"translate3d(0px, "+e.left+"px, 0px)":"translate3d("+e.left+"px, 0px, 0px)",S=e.vertical?"translateY("+e.left+"px)":"translateX("+e.left+"px)";d=cr(cr({},d),{},{WebkitTransform:p,transform:c,msTransform:S})}else e.vertical?d.top=e.left:d.left=e.left;return e.fade&&(d={opacity:1}),n&&(d.width=n),o&&(d.height=o),window&&!window.addEventListener&&window.attachEvent&&(e.vertical?d.marginTop=e.left+"px":d.marginLeft=e.left+"px"),d},p5=pt.getTrackAnimateCSS=function(e){Vw(e,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var n=Ey(e);return e.useTransform?(n.WebkitTransition="-webkit-transform "+e.speed+"ms "+e.cssEase,n.transition="transform "+e.speed+"ms "+e.cssEase):e.vertical?n.transition="top "+e.speed+"ms "+e.cssEase:n.transition="left "+e.speed+"ms "+e.cssEase,n},Iy=pt.getTrackLeft=function(e){if(e.unslick)return 0;Vw(e,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var n=e.slideIndex,o=e.trackRef,a=e.infinite,d=e.centerMode,p=e.slideCount,c=e.slidesToShow,S=e.slidesToScroll,A=e.slideWidth,D=e.listWidth,L=e.variableWidth,z=e.slideHeight,ee=e.fade,pe=e.vertical,ue=0,me,te,G=0;if(ee||e.slideCount===1)return 0;var re=0;if(a?(re=-zg(e),p%S!==0&&n+S>p&&(re=-(n>p?c-(n-p):p%S)),d&&(re+=parseInt(c/2))):(p%S!==0&&n+S>p&&(re=c-p%S),d&&(re=parseInt(c/2))),ue=re*A,G=re*z,pe?me=n*z*-1+G:me=n*A*-1+ue,L===!0){var be,Le=o&&o.node;if(be=n+zg(e),te=Le&&Le.childNodes[be],me=te?te.offsetLeft*-1:0,d===!0){be=a?n+zg(e):n,te=Le&&Le.children[be],me=0;for(var Me=0;Me<be;Me++)me-=Le&&Le.children[Me]&&Le.children[Me].offsetWidth;me-=parseInt(e.centerPadding),me+=te&&(D-te.offsetWidth)/2}}return me},zg=pt.getPreClones=function(e){return e.unslick||!e.infinite?0:e.variableWidth?e.slideCount:e.slidesToShow+(e.centerMode?1:0)},V9=pt.getPostClones=function(e){return e.unslick||!e.infinite?0:e.slideCount},j9=pt.getTotalSlides=function(e){return e.slideCount===1?1:zg(e)+e.slideCount+V9(e)},U9=pt.siblingDirection=function(e){return e.targetSlide>e.currentSlide?e.targetSlide>e.currentSlide+$9(e)?"left":"right":e.targetSlide<e.currentSlide-q9(e)?"right":"left"},$9=pt.slidesOnRight=function(e){var n=e.slidesToShow,o=e.centerMode,a=e.rtl,d=e.centerPadding;if(o){var p=(n-1)/2+1;return parseInt(d)>0&&(p+=1),a&&n%2===0&&(p+=1),p}return a?0:n-1},q9=pt.slidesOnLeft=function(e){var n=e.slidesToShow,o=e.centerMode,a=e.rtl,d=e.centerPadding;if(o){var p=(n-1)/2+1;return parseInt(d)>0&&(p+=1),!a&&n%2===0&&(p+=1),p}return a?n-1:0};pt.canUseDOM=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)};var H9=pt.validSettings=Object.keys(L9.default);function W9(t){return H9.reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e},{})}var w_={};Object.defineProperty(w_,"__esModule",{value:!0});w_.Track=void 0;var Vl=f5(Ve),uv=f5(x_),cv=pt;function f5(t){return t&&t.__esModule?t:{default:t}}function hd(t){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}function J1(){return J1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},J1.apply(this,arguments)}function G9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K9(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,g5(o.key),o)}}function Z9(t,e,n){return e&&K9(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function X9(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ex(t,e)}function ex(t,e){return ex=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,a){return o.__proto__=a,o},ex(t,e)}function Y9(t){var e=m5();return function(){var o=Cy(t),a;if(e){var d=Cy(this).constructor;a=Reflect.construct(o,arguments,d)}else a=o.apply(this,arguments);return Q9(this,a)}}function Q9(t,e){if(e&&(hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tx(t)}function tx(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m5=function(){return!!t})()}function Cy(t){return Cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Cy(t)}function IE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function So(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IE(Object(n),!0).forEach(function(o){nx(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IE(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function nx(t,e,n){return e=g5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g5(t){var e=J9(t,"string");return hd(e)=="symbol"?e:String(e)}function J9(t,e){if(hd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(hd(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hv=function(e){var n,o,a,d,p;e.rtl?p=e.slideCount-1-e.index:p=e.index,a=p<0||p>=e.slideCount,e.centerMode?(d=Math.floor(e.slidesToShow/2),o=(p-e.currentSlide)%e.slideCount===0,p>e.currentSlide-d-1&&p<=e.currentSlide+d&&(n=!0)):n=e.currentSlide<=p&&p<e.currentSlide+e.slidesToShow;var c;e.targetSlide<0?c=e.targetSlide+e.slideCount:e.targetSlide>=e.slideCount?c=e.targetSlide-e.slideCount:c=e.targetSlide;var S=p===c;return{"slick-slide":!0,"slick-active":n,"slick-center":o,"slick-cloned":a,"slick-current":S}},eV=function(e){var n={};return(e.variableWidth===void 0||e.variableWidth===!1)&&(n.width=e.slideWidth),e.fade&&(n.position="relative",e.vertical?n.top=-e.index*parseInt(e.slideHeight):n.left=-e.index*parseInt(e.slideWidth),n.opacity=e.currentSlide===e.index?1:0,n.zIndex=e.currentSlide===e.index?999:998,e.useCSS&&(n.transition="opacity "+e.speed+"ms "+e.cssEase+", visibility "+e.speed+"ms "+e.cssEase)),n},dv=function(e,n){return e.key||n},tV=function(e){var n,o=[],a=[],d=[],p=Vl.default.Children.count(e.children),c=(0,cv.lazyStartIndex)(e),S=(0,cv.lazyEndIndex)(e);return Vl.default.Children.forEach(e.children,function(A,D){var L,z={message:"children",index:D,slidesToScroll:e.slidesToScroll,currentSlide:e.currentSlide};!e.lazyLoad||e.lazyLoad&&e.lazyLoadedList.indexOf(D)>=0?L=A:L=Vl.default.createElement("div",null);var ee=eV(So(So({},e),{},{index:D})),pe=L.props.className||"",ue=hv(So(So({},e),{},{index:D}));if(o.push(Vl.default.cloneElement(L,{key:"original"+dv(L,D),"data-index":D,className:(0,uv.default)(ue,pe),tabIndex:"-1","aria-hidden":!ue["slick-active"],style:So(So({outline:"none"},L.props.style||{}),ee),onClick:function(G){L.props&&L.props.onClick&&L.props.onClick(G),e.focusOnSelect&&e.focusOnSelect(z)}})),e.infinite&&e.fade===!1){var me=p-D;me<=(0,cv.getPreClones)(e)&&(n=-me,n>=c&&(L=A),ue=hv(So(So({},e),{},{index:n})),a.push(Vl.default.cloneElement(L,{key:"precloned"+dv(L,n),"data-index":n,tabIndex:"-1",className:(0,uv.default)(ue,pe),"aria-hidden":!ue["slick-active"],style:So(So({},L.props.style||{}),ee),onClick:function(G){L.props&&L.props.onClick&&L.props.onClick(G),e.focusOnSelect&&e.focusOnSelect(z)}}))),n=p+D,n<S&&(L=A),ue=hv(So(So({},e),{},{index:n})),d.push(Vl.default.cloneElement(L,{key:"postcloned"+dv(L,n),"data-index":n,tabIndex:"-1",className:(0,uv.default)(ue,pe),"aria-hidden":!ue["slick-active"],style:So(So({},L.props.style||{}),ee),onClick:function(G){L.props&&L.props.onClick&&L.props.onClick(G),e.focusOnSelect&&e.focusOnSelect(z)}}))}}),e.rtl?a.concat(o,d).reverse():a.concat(o,d)};w_.Track=function(t){X9(n,t);var e=Y9(n);function n(){var o;G9(this,n);for(var a=arguments.length,d=new Array(a),p=0;p<a;p++)d[p]=arguments[p];return o=e.call.apply(e,[this].concat(d)),nx(tx(o),"node",null),nx(tx(o),"handleRef",function(c){o.node=c}),o}return Z9(n,[{key:"render",value:function(){var a=tV(this.props),d=this.props,p=d.onMouseEnter,c=d.onMouseOver,S=d.onMouseLeave,A={onMouseEnter:p,onMouseOver:c,onMouseLeave:S};return Vl.default.createElement("div",J1({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},A),a)}}]),n}(Vl.default.PureComponent);var b_={};function dd(t){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dd(t)}Object.defineProperty(b_,"__esModule",{value:!0});b_.Dots=void 0;var cg=y5(Ve),nV=y5(x_),CE=pt;function y5(t){return t&&t.__esModule?t:{default:t}}function AE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function rV(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AE(Object(n),!0).forEach(function(o){iV(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AE(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function iV(t,e,n){return e=_5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sV(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_5(o.key),o)}}function aV(t,e,n){return e&&sV(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _5(t){var e=lV(t,"string");return dd(e)=="symbol"?e:String(e)}function lV(t,e){if(dd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(dd(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rx(t,e)}function rx(t,e){return rx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,a){return o.__proto__=a,o},rx(t,e)}function cV(t){var e=v5();return function(){var o=Ay(t),a;if(e){var d=Ay(this).constructor;a=Reflect.construct(o,arguments,d)}else a=o.apply(this,arguments);return hV(this,a)}}function hV(t,e){if(e&&(dd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dV(t)}function dV(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v5=function(){return!!t})()}function Ay(t){return Ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ay(t)}var pV=function(e){var n;return e.infinite?n=Math.ceil(e.slideCount/e.slidesToScroll):n=Math.ceil((e.slideCount-e.slidesToShow)/e.slidesToScroll)+1,n};b_.Dots=function(t){uV(n,t);var e=cV(n);function n(){return oV(this,n),e.apply(this,arguments)}return aV(n,[{key:"clickHandler",value:function(a,d){d.preventDefault(),this.props.clickHandler(a)}},{key:"render",value:function(){for(var a=this.props,d=a.onMouseEnter,p=a.onMouseOver,c=a.onMouseLeave,S=a.infinite,A=a.slidesToScroll,D=a.slidesToShow,L=a.slideCount,z=a.currentSlide,ee=pV({slideCount:L,slidesToScroll:A,slidesToShow:D,infinite:S}),pe={onMouseEnter:d,onMouseOver:p,onMouseLeave:c},ue=[],me=0;me<ee;me++){var te=(me+1)*A-1,G=S?te:(0,CE.clamp)(te,0,L-1),re=G-(A-1),be=S?re:(0,CE.clamp)(re,0,L-1),Le=(0,nV.default)({"slick-active":S?z>=be&&z<=G:z===be}),Me={message:"dots",index:me,slidesToScroll:A,currentSlide:z},J=this.clickHandler.bind(this,Me);ue=ue.concat(cg.default.createElement("li",{key:me,className:Le},cg.default.cloneElement(this.props.customPaging(me),{onClick:J})))}return cg.default.cloneElement(this.props.appendDots(ue),rV({className:this.props.dotsClass},pe))}}]),n}(cg.default.PureComponent);var pd={};function fd(t){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}Object.defineProperty(pd,"__esModule",{value:!0});pd.PrevArrow=pd.NextArrow=void 0;var qh=w5(Ve),x5=w5(x_),fV=pt;function w5(t){return t&&t.__esModule?t:{default:t}}function ky(){return ky=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ky.apply(this,arguments)}function kE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function Py(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kE(Object(n),!0).forEach(function(o){mV(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function mV(t,e,n){return e=T5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gV(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,T5(o.key),o)}}function S5(t,e,n){return e&&gV(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function T5(t){var e=yV(t,"string");return fd(e)=="symbol"?e:String(e)}function yV(t,e){if(fd(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(fd(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function E5(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ix(t,e)}function ix(t,e){return ix=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,a){return o.__proto__=a,o},ix(t,e)}function I5(t){var e=C5();return function(){var o=Ry(t),a;if(e){var d=Ry(this).constructor;a=Reflect.construct(o,arguments,d)}else a=o.apply(this,arguments);return _V(this,a)}}function _V(t,e){if(e&&(fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vV(t)}function vV(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C5=function(){return!!t})()}function Ry(t){return Ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ry(t)}pd.PrevArrow=function(t){E5(n,t);var e=I5(n);function n(){return b5(this,n),e.apply(this,arguments)}return S5(n,[{key:"clickHandler",value:function(a,d){d&&d.preventDefault(),this.props.clickHandler(a,d)}},{key:"render",value:function(){var a={"slick-arrow":!0,"slick-prev":!0},d=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(a["slick-disabled"]=!0,d=null);var p={key:"0","data-role":"none",className:(0,x5.default)(a),style:{display:"block"},onClick:d},c={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},S;return this.props.prevArrow?S=qh.default.cloneElement(this.props.prevArrow,Py(Py({},p),c)):S=qh.default.createElement("button",ky({key:"0",type:"button"},p)," ","Previous"),S}}]),n}(qh.default.PureComponent);pd.NextArrow=function(t){E5(n,t);var e=I5(n);function n(){return b5(this,n),e.apply(this,arguments)}return S5(n,[{key:"clickHandler",value:function(a,d){d&&d.preventDefault(),this.props.clickHandler(a,d)}},{key:"render",value:function(){var a={"slick-arrow":!0,"slick-next":!0},d=this.clickHandler.bind(this,{message:"next"});(0,fV.canGoNext)(this.props)||(a["slick-disabled"]=!0,d=null);var p={key:"1","data-role":"none",className:(0,x5.default)(a),style:{display:"block"},onClick:d},c={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},S;return this.props.nextArrow?S=qh.default.cloneElement(this.props.nextArrow,Py(Py({},p),c)):S=qh.default.createElement("button",ky({key:"1",type:"button"},p)," ","Next"),S}}]),n}(qh.default.PureComponent);var A5=function(){if(typeof Map<"u")return Map;function t(e,n){var o=-1;return e.some(function(a,d){return a[0]===n?(o=d,!0):!1}),o}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var o=t(this.__entries__,n),a=this.__entries__[o];return a&&a[1]},e.prototype.set=function(n,o){var a=t(this.__entries__,n);~a?this.__entries__[a][1]=o:this.__entries__.push([n,o])},e.prototype.delete=function(n){var o=this.__entries__,a=t(o,n);~a&&o.splice(a,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,o){o===void 0&&(o=null);for(var a=0,d=this.__entries__;a<d.length;a++){var p=d[a];n.call(o,p[1],p[0])}},e}()}(),ox=typeof window<"u"&&typeof document<"u"&&window.document===document,My=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),xV=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(My):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),wV=2;function bV(t,e){var n=!1,o=!1,a=0;function d(){n&&(n=!1,t()),o&&c()}function p(){xV(d)}function c(){var S=Date.now();if(n){if(S-a<wV)return;o=!0}else n=!0,o=!1,setTimeout(p,e);a=S}return c}var SV=20,TV=["top","right","bottom","left","width","height","size","weight"],EV=typeof MutationObserver<"u",IV=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=bV(this.refresh.bind(this),SV)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,o=n.indexOf(e);~o&&n.splice(o,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!ox||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),EV?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!ox||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,o=n===void 0?"":n,a=TV.some(function(d){return!!~o.indexOf(d)});a&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),k5=function(t,e){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];Object.defineProperty(t,a,{value:e[a],enumerable:!1,writable:!1,configurable:!0})}return t},md=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||My},P5=S_(0,0,0,0);function Ly(t){return parseFloat(t)||0}function PE(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(o,a){var d=t["border-"+a+"-width"];return o+Ly(d)},0)}function CV(t){for(var e=["top","right","bottom","left"],n={},o=0,a=e;o<a.length;o++){var d=a[o],p=t["padding-"+d];n[d]=Ly(p)}return n}function AV(t){var e=t.getBBox();return S_(0,0,e.width,e.height)}function kV(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return P5;var o=md(t).getComputedStyle(t),a=CV(o),d=a.left+a.right,p=a.top+a.bottom,c=Ly(o.width),S=Ly(o.height);if(o.boxSizing==="border-box"&&(Math.round(c+d)!==e&&(c-=PE(o,"left","right")+d),Math.round(S+p)!==n&&(S-=PE(o,"top","bottom")+p)),!RV(t)){var A=Math.round(c+d)-e,D=Math.round(S+p)-n;Math.abs(A)!==1&&(c-=A),Math.abs(D)!==1&&(S-=D)}return S_(a.left,a.top,c,S)}var PV=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof md(t).SVGGraphicsElement}:function(t){return t instanceof md(t).SVGElement&&typeof t.getBBox=="function"}}();function RV(t){return t===md(t).document.documentElement}function MV(t){return ox?PV(t)?AV(t):kV(t):P5}function LV(t){var e=t.x,n=t.y,o=t.width,a=t.height,d=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,p=Object.create(d.prototype);return k5(p,{x:e,y:n,width:o,height:a,top:n,right:e+o,bottom:a+n,left:e}),p}function S_(t,e,n,o){return{x:t,y:e,width:n,height:o}}var DV=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S_(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=MV(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),zV=function(){function t(e,n){var o=LV(n);k5(this,{target:e,contentRect:o})}return t}(),OV=function(){function t(e,n,o){if(this.activeObservations_=[],this.observations_=new A5,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=o}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof md(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new DV(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof md(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(o){return new zV(o.target,o.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),R5=typeof WeakMap<"u"?new WeakMap:new A5,M5=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=IV.getInstance(),o=new OV(e,n,this);R5.set(this,o)}return t}();["observe","unobserve","disconnect"].forEach(function(t){M5.prototype[t]=function(){var e;return(e=R5.get(this))[t].apply(e,arguments)}});var FV=function(){return typeof My.ResizeObserver<"u"?My.ResizeObserver:M5}();const NV=Object.freeze(Object.defineProperty({__proto__:null,default:FV},Symbol.toStringTag,{value:"Module"})),BV=MM(NV);Object.defineProperty(v_,"__esModule",{value:!0});v_.InnerSlider=void 0;var co=Hf(Ve),VV=Hf(r5),jV=Hf(R9),UV=Hf(x_),fr=pt,$V=w_,qV=b_,RE=pd,HV=Hf(BV);function Hf(t){return t&&t.__esModule?t:{default:t}}function vc(t){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(t)}function Dy(){return Dy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Dy.apply(this,arguments)}function WV(t,e){if(t==null)return{};var n=GV(t,e),o,a;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(a=0;a<d.length;a++)o=d[a],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function GV(t,e){if(t==null)return{};var n={},o=Object.keys(t),a,d;for(d=0;d<o.length;d++)a=o[d],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function ME(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,o)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ME(Object(n),!0).forEach(function(o){an(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ME(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function KV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZV(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,D5(o.key),o)}}function XV(t,e,n){return e&&ZV(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function YV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sx(t,e)}function sx(t,e){return sx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,a){return o.__proto__=a,o},sx(t,e)}function QV(t){var e=L5();return function(){var o=zy(t),a;if(e){var d=zy(this).constructor;a=Reflect.construct(o,arguments,d)}else a=o.apply(this,arguments);return JV(this,a)}}function JV(t,e){if(e&&(vc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sn(t)}function sn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L5=function(){return!!t})()}function zy(t){return zy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zy(t)}function an(t,e,n){return e=D5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D5(t){var e=e7(t,"string");return vc(e)=="symbol"?e:String(e)}function e7(t,e){if(vc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(vc(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}v_.InnerSlider=function(t){YV(n,t);var e=QV(n);function n(o){var a;KV(this,n),a=e.call(this,o),an(sn(a),"listRefHandler",function(p){return a.list=p}),an(sn(a),"trackRefHandler",function(p){return a.track=p}),an(sn(a),"adaptHeight",function(){if(a.props.adaptiveHeight&&a.list){var p=a.list.querySelector('[data-index="'.concat(a.state.currentSlide,'"]'));a.list.style.height=(0,fr.getHeight)(p)+"px"}}),an(sn(a),"componentDidMount",function(){if(a.props.onInit&&a.props.onInit(),a.props.lazyLoad){var p=(0,fr.getOnDemandLazySlides)(Ut(Ut({},a.props),a.state));p.length>0&&(a.setState(function(S){return{lazyLoadedList:S.lazyLoadedList.concat(p)}}),a.props.onLazyLoad&&a.props.onLazyLoad(p))}var c=Ut({listRef:a.list,trackRef:a.track},a.props);a.updateState(c,!0,function(){a.adaptHeight(),a.props.autoplay&&a.autoPlay("update")}),a.props.lazyLoad==="progressive"&&(a.lazyLoadTimer=setInterval(a.progressiveLazyLoad,1e3)),a.ro=new HV.default(function(){a.state.animating?(a.onWindowResized(!1),a.callbackTimers.push(setTimeout(function(){return a.onWindowResized()},a.props.speed))):a.onWindowResized()}),a.ro.observe(a.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(S){S.onfocus=a.props.pauseOnFocus?a.onSlideFocus:null,S.onblur=a.props.pauseOnFocus?a.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",a.onWindowResized):window.attachEvent("onresize",a.onWindowResized)}),an(sn(a),"componentWillUnmount",function(){a.animationEndCallback&&clearTimeout(a.animationEndCallback),a.lazyLoadTimer&&clearInterval(a.lazyLoadTimer),a.callbackTimers.length&&(a.callbackTimers.forEach(function(p){return clearTimeout(p)}),a.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",a.onWindowResized):window.detachEvent("onresize",a.onWindowResized),a.autoplayTimer&&clearInterval(a.autoplayTimer),a.ro.disconnect()}),an(sn(a),"componentDidUpdate",function(p){if(a.checkImagesLoad(),a.props.onReInit&&a.props.onReInit(),a.props.lazyLoad){var c=(0,fr.getOnDemandLazySlides)(Ut(Ut({},a.props),a.state));c.length>0&&(a.setState(function(D){return{lazyLoadedList:D.lazyLoadedList.concat(c)}}),a.props.onLazyLoad&&a.props.onLazyLoad(c))}a.adaptHeight();var S=Ut(Ut({listRef:a.list,trackRef:a.track},a.props),a.state),A=a.didPropsChange(p);A&&a.updateState(S,A,function(){a.state.currentSlide>=co.default.Children.count(a.props.children)&&a.changeSlide({message:"index",index:co.default.Children.count(a.props.children)-a.props.slidesToShow,currentSlide:a.state.currentSlide}),a.props.autoplay?a.autoPlay("update"):a.pause("paused")})}),an(sn(a),"onWindowResized",function(p){a.debouncedResize&&a.debouncedResize.cancel(),a.debouncedResize=(0,jV.default)(function(){return a.resizeWindow(p)},50),a.debouncedResize()}),an(sn(a),"resizeWindow",function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,c=!!(a.track&&a.track.node);if(c){var S=Ut(Ut({listRef:a.list,trackRef:a.track},a.props),a.state);a.updateState(S,p,function(){a.props.autoplay?a.autoPlay("update"):a.pause("paused")}),a.setState({animating:!1}),clearTimeout(a.animationEndCallback),delete a.animationEndCallback}}),an(sn(a),"updateState",function(p,c,S){var A=(0,fr.initializedState)(p);p=Ut(Ut(Ut({},p),A),{},{slideIndex:A.currentSlide});var D=(0,fr.getTrackLeft)(p);p=Ut(Ut({},p),{},{left:D});var L=(0,fr.getTrackCSS)(p);(c||co.default.Children.count(a.props.children)!==co.default.Children.count(p.children))&&(A.trackStyle=L),a.setState(A,S)}),an(sn(a),"ssrInit",function(){if(a.props.variableWidth){var p=0,c=0,S=[],A=(0,fr.getPreClones)(Ut(Ut(Ut({},a.props),a.state),{},{slideCount:a.props.children.length})),D=(0,fr.getPostClones)(Ut(Ut(Ut({},a.props),a.state),{},{slideCount:a.props.children.length}));a.props.children.forEach(function(J){S.push(J.props.style.width),p+=J.props.style.width});for(var L=0;L<A;L++)c+=S[S.length-1-L],p+=S[S.length-1-L];for(var z=0;z<D;z++)p+=S[z];for(var ee=0;ee<a.state.currentSlide;ee++)c+=S[ee];var pe={width:p+"px",left:-c+"px"};if(a.props.centerMode){var ue="".concat(S[a.state.currentSlide],"px");pe.left="calc(".concat(pe.left," + (100% - ").concat(ue,") / 2 ) ")}return{trackStyle:pe}}var me=co.default.Children.count(a.props.children),te=Ut(Ut(Ut({},a.props),a.state),{},{slideCount:me}),G=(0,fr.getPreClones)(te)+(0,fr.getPostClones)(te)+me,re=100/a.props.slidesToShow*G,be=100/G,Le=-be*((0,fr.getPreClones)(te)+a.state.currentSlide)*re/100;a.props.centerMode&&(Le+=(100-be*re/100)/2);var Me={width:re+"%",left:Le+"%"};return{slideWidth:be+"%",trackStyle:Me}}),an(sn(a),"checkImagesLoad",function(){var p=a.list&&a.list.querySelectorAll&&a.list.querySelectorAll(".slick-slide img")||[],c=p.length,S=0;Array.prototype.forEach.call(p,function(A){var D=function(){return++S&&S>=c&&a.onWindowResized()};if(!A.onclick)A.onclick=function(){return A.parentNode.focus()};else{var L=A.onclick;A.onclick=function(z){L(z),A.parentNode.focus()}}A.onload||(a.props.lazyLoad?A.onload=function(){a.adaptHeight(),a.callbackTimers.push(setTimeout(a.onWindowResized,a.props.speed))}:(A.onload=D,A.onerror=function(){D(),a.props.onLazyLoadError&&a.props.onLazyLoadError()}))})}),an(sn(a),"progressiveLazyLoad",function(){for(var p=[],c=Ut(Ut({},a.props),a.state),S=a.state.currentSlide;S<a.state.slideCount+(0,fr.getPostClones)(c);S++)if(a.state.lazyLoadedList.indexOf(S)<0){p.push(S);break}for(var A=a.state.currentSlide-1;A>=-(0,fr.getPreClones)(c);A--)if(a.state.lazyLoadedList.indexOf(A)<0){p.push(A);break}p.length>0?(a.setState(function(D){return{lazyLoadedList:D.lazyLoadedList.concat(p)}}),a.props.onLazyLoad&&a.props.onLazyLoad(p)):a.lazyLoadTimer&&(clearInterval(a.lazyLoadTimer),delete a.lazyLoadTimer)}),an(sn(a),"slideHandler",function(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=a.props,A=S.asNavFor,D=S.beforeChange,L=S.onLazyLoad,z=S.speed,ee=S.afterChange,pe=a.state.currentSlide,ue=(0,fr.slideHandler)(Ut(Ut(Ut({index:p},a.props),a.state),{},{trackRef:a.track,useCSS:a.props.useCSS&&!c})),me=ue.state,te=ue.nextState;if(me){D&&D(pe,me.currentSlide);var G=me.lazyLoadedList.filter(function(re){return a.state.lazyLoadedList.indexOf(re)<0});L&&G.length>0&&L(G),!a.props.waitForAnimate&&a.animationEndCallback&&(clearTimeout(a.animationEndCallback),ee&&ee(pe),delete a.animationEndCallback),a.setState(me,function(){A&&a.asNavForIndex!==p&&(a.asNavForIndex=p,A.innerSlider.slideHandler(p)),te&&(a.animationEndCallback=setTimeout(function(){var re=te.animating,be=WV(te,["animating"]);a.setState(be,function(){a.callbackTimers.push(setTimeout(function(){return a.setState({animating:re})},10)),ee&&ee(me.currentSlide),delete a.animationEndCallback})},z))})}}),an(sn(a),"changeSlide",function(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=Ut(Ut({},a.props),a.state),A=(0,fr.changeSlide)(S,p);if(!(A!==0&&!A)&&(c===!0?a.slideHandler(A,c):a.slideHandler(A),a.props.autoplay&&a.autoPlay("update"),a.props.focusOnSelect)){var D=a.list.querySelectorAll(".slick-current");D[0]&&D[0].focus()}}),an(sn(a),"clickHandler",function(p){a.clickable===!1&&(p.stopPropagation(),p.preventDefault()),a.clickable=!0}),an(sn(a),"keyHandler",function(p){var c=(0,fr.keyHandler)(p,a.props.accessibility,a.props.rtl);c!==""&&a.changeSlide({message:c})}),an(sn(a),"selectHandler",function(p){a.changeSlide(p)}),an(sn(a),"disableBodyScroll",function(){var p=function(S){S=S||window.event,S.preventDefault&&S.preventDefault(),S.returnValue=!1};window.ontouchmove=p}),an(sn(a),"enableBodyScroll",function(){window.ontouchmove=null}),an(sn(a),"swipeStart",function(p){a.props.verticalSwiping&&a.disableBodyScroll();var c=(0,fr.swipeStart)(p,a.props.swipe,a.props.draggable);c!==""&&a.setState(c)}),an(sn(a),"swipeMove",function(p){var c=(0,fr.swipeMove)(p,Ut(Ut(Ut({},a.props),a.state),{},{trackRef:a.track,listRef:a.list,slideIndex:a.state.currentSlide}));c&&(c.swiping&&(a.clickable=!1),a.setState(c))}),an(sn(a),"swipeEnd",function(p){var c=(0,fr.swipeEnd)(p,Ut(Ut(Ut({},a.props),a.state),{},{trackRef:a.track,listRef:a.list,slideIndex:a.state.currentSlide}));if(c){var S=c.triggerSlideHandler;delete c.triggerSlideHandler,a.setState(c),S!==void 0&&(a.slideHandler(S),a.props.verticalSwiping&&a.enableBodyScroll())}}),an(sn(a),"touchEnd",function(p){a.swipeEnd(p),a.clickable=!0}),an(sn(a),"slickPrev",function(){a.callbackTimers.push(setTimeout(function(){return a.changeSlide({message:"previous"})},0))}),an(sn(a),"slickNext",function(){a.callbackTimers.push(setTimeout(function(){return a.changeSlide({message:"next"})},0))}),an(sn(a),"slickGoTo",function(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(p=Number(p),isNaN(p))return"";a.callbackTimers.push(setTimeout(function(){return a.changeSlide({message:"index",index:p,currentSlide:a.state.currentSlide},c)},0))}),an(sn(a),"play",function(){var p;if(a.props.rtl)p=a.state.currentSlide-a.props.slidesToScroll;else if((0,fr.canGoNext)(Ut(Ut({},a.props),a.state)))p=a.state.currentSlide+a.props.slidesToScroll;else return!1;a.slideHandler(p)}),an(sn(a),"autoPlay",function(p){a.autoplayTimer&&clearInterval(a.autoplayTimer);var c=a.state.autoplaying;if(p==="update"){if(c==="hovered"||c==="focused"||c==="paused")return}else if(p==="leave"){if(c==="paused"||c==="focused")return}else if(p==="blur"&&(c==="paused"||c==="hovered"))return;a.autoplayTimer=setInterval(a.play,a.props.autoplaySpeed+50),a.setState({autoplaying:"playing"})}),an(sn(a),"pause",function(p){a.autoplayTimer&&(clearInterval(a.autoplayTimer),a.autoplayTimer=null);var c=a.state.autoplaying;p==="paused"?a.setState({autoplaying:"paused"}):p==="focused"?(c==="hovered"||c==="playing")&&a.setState({autoplaying:"focused"}):c==="playing"&&a.setState({autoplaying:"hovered"})}),an(sn(a),"onDotsOver",function(){return a.props.autoplay&&a.pause("hovered")}),an(sn(a),"onDotsLeave",function(){return a.props.autoplay&&a.state.autoplaying==="hovered"&&a.autoPlay("leave")}),an(sn(a),"onTrackOver",function(){return a.props.autoplay&&a.pause("hovered")}),an(sn(a),"onTrackLeave",function(){return a.props.autoplay&&a.state.autoplaying==="hovered"&&a.autoPlay("leave")}),an(sn(a),"onSlideFocus",function(){return a.props.autoplay&&a.pause("focused")}),an(sn(a),"onSlideBlur",function(){return a.props.autoplay&&a.state.autoplaying==="focused"&&a.autoPlay("blur")}),an(sn(a),"render",function(){var p=(0,UV.default)("slick-slider",a.props.className,{"slick-vertical":a.props.vertical,"slick-initialized":!0}),c=Ut(Ut({},a.props),a.state),S=(0,fr.extractObject)(c,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),A=a.props.pauseOnHover;S=Ut(Ut({},S),{},{onMouseEnter:A?a.onTrackOver:null,onMouseLeave:A?a.onTrackLeave:null,onMouseOver:A?a.onTrackOver:null,focusOnSelect:a.props.focusOnSelect&&a.clickable?a.selectHandler:null});var D;if(a.props.dots===!0&&a.state.slideCount>=a.props.slidesToShow){var L=(0,fr.extractObject)(c,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),z=a.props.pauseOnDotsHover;L=Ut(Ut({},L),{},{clickHandler:a.changeSlide,onMouseEnter:z?a.onDotsLeave:null,onMouseOver:z?a.onDotsOver:null,onMouseLeave:z?a.onDotsLeave:null}),D=co.default.createElement(qV.Dots,L)}var ee,pe,ue=(0,fr.extractObject)(c,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);ue.clickHandler=a.changeSlide,a.props.arrows&&(ee=co.default.createElement(RE.PrevArrow,ue),pe=co.default.createElement(RE.NextArrow,ue));var me=null;a.props.vertical&&(me={height:a.state.listHeight});var te=null;a.props.vertical===!1?a.props.centerMode===!0&&(te={padding:"0px "+a.props.centerPadding}):a.props.centerMode===!0&&(te={padding:a.props.centerPadding+" 0px"});var G=Ut(Ut({},me),te),re=a.props.touchMove,be={className:"slick-list",style:G,onClick:a.clickHandler,onMouseDown:re?a.swipeStart:null,onMouseMove:a.state.dragging&&re?a.swipeMove:null,onMouseUp:re?a.swipeEnd:null,onMouseLeave:a.state.dragging&&re?a.swipeEnd:null,onTouchStart:re?a.swipeStart:null,onTouchMove:a.state.dragging&&re?a.swipeMove:null,onTouchEnd:re?a.touchEnd:null,onTouchCancel:a.state.dragging&&re?a.swipeEnd:null,onKeyDown:a.props.accessibility?a.keyHandler:null},Le={className:p,dir:"ltr",style:a.props.style};return a.props.unslick&&(be={className:"slick-list"},Le={className:p}),co.default.createElement("div",Le,a.props.unslick?"":ee,co.default.createElement("div",Dy({ref:a.listRefHandler},be),co.default.createElement($V.Track,Dy({ref:a.trackRefHandler},S),a.props.children)),a.props.unslick?"":pe,a.props.unslick?"":D)}),a.list=null,a.track=null,a.state=Ut(Ut({},VV.default),{},{currentSlide:a.props.initialSlide,targetSlide:a.props.initialSlide?a.props.initialSlide:0,slideCount:co.default.Children.count(a.props.children)}),a.callbackTimers=[],a.clickable=!0,a.debouncedResize=null;var d=a.ssrInit();return a.state=Ut(Ut({},a.state),d),a}return XV(n,[{key:"didPropsChange",value:function(a){for(var d=!1,p=0,c=Object.keys(this.props);p<c.length;p++){var S=c[p];if(!a.hasOwnProperty(S)){d=!0;break}if(!(vc(a[S])==="object"||typeof a[S]=="function"||isNaN(a[S]))&&a[S]!==this.props[S]){d=!0;break}}return d||co.default.Children.count(this.props.children)!==co.default.Children.count(a.children)}}]),n}(co.default.Component);var t7=function(t){return t.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}).toLowerCase()},n7=t7,r7=n7,i7=function(t){var e=/[height|width]$/;return e.test(t)},LE=function(t){var e="",n=Object.keys(t);return n.forEach(function(o,a){var d=t[o];o=r7(o),i7(o)&&typeof d=="number"&&(d=d+"px"),d===!0?e+=o:d===!1?e+="not "+o:e+="("+o+": "+d+")",a<n.length-1&&(e+=" and ")}),e},o7=function(t){var e="";return typeof t=="string"?t:t instanceof Array?(t.forEach(function(n,o){e+=LE(n),o<t.length-1&&(e+=", ")}),e):LE(t)},s7=o7,pv,DE;function a7(){if(DE)return pv;DE=1;function t(e){this.options=e,!e.deferSetup&&this.setup()}return t.prototype={constructor:t,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(e){return this.options===e||this.options.match===e}},pv=t,pv}var fv,zE;function z5(){if(zE)return fv;zE=1;function t(o,a){var d=0,p=o.length,c;for(d;d<p&&(c=a(o[d],d),c!==!1);d++);}function e(o){return Object.prototype.toString.apply(o)==="[object Array]"}function n(o){return typeof o=="function"}return fv={isFunction:n,isArray:e,each:t},fv}var mv,OE;function l7(){if(OE)return mv;OE=1;var t=a7(),e=z5().each;function n(o,a){this.query=o,this.isUnconditional=a,this.handlers=[],this.mql=window.matchMedia(o);var d=this;this.listener=function(p){d.mql=p.currentTarget||p,d.assess()},this.mql.addListener(this.listener)}return n.prototype={constuctor:n,addHandler:function(o){var a=new t(o);this.handlers.push(a),this.matches()&&a.on()},removeHandler:function(o){var a=this.handlers;e(a,function(d,p){if(d.equals(o))return d.destroy(),!a.splice(p,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){e(this.handlers,function(o){o.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var o=this.matches()?"on":"off";e(this.handlers,function(a){a[o]()})}},mv=n,mv}var gv,FE;function u7(){if(FE)return gv;FE=1;var t=l7(),e=z5(),n=e.each,o=e.isFunction,a=e.isArray;function d(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return d.prototype={constructor:d,register:function(p,c,S){var A=this.queries,D=S&&this.browserIsIncapable;return A[p]||(A[p]=new t(p,D)),o(c)&&(c={match:c}),a(c)||(c=[c]),n(c,function(L){o(L)&&(L={match:L}),A[p].addHandler(L)}),this},unregister:function(p,c){var S=this.queries[p];return S&&(c?S.removeHandler(c):(S.clear(),delete this.queries[p])),this}},gv=d,gv}var yv,NE;function c7(){if(NE)return yv;NE=1;var t=u7();return yv=new t,yv}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=p(Ve),n=v_,o=p(s7),a=p(Bw),d=pt;function p(Y){return Y&&Y.__esModule?Y:{default:Y}}function c(Y){"@babel/helpers - typeof";return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie},c(Y)}function S(){return S=Object.assign?Object.assign.bind():function(Y){for(var ie=1;ie<arguments.length;ie++){var de=arguments[ie];for(var we in de)Object.prototype.hasOwnProperty.call(de,we)&&(Y[we]=de[we])}return Y},S.apply(this,arguments)}function A(Y,ie){var de=Object.keys(Y);if(Object.getOwnPropertySymbols){var we=Object.getOwnPropertySymbols(Y);ie&&(we=we.filter(function(se){return Object.getOwnPropertyDescriptor(Y,se).enumerable})),de.push.apply(de,we)}return de}function D(Y){for(var ie=1;ie<arguments.length;ie++){var de=arguments[ie]!=null?arguments[ie]:{};ie%2?A(Object(de),!0).forEach(function(we){Le(Y,we,de[we])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(de)):A(Object(de)).forEach(function(we){Object.defineProperty(Y,we,Object.getOwnPropertyDescriptor(de,we))})}return Y}function L(Y,ie){if(!(Y instanceof ie))throw new TypeError("Cannot call a class as a function")}function z(Y,ie){for(var de=0;de<ie.length;de++){var we=ie[de];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(Y,Me(we.key),we)}}function ee(Y,ie,de){return ie&&z(Y.prototype,ie),Object.defineProperty(Y,"prototype",{writable:!1}),Y}function pe(Y,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(ie&&ie.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),Object.defineProperty(Y,"prototype",{writable:!1}),ie&&ue(Y,ie)}function ue(Y,ie){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(we,se){return we.__proto__=se,we},ue(Y,ie)}function me(Y){var ie=re();return function(){var we=be(Y),se;if(ie){var ut=be(this).constructor;se=Reflect.construct(we,arguments,ut)}else se=we.apply(this,arguments);return te(this,se)}}function te(Y,ie){if(ie&&(c(ie)==="object"||typeof ie=="function"))return ie;if(ie!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G(Y)}function G(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function re(){try{var Y=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(re=function(){return!!Y})()}function be(Y){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(de){return de.__proto__||Object.getPrototypeOf(de)},be(Y)}function Le(Y,ie,de){return ie=Me(ie),ie in Y?Object.defineProperty(Y,ie,{value:de,enumerable:!0,configurable:!0,writable:!0}):Y[ie]=de,Y}function Me(Y){var ie=J(Y,"string");return c(ie)=="symbol"?ie:String(ie)}function J(Y,ie){if(c(Y)!="object"||!Y)return Y;var de=Y[Symbol.toPrimitive];if(de!==void 0){var we=de.call(Y,ie||"default");if(c(we)!="object")return we;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ie==="string"?String:Number)(Y)}var X=(0,d.canUseDOM)()&&c7();t.default=function(Y){pe(de,Y);var ie=me(de);function de(we){var se;return L(this,de),se=ie.call(this,we),Le(G(se),"innerSliderRefHandler",function(ut){return se.innerSlider=ut}),Le(G(se),"slickPrev",function(){return se.innerSlider.slickPrev()}),Le(G(se),"slickNext",function(){return se.innerSlider.slickNext()}),Le(G(se),"slickGoTo",function(ut){var un=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return se.innerSlider.slickGoTo(ut,un)}),Le(G(se),"slickPause",function(){return se.innerSlider.pause("paused")}),Le(G(se),"slickPlay",function(){return se.innerSlider.autoPlay("play")}),se.state={breakpoint:null},se._responsiveMediaHandlers=[],se}return ee(de,[{key:"media",value:function(se,ut){X.register(se,ut),this._responsiveMediaHandlers.push({query:se,handler:ut})}},{key:"componentDidMount",value:function(){var se=this;if(this.props.responsive){var ut=this.props.responsive.map(function(cn){return cn.breakpoint});ut.sort(function(cn,tn){return cn-tn}),ut.forEach(function(cn,tn){var et;tn===0?et=(0,o.default)({minWidth:0,maxWidth:cn}):et=(0,o.default)({minWidth:ut[tn-1]+1,maxWidth:cn}),(0,d.canUseDOM)()&&se.media(et,function(){se.setState({breakpoint:cn})})});var un=(0,o.default)({minWidth:ut.slice(-1)[0]});(0,d.canUseDOM)()&&this.media(un,function(){se.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(se){X.unregister(se.query,se.handler)})}},{key:"render",value:function(){var se=this,ut,un;this.state.breakpoint?(un=this.props.responsive.filter(function(fn){return fn.breakpoint===se.state.breakpoint}),ut=un[0].settings==="unslick"?"unslick":D(D(D({},a.default),this.props),un[0].settings)):ut=D(D({},a.default),this.props),ut.centerMode&&(ut.slidesToScroll>1,ut.slidesToScroll=1),ut.fade&&(ut.slidesToShow>1,ut.slidesToScroll>1,ut.slidesToShow=1,ut.slidesToScroll=1);var cn=e.default.Children.toArray(this.props.children);cn=cn.filter(function(fn){return typeof fn=="string"?!!fn.trim():!!fn}),ut.variableWidth&&(ut.rows>1||ut.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),ut.variableWidth=!1);for(var tn=[],et=null,ht=0;ht<cn.length;ht+=ut.rows*ut.slidesPerRow){for(var Tt=[],kt=ht;kt<ht+ut.rows*ut.slidesPerRow;kt+=ut.slidesPerRow){for(var At=[],jt=kt;jt<kt+ut.slidesPerRow&&(ut.variableWidth&&cn[jt].props.style&&(et=cn[jt].props.style.width),!(jt>=cn.length));jt+=1)At.push(e.default.cloneElement(cn[jt],{key:100*ht+10*kt+jt,tabIndex:-1,style:{width:"".concat(100/ut.slidesPerRow,"%"),display:"inline-block"}}));Tt.push(e.default.createElement("div",{key:10*ht+kt},At))}ut.variableWidth?tn.push(e.default.createElement("div",{key:ht,style:{width:et}},Tt)):tn.push(e.default.createElement("div",{key:ht},Tt))}if(ut==="unslick"){var Hn="regular slider "+(this.props.className||"");return e.default.createElement("div",{className:Hn},cn)}else tn.length<=ut.slidesToShow&&!ut.infinite&&(ut.unslick=!0);return e.default.createElement(n.InnerSlider,S({style:this.props.style,ref:this.innerSliderRefHandler},(0,d.filterSettings)(ut)),tn)}}]),de}(e.default.Component)})(n5);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=n(n5);function n(o){return o&&o.__esModule?o:{default:o}}t.default=e.default})(t5);const h7=gd(t5);function O5({images:t}){const e={infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:4e3,dots:!0};return He.jsx("div",{className:"mt-6 carousel-container",children:He.jsxs(h7,{...e,children:[He.jsx("div",{children:He.jsx("img",{src:t.image1,className:"rounded-2xl object-cover mx-auto",alt:"Slide 1"})}),He.jsx("div",{children:He.jsx("img",{src:t.image2,className:"rounded-2xl object-cover mx-auto",alt:"Slide 2"})}),He.jsx("div",{children:He.jsx("img",{src:t.image3,className:"rounded-2xl object-cover mx-auto",alt:"Slide 3"})})]})})}O5.propTypes={images:Np.shape({image1:Np.string.isRequired,image2:Np.string.isRequired,image3:Np.string.isRequired}).isRequired};const d7="/mualaApp/assets/mualalogo-CEI02jA0.png",p7=[{id:"czubereki",category:"ukrainska",title:"Czebureki, chaczapuri, bilaszy",subtitle:"Kuchania ukraiska",address:"Park praski 01, 03-402 Warszawa",phone:"797-863-182",website:"",googleMaps:"https://www.google.com/maps/place/Czebureki/@52.8210271,17.7380807,7z/data=!4m10!1m2!2m1!1sczeburek+bilaszy!3m6!1s0x471ecd6d101d96d1:0x7188e7de441fb816!8m2!3d52.2527061!4d21.0294178!15sChBjemVidXJlayBiaWxhc3p5WhIiEGN6ZWJ1cmVrIGJpbGFzenmSARRmYXN0X2Zvb2RfcmVzdGF1cmFudJoBI0NoWkRTVWhOTUc5blMwVkpRMEZuU1VSRWEwOTZVMGwzRUFF4AEA!16s%2Fg%2F11fm_snlkg?entry=ttu",youtube:"https://www.youtube.com/watch?v=E3odGfugOKc",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/czubereki.png?alt=media&token=91d3bd46-4228-4889-888c-69655d8d77fc",latitude:52.252628,longitude:21.029509},{id:"barKantyna",category:"polska",title:"Bar KANTYNA",subtitle:"Kuchania polska/wojskowa",address:"Igoomska 31, 31-983 Krakw",phone:"",website:"https://www.facebook.com/barkantyna",googleMaps:"https://www.google.com/maps/place/Bar+KANTYNA/@50.0760822,20.1467722,18.75z/data=!4m6!3m5!1s0x4716461b75180f73:0x594ecc1c195614a9!8m2!3d50.0763717!4d20.1471332!16s%2Fg%2F11f5hly38x?entry=ttu",youtube:"https://www.youtube.com/watch?v=ysajqVdMpYE",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/barKantyna.png?alt=media&token=7430ea04-9568-476f-b770-4cf3694d7f99",latitude:50.076236,longitude:20.14715},{id:"domsTrawy",category:"amerykanska",title:"DOM sTRAWY",subtitle:"Kuchania amerykaska",address:"Tarnowska 40, 25-394 Kielce",phone:"607-540-620",website:"http://domstrawy.pl/",googleMaps:"https://www.google.com/maps/place/DOM+sTRAWY/@50.8588814,20.6381072,17z/data=!3m1!4b1!4m6!3m5!1s0x4718271ac65d076d:0x1035db3a30240b1f!8m2!3d50.8588814!4d20.6381072!16s%2Fg%2F11rwqqgs6z?entry=ttu",youtube:"https://www.youtube.com/watch?v=M1w4N17lnh4",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/domStrawy.png?alt=media&token=61d61a6a-9dd9-4e11-bb1c-87040b9a5f1a",latitude:50.858846,longitude:20.638403},{id:"zapiekankiAdamus",category:"polska",title:"Zapiekanki Adamus",subtitle:"Kuchania polska",address:"Wadysawa Sikorskiego 11, 32-050 Skawina",phone:"12-276-20-75",website:"https://www.zapiekankiadamus.pl/",googleMaps:"https://www.google.com/maps/place/Zapiekanki+Adamus/@49.9766782,19.8197595,17z/data=!3m1!4b1!4m6!3m5!1s0x47165df3a2ab5b6f:0x1b5b3f1df6b4cc6e!8m2!3d49.9766782!4d19.8223344!16s%2Fg%2F1hf0704g4?entry=ttu",youtube:"https://www.youtube.com/watch?v=gcvveo0zZBc",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/zapiekankiAdamus.png?alt=media&token=9035c718-e970-4e2a-a40f-72373de37186",latitude:49.976788,longitude:19.82226},{id:"zapiekankiBilgoraj",category:"polska",title:"Zapiekanki w Bilgoraju",subtitle:"Kuchania polska",address:"Tadeusza Kociuszki 79, 23-400 Bigoraj",phone:"",website:"",googleMaps:"https://www.google.com/maps/place/Zapiekanki/@50.5317838,22.7191173,17.75z/data=!4m15!1m8!3m7!1s0x4723355490a92515:0xe0d361f3a39adbac!2sZapiekanki!8m2!3d50.5321864!4d22.7198235!10e1!16s%2Fg%2F11v4lxmsxy!3m5!1s0x4723355490a92515:0xe0d361f3a39adbac!8m2!3d50.5321864!4d22.7198235!16s%2Fg%2F11v4lxmsxy?entry=ttu",youtube:"https://www.youtube.com/watch?v=CUP0IlOyhAQ",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/zapiekankiBilgoraj.png?alt=media&token=ce05b630-2a2f-4350-9934-9ff82c0963c2",latitude:50.532214,longitude:22.719633},{id:"slaskaProhibicja",category:"polska",title:"lska Prohibicja",subtitle:"Kuchania polska",address:"Krawczyka 1, 40-423 Katowice",phone:"32-723-28-99",website:"https://slaskaprohibicja.pl/",googleMaps:"https://www.google.com/maps/place/%C5%9Al%C4%85ska+Prohibicja/@50.2436485,19.079971,17z/data=!3m1!4b1!4m6!3m5!1s0x4716cf8c1b89cb0f:0xa7a6844a6499e6bf!8m2!3d50.2436485!4d19.079971!16s%2Fg%2F11d_8ck8mn?entry=ttu",youtube:"https://www.youtube.com/watch?v=ArkjDgSBF8M",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/slaskaProhibicja.png?alt=media&token=1add60bc-4a14-4be6-9b8d-83be480915f9",latitude:50.243522,longitude:19.079916},{id:"barKukuryku",category:"polska",title:"Bar Mleczny KukuRyku",subtitle:"Kuchania polska",address:"Wilimowskiego 6, 40-061 Katowice",phone:"881-799-105",website:"http://www.barmlecznykukuryku.pl/",googleMaps:"https://www.google.com/maps/place/Bar+Mleczny+KukuRyku/@50.2553652,19.0101222,17z/data=!3m1!4b1!4m6!3m5!1s0x4716cf1f0fae3ca7:0xe7cdff632c633a6f!8m2!3d50.2553652!4d19.0101222!16s%2Fg%2F11fk8c4j3x?entry=ttu",youtube:"https://www.youtube.com/watch?v=D-1zlC5aXT0",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/barKukuryku.png?alt=media&token=190fc75e-b811-4733-ab4f-3674f2fc7bf3",latitude:50.255285,longitude:19.010111},{id:"szamkaKebab",category:"turecka",title:"Szamka | Kebab",subtitle:"Kuchnia turecka",address:"Mickiewicza 1, 62-300 Wrzenia",phone:"609-930-842",website:"https://www.szamkawrzesnia.pl/",googleMaps:"https://www.google.com/maps/place/Szamka+%7C+Kebab/@52.3245656,17.5639971,17z/data=!4m6!3m5!1s0x4704e9981ff8febb:0x39328f92e8f2a65e!8m2!3d52.3245263!4d17.5648876!16s%2Fg%2F11j1g2l0b2?entry=ttu",youtube:"https://www.youtube.com/watch?v=fvCh5i8dA-Q",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/szamkaKebab.png?alt=media&token=9dbd7ca4-1625-4ae2-9b33-9a3b8cdce6f4",latitude:52.324511,longitude:17.564768},{id:"zapiekankiPaniAni",category:"polska",title:"Zapiekanki Pani Ani",subtitle:"Kuchania polska",address:"Mieszka I 27a, 62-200 Gniezno",phone:"",website:"",googleMaps:"https://www.google.com/maps/place/Zapiekanki/@52.5324777,17.598315,17z/data=!3m1!4b1!4m6!3m5!1s0x4704910dee71df9d:0x4912d76677fc377!8m2!3d52.5324777!4d17.598315!16s%2Fg%2F11dxm8ksqk?entry=ttu",youtube:"https://www.youtube.com/watch?v=8elt86N50Kw",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/zapiekankiPaniAni.png?alt=media&token=edea33b0-ccf8-40ea-be4a-113d41f6d1e8",latitude:52.53245,longitude:17.598152},{id:"chefNaKolach",category:"burger",title:"Chef na koach",subtitle:"Kuchania amerykaska",address:"Podzamcze, 87-200 Wbrzeno",phone:"724-398-964",website:"",googleMaps:"https://www.google.com/maps/place/Chef+na+ko%C5%82ach/@53.2851267,18.9387407,17z/data=!3m1!4b1!4m6!3m5!1s0x471d2bd61f23c477:0x95d06d720c16dae1!8m2!3d53.2851267!4d18.9387407!16s%2Fg%2F11q2xkl4py?entry=ttu",youtube:"https://www.youtube.com/watch?v=YN0dvxH4bAg&t=761s",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/chefNaKolach.png?alt=media&token=07e5ece0-c281-4877-9596-f18574c73e49",latitude:53.285105,longitude:18.938681},{id:"burgerMeister",category:"amerykanska",title:"Burgermeister",subtitle:"Kuchania amerykaska",address:"Dircksenstrae 113, 10178 Berlin, Niemcy",phone:"+49 30-678-268-20",website:"http://www.burgermeister.com/",googleMaps:"https://www.google.com/maps/place/Burgermeister+Alexanderplatz/@52.5203627,13.4131421,17z/data=!3m1!4b1!4m6!3m5!1s0x47a84f3c22892d55:0xd95d5cd7eb147184!8m2!3d52.5203627!4d13.4131421!16s%2Fg%2F11t3x_j0vk?entry=ttu",youtube:"https://www.youtube.com/watch?v=DeZ5Ai4H2xA",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/burgerMeister.png?alt=media&token=7ea22ce4-d4ba-46ad-8d90-66acb44408d6",latitude:52.520352,longitude:13.413112},{id:"barMlecznyJaros",category:"polska",title:"Bar Mleczny Jaros",subtitle:"Kuchania polska",address:"Jagielloska 38, 80-367 Gdask",phone:"",website:"https://m.facebook.com/permalink.php?story_fbid=133387804971372&id=110130200630466",googleMaps:"https://www.google.com/maps/place/Bar+mleczny+Jaros/@54.4131327,18.5984808,17z/data=!3m1!4b1!4m6!3m5!1s0x46fd0b293cd3c0db:0x4d91fe00f2dc3cfc!8m2!3d54.4131327!4d18.5984808!16s%2Fg%2F11c0r5rcnq?entry=ttu",youtube:"https://www.youtube.com/watch?v=lQJUlmTGpQE",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/barMlecznyJaros.png?alt=media&token=f00383f9-b3f7-40be-9324-eb9bf0d71f28",latitude:54.413238,longitude:18.598047},{id:"hellskiBurger",category:"amerykanska",title:"HELLski Burger",subtitle:"Kuchania amerykaska",address:"Wiejska 109, 84-150 Hel",phone:"539-231-243",website:"https://www.facebook.com/HELLskiBurger/",googleMaps:"https://www.google.com/maps/place/HELLski+Burger/@54.6029726,18.8042298,17z/data=!3m1!4b1!4m6!3m5!1s0x46fd05e282a05703:0x5b1b29565322b0d!8m2!3d54.6029726!4d18.8042298!16s%2Fg%2F11hfy0nt2l?entry=ttu",youtube:"https://www.youtube.com/watch?v=4Gwwdk_QF3M",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/hellskiBurger.png?alt=media&token=353ee5c1-1b3e-4e96-bcf2-95d605286995",latitude:54.602977,longitude:18.804015},{id:"fazirKebab",category:"turecka",title:"Fazir kebab falafel",subtitle:"Kuchania turecka",address:"Jzefa Pisudskiego 40, 05-410 Jzefw",phone:"782-544-139",website:"https://www.facebook.com/FazirKebab/",googleMaps:"https://www.google.com/maps/place/Fazir+kebab+falafel/@52.1476184,21.2245048,17z/data=!3m1!4b1!4m6!3m5!1s0x47192b7cf7cac355:0x600e20c0e580d8bc!8m2!3d52.1476184!4d21.2245048!16s%2Fg%2F11ghzsw9tg?entry=ttu",youtube:"https://www.youtube.com/watch?v=KHDBR8QSu2E&t=383s",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/fazirKebab.png?alt=media&token=cec49526-328c-433a-b945-a0d4740c5a88",latitude:52.147704,longitude:21.224647},{id:"kurczakZRozna",category:"polska",title:"Kurczak z rona na Dolnej",subtitle:"Kuchania polska",address:"Dolna 2A, 00-774 Warszawa",phone:"882-947-555",website:"https://akur.at/",googleMaps:"https://www.google.com/maps/place/Kurczak+z+ro%C5%BCna+na+Dolnej/@52.2018841,21.0347823,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecd251089ef71:0x2661c17194883d6e!8m2!3d52.2018841!4d21.0347823!16s%2Fg%2F11c5g83bp8?entry=ttu",youtube:"https://www.youtube.com/watch?v=lffmCKTrDo0",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/kurczakZRo%C5%BCna.png?alt=media&token=c198cbef-5799-4bdf-99c6-c2786d9c910c",latitude:52.201777,longitude:21.034856},{id:"senorLucas",category:"meksykanska",title:"Seor Lucas Taquera",subtitle:"Kuchania meksykaska",address:"Poznaska 26, 00-684 Warszawa",phone:"690-590-610",website:"https://www.facebook.com/senorlucasmexican/",googleMaps:"https://www.google.com/maps/place/Se%C3%B1or+Lucas+Taquer%C3%ADa/@52.2267735,21.0111552,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecd4dd98ae9d9:0x27685bb2d55387c6!8m2!3d52.2267735!4d21.0111552!16s%2Fg%2F11kmwvdsj5?entry=ttu",youtube:"https://www.youtube.com/watch?v=0zVJKtICbB4",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/senorLucas.png?alt=media&token=80f8cbaa-36c5-4fa9-a6c3-d8e7d4b5d90b",latitude:52.201777,longitude:21.034856},{id:"pyzyFlakiGorace",category:"polska",title:"Pyzy, Flaki Gorce!",subtitle:"Kuchania polska",address:"Brzeska 29/31, 03-739 Warszawa",phone:"606-294-499",website:"https://www.pyzyflakigorace.pl/",googleMaps:"https://www.google.com/maps/place/Pyzy,+Flaki+Gor%C4%85ce!/@52.2528996,21.0412598,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecc47eab857bf:0x314660c3d0799146!8m2!3d52.2528996!4d21.0412598!16s%2Fg%2F11cn9lbqsj?entry=ttu",youtube:"https://www.youtube.com/watch?v=oy44sJxYIKs",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/pyzyFlakiGor%C4%85ce.png?alt=media&token=089f978c-9de2-4ba0-9762-4a12f566418a",latitude:52.252964,longitude:21.041384},{id:"sirinBodrum",category:"turecka",title:"Sirin Bodrum Dner Kebab",subtitle:"Kuchania turecka",address:"al. Jana Pawa II 18, 00-116 Warszawa",phone:"780-641-041",website:"https://www.instagram.com/sirindonerkebab/",googleMaps:"https://www.google.com/maps/place/Sirin+Bodrum+D%C3%B6ner+Kebab/@52.2339175,20.9985659,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecd3f1dc04e13:0x61df34b43a6bed1a!8m2!3d52.2339175!4d20.9985659!16s%2Fg%2F11y1brkhkk?entry=ttu",youtube:"https://www.youtube.com/watch?v=m3MOkp6LSvc",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/sirinBodrum.png?alt=media&token=bbbc6dfa-b0e4-4a51-8670-f7ab04807e73",latitude:52.233901,longitude:20.998434},{id:"eleganceRestauracja",category:"turecka",title:"Sirin Bodrum Dner Kebab",subtitle:"Kuchania turecka",address:"Karolkowa 28a/lok. U3, 01-207 Warszawa",phone:"577-276-911",website:"https://linktr.ee/elegancerestauracja",googleMaps:"https://www.google.com/maps/place/Elegance+Restauracja/@52.2311692,20.9780393,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecde5931c6ba7:0x225edb27f1c7201d!8m2!3d52.2311692!4d20.9780393!16s%2Fg%2F11s5fshm02?entry=ttu",youtube:"https://www.youtube.com/watch?v=HCI7GcbYCrc",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/eleganceRestauracja.png?alt=media&token=40049dfb-7d2a-4a73-825f-2524851aec81",latitude:52.231125,longitude:20.977851},{id:"rurki",category:"polska",title:"Rurki z prawdziw bit mietan",subtitle:"Kuchania polska",address:"Wolska 50a/paw.7 B, 01-187 Warszawa",phone:"603-348-316",website:"https://www.facebook.com/people/Wolskie-Rurki-z-Prawdziw%C4%85-Bit%C4%85-%C5%9Amietan%C4%85/100049241751807/",googleMaps:"https://www.google.com/maps/place/Rurki+z+prawdziw%C4%85+bit%C4%85+%C5%9Bmietan%C4%85/@52.2340758,20.9682963,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecbd505f3a8e3:0xe8574efa1d76e759!8m2!3d52.2340758!4d20.9682963!16s%2Fg%2F11hf84xhp5?entry=ttu",youtube:"https://www.youtube.com/watch?v=Z7chnfu8cJY",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/rurki.png?alt=media&token=921a8d70-69d6-4206-a01a-f7a722724f49",latitude:52.234013,longitude:20.968336},{id:"tantuni",category:"turecka",title:"Tantuni Kebab",subtitle:"Kuchania turkish",address:"Wolska 44a, 01-187 Warszawa",phone:"603-348-316",website:"https://www.facebook.com/people/Wolskie-Rurki-z-Prawdziw%C4%85-Bit%C4%85-%C5%9Amietan%C4%85/100049241751807/",googleMaps:"https://www.google.com/maps/place/TANTUN%C4%B0+KEBAB/@52.2342638,20.969816,19.25z/data=!4m6!3m5!1s0x471ecb7624ac367d:0xbec29bdb08007fa!8m2!3d52.2344118!4d20.9698039!16s%2Fg%2F11kr76lqqc?entry=ttu",youtube:"https://www.youtube.com/watch?v=HCI7GcbYCrc",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/tantuni.png?alt=media&token=462c1171-15ee-4656-9000-7388ba1ab7fc",latitude:52.234296,longitude:20.969827},{id:"barWaga",category:"polska",title:"Bar Waga",subtitle:"Kuchania polska",address:"Obozowa 82A/lok 15, 01-434 Warszawa",phone:"662-934-705",website:"https://www.facebook.com/profile.php?id=100093054352680",googleMaps:"https://www.google.com/maps/place/Bar+Waga/@52.2473272,20.9469746,17z/data=!3m1!4b1!4m6!3m5!1s0x471ecc817966ef13:0x73fbc9147e5ec5f!8m2!3d52.2473272!4d20.9469746!16s%2Fg%2F11g86lrkr_?entry=ttu",youtube:"https://www.youtube.com/watch?v=0ksqvzDROUE",images:{image1:"https://picsum.photos/750/320",image2:"https://picsum.photos/750/320",image3:"https://picsum.photos/750/320"},mainImage:"https://firebasestorage.googleapis.com/v0/b/mualaapp-32feb.appspot.com/o/barWaga.png?alt=media&token=3887fac1-589d-4831-be98-acb0e504d87f",latitude:52.247096,longitude:20.947053}];function F5(t){return Lo({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 288 480 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-370.7 0 73.4-73.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-128 128z"},child:[]}]})(t)}function f7(){var a;const{id:t}=zL(),e=p7.find(d=>d.id===t),o=((a=Ea().state)==null?void 0:a.link)||"/";return He.jsxs("div",{className:"markerdetail h-[90vh] 2xl:w-[1440px] mx-auto bg-appColor dark:bg-lightGray dark:text-appColor overflow-y-auto overflow-x-hidden",children:[He.jsx("div",{className:"fixed z-10 flex rounded-full top-2 left-4 bg-navColor text-white shadow-lg duration-200 hover:text-main hover:shadow-main hover:scale-110",children:He.jsx("button",{type:"button",className:"p-3",children:He.jsx(cy,{to:`../${o}`,children:He.jsx(F5,{size:30})})})}),He.jsx("img",{src:d7,className:"absolute top-10 left-1/2 transform -translate-x-1/2 -translate-y-1/2 size-16",alt:"logo"}),He.jsx("img",{src:e.mainImage,alt:"Delicious Noodle Bar",className:"w-full h-2/5 object-cover bg-center"}),He.jsx("div",{className:"absolute bottom-4 left-0 right-0 bg-appColor dark:bg-lightGray dark:text-appColor rounded-t-[2rem] 2xl:rounded-none px-8 pt-4 text-fontColor text-xl h-3/5",children:He.jsxs("div",{className:"mx-auto lg:w-3/5 2xl:w-2/5",children:[He.jsx("h1",{className:"text-5xl text-center tracking-wider font-bold bg-gradient-to-tr from-yellow-500 via-yellow-400 to-amber-500 bg-clip-text text-transparent pb-2",children:e.title}),He.jsx("p",{className:"text-main text-center dark:font-normal font-extralight italic -mt-2",children:e.subtitle}),He.jsxs("p",{className:"flex items-center justify-center dark:font-normal font-extralight mt-3",children:[He.jsx(p9,{className:"mr-2"}),e.address]}),e.phone&&He.jsxs("a",{href:`tel:${e.phone}`,className:"flex items-center justify-center dark:font-normal font-extralight mt-3",children:[He.jsx(d9,{className:"mr-2"}),e.phone]}),He.jsxs("div",{className:`mx-auto grid gap-5 dark:text-white ${e.website===""||e.youtube===""||e.googleMaps===""?"grid-cols-2":"grid-cols-3"} h-40 text-2xl`,children:[e.website&&He.jsxs("a",{href:e.website,className:"group col-span-1 row-span-1 flex items-center justify-center mt-4 px-5 bg-gradient-to-tr from-orange-400 via-amber-400 to-orange-400 rounded-2xl shadow-lg transition-colors hover:bg-whiteHover",children:[He.jsx(a9,{className:"mr-1 duration-300 group-hover:text-blue-600"}),"WWW"]}),He.jsxs("a",{href:e.youtube,className:"group col-span-1 row-span-1 flex items-center justify-center mt-4 px-5 bg-gradient-to-tr from-orange-400 via-amber-400 to-orange-400 rounded-2xl shadow-lg transition-colors hover:bg-whiteHover",target:"_blank",children:[He.jsx(e5,{className:"mr-1 duration-300 group-hover:text-red-600"}),"Youtube"]}),He.jsxs("a",{href:e.googleMaps,className:"group col-span-1 row-span-1 flex items-center justify-center mt-4 px-5 bg-gradient-to-tr from-orange-400 via-amber-400 to-orange-400 rounded-2xl shadow-lg transition-colors hover:bg-whiteHover",children:[He.jsx(h9,{className:"mr-1 duration-300 group-hover:text-green-600"}),"Maps"]})]}),He.jsx(O5,{images:e.images})]})})]})}function m7(){var p;const t=Ea(),[e,n]=Ve.useState([]),[o,a]=Ve.useState(!0);Ve.useEffect(()=>{(async()=>{a(!0);try{const S=await EP();n(S)}catch(S){console.error("Error fetching locations:",S)}finally{a(!1)}})()},[]);const d=((p=t.state)==null?void 0:p.link)||"/";return He.jsx(He.Fragment,{children:o?He.jsx("div",{className:"absolute transition duration-300  text-6xl top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 font-bold bg-gradient-to-tr from-yellow-500 via-yellow-400 to-amber-500 bg-clip-text text-transparent",children:He.jsx(JP,{visible:!0,width:"200",color:"#F18C18",ariaLabel:"infinity-spin-loading"})}):He.jsx(He.Fragment,{children:He.jsxs("div",{className:"w-4/6 mx-auto mt-4 2xl:w-[1440px] relative",children:[He.jsx("div",{className:"fixed z-10 flex rounded-full top-2 left-4 bg-navColor text-white shadow-lg duration-200 hover:text-main hover:shadow-main hover:scale-110",children:He.jsx("button",{type:"button",className:"p-3",children:He.jsx(cy,{to:d,children:He.jsx(F5,{size:30})})})}),e.map((c,S)=>He.jsx(cy,{to:`/${c.id}`,state:{from:"/list"},children:He.jsxs("div",{className:"flex items-center 2xl:w-[1000px] justify-center relative text-white dark:text-appColor mb-6 w-full xl:w-4/6 border-[2px] border-[#424349] dark:border-[#e6e5e5] mx-auto p-2 rounded-2xl shadow-xl hover:shadow-main hover:shadow-md transition duration-300",children:[He.jsxs("span",{className:"absolute flex items-center justify-center left-2 top-2 rounded-full bg-main size-6 text-white",children:[S+1," "]}),He.jsxs("div",{className:"w-4/6 mt-7 flex justify-center flex-col font-medium text-left",children:[He.jsx("h1",{className:"lg:text-xl xl:text-2xl mb-2",children:c.title}),He.jsxs("a",{href:c.youtube,className:"group flex w-1/2 p-7 items-center lg:text-lg xl:text-xl justify-center lg:mt-2 bg-gradient-to-tr from-orange-400 dark:text-white via-amber-400 to-orange-400 rounded-2xl shadow-lg transition-colors hover:bg-whiteHover",children:[He.jsx(e5,{className:"mr-1 duration-300 group-hover:text-red-600"}),"Youtube"]})]}),He.jsx("div",{className:"w-3/6 max-h-1/2",children:He.jsx("div",{className:"rounded-2xl overflow-hidden aspect-w-16 aspect-h-9",children:He.jsx("img",{src:c.mainImage,className:"object-cover w-full h-full",alt:"main image"})})})]})},c.id))]})})})}function g7(){return He.jsx(XL,{children:He.jsxs(Op,{path:"/",element:He.jsx(c9,{}),children:[He.jsx(Op,{index:!0,element:He.jsx(i9,{})}),He.jsx(Op,{path:"/:id",element:He.jsx(f7,{})}),He.jsx(Op,{path:"/list",element:He.jsx(m7,{})})]})})}_v.createRoot(document.getElementById("root")).render(He.jsx(mr.StrictMode,{children:He.jsx(oD,{basename:"/mualaApp/",children:He.jsx(g7,{})})}));
